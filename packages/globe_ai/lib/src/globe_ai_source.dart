// GENERATED FILE â€” DO NOT MODIFY BY HAND
// This file was generated from package.json

const packageVersion = '1.0.0';

const packageSource = r'''
var xp=Object.create;var ss=Object.defineProperty,Sp=Object.defineProperties,Tp=Object.getOwnPropertyDescriptor,Ip=Object.getOwnPropertyDescriptors,kp=Object.getOwnPropertyNames,lo=Object.getOwnPropertySymbols,Ap=Object.getPrototypeOf,as=Object.prototype.hasOwnProperty,ca=Object.prototype.propertyIsEnumerable;var ua=(e,t)=>(t=Symbol[e])?t:Symbol.for("Symbol."+e),da=e=>{throw TypeError(e)};var pa=(e,t,r)=>t in e?ss(e,t,{enumerable:true,configurable:true,writable:true,value:r}):e[t]=r,d=(e,t)=>{for(var r in t||(t={}))as.call(t,r)&&pa(e,r,t[r]);if(lo)for(var r of lo(t))ca.call(t,r)&&pa(e,r,t[r]);return e},g=(e,t)=>Sp(e,Ip(t));var Ge=(e,t)=>{var r={};for(var n in e)as.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&lo)for(var n of lo(e))t.indexOf(n)<0&&ca.call(e,n)&&(r[n]=e[n]);return r};var fa=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var Ep=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of kp(t))!as.call(e,o)&&o!==r&&ss(e,o,{get:()=>t[o],enumerable:!(n=Tp(t,o))||n.enumerable});return e};var ha=(e,t,r)=>(r=e!=null?xp(Ap(e)):{},Ep(ss(r,"default",{value:e,enumerable:true}),e));var Rp=(e,t,r)=>t.has(e)||da("Cannot "+r);var jt=(e,t,r)=>(Rp(e,t,"read from private field"),r?r.call(e):t.get(e)),Nr=(e,t,r)=>t.has(e)?da("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r);var E=(e,t,r)=>new Promise((n,o)=>{var s=u=>{try{i(r.next(u));}catch(p){o(p);}},a=u=>{try{i(r.throw(u));}catch(p){o(p);}},i=u=>u.done?n(u.value):Promise.resolve(u.value).then(s,a);i((r=r.apply(e,t)).next());});var uo=(e,t,r)=>(t=e[ua("asyncIterator")])?t.call(e):(e=e[ua("iterator")](),t={},r=(n,o)=>(o=e[n])&&(t[n]=s=>new Promise((a,i,u)=>(s=o.call(e,s),u=s.done,Promise.resolve(s.value).then(p=>a({value:p,done:u}),i)))),r("next"),r("return"),t);var hi=fa((ey,Vr)=>{var ud=typeof Buffer!="undefined",pi=/"(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])"\s*:/,ci=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/;function di(e,t,r){r==null&&t!==null&&typeof t=="object"&&(r=t,t=void 0),ud&&Buffer.isBuffer(e)&&(e=e.toString()),e&&e.charCodeAt(0)===65279&&(e=e.slice(1));let n=JSON.parse(e,t);if(n===null||typeof n!="object")return n;let o=r&&r.protoAction||"error",s=r&&r.constructorAction||"error";if(o==="ignore"&&s==="ignore")return n;if(o!=="ignore"&&s!=="ignore"){if(pi.test(e)===false&&ci.test(e)===false)return n}else if(o!=="ignore"&&s==="ignore"){if(pi.test(e)===false)return n}else if(ci.test(e)===false)return n;return fi(n,{protoAction:o,constructorAction:s,safe:r&&r.safe})}function fi(e,{protoAction:t="error",constructorAction:r="error",safe:n}={}){let o=[e];for(;o.length;){let s=o;o=[];for(let a of s){if(t!=="ignore"&&Object.prototype.hasOwnProperty.call(a,"__proto__")){if(n===true)return null;if(t==="error")throw new SyntaxError("Object contains forbidden prototype property");delete a.__proto__;}if(r!=="ignore"&&Object.prototype.hasOwnProperty.call(a,"constructor")&&Object.prototype.hasOwnProperty.call(a.constructor,"prototype")){if(n===true)return null;if(r==="error")throw new SyntaxError("Object contains forbidden prototype property");delete a.constructor;}for(let i in a){let u=a[i];u&&typeof u=="object"&&o.push(u);}}}return e}function hs(e,t,r){let n=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return di(e,t,r)}finally{Error.stackTraceLimit=n;}}function pd(e,t){let r=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return di(e,t,{safe:!0})}catch(n){return null}finally{Error.stackTraceLimit=r;}}Vr.exports=hs;Vr.exports.default=hs;Vr.exports.parse=hs;Vr.exports.safeParse=pd;Vr.exports.scan=fi;});var wp=fa(Ve=>{var Ys=typeof Object.defineProperties=="function"?Object.defineProperty:function(e,t,r){e!=Array.prototype&&e!=Object.prototype&&(e[t]=r.value);},Cr=typeof window!="undefined"&&window===Ve?Ve:typeof global!="undefined"&&global!=null?global:Ve;function hg(e,t){if(t){var r=Cr;e=e.split(".");for(var n=0;n<e.length-1;n++){var o=e[n];o in r||(r[o]={}),r=r[o];}e=e[e.length-1],n=r[e],t=t(n),t!=n&&t!=null&&Ys(r,e,{configurable:true,writable:true,value:t});}}function mg(e){var t=0;return function(){return t<e.length?{done:false,value:e[t++]}:{done:true}}}function Ju(){Ju=function(){},Cr.Symbol||(Cr.Symbol=gg);}function Wu(e,t){this.a=e,Ys(this,"description",{configurable:true,writable:true,value:t});}Wu.prototype.toString=function(){return this.a};var gg=function(){function e(r){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new Wu("jscomp_symbol_"+(r||"")+"_"+t++,r)}var t=0;return e}();function Xs(){Ju();var e=Cr.Symbol.iterator;e||(e=Cr.Symbol.iterator=Cr.Symbol("Symbol.iterator")),typeof Array.prototype[e]!="function"&&Ys(Array.prototype,e,{configurable:true,writable:true,value:function(){return yg(mg(this))}}),Xs=function(){};}function yg(e){return Xs(),e={next:e},e[Cr.Symbol.iterator]=function(){return this},e}function vg(e,t){Xs(),e instanceof String&&(e+="");var r=0,n={next:function(){if(r<e.length){var o=r++;return {value:t(o,e[o]),done:false}}return n.next=function(){return {done:true,value:void 0}},n.next()}};return n[Symbol.iterator]=function(){return n},n}hg("Array.prototype.entries",function(e){return e||function(){return vg(this,function(t,r){return [t,r]})}});var _g=Ve||self;function $(e,t,r){e=e.split("."),r=r||_g,e[0]in r||typeof r.execScript=="undefined"||r.execScript("var "+e[0]);for(var n;e.length&&(n=e.shift());)e.length||t===void 0?r[n]&&r[n]!==Object.prototype[n]?r=r[n]:r=r[n]={}:r[n]=t;}function Ht(e){var t=typeof e;if(t=="object")if(e){if(e instanceof Array)return "array";if(e instanceof Object)return t;var r=Object.prototype.toString.call(e);if(r=="[object Window]")return "object";if(r=="[object Array]"||typeof e.length=="number"&&typeof e.splice!="undefined"&&typeof e.propertyIsEnumerable!="undefined"&&!e.propertyIsEnumerable("splice"))return "array";if(r=="[object Function]"||typeof e.call!="undefined"&&typeof e.propertyIsEnumerable!="undefined"&&!e.propertyIsEnumerable("call"))return "function"}else return "null";else if(t=="function"&&typeof e.call=="undefined")return "object";return t}function Bu(e){var t=typeof e;return t=="object"&&e!=null||t=="function"}function bg(e,t,r){$(e,t,r);}function wg(e,t){function r(){}r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e;}var zu="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function xg(e,t){for(var r,n,o=1;o<arguments.length;o++){n=arguments[o];for(r in n)e[r]=n[r];for(var s=0;s<zu.length;s++)r=zu[s],Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r]);}}var Sg=Array.prototype.forEach?function(e,t){Array.prototype.forEach.call(e,t,void 0);}:function(e,t){for(var r=e.length,n=typeof e=="string"?e.split(""):e,o=0;o<r;o++)o in n&&t.call(void 0,n[o],o,e);},Vn=Array.prototype.map?function(e,t){return Array.prototype.map.call(e,t,void 0)}:function(e,t){for(var r=e.length,n=Array(r),o=typeof e=="string"?e.split(""):e,s=0;s<r;s++)s in o&&(n[s]=t.call(void 0,o[s],s,e));return n};function Tg(e,t,r){return 2>=arguments.length?Array.prototype.slice.call(e,t):Array.prototype.slice.call(e,t,r)}function zo(e,t,r,n){var o="Assertion failed";if(r){o+=": "+r;var s=n;}else e&&(o+=": "+e,s=t);throw Error(o,s||[])}function v(e,t,r){for(var n=[],o=2;o<arguments.length;++o)n[o-2]=arguments[o];return e||zo("",null,t,n),e}function Ig(e,t,r){for(var n=[],o=2;o<arguments.length;++o)n[o-2]=arguments[o];typeof e!="string"&&zo("Expected string but got %s: %s.",[Ht(e),e],t,n);}function kg(e,t,r){for(var n=[],o=2;o<arguments.length;++o)n[o-2]=arguments[o];Array.isArray(e)||zo("Expected array but got %s: %s.",[Ht(e),e],t,n);}function qe(e,t){for(var r=[],n=1;n<arguments.length;++n)r[n-1]=arguments[n];throw Error("Failure"+(e?": "+e:""),r)}function At(e,t,r,n){for(var o=[],s=3;s<arguments.length;++s)o[s-3]=arguments[s];e instanceof t||zo("Expected instanceof %s but got %s.",[Lu(t),Lu(e)],r,o);}function Lu(e){return e instanceof Function?e.displayName||e.name||"unknown type name":e instanceof Object?e.constructor.displayName||e.constructor.name||Object.prototype.toString.call(e):e===null?"null":typeof e}function G(e,t){if(this.c=e,this.b=t,this.a={},this.arrClean=true,0<this.c.length){for(e=0;e<this.c.length;e++){t=this.c[e];var r=t[0];this.a[r.toString()]=new Gu(r,t[1]);}this.arrClean=true;}}$("jspb.Map",G,void 0);G.prototype.g=function(){if(this.arrClean){if(this.b){var e=this.a,t;for(t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var r=e[t].a;r&&r.g();}}}else {for(this.c.length=0,e=sr(this),e.sort(),t=0;t<e.length;t++){var n=this.a[e[t]];(r=n.a)&&r.g(),this.c.push([n.key,n.value]);}this.arrClean=true;}return this.c};G.prototype.toArray=G.prototype.g;G.prototype.Mc=function(e,t){for(var r=this.g(),n=[],o=0;o<r.length;o++){var s=this.a[r[o][0].toString()];rn(this,s);var a=s.a;a?(v(t),n.push([s.key,t(e,a)])):n.push([s.key,s.value]);}return n};G.prototype.toObject=G.prototype.Mc;G.fromObject=function(e,t,r){t=new G([],t);for(var n=0;n<e.length;n++){var o=e[n][0],s=r(e[n][1]);t.set(o,s);}return t};function Zn(e){this.a=0,this.b=e;}Zn.prototype.next=function(){return this.a<this.b.length?{done:false,value:this.b[this.a++]}:{done:true,value:void 0}};typeof Symbol!="undefined"&&(Zn.prototype[Symbol.iterator]=function(){return this});G.prototype.Jb=function(){return sr(this).length};G.prototype.getLength=G.prototype.Jb;G.prototype.clear=function(){this.a={},this.arrClean=false;};G.prototype.clear=G.prototype.clear;G.prototype.Cb=function(e){e=e.toString();var t=this.a.hasOwnProperty(e);return delete this.a[e],this.arrClean=false,t};G.prototype.del=G.prototype.Cb;G.prototype.Eb=function(){var e=[],t=sr(this);t.sort();for(var r=0;r<t.length;r++){var n=this.a[t[r]];e.push([n.key,n.value]);}return e};G.prototype.getEntryList=G.prototype.Eb;G.prototype.entries=function(){var e=[],t=sr(this);t.sort();for(var r=0;r<t.length;r++){var n=this.a[t[r]];e.push([n.key,rn(this,n)]);}return new Zn(e)};G.prototype.entries=G.prototype.entries;G.prototype.keys=function(){var e=[],t=sr(this);t.sort();for(var r=0;r<t.length;r++)e.push(this.a[t[r]].key);return new Zn(e)};G.prototype.keys=G.prototype.keys;G.prototype.values=function(){var e=[],t=sr(this);t.sort();for(var r=0;r<t.length;r++)e.push(rn(this,this.a[t[r]]));return new Zn(e)};G.prototype.values=G.prototype.values;G.prototype.forEach=function(e,t){var r=sr(this);r.sort();for(var n=0;n<r.length;n++){var o=this.a[r[n]];e.call(t,rn(this,o),o.key,this);}};G.prototype.forEach=G.prototype.forEach;G.prototype.set=function(e,t){var r=new Gu(e);return this.b?(r.a=t,r.value=t.g()):r.value=t,this.a[e.toString()]=r,this.arrClean=false,this};G.prototype.set=G.prototype.set;function rn(e,t){return e.b?(t.a||(t.a=new e.b(t.value)),t.a):t.value}G.prototype.get=function(e){if(e=this.a[e.toString()])return rn(this,e)};G.prototype.get=G.prototype.get;G.prototype.has=function(e){return e.toString()in this.a};G.prototype.has=G.prototype.has;G.prototype.Jc=function(e,t,r,n,o){var s=sr(this);s.sort();for(var a=0;a<s.length;a++){var i=this.a[s[a]];t.Va(e),r.call(t,1,i.key),this.b?n.call(t,2,rn(this,i),o):n.call(t,2,i.value),t.Ya();}};G.prototype.serializeBinary=G.prototype.Jc;G.deserializeBinary=function(e,t,r,n,o,s,a){for(;t.oa()&&!t.bb();){var i=t.c;i==1?s=r.call(t):i==2&&(e.b?(v(o),a||(a=new e.b),n.call(t,a,o)):a=n.call(t));}v(s!=null),v(a!=null),e.set(s,a);};function sr(e){e=e.a;var t=[],r;for(r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t}function Gu(e,t){this.key=e,this.value=t,this.a=void 0;}function Hu(e){if(8192>=e.length)return String.fromCharCode.apply(null,e);for(var t="",r=0;r<e.length;r+=8192)t+=String.fromCharCode.apply(null,Tg(e,r,r+8192));return t}var Ws={"\0":"\\0","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","\v":"\\x0B",'"':'\\"',"\\":"\\\\","<":"\\u003C"},Bo={"'":"\\'"},Ku={},qn=null;function Yu(e,t){t===void 0&&(t=0),Qu(),t=Ku[t];for(var r=[],n=0;n<e.length;n+=3){var o=e[n],s=n+1<e.length,a=s?e[n+1]:0,i=n+2<e.length,u=i?e[n+2]:0,p=o>>2;o=(o&3)<<4|a>>4,a=(a&15)<<2|u>>6,u&=63,i||(u=64,s||(a=64)),r.push(t[p],t[o],t[a]||"",t[u]||"");}return r.join("")}function Xu(e){var t=e.length,r=3*t/4;r%3?r=Math.floor(r):"=.".indexOf(e[t-1])!=-1&&(r="=.".indexOf(e[t-2])!=-1?r-2:r-1);var n=new Uint8Array(r),o=0;return Ag(e,function(s){n[o++]=s;}),n.subarray(0,o)}function Ag(e,t){function r(u){for(;n<e.length;){var p=e.charAt(n++),h=qn[p];if(h!=null)return h;if(!/^[\s\xa0]*$/.test(p))throw Error("Unknown base64 encoding at char: "+p)}return u}Qu();for(var n=0;;){var o=r(-1),s=r(0),a=r(64),i=r(64);if(i===64&&o===-1)break;t(o<<2|s>>4),a!=64&&(t(s<<4&240|a>>2),i!=64&&t(a<<6&192|i));}}function Qu(){if(!qn){qn={};for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),t=["+/=","+/","-_=","-_.","-_"],r=0;5>r;r++){var n=e.concat(t[r].split(""));Ku[r]=n;for(var o=0;o<n.length;o++){var s=n[o];qn[s]===void 0&&(qn[s]=o);}}}}$("jspb.ConstBinaryMessage",function(){},void 0);$("jspb.BinaryMessage",function(){},void 0);$("jspb.BinaryConstants.FieldType",{yb:-1,ee:1,FLOAT:2,ke:3,te:4,je:5,xb:6,wb:7,BOOL:8,re:9,ie:10,le:11,ce:12,se:13,ge:14,me:15,ne:16,oe:17,pe:18,he:30,ve:31},void 0);$("jspb.BinaryConstants.WireType",{yb:-1,ue:0,xb:1,de:2,qe:3,fe:4,wb:5},void 0);$("jspb.BinaryConstants.FieldTypeToWireType",function(e){switch(e){case 5:case 3:case 13:case 4:case 17:case 18:case 8:case 14:case 31:return 0;case 1:case 6:case 16:case 30:return 1;case 9:case 11:case 12:return 2;case 2:case 7:case 15:return 5;default:return  -1}},void 0);$("jspb.BinaryConstants.INVALID_FIELD_NUMBER",-1,void 0);$("jspb.BinaryConstants.FLOAT32_EPS",1401298464324817e-60,void 0);$("jspb.BinaryConstants.FLOAT32_MIN",11754943508222875e-54,void 0);$("jspb.BinaryConstants.FLOAT32_MAX",34028234663852886e22,void 0);$("jspb.BinaryConstants.FLOAT64_EPS",5e-324,void 0);$("jspb.BinaryConstants.FLOAT64_MIN",22250738585072014e-324,void 0);$("jspb.BinaryConstants.FLOAT64_MAX",17976931348623157e292,void 0);$("jspb.BinaryConstants.TWO_TO_20",1048576,void 0);$("jspb.BinaryConstants.TWO_TO_23",8388608,void 0);$("jspb.BinaryConstants.TWO_TO_31",2147483648,void 0);$("jspb.BinaryConstants.TWO_TO_32",4294967296,void 0);$("jspb.BinaryConstants.TWO_TO_52",4503599627370496,void 0);$("jspb.BinaryConstants.TWO_TO_63",9223372036854776e3,void 0);$("jspb.BinaryConstants.TWO_TO_64",18446744073709552e3,void 0);$("jspb.BinaryConstants.ZERO_HASH","\0\0\0\0\0\0\0\0",void 0);var ce=0,de=0;$("jspb.utils.getSplit64Low",function(){return ce},void 0);$("jspb.utils.getSplit64High",function(){return de},void 0);function Qs(e){var t=e>>>0;e=Math.floor((e-t)/4294967296)>>>0,ce=t,de=e;}$("jspb.utils.splitUint64",Qs,void 0);function Jn(e){var t=0>e;e=Math.abs(e);var r=e>>>0;e=Math.floor((e-r)/4294967296),e>>>=0,t&&(e=~e>>>0,r=(~r>>>0)+1,4294967295<r&&(r=0,e++,4294967295<e&&(e=0))),ce=r,de=e;}$("jspb.utils.splitInt64",Jn,void 0);function ep(e){var t=0>e;e=2*Math.abs(e),Qs(e),e=ce;var r=de;t&&(e==0?r==0?r=e=4294967295:(r--,e=4294967295):e--),ce=e,de=r;}$("jspb.utils.splitZigzag64",ep,void 0);function tp(e){var t=0>e?1:0;if(e=t?-e:e,e===0)0<1/e?ce=de=0:(de=0,ce=2147483648);else if(isNaN(e))de=0,ce=2147483647;else if(34028234663852886e22<e)de=0,ce=(t<<31|2139095040)>>>0;else if(11754943508222875e-54>e)e=Math.round(e/Math.pow(2,-149)),de=0,ce=(t<<31|e)>>>0;else {var r=Math.floor(Math.log(e)/Math.LN2);e*=Math.pow(2,-r),e=Math.round(8388608*e),16777216<=e&&++r,de=0,ce=(t<<31|r+127<<23|e&8388607)>>>0;}}$("jspb.utils.splitFloat32",tp,void 0);function rp(e){var t=0>e?1:0;if(e=t?-e:e,e===0)de=0<1/e?0:2147483648,ce=0;else if(isNaN(e))de=2147483647,ce=4294967295;else if(17976931348623157e292<e)de=(t<<31|2146435072)>>>0,ce=0;else if(22250738585072014e-324>e)e/=Math.pow(2,-1074),de=(t<<31|e/4294967296)>>>0,ce=e>>>0;else {var r=e,n=0;if(2<=r)for(;2<=r&&1023>n;)n++,r/=2;else for(;1>r&&-1022<n;)r*=2,n--;e*=Math.pow(2,-n),de=(t<<31|n+1023<<20|1048576*e&1048575)>>>0,ce=4503599627370496*e>>>0;}}$("jspb.utils.splitFloat64",rp,void 0);function ar(e){var t=e.charCodeAt(4),r=e.charCodeAt(5),n=e.charCodeAt(6),o=e.charCodeAt(7);ce=e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)>>>0,de=t+(r<<8)+(n<<16)+(o<<24)>>>0;}$("jspb.utils.splitHash64",ar,void 0);function nn(e,t){return 4294967296*t+(e>>>0)}$("jspb.utils.joinUint64",nn,void 0);function Wn(e,t){var r=t&2147483648;return r&&(e=~e+1>>>0,t=~t>>>0,e==0&&(t=t+1>>>0)),e=nn(e,t),r?-e:e}$("jspb.utils.joinInt64",Wn,void 0);function Lo(e,t,r){var n=t>>31;return r(e<<1^n,(t<<1|e>>>31)^n)}$("jspb.utils.toZigzag64",Lo,void 0);function np(e,t){return Vo(e,t,Wn)}$("jspb.utils.joinZigzag64",np,void 0);function Vo(e,t,r){var n=-(e&1);return r((e>>>1|t<<31)^n,t>>>1^n)}$("jspb.utils.fromZigzag64",Vo,void 0);function op(e){var t=2*(e>>31)+1,r=e>>>23&255;return e&=8388607,r==255?e?NaN:1/0*t:r==0?t*Math.pow(2,-149)*e:t*Math.pow(2,r-150)*(e+Math.pow(2,23))}$("jspb.utils.joinFloat32",op,void 0);function sp(e,t){var r=2*(t>>31)+1,n=t>>>20&2047;return e=4294967296*(t&1048575)+e,n==2047?e?NaN:1/0*r:n==0?r*Math.pow(2,-1074)*e:r*Math.pow(2,n-1075)*(e+4503599627370496)}$("jspb.utils.joinFloat64",sp,void 0);function Zo(e,t){return String.fromCharCode(e>>>0&255,e>>>8&255,e>>>16&255,e>>>24&255,t>>>0&255,t>>>8&255,t>>>16&255,t>>>24&255)}$("jspb.utils.joinHash64",Zo,void 0);$("jspb.utils.DIGITS","0123456789abcdef".split(""),void 0);function Gn(e,t){function r(o,s){return o=o?String(o):"",s?"0000000".slice(o.length)+o:o}if(2097151>=t)return ""+nn(e,t);var n=(e>>>24|t<<8)>>>0&16777215;return t=t>>16&65535,e=(e&16777215)+6777216*n+6710656*t,n+=8147497*t,t*=2,1e7<=e&&(n+=Math.floor(e/1e7),e%=1e7),1e7<=n&&(t+=Math.floor(n/1e7),n%=1e7),r(t,0)+r(n,t)+r(e,1)}$("jspb.utils.joinUnsignedDecimalString",Gn,void 0);function Hn(e,t){var r=t&2147483648;return r&&(e=~e+1>>>0,t=~t+(e==0?1:0)>>>0),e=Gn(e,t),r?"-"+e:e}$("jspb.utils.joinSignedDecimalString",Hn,void 0);function ap(e,t){ar(e),e=ce;var r=de;return t?Hn(e,r):Gn(e,r)}$("jspb.utils.hash64ToDecimalString",ap,void 0);$("jspb.utils.hash64ArrayToDecimalStrings",function(e,t){for(var r=Array(e.length),n=0;n<e.length;n++)r[n]=ap(e[n],t);return r},void 0);function Kn(e){function t(a,i){for(var u=0;8>u&&(a!==1||0<i);u++)i=a*o[u]+i,o[u]=i&255,i>>>=8;}function r(){for(var a=0;8>a;a++)o[a]=~o[a]&255;}v(0<e.length);var n=false;e[0]==="-"&&(n=true,e=e.slice(1));for(var o=[0,0,0,0,0,0,0,0],s=0;s<e.length;s++)t(10,e.charCodeAt(s)-48);return n&&(r(),t(1,1)),Hu(o)}$("jspb.utils.decimalStringToHash64",Kn,void 0);$("jspb.utils.splitDecimalString",function(e){ar(Kn(e));},void 0);function Vu(e){return String.fromCharCode(10>e?48+e:87+e)}function Zu(e){return 97<=e?e-97+10:e-48}$("jspb.utils.hash64ToHexString",function(e){var t=Array(18);t[0]="0",t[1]="x";for(var r=0;8>r;r++){var n=e.charCodeAt(7-r);t[2*r+2]=Vu(n>>4),t[2*r+3]=Vu(n&15);}return t.join("")},void 0);$("jspb.utils.hexStringToHash64",function(e){e=e.toLowerCase(),v(e.length==18),v(e[0]=="0"),v(e[1]=="x");for(var t="",r=0;8>r;r++)t=String.fromCharCode(16*Zu(e.charCodeAt(2*r+2))+Zu(e.charCodeAt(2*r+3)))+t;return t},void 0);$("jspb.utils.hash64ToNumber",function(e,t){ar(e),e=ce;var r=de;return t?Wn(e,r):nn(e,r)},void 0);$("jspb.utils.numberToHash64",function(e){return Jn(e),Zo(ce,de)},void 0);$("jspb.utils.countVarints",function(e,t,r){for(var n=0,o=t;o<r;o++)n+=e[o]>>7;return r-t-n},void 0);$("jspb.utils.countVarintFields",function(e,t,r,n){var o=0;if(n*=8,128>n)for(;t<r&&e[t++]==n;)for(o++;;){var s=e[t++];if((s&128)==0)break}else for(;t<r;){for(s=n;128<s;){if(e[t]!=(s&127|128))return o;t++,s>>=7;}if(e[t++]!=s)break;for(o++;s=e[t++],(s&128)!=0;);}return o},void 0);function ip(e,t,r,n,o){var s=0;if(128>n)for(;t<r&&e[t++]==n;)s++,t+=o;else for(;t<r;){for(var a=n;128<a;){if(e[t++]!=(a&127|128))return s;a>>=7;}if(e[t++]!=a)break;s++,t+=o;}return s}$("jspb.utils.countFixed32Fields",function(e,t,r,n){return ip(e,t,r,8*n+5,4)},void 0);$("jspb.utils.countFixed64Fields",function(e,t,r,n){return ip(e,t,r,8*n+1,8)},void 0);$("jspb.utils.countDelimitedFields",function(e,t,r,n){var o=0;for(n=8*n+2;t<r;){for(var s=n;128<s;){if(e[t++]!=(s&127|128))return o;s>>=7;}if(e[t++]!=s)break;o++;for(var a=0,i=1;s=e[t++],a+=(s&127)*i,i*=128,(s&128)!=0;);t+=a;}return o},void 0);$("jspb.utils.debugBytesToTextFormat",function(e){var t='"';if(e){e=Jo(e);for(var r=0;r<e.length;r++)t+="\\x",16>e[r]&&(t+="0"),t+=e[r].toString(16);}return t+'"'},void 0);$("jspb.utils.debugScalarToTextFormat",function(e){if(typeof e=="string"){e=String(e);for(var t=['"'],r=0;r<e.length;r++){var n=e.charAt(r),o=n.charCodeAt(0),s=r+1,a;(a=Ws[n])||(31<o&&127>o||(o=n,o in Bo?n=Bo[o]:o in Ws?n=Bo[o]=Ws[o]:(a=o.charCodeAt(0),31<a&&127>a?n=o:(256>a?(n="\\x",(16>a||256<a)&&(n+="0")):(n="\\u",4096>a&&(n+="0")),n+=a.toString(16).toUpperCase()),n=Bo[o]=n)),a=n),t[s]=a;}t.push('"'),e=t.join("");}else e=e.toString();return e},void 0);$("jspb.utils.stringToByteArray",function(e){for(var t=new Uint8Array(e.length),r=0;r<e.length;r++){var n=e.charCodeAt(r);if(255<n)throw Error("Conversion error: string contains codepoint outside of byte range");t[r]=n;}return t},void 0);function Jo(e){return e.constructor===Uint8Array?e:e.constructor===ArrayBuffer?new Uint8Array(e):e.constructor===Array?new Uint8Array(e):e.constructor===String?Xu(e):e instanceof Uint8Array?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):(qe("Type not convertible to Uint8Array."),new Uint8Array(0))}$("jspb.utils.byteSourceToUint8Array",Jo,void 0);function y(e,t,r){this.b=null,this.a=this.c=this.h=0,this.v=false,e&&this.H(e,t,r);}$("jspb.BinaryDecoder",y,void 0);var Bn=[];y.getInstanceCacheLength=function(){return Bn.length};function Wo(e,t,r){if(Bn.length){var n=Bn.pop();return e&&n.H(e,t,r),n}return new y(e,t,r)}y.alloc=Wo;y.prototype.Ca=function(){this.clear(),100>Bn.length&&Bn.push(this);};y.prototype.free=y.prototype.Ca;y.prototype.clone=function(){return Wo(this.b,this.h,this.c-this.h)};y.prototype.clone=y.prototype.clone;y.prototype.clear=function(){this.b=null,this.a=this.c=this.h=0,this.v=false;};y.prototype.clear=y.prototype.clear;y.prototype.Y=function(){return this.b};y.prototype.getBuffer=y.prototype.Y;y.prototype.H=function(e,t,r){this.b=Jo(e),this.h=t!==void 0?t:0,this.c=r!==void 0?this.h+r:this.b.length,this.a=this.h;};y.prototype.setBlock=y.prototype.H;y.prototype.Db=function(){return this.c};y.prototype.getEnd=y.prototype.Db;y.prototype.setEnd=function(e){this.c=e;};y.prototype.setEnd=y.prototype.setEnd;y.prototype.reset=function(){this.a=this.h;};y.prototype.reset=y.prototype.reset;y.prototype.B=function(){return this.a};y.prototype.getCursor=y.prototype.B;y.prototype.Ma=function(e){this.a=e;};y.prototype.setCursor=y.prototype.Ma;y.prototype.advance=function(e){this.a+=e,v(this.a<=this.c);};y.prototype.advance=y.prototype.advance;y.prototype.ya=function(){return this.a==this.c};y.prototype.atEnd=y.prototype.ya;y.prototype.Qb=function(){return this.a>this.c};y.prototype.pastEnd=y.prototype.Qb;y.prototype.getError=function(){return this.v||0>this.a||this.a>this.c};y.prototype.getError=y.prototype.getError;y.prototype.w=function(e){for(var t=128,r=0,n=0,o=0;4>o&&128<=t;o++)t=this.b[this.a++],r|=(t&127)<<7*o;if(128<=t&&(t=this.b[this.a++],r|=(t&127)<<28,n|=(t&127)>>4),128<=t)for(o=0;5>o&&128<=t;o++)t=this.b[this.a++],n|=(t&127)<<7*o+3;if(128>t)return e(r>>>0,n>>>0);qe("Failed to read varint, encoding is invalid."),this.v=true;};y.prototype.readSplitVarint64=y.prototype.w;y.prototype.ea=function(e){return this.w(function(t,r){return Vo(t,r,e)})};y.prototype.readSplitZigzagVarint64=y.prototype.ea;y.prototype.ta=function(e){var t=this.b,r=this.a;this.a+=8;for(var n=0,o=0,s=r+7;s>=r;s--)n=n<<8|t[s],o=o<<8|t[s+4];return e(n,o)};y.prototype.readSplitFixed64=y.prototype.ta;y.prototype.kb=function(){for(;this.b[this.a]&128;)this.a++;this.a++;};y.prototype.skipVarint=y.prototype.kb;y.prototype.mb=function(e){for(;128<e;)this.a--,e>>>=7;this.a--;};y.prototype.unskipVarint=y.prototype.mb;y.prototype.o=function(){var e=this.b,t=e[this.a],r=t&127;return 128>t?(this.a+=1,v(this.a<=this.c),r):(t=e[this.a+1],r|=(t&127)<<7,128>t?(this.a+=2,v(this.a<=this.c),r):(t=e[this.a+2],r|=(t&127)<<14,128>t?(this.a+=3,v(this.a<=this.c),r):(t=e[this.a+3],r|=(t&127)<<21,128>t?(this.a+=4,v(this.a<=this.c),r):(t=e[this.a+4],r|=(t&15)<<28,128>t?(this.a+=5,v(this.a<=this.c),r>>>0):(this.a+=5,128<=e[this.a++]&&128<=e[this.a++]&&128<=e[this.a++]&&128<=e[this.a++]&&128<=e[this.a++]&&v(false),v(this.a<=this.c),r)))))};y.prototype.readUnsignedVarint32=y.prototype.o;y.prototype.da=function(){return ~~this.o()};y.prototype.readSignedVarint32=y.prototype.da;y.prototype.O=function(){return this.o().toString()};y.prototype.Ea=function(){return this.da().toString()};y.prototype.readSignedVarint32String=y.prototype.Ea;y.prototype.Ia=function(){var e=this.o();return e>>>1^-(e&1)};y.prototype.readZigzagVarint32=y.prototype.Ia;y.prototype.Ga=function(){return this.w(nn)};y.prototype.readUnsignedVarint64=y.prototype.Ga;y.prototype.Ha=function(){return this.w(Gn)};y.prototype.readUnsignedVarint64String=y.prototype.Ha;y.prototype.sa=function(){return this.w(Wn)};y.prototype.readSignedVarint64=y.prototype.sa;y.prototype.Fa=function(){return this.w(Hn)};y.prototype.readSignedVarint64String=y.prototype.Fa;y.prototype.Ja=function(){return this.w(np)};y.prototype.readZigzagVarint64=y.prototype.Ja;y.prototype.fb=function(){return this.ea(Zo)};y.prototype.readZigzagVarintHash64=y.prototype.fb;y.prototype.Ka=function(){return this.ea(Hn)};y.prototype.readZigzagVarint64String=y.prototype.Ka;y.prototype.Gc=function(){var e=this.b[this.a];return this.a+=1,v(this.a<=this.c),e};y.prototype.readUint8=y.prototype.Gc;y.prototype.Ec=function(){var e=this.b[this.a],t=this.b[this.a+1];return this.a+=2,v(this.a<=this.c),e<<0|t<<8};y.prototype.readUint16=y.prototype.Ec;y.prototype.m=function(){var e=this.b[this.a],t=this.b[this.a+1],r=this.b[this.a+2],n=this.b[this.a+3];return this.a+=4,v(this.a<=this.c),(e<<0|t<<8|r<<16|n<<24)>>>0};y.prototype.readUint32=y.prototype.m;y.prototype.ga=function(){var e=this.m(),t=this.m();return nn(e,t)};y.prototype.readUint64=y.prototype.ga;y.prototype.ha=function(){var e=this.m(),t=this.m();return Gn(e,t)};y.prototype.readUint64String=y.prototype.ha;y.prototype.Xb=function(){var e=this.b[this.a];return this.a+=1,v(this.a<=this.c),e<<24>>24};y.prototype.readInt8=y.prototype.Xb;y.prototype.Vb=function(){var e=this.b[this.a],t=this.b[this.a+1];return this.a+=2,v(this.a<=this.c),(e<<0|t<<8)<<16>>16};y.prototype.readInt16=y.prototype.Vb;y.prototype.P=function(){var e=this.b[this.a],t=this.b[this.a+1],r=this.b[this.a+2],n=this.b[this.a+3];return this.a+=4,v(this.a<=this.c),e<<0|t<<8|r<<16|n<<24};y.prototype.readInt32=y.prototype.P;y.prototype.ba=function(){var e=this.m(),t=this.m();return Wn(e,t)};y.prototype.readInt64=y.prototype.ba;y.prototype.ca=function(){var e=this.m(),t=this.m();return Hn(e,t)};y.prototype.readInt64String=y.prototype.ca;y.prototype.aa=function(){var e=this.m();return op(e)};y.prototype.readFloat=y.prototype.aa;y.prototype.Z=function(){var e=this.m(),t=this.m();return sp(e,t)};y.prototype.readDouble=y.prototype.Z;y.prototype.pa=function(){return !!this.b[this.a++]};y.prototype.readBool=y.prototype.pa;y.prototype.ra=function(){return this.da()};y.prototype.readEnum=y.prototype.ra;y.prototype.fa=function(e){var t=this.b,r=this.a;e=r+e;for(var n=[],o="";r<e;){var s=t[r++];if(128>s)n.push(s);else {if(192>s)continue;if(224>s){var a=t[r++];n.push((s&31)<<6|a&63);}else if(240>s){a=t[r++];var i=t[r++];n.push((s&15)<<12|(a&63)<<6|i&63);}else if(248>s){a=t[r++],i=t[r++];var u=t[r++];s=(s&7)<<18|(a&63)<<12|(i&63)<<6|u&63,s-=65536,n.push((s>>10&1023)+55296,(s&1023)+56320);}}8192<=n.length&&(o+=String.fromCharCode.apply(null,n),n.length=0);}return o+=Hu(n),this.a=r,o};y.prototype.readString=y.prototype.fa;y.prototype.Dc=function(){var e=this.o();return this.fa(e)};y.prototype.readStringWithLength=y.prototype.Dc;y.prototype.qa=function(e){if(0>e||this.a+e>this.b.length)return this.v=true,qe("Invalid byte length!"),new Uint8Array(0);var t=this.b.subarray(this.a,this.a+e);return this.a+=e,v(this.a<=this.c),t};y.prototype.readBytes=y.prototype.qa;y.prototype.ia=function(){return this.w(Zo)};y.prototype.readVarintHash64=y.prototype.ia;y.prototype.$=function(){var e=this.b,t=this.a,r=e[t],n=e[t+1],o=e[t+2],s=e[t+3],a=e[t+4],i=e[t+5],u=e[t+6];return e=e[t+7],this.a+=8,String.fromCharCode(r,n,o,s,a,i,u,e)};y.prototype.readFixedHash64=y.prototype.$;function f(e,t,r){this.a=Wo(e,t,r),this.O=this.a.B(),this.b=this.c=-1,this.h=false,this.v=null;}$("jspb.BinaryReader",f,void 0);var tn=[];f.clearInstanceCache=function(){tn=[];};f.getInstanceCacheLength=function(){return tn.length};function lp(e,t,r){if(tn.length){var n=tn.pop();return e&&n.a.H(e,t,r),n}return new f(e,t,r)}f.alloc=lp;f.prototype.zb=lp;f.prototype.alloc=f.prototype.zb;f.prototype.Ca=function(){this.a.clear(),this.b=this.c=-1,this.h=false,this.v=null,100>tn.length&&tn.push(this);};f.prototype.free=f.prototype.Ca;f.prototype.Fb=function(){return this.O};f.prototype.getFieldCursor=f.prototype.Fb;f.prototype.B=function(){return this.a.B()};f.prototype.getCursor=f.prototype.B;f.prototype.Y=function(){return this.a.Y()};f.prototype.getBuffer=f.prototype.Y;f.prototype.Hb=function(){return this.c};f.prototype.getFieldNumber=f.prototype.Hb;f.prototype.Lb=function(){return this.b};f.prototype.getWireType=f.prototype.Lb;f.prototype.Mb=function(){return this.b==2};f.prototype.isDelimited=f.prototype.Mb;f.prototype.bb=function(){return this.b==4};f.prototype.isEndGroup=f.prototype.bb;f.prototype.getError=function(){return this.h||this.a.getError()};f.prototype.getError=f.prototype.getError;f.prototype.H=function(e,t,r){this.a.H(e,t,r),this.b=this.c=-1;};f.prototype.setBlock=f.prototype.H;f.prototype.reset=function(){this.a.reset(),this.b=this.c=-1;};f.prototype.reset=f.prototype.reset;f.prototype.advance=function(e){this.a.advance(e);};f.prototype.advance=f.prototype.advance;f.prototype.oa=function(){if(this.a.ya())return  false;if(this.getError())return qe("Decoder hit an error"),false;this.O=this.a.B();var e=this.a.o(),t=e>>>3;return e&=7,e!=0&&e!=5&&e!=1&&e!=2&&e!=3&&e!=4?(qe("Invalid wire type: %s (at position %s)",e,this.O),this.h=true,false):(this.c=t,this.b=e,true)};f.prototype.nextField=f.prototype.oa;f.prototype.Oa=function(){this.a.mb(this.c<<3|this.b);};f.prototype.unskipHeader=f.prototype.Oa;f.prototype.Lc=function(){var e=this.c;for(this.Oa();this.oa()&&this.c==e;)this.C();this.a.ya()||this.Oa();};f.prototype.skipMatchingFields=f.prototype.Lc;f.prototype.lb=function(){this.b!=0?(qe("Invalid wire type for skipVarintField"),this.C()):this.a.kb();};f.prototype.skipVarintField=f.prototype.lb;f.prototype.gb=function(){if(this.b!=2)qe("Invalid wire type for skipDelimitedField"),this.C();else {var e=this.a.o();this.a.advance(e);}};f.prototype.skipDelimitedField=f.prototype.gb;f.prototype.hb=function(){this.b!=5?(qe("Invalid wire type for skipFixed32Field"),this.C()):this.a.advance(4);};f.prototype.skipFixed32Field=f.prototype.hb;f.prototype.ib=function(){this.b!=1?(qe("Invalid wire type for skipFixed64Field"),this.C()):this.a.advance(8);};f.prototype.skipFixed64Field=f.prototype.ib;f.prototype.jb=function(){var e=this.c;do{if(!this.oa()){qe("Unmatched start-group tag: stream EOF"),this.h=true;break}if(this.b==4){this.c!=e&&(qe("Unmatched end-group tag"),this.h=true);break}this.C();}while(true)};f.prototype.skipGroup=f.prototype.jb;f.prototype.C=function(){switch(this.b){case 0:this.lb();break;case 1:this.ib();break;case 2:this.gb();break;case 5:this.hb();break;case 3:this.jb();break;default:qe("Invalid wire encoding for field.");}};f.prototype.skipField=f.prototype.C;f.prototype.Hc=function(e,t){this.v===null&&(this.v={}),v(!this.v[e]),this.v[e]=t;};f.prototype.registerReadCallback=f.prototype.Hc;f.prototype.Ic=function(e){return v(this.v!==null),e=this.v[e],v(e),e(this)};f.prototype.runReadCallback=f.prototype.Ic;f.prototype.Yb=function(e,t){v(this.b==2);var r=this.a.c,n=this.a.o();n=this.a.B()+n,this.a.setEnd(n),t(e,this),this.a.Ma(n),this.a.setEnd(r);};f.prototype.readMessage=f.prototype.Yb;f.prototype.Ub=function(e,t,r){v(this.b==3),v(this.c==e),r(t,this),this.h||this.b==4||(qe("Group submessage did not end with an END_GROUP tag"),this.h=true);};f.prototype.readGroup=f.prototype.Ub;f.prototype.Gb=function(){v(this.b==2);var e=this.a.o(),t=this.a.B(),r=t+e;return e=Wo(this.a.Y(),t,e),this.a.Ma(r),e};f.prototype.getFieldDecoder=f.prototype.Gb;f.prototype.P=function(){return v(this.b==0),this.a.da()};f.prototype.readInt32=f.prototype.P;f.prototype.Wb=function(){return v(this.b==0),this.a.Ea()};f.prototype.readInt32String=f.prototype.Wb;f.prototype.ba=function(){return v(this.b==0),this.a.sa()};f.prototype.readInt64=f.prototype.ba;f.prototype.ca=function(){return v(this.b==0),this.a.Fa()};f.prototype.readInt64String=f.prototype.ca;f.prototype.m=function(){return v(this.b==0),this.a.o()};f.prototype.readUint32=f.prototype.m;f.prototype.Fc=function(){return v(this.b==0),this.a.O()};f.prototype.readUint32String=f.prototype.Fc;f.prototype.ga=function(){return v(this.b==0),this.a.Ga()};f.prototype.readUint64=f.prototype.ga;f.prototype.ha=function(){return v(this.b==0),this.a.Ha()};f.prototype.readUint64String=f.prototype.ha;f.prototype.zc=function(){return v(this.b==0),this.a.Ia()};f.prototype.readSint32=f.prototype.zc;f.prototype.Ac=function(){return v(this.b==0),this.a.Ja()};f.prototype.readSint64=f.prototype.Ac;f.prototype.Bc=function(){return v(this.b==0),this.a.Ka()};f.prototype.readSint64String=f.prototype.Bc;f.prototype.Rb=function(){return v(this.b==5),this.a.m()};f.prototype.readFixed32=f.prototype.Rb;f.prototype.Sb=function(){return v(this.b==1),this.a.ga()};f.prototype.readFixed64=f.prototype.Sb;f.prototype.Tb=function(){return v(this.b==1),this.a.ha()};f.prototype.readFixed64String=f.prototype.Tb;f.prototype.vc=function(){return v(this.b==5),this.a.P()};f.prototype.readSfixed32=f.prototype.vc;f.prototype.wc=function(){return v(this.b==5),this.a.P().toString()};f.prototype.readSfixed32String=f.prototype.wc;f.prototype.xc=function(){return v(this.b==1),this.a.ba()};f.prototype.readSfixed64=f.prototype.xc;f.prototype.yc=function(){return v(this.b==1),this.a.ca()};f.prototype.readSfixed64String=f.prototype.yc;f.prototype.aa=function(){return v(this.b==5),this.a.aa()};f.prototype.readFloat=f.prototype.aa;f.prototype.Z=function(){return v(this.b==1),this.a.Z()};f.prototype.readDouble=f.prototype.Z;f.prototype.pa=function(){return v(this.b==0),!!this.a.o()};f.prototype.readBool=f.prototype.pa;f.prototype.ra=function(){return v(this.b==0),this.a.sa()};f.prototype.readEnum=f.prototype.ra;f.prototype.fa=function(){v(this.b==2);var e=this.a.o();return this.a.fa(e)};f.prototype.readString=f.prototype.fa;f.prototype.qa=function(){v(this.b==2);var e=this.a.o();return this.a.qa(e)};f.prototype.readBytes=f.prototype.qa;f.prototype.ia=function(){return v(this.b==0),this.a.ia()};f.prototype.readVarintHash64=f.prototype.ia;f.prototype.Cc=function(){return v(this.b==0),this.a.fb()};f.prototype.readSintHash64=f.prototype.Cc;f.prototype.w=function(e){return v(this.b==0),this.a.w(e)};f.prototype.readSplitVarint64=f.prototype.w;f.prototype.ea=function(e){return v(this.b==0),this.a.w(function(t,r){return Vo(t,r,e)})};f.prototype.readSplitZigzagVarint64=f.prototype.ea;f.prototype.$=function(){return v(this.b==1),this.a.$()};f.prototype.readFixedHash64=f.prototype.$;f.prototype.ta=function(e){return v(this.b==1),this.a.ta(e)};f.prototype.readSplitFixed64=f.prototype.ta;function xe(e,t){v(e.b==2);var r=e.a.o();r=e.a.B()+r;for(var n=[];e.a.B()<r;)n.push(t.call(e.a));return n}f.prototype.gc=function(){return xe(this,this.a.da)};f.prototype.readPackedInt32=f.prototype.gc;f.prototype.hc=function(){return xe(this,this.a.Ea)};f.prototype.readPackedInt32String=f.prototype.hc;f.prototype.ic=function(){return xe(this,this.a.sa)};f.prototype.readPackedInt64=f.prototype.ic;f.prototype.jc=function(){return xe(this,this.a.Fa)};f.prototype.readPackedInt64String=f.prototype.jc;f.prototype.qc=function(){return xe(this,this.a.o)};f.prototype.readPackedUint32=f.prototype.qc;f.prototype.rc=function(){return xe(this,this.a.O)};f.prototype.readPackedUint32String=f.prototype.rc;f.prototype.sc=function(){return xe(this,this.a.Ga)};f.prototype.readPackedUint64=f.prototype.sc;f.prototype.tc=function(){return xe(this,this.a.Ha)};f.prototype.readPackedUint64String=f.prototype.tc;f.prototype.nc=function(){return xe(this,this.a.Ia)};f.prototype.readPackedSint32=f.prototype.nc;f.prototype.oc=function(){return xe(this,this.a.Ja)};f.prototype.readPackedSint64=f.prototype.oc;f.prototype.pc=function(){return xe(this,this.a.Ka)};f.prototype.readPackedSint64String=f.prototype.pc;f.prototype.bc=function(){return xe(this,this.a.m)};f.prototype.readPackedFixed32=f.prototype.bc;f.prototype.cc=function(){return xe(this,this.a.ga)};f.prototype.readPackedFixed64=f.prototype.cc;f.prototype.dc=function(){return xe(this,this.a.ha)};f.prototype.readPackedFixed64String=f.prototype.dc;f.prototype.kc=function(){return xe(this,this.a.P)};f.prototype.readPackedSfixed32=f.prototype.kc;f.prototype.lc=function(){return xe(this,this.a.ba)};f.prototype.readPackedSfixed64=f.prototype.lc;f.prototype.mc=function(){return xe(this,this.a.ca)};f.prototype.readPackedSfixed64String=f.prototype.mc;f.prototype.fc=function(){return xe(this,this.a.aa)};f.prototype.readPackedFloat=f.prototype.fc;f.prototype.$b=function(){return xe(this,this.a.Z)};f.prototype.readPackedDouble=f.prototype.$b;f.prototype.Zb=function(){return xe(this,this.a.pa)};f.prototype.readPackedBool=f.prototype.Zb;f.prototype.ac=function(){return xe(this,this.a.ra)};f.prototype.readPackedEnum=f.prototype.ac;f.prototype.uc=function(){return xe(this,this.a.ia)};f.prototype.readPackedVarintHash64=f.prototype.uc;f.prototype.ec=function(){return xe(this,this.a.$)};f.prototype.readPackedFixedHash64=f.prototype.ec;function zn(e,t,r,n,o){this.ma=e,this.Ba=t,this.la=r,this.Na=n,this.na=o;}$("jspb.ExtensionFieldInfo",zn,void 0);function up(e,t,r,n,o,s){this.Za=e,this.za=t,this.Aa=r,this.Wa=n,this.Ab=o,this.Nb=s;}$("jspb.ExtensionFieldBinaryInfo",up,void 0);zn.prototype.F=function(){return !!this.la};zn.prototype.isMessageType=zn.prototype.F;function j(){}$("jspb.Message",j,void 0);j.GENERATE_TO_OBJECT=true;j.GENERATE_FROM_OBJECT=true;var Go=typeof Uint8Array=="function";j.prototype.Ib=function(){return this.b};j.prototype.getJsPbMessageId=j.prototype.Ib;j.initialize=function(e,t,r,n,o,s){e.f=null,t||(t=r?[r]:[]),e.b=r?String(r):void 0,e.D=r===0?-1:0,e.u=t;e:{if(r=e.u.length,t=-1,r&&(t=r-1,r=e.u[t],!(r===null||typeof r!="object"||Array.isArray(r)||Go&&r instanceof Uint8Array))){e.G=t-e.D,e.i=r;break e} -1<n?(e.G=Math.max(n,t+1-e.D),e.i=null):e.G=Number.MAX_VALUE;}if(e.a={},o)for(n=0;n<o.length;n++)t=o[n],t<e.G?(t+=e.D,e.u[t]=e.u[t]||Ln):(Ho(e),e.i[t]=e.i[t]||Ln);if(s&&s.length)for(n=0;n<s.length;n++)ea(e,s[n]);};var Ln=Object.freeze?Object.freeze([]):[];function Ho(e){var t=e.G+e.D;e.u[t]||(e.i=e.u[t]={});}function pp(e,t,r){for(var n=[],o=0;o<e.length;o++)n[o]=t.call(e[o],r,e[o]);return n}j.toObjectList=pp;j.toObjectExtension=function(e,t,r,n,o){for(var s in r){var a=r[s],i=n.call(e,a);if(i!=null){for(var u in a.Ba)if(a.Ba.hasOwnProperty(u))break;t[u]=a.Na?a.na?pp(i,a.Na,o):a.Na(o,i):i;}}};j.serializeBinaryExtensions=function(e,t,r,n){for(var o in r){var s=r[o],a=s.Za;if(!s.Aa)throw Error("Message extension present that was generated without binary serialization support");var i=n.call(e,a);if(i!=null)if(a.F())if(s.Wa)s.Aa.call(t,a.ma,i,s.Wa);else throw Error("Message extension present holding submessage without binary support enabled, and message is being serialized to binary format");else s.Aa.call(t,a.ma,i);}};j.readBinaryExtension=function(e,t,r,n,o){var s=r[t.c];if(s){if(r=s.Za,!s.za)throw Error("Deserializing extension whose generated code does not support binary format");if(r.F()){var a=new r.la;s.za.call(t,a,s.Ab);}else a=s.za.call(t);r.na&&!s.Nb?(t=n.call(e,r))?t.push(a):o.call(e,r,[a]):o.call(e,r,a);}else t.C();};function pt(e,t){if(t<e.G){t+=e.D;var r=e.u[t];return r===Ln?e.u[t]=[]:r}if(e.i)return r=e.i[t],r===Ln?e.i[t]=[]:r}j.getField=pt;j.getRepeatedField=function(e,t){return pt(e,t)};function cp(e,t){return e=pt(e,t),e==null?e:+e}j.getOptionalFloatingPointField=cp;function dp(e,t){return e=pt(e,t),e==null?e:!!e}j.getBooleanField=dp;j.getRepeatedFloatingPointField=function(e,t){var r=pt(e,t);if(e.a||(e.a={}),!e.a[t]){for(var n=0;n<r.length;n++)r[n]=+r[n];e.a[t]=true;}return r};j.getRepeatedBooleanField=function(e,t){var r=pt(e,t);if(e.a||(e.a={}),!e.a[t]){for(var n=0;n<r.length;n++)r[n]=!!r[n];e.a[t]=true;}return r};function fp(e){return e==null||typeof e=="string"?e:Go&&e instanceof Uint8Array?Yu(e):(qe("Cannot coerce to b64 string: "+Ht(e)),null)}j.bytesAsB64=fp;function hp(e){return e==null||e instanceof Uint8Array?e:typeof e=="string"?Xu(e):(qe("Cannot coerce to Uint8Array: "+Ht(e)),null)}j.bytesAsU8=hp;j.bytesListAsB64=function(e){return mp(e),e.length&&typeof e[0]!="string"?Vn(e,fp):e};j.bytesListAsU8=function(e){return mp(e),!e.length||e[0]instanceof Uint8Array?e:Vn(e,hp)};function mp(e){if(e&&1<e.length){var t=Ht(e[0]);Sg(e,function(r){Ht(r)!=t&&qe("Inconsistent type in JSPB repeated field array. Got "+Ht(r)+" expected "+t);});}}function gp(e,t,r){return e=pt(e,t),e==null?r:e}j.getFieldWithDefault=gp;j.getBooleanFieldWithDefault=function(e,t,r){return e=dp(e,t),e==null?r:e};j.getFloatingPointFieldWithDefault=function(e,t,r){return e=cp(e,t),e==null?r:e};j.getFieldProto3=gp;j.getMapField=function(e,t,r,n){if(e.f||(e.f={}),t in e.f)return e.f[t];var o=pt(e,t);if(!o){if(r)return;o=[],Kt(e,t,o);}return e.f[t]=new G(o,n)};function Kt(e,t,r){return At(e,j),t<e.G?e.u[t+e.D]=r:(Ho(e),e.i[t]=r),e}j.setField=Kt;j.setProto3IntField=function(e,t,r){return jr(e,t,r,0)};j.setProto3FloatField=function(e,t,r){return jr(e,t,r,0)};j.setProto3BooleanField=function(e,t,r){return jr(e,t,r,false)};j.setProto3StringField=function(e,t,r){return jr(e,t,r,"")};j.setProto3BytesField=function(e,t,r){return jr(e,t,r,"")};j.setProto3EnumField=function(e,t,r){return jr(e,t,r,0)};j.setProto3StringIntField=function(e,t,r){return jr(e,t,r,"0")};function jr(e,t,r,n){return At(e,j),r!==n?Kt(e,t,r):t<e.G?e.u[t+e.D]=null:(Ho(e),delete e.i[t]),e}j.addToRepeatedField=function(e,t,r,n){return At(e,j),t=pt(e,t),n!=null?t.splice(n,0,r):t.push(r),e};function yp(e,t,r,n){return At(e,j),(r=ea(e,r))&&r!==t&&n!==void 0&&(e.f&&r in e.f&&(e.f[r]=void 0),Kt(e,r,void 0)),Kt(e,t,n)}j.setOneofField=yp;function ea(e,t){for(var r,n,o=0;o<t.length;o++){var s=t[o],a=pt(e,s);a!=null&&(r=s,n=a,Kt(e,s,void 0));}return r?(Kt(e,r,n),r):0}j.computeOneofCase=ea;j.getWrapperField=function(e,t,r,n){if(e.f||(e.f={}),!e.f[r]){var o=pt(e,r);(n||o)&&(e.f[r]=new t(o));}return e.f[r]};j.getRepeatedWrapperField=function(e,t,r){return vp(e,t,r),t=e.f[r],t==Ln&&(t=e.f[r]=[]),t};function vp(e,t,r){if(e.f||(e.f={}),!e.f[r]){for(var n=pt(e,r),o=[],s=0;s<n.length;s++)o[s]=new t(n[s]);e.f[r]=o;}}j.setWrapperField=function(e,t,r){At(e,j),e.f||(e.f={});var n=r&&r.g();return e.f[t]=r,Kt(e,t,n)};j.setOneofWrapperField=function(e,t,r,n){At(e,j),e.f||(e.f={});var o=n&&n.g();return e.f[t]=n,yp(e,t,r,o)};j.setRepeatedWrapperField=function(e,t,r){At(e,j),e.f||(e.f={}),r=r||[];for(var n=[],o=0;o<r.length;o++)n[o]=r[o].g();return e.f[t]=r,Kt(e,t,n)};j.addToRepeatedWrapperField=function(e,t,r,n,o){vp(e,n,t);var s=e.f[t];return s||(s=e.f[t]=[]),r=r||new n,e=pt(e,t),o!=null?(s.splice(o,0,r),e.splice(o,0,r.g())):(s.push(r),e.push(r.g())),r};j.toMap=function(e,t,r,n){for(var o={},s=0;s<e.length;s++)o[t.call(e[s])]=r?r.call(e[s],n,e[s]):e[s];return o};function _p(e){if(e.f)for(var t in e.f){var r=e.f[t];if(Array.isArray(r))for(var n=0;n<r.length;n++)r[n]&&r[n].g();else r&&r.g();}}j.prototype.g=function(){return _p(this),this.u};j.prototype.toArray=j.prototype.g;j.prototype.toString=function(){return _p(this),this.u.toString()};j.prototype.getExtension=function(e){if(this.i){this.f||(this.f={});var t=e.ma;if(e.na){if(e.F())return this.f[t]||(this.f[t]=Vn(this.i[t]||[],function(r){return new e.la(r)})),this.f[t]}else if(e.F())return !this.f[t]&&this.i[t]&&(this.f[t]=new e.la(this.i[t])),this.f[t];return this.i[t]}};j.prototype.getExtension=j.prototype.getExtension;j.prototype.Kc=function(e,t){this.f||(this.f={}),Ho(this);var r=e.ma;return e.na?(t=t||[],e.F()?(this.f[r]=t,this.i[r]=Vn(t,function(n){return n.g()})):this.i[r]=t):e.F()?(this.f[r]=t,this.i[r]=t&&t.g()):this.i[r]=t,this};j.prototype.setExtension=j.prototype.Kc;j.difference=function(e,t){if(!(e instanceof t.constructor))throw Error("Messages have different types.");var r=e.g();t=t.g();var n=[],o=0,s=r.length>t.length?r.length:t.length;for(e.b&&(n[0]=e.b,o=1);o<s;o++)Yn(r[o],t[o])||(n[o]=t[o]);return new e.constructor(n)};j.equals=function(e,t){return e==t||!(!e||!t)&&e instanceof t.constructor&&Yn(e.g(),t.g())};function Gs(e,t){e=e||{},t=t||{};var r={},n;for(n in e)r[n]=0;for(n in t)r[n]=0;for(n in r)if(!Yn(e[n],t[n]))return  false;return  true}j.compareExtensions=Gs;function Yn(e,t){if(e==t)return  true;if(!Bu(e)||!Bu(t))return typeof e=="number"&&isNaN(e)||typeof t=="number"&&isNaN(t)?String(e)==String(t):false;if(e.constructor!=t.constructor)return  false;if(Go&&e.constructor===Uint8Array){if(e.length!=t.length)return  false;for(var r=0;r<e.length;r++)if(e[r]!=t[r])return  false;return  true}if(e.constructor===Array){var n=void 0,o=void 0,s=Math.max(e.length,t.length);for(r=0;r<s;r++){var a=e[r],i=t[r];if(a&&a.constructor==Object&&(v(n===void 0),v(r===e.length-1),n=a,a=void 0),i&&i.constructor==Object&&(v(o===void 0),v(r===t.length-1),o=i,i=void 0),!Yn(a,i))return  false}return n||o?(n=n||{},o=o||{},Gs(n,o)):true}if(e.constructor===Object)return Gs(e,t);throw Error("Invalid type in JSPB array")}j.compareFields=Yn;j.prototype.Bb=function(){return Ko(this)};j.prototype.cloneMessage=j.prototype.Bb;j.prototype.clone=function(){return Ko(this)};j.prototype.clone=j.prototype.clone;j.clone=function(e){return Ko(e)};function Ko(e){return new e.constructor(Hs(e.g()))}j.copyInto=function(e,t){At(e,j),At(t,j),v(e.constructor==t.constructor,"Copy source and target message should have the same type."),e=Ko(e);for(var r=t.g(),n=e.g(),o=r.length=0;o<n.length;o++)r[o]=n[o];t.f=e.f,t.i=e.i;};function Hs(e){if(Array.isArray(e)){for(var t=Array(e.length),r=0;r<e.length;r++){var n=e[r];n!=null&&(t[r]=typeof n=="object"?Hs(v(n)):n);}return t}if(Go&&e instanceof Uint8Array)return new Uint8Array(e);t={};for(r in e)n=e[r],n!=null&&(t[r]=typeof n=="object"?Hs(v(n)):n);return t}j.registerMessageType=function(e,t){t.we=e;};var kt={dump:function(e){return At(e,j,"jspb.Message instance expected"),v(e.getExtension,"Only unobfuscated and unoptimized compilation modes supported."),kt.X(e)}};$("jspb.debug.dump",kt.dump,void 0);kt.X=function(e){var t=Ht(e);if(t=="number"||t=="string"||t=="boolean"||t=="null"||t=="undefined"||typeof Uint8Array!="undefined"&&e instanceof Uint8Array)return e;if(t=="array")return kg(e),Vn(e,kt.X);if(e instanceof G){var r={};e=e.entries();for(var n=e.next();!n.done;n=e.next())r[n.value[0]]=kt.X(n.value[1]);return r}At(e,j,"Only messages expected: "+e),t=e.constructor;var o={$name:t.name||t.displayName};for(i in t.prototype){var s=/^get([A-Z]\w*)/.exec(i);if(s&&i!="getExtension"&&i!="getJsPbMessageId"){var a="has"+s[1];(!e[a]||e[a]())&&(a=e[i](),o[kt.$a(s[1])]=kt.X(a));}}if(e.extensionObject_)return o.$extensions="Recursive dumping of extensions not supported in compiled code. Switch to uncompiled or dump extension object directly",o;for(n in t.extensions)if(/^\d+$/.test(n)){a=t.extensions[n];var i=e.getExtension(a);s=void 0,a=a.Ba;var u=[],p=0;for(s in a)u[p++]=s;s=u[0],i!=null&&(r||(r=o.$extensions={}),r[kt.$a(s)]=kt.X(i));}return o};kt.$a=function(e){return e.replace(/^[A-Z]/,function(t){return t.toLowerCase()})};function R(){this.a=[];}$("jspb.BinaryEncoder",R,void 0);R.prototype.length=function(){return this.a.length};R.prototype.length=R.prototype.length;R.prototype.end=function(){var e=this.a;return this.a=[],e};R.prototype.end=R.prototype.end;R.prototype.l=function(e,t){for(v(e==Math.floor(e)),v(t==Math.floor(t)),v(0<=e&&4294967296>e),v(0<=t&&4294967296>t);0<t||127<e;)this.a.push(e&127|128),e=(e>>>7|t<<25)>>>0,t>>>=7;this.a.push(e);};R.prototype.writeSplitVarint64=R.prototype.l;R.prototype.A=function(e,t){v(e==Math.floor(e)),v(t==Math.floor(t)),v(0<=e&&4294967296>e),v(0<=t&&4294967296>t),this.s(e),this.s(t);};R.prototype.writeSplitFixed64=R.prototype.A;R.prototype.j=function(e){for(v(e==Math.floor(e)),v(0<=e&&4294967296>e);127<e;)this.a.push(e&127|128),e>>>=7;this.a.push(e);};R.prototype.writeUnsignedVarint32=R.prototype.j;R.prototype.M=function(e){if(v(e==Math.floor(e)),v(-2147483648<=e&&2147483648>e),0<=e)this.j(e);else {for(var t=0;9>t;t++)this.a.push(e&127|128),e>>=7;this.a.push(1);}};R.prototype.writeSignedVarint32=R.prototype.M;R.prototype.va=function(e){v(e==Math.floor(e)),v(0<=e&&18446744073709552e3>e),Jn(e),this.l(ce,de);};R.prototype.writeUnsignedVarint64=R.prototype.va;R.prototype.ua=function(e){v(e==Math.floor(e)),v(-9223372036854776e3<=e&&9223372036854776e3>e),Jn(e),this.l(ce,de);};R.prototype.writeSignedVarint64=R.prototype.ua;R.prototype.wa=function(e){v(e==Math.floor(e)),v(-2147483648<=e&&2147483648>e),this.j((e<<1^e>>31)>>>0);};R.prototype.writeZigzagVarint32=R.prototype.wa;R.prototype.xa=function(e){v(e==Math.floor(e)),v(-9223372036854776e3<=e&&9223372036854776e3>e),ep(e),this.l(ce,de);};R.prototype.writeZigzagVarint64=R.prototype.xa;R.prototype.Ta=function(e){this.W(Kn(e));};R.prototype.writeZigzagVarint64String=R.prototype.Ta;R.prototype.W=function(e){var t=this;ar(e),Lo(ce,de,function(r,n){t.l(r>>>0,n>>>0);});};R.prototype.writeZigzagVarintHash64=R.prototype.W;R.prototype.be=function(e){v(e==Math.floor(e)),v(0<=e&&256>e),this.a.push(e>>>0&255);};R.prototype.writeUint8=R.prototype.be;R.prototype.ae=function(e){v(e==Math.floor(e)),v(0<=e&&65536>e),this.a.push(e>>>0&255),this.a.push(e>>>8&255);};R.prototype.writeUint16=R.prototype.ae;R.prototype.s=function(e){v(e==Math.floor(e)),v(0<=e&&4294967296>e),this.a.push(e>>>0&255),this.a.push(e>>>8&255),this.a.push(e>>>16&255),this.a.push(e>>>24&255);};R.prototype.writeUint32=R.prototype.s;R.prototype.V=function(e){v(e==Math.floor(e)),v(0<=e&&18446744073709552e3>e),Qs(e),this.s(ce),this.s(de);};R.prototype.writeUint64=R.prototype.V;R.prototype.Qc=function(e){v(e==Math.floor(e)),v(-128<=e&&128>e),this.a.push(e>>>0&255);};R.prototype.writeInt8=R.prototype.Qc;R.prototype.Pc=function(e){v(e==Math.floor(e)),v(-32768<=e&&32768>e),this.a.push(e>>>0&255),this.a.push(e>>>8&255);};R.prototype.writeInt16=R.prototype.Pc;R.prototype.S=function(e){v(e==Math.floor(e)),v(-2147483648<=e&&2147483648>e),this.a.push(e>>>0&255),this.a.push(e>>>8&255),this.a.push(e>>>16&255),this.a.push(e>>>24&255);};R.prototype.writeInt32=R.prototype.S;R.prototype.T=function(e){v(e==Math.floor(e)),v(-9223372036854776e3<=e&&9223372036854776e3>e),Jn(e),this.A(ce,de);};R.prototype.writeInt64=R.prototype.T;R.prototype.ka=function(e){v(e==Math.floor(e)),v(-9223372036854776e3<=+e&&9223372036854776e3>+e),ar(Kn(e)),this.A(ce,de);};R.prototype.writeInt64String=R.prototype.ka;R.prototype.L=function(e){v(e===1/0||e===-1/0||isNaN(e)||-34028234663852886e22<=e&&34028234663852886e22>=e),tp(e),this.s(ce);};R.prototype.writeFloat=R.prototype.L;R.prototype.J=function(e){v(e===1/0||e===-1/0||isNaN(e)||-17976931348623157e292<=e&&17976931348623157e292>=e),rp(e),this.s(ce),this.s(de);};R.prototype.writeDouble=R.prototype.J;R.prototype.I=function(e){v(typeof e=="boolean"||typeof e=="number"),this.a.push(e?1:0);};R.prototype.writeBool=R.prototype.I;R.prototype.R=function(e){v(e==Math.floor(e)),v(-2147483648<=e&&2147483648>e),this.M(e);};R.prototype.writeEnum=R.prototype.R;R.prototype.ja=function(e){this.a.push.apply(this.a,e);};R.prototype.writeBytes=R.prototype.ja;R.prototype.N=function(e){ar(e),this.l(ce,de);};R.prototype.writeVarintHash64=R.prototype.N;R.prototype.K=function(e){ar(e),this.s(ce),this.s(de);};R.prototype.writeFixedHash64=R.prototype.K;R.prototype.U=function(e){var t=this.a.length;Ig(e);for(var r=0;r<e.length;r++){var n=e.charCodeAt(r);if(128>n)this.a.push(n);else if(2048>n)this.a.push(n>>6|192),this.a.push(n&63|128);else if(65536>n)if(55296<=n&&56319>=n&&r+1<e.length){var o=e.charCodeAt(r+1);56320<=o&&57343>=o&&(n=1024*(n-55296)+o-56320+65536,this.a.push(n>>18|240),this.a.push(n>>12&63|128),this.a.push(n>>6&63|128),this.a.push(n&63|128),r++);}else this.a.push(n>>12|224),this.a.push(n>>6&63|128),this.a.push(n&63|128);}return this.a.length-t};R.prototype.writeString=R.prototype.U;function Z(e,t){this.lo=e,this.hi=t;}$("jspb.arith.UInt64",Z,void 0);Z.prototype.cmp=function(e){return this.hi<e.hi||this.hi==e.hi&&this.lo<e.lo?-1:this.hi==e.hi&&this.lo==e.lo?0:1};Z.prototype.cmp=Z.prototype.cmp;Z.prototype.La=function(){return new Z((this.lo>>>1|(this.hi&1)<<31)>>>0,this.hi>>>1>>>0)};Z.prototype.rightShift=Z.prototype.La;Z.prototype.Da=function(){return new Z(this.lo<<1>>>0,(this.hi<<1|this.lo>>>31)>>>0)};Z.prototype.leftShift=Z.prototype.Da;Z.prototype.cb=function(){return !!(this.hi&2147483648)};Z.prototype.msb=Z.prototype.cb;Z.prototype.Ob=function(){return !!(this.lo&1)};Z.prototype.lsb=Z.prototype.Ob;Z.prototype.Ua=function(){return this.lo==0&&this.hi==0};Z.prototype.zero=Z.prototype.Ua;Z.prototype.add=function(e){return new Z((this.lo+e.lo&4294967295)>>>0>>>0,((this.hi+e.hi&4294967295)>>>0)+(4294967296<=this.lo+e.lo?1:0)>>>0)};Z.prototype.add=Z.prototype.add;Z.prototype.sub=function(e){return new Z((this.lo-e.lo&4294967295)>>>0>>>0,((this.hi-e.hi&4294967295)>>>0)-(0>this.lo-e.lo?1:0)>>>0)};Z.prototype.sub=Z.prototype.sub;function Ks(e,t){var r=e&65535;e>>>=16;var n=t&65535,o=t>>>16;for(t=r*n+65536*(r*o&65535)+65536*(e*n&65535),r=e*o+(r*o>>>16)+(e*n>>>16);4294967296<=t;)t-=4294967296,r+=1;return new Z(t>>>0,r>>>0)}Z.mul32x32=Ks;Z.prototype.eb=function(e){var t=Ks(this.lo,e);return e=Ks(this.hi,e),e.hi=e.lo,e.lo=0,t.add(e)};Z.prototype.mul=Z.prototype.eb;Z.prototype.Xa=function(e){if(e==0)return [];var t=new Z(0,0),r=new Z(this.lo,this.hi);e=new Z(e,0);for(var n=new Z(1,0);!e.cb();)e=e.Da(),n=n.Da();for(;!n.Ua();)0>=e.cmp(r)&&(t=t.add(n),r=r.sub(e)),e=e.La(),n=n.La();return [t,r]};Z.prototype.div=Z.prototype.Xa;Z.prototype.toString=function(){for(var e="",t=this;!t.Ua();){t=t.Xa(10);var r=t[0];e=t[1].lo+e,t=r;}return e==""&&(e="0"),e};Z.prototype.toString=Z.prototype.toString;function on(e){for(var t=new Z(0,0),r=new Z(0,0),n=0;n<e.length;n++){if("0">e[n]||"9"<e[n])return null;r.lo=parseInt(e[n],10),t=t.eb(10).add(r);}return t}Z.fromString=on;Z.prototype.clone=function(){return new Z(this.lo,this.hi)};Z.prototype.clone=Z.prototype.clone;function Be(e,t){this.lo=e,this.hi=t;}$("jspb.arith.Int64",Be,void 0);Be.prototype.add=function(e){return new Be((this.lo+e.lo&4294967295)>>>0>>>0,((this.hi+e.hi&4294967295)>>>0)+(4294967296<=this.lo+e.lo?1:0)>>>0)};Be.prototype.add=Be.prototype.add;Be.prototype.sub=function(e){return new Be((this.lo-e.lo&4294967295)>>>0>>>0,((this.hi-e.hi&4294967295)>>>0)-(0>this.lo-e.lo?1:0)>>>0)};Be.prototype.sub=Be.prototype.sub;Be.prototype.clone=function(){return new Be(this.lo,this.hi)};Be.prototype.clone=Be.prototype.clone;Be.prototype.toString=function(){var e=(this.hi&2147483648)!=0,t=new Z(this.lo,this.hi);return e&&(t=new Z(0,0).sub(t)),(e?"-":"")+t.toString()};Be.prototype.toString=Be.prototype.toString;function Yo(e){var t=0<e.length&&e[0]=="-";return t&&(e=e.substring(1)),e=on(e),e===null?null:(t&&(e=new Z(0,0).sub(e)),new Be(e.lo,e.hi))}Be.fromString=Yo;function c(){this.c=[],this.b=0,this.a=new R,this.h=[];}$("jspb.BinaryWriter",c,void 0);function bp(e,t){var r=e.a.end();e.c.push(r),e.c.push(t),e.b+=r.length+t.length;}function Re(e,t){return J(e,t,2),t=e.a.end(),e.c.push(t),e.b+=t.length,t.push(e.b),t}function Ce(e,t){var r=t.pop();for(r=e.b+e.a.length()-r,v(0<=r);127<r;)t.push(r&127|128),r>>>=7,e.b++;t.push(r),e.b++;}c.prototype.pb=function(e,t,r){bp(this,e.subarray(t,r));};c.prototype.writeSerializedMessage=c.prototype.pb;c.prototype.Pb=function(e,t,r){e!=null&&t!=null&&r!=null&&this.pb(e,t,r);};c.prototype.maybeWriteSerializedMessage=c.prototype.Pb;c.prototype.reset=function(){this.c=[],this.a.end(),this.b=0,this.h=[];};c.prototype.reset=c.prototype.reset;c.prototype.ab=function(){v(this.h.length==0);for(var e=new Uint8Array(this.b+this.a.length()),t=this.c,r=t.length,n=0,o=0;o<r;o++){var s=t[o];e.set(s,n),n+=s.length;}return t=this.a.end(),e.set(t,n),n+=t.length,v(n==e.length),this.c=[e],e};c.prototype.getResultBuffer=c.prototype.ab;c.prototype.Kb=function(e){return Yu(this.ab(),e)};c.prototype.getResultBase64String=c.prototype.Kb;c.prototype.Va=function(e){this.h.push(Re(this,e));};c.prototype.beginSubMessage=c.prototype.Va;c.prototype.Ya=function(){v(0<=this.h.length),Ce(this,this.h.pop());};c.prototype.endSubMessage=c.prototype.Ya;function J(e,t,r){v(1<=t&&t==Math.floor(t)),e.a.j(8*t+r);}c.prototype.Nc=function(e,t,r){switch(e){case 1:this.J(t,r);break;case 2:this.L(t,r);break;case 3:this.T(t,r);break;case 4:this.V(t,r);break;case 5:this.S(t,r);break;case 6:this.Qa(t,r);break;case 7:this.Pa(t,r);break;case 8:this.I(t,r);break;case 9:this.U(t,r);break;case 10:qe("Group field type not supported in writeAny()");break;case 11:qe("Message field type not supported in writeAny()");break;case 12:this.ja(t,r);break;case 13:this.s(t,r);break;case 14:this.R(t,r);break;case 15:this.Ra(t,r);break;case 16:this.Sa(t,r);break;case 17:this.rb(t,r);break;case 18:this.sb(t,r);break;case 30:this.K(t,r);break;case 31:this.N(t,r);break;default:qe("Invalid field type in writeAny()");}};c.prototype.writeAny=c.prototype.Nc;function ta(e,t,r){r!=null&&(J(e,t,0),e.a.j(r));}function ra(e,t,r){r!=null&&(J(e,t,0),e.a.M(r));}c.prototype.S=function(e,t){t!=null&&(v(-2147483648<=t&&2147483648>t),ra(this,e,t));};c.prototype.writeInt32=c.prototype.S;c.prototype.ob=function(e,t){t!=null&&(t=parseInt(t,10),v(-2147483648<=t&&2147483648>t),ra(this,e,t));};c.prototype.writeInt32String=c.prototype.ob;c.prototype.T=function(e,t){t!=null&&(v(-9223372036854776e3<=t&&9223372036854776e3>t),t!=null&&(J(this,e,0),this.a.ua(t)));};c.prototype.writeInt64=c.prototype.T;c.prototype.ka=function(e,t){t!=null&&(t=Yo(t),J(this,e,0),this.a.l(t.lo,t.hi));};c.prototype.writeInt64String=c.prototype.ka;c.prototype.s=function(e,t){t!=null&&(v(0<=t&&4294967296>t),ta(this,e,t));};c.prototype.writeUint32=c.prototype.s;c.prototype.ub=function(e,t){t!=null&&(t=parseInt(t,10),v(0<=t&&4294967296>t),ta(this,e,t));};c.prototype.writeUint32String=c.prototype.ub;c.prototype.V=function(e,t){t!=null&&(v(0<=t&&18446744073709552e3>t),t!=null&&(J(this,e,0),this.a.va(t)));};c.prototype.writeUint64=c.prototype.V;c.prototype.vb=function(e,t){t!=null&&(t=on(t),J(this,e,0),this.a.l(t.lo,t.hi));};c.prototype.writeUint64String=c.prototype.vb;c.prototype.rb=function(e,t){t!=null&&(v(-2147483648<=t&&2147483648>t),t!=null&&(J(this,e,0),this.a.wa(t)));};c.prototype.writeSint32=c.prototype.rb;c.prototype.sb=function(e,t){t!=null&&(v(-9223372036854776e3<=t&&9223372036854776e3>t),t!=null&&(J(this,e,0),this.a.xa(t)));};c.prototype.writeSint64=c.prototype.sb;c.prototype.$d=function(e,t){t!=null&&t!=null&&(J(this,e,0),this.a.W(t));};c.prototype.writeSintHash64=c.prototype.$d;c.prototype.Zd=function(e,t){t!=null&&t!=null&&(J(this,e,0),this.a.Ta(t));};c.prototype.writeSint64String=c.prototype.Zd;c.prototype.Pa=function(e,t){t!=null&&(v(0<=t&&4294967296>t),J(this,e,5),this.a.s(t));};c.prototype.writeFixed32=c.prototype.Pa;c.prototype.Qa=function(e,t){t!=null&&(v(0<=t&&18446744073709552e3>t),J(this,e,1),this.a.V(t));};c.prototype.writeFixed64=c.prototype.Qa;c.prototype.nb=function(e,t){t!=null&&(t=on(t),J(this,e,1),this.a.A(t.lo,t.hi));};c.prototype.writeFixed64String=c.prototype.nb;c.prototype.Ra=function(e,t){t!=null&&(v(-2147483648<=t&&2147483648>t),J(this,e,5),this.a.S(t));};c.prototype.writeSfixed32=c.prototype.Ra;c.prototype.Sa=function(e,t){t!=null&&(v(-9223372036854776e3<=t&&9223372036854776e3>t),J(this,e,1),this.a.T(t));};c.prototype.writeSfixed64=c.prototype.Sa;c.prototype.qb=function(e,t){t!=null&&(t=Yo(t),J(this,e,1),this.a.A(t.lo,t.hi));};c.prototype.writeSfixed64String=c.prototype.qb;c.prototype.L=function(e,t){t!=null&&(J(this,e,5),this.a.L(t));};c.prototype.writeFloat=c.prototype.L;c.prototype.J=function(e,t){t!=null&&(J(this,e,1),this.a.J(t));};c.prototype.writeDouble=c.prototype.J;c.prototype.I=function(e,t){t!=null&&(v(typeof t=="boolean"||typeof t=="number"),J(this,e,0),this.a.I(t));};c.prototype.writeBool=c.prototype.I;c.prototype.R=function(e,t){t!=null&&(v(-2147483648<=t&&2147483648>t),J(this,e,0),this.a.M(t));};c.prototype.writeEnum=c.prototype.R;c.prototype.U=function(e,t){t!=null&&(e=Re(this,e),this.a.U(t),Ce(this,e));};c.prototype.writeString=c.prototype.U;c.prototype.ja=function(e,t){t!=null&&(t=Jo(t),J(this,e,2),this.a.j(t.length),bp(this,t));};c.prototype.writeBytes=c.prototype.ja;c.prototype.Rc=function(e,t,r){t!=null&&(e=Re(this,e),r(t,this),Ce(this,e));};c.prototype.writeMessage=c.prototype.Rc;c.prototype.Sc=function(e,t,r){t!=null&&(J(this,1,3),J(this,2,0),this.a.M(e),e=Re(this,3),r(t,this),Ce(this,e),J(this,1,4));};c.prototype.writeMessageSet=c.prototype.Sc;c.prototype.Oc=function(e,t,r){t!=null&&(J(this,e,3),r(t,this),J(this,e,4));};c.prototype.writeGroup=c.prototype.Oc;c.prototype.K=function(e,t){t!=null&&(v(t.length==8),J(this,e,1),this.a.K(t));};c.prototype.writeFixedHash64=c.prototype.K;c.prototype.N=function(e,t){t!=null&&(v(t.length==8),J(this,e,0),this.a.N(t));};c.prototype.writeVarintHash64=c.prototype.N;c.prototype.A=function(e,t,r){J(this,e,1),this.a.A(t,r);};c.prototype.writeSplitFixed64=c.prototype.A;c.prototype.l=function(e,t,r){J(this,e,0),this.a.l(t,r);};c.prototype.writeSplitVarint64=c.prototype.l;c.prototype.tb=function(e,t,r){J(this,e,0);var n=this.a;Lo(t,r,function(o,s){n.l(o>>>0,s>>>0);});};c.prototype.writeSplitZigzagVarint64=c.prototype.tb;c.prototype.Ed=function(e,t){if(t!=null)for(var r=0;r<t.length;r++)ra(this,e,t[r]);};c.prototype.writeRepeatedInt32=c.prototype.Ed;c.prototype.Fd=function(e,t){if(t!=null)for(var r=0;r<t.length;r++)this.ob(e,t[r]);};c.prototype.writeRepeatedInt32String=c.prototype.Fd;c.prototype.Gd=function(e,t){if(t!=null)for(var r=0;r<t.length;r++){var n=t[r];n!=null&&(J(this,e,0),this.a.ua(n));}};c.prototype.writeRepeatedInt64=c.prototype.Gd;c.prototype.Qd=function(e,t,r,n){if(t!=null)for(var o=0;o<t.length;o++)this.A(e,r(t[o]),n(t[o]));};c.prototype.writeRepeatedSplitFixed64=c.prototype.Qd;c.prototype.Rd=function(e,t,r,n){if(t!=null)for(var o=0;o<t.length;o++)this.l(e,r(t[o]),n(t[o]));};c.prototype.writeRepeatedSplitVarint64=c.prototype.Rd;c.prototype.Sd=function(e,t,r,n){if(t!=null)for(var o=0;o<t.length;o++)this.tb(e,r(t[o]),n(t[o]));};c.prototype.writeRepeatedSplitZigzagVarint64=c.prototype.Sd;c.prototype.Hd=function(e,t){if(t!=null)for(var r=0;r<t.length;r++)this.ka(e,t[r]);};c.prototype.writeRepeatedInt64String=c.prototype.Hd;c.prototype.Ud=function(e,t){if(t!=null)for(var r=0;r<t.length;r++)ta(this,e,t[r]);};c.prototype.writeRepeatedUint32=c.prototype.Ud;c.prototype.Vd=function(e,t){if(t!=null)for(var r=0;r<t.length;r++)this.ub(e,t[r]);};c.prototype.writeRepeatedUint32String=c.prototype.Vd;c.prototype.Wd=function(e,t){if(t!=null)for(var r=0;r<t.length;r++){var n=t[r];n!=null&&(J(this,e,0),this.a.va(n));}};c.prototype.writeRepeatedUint64=c.prototype.Wd;c.prototype.Xd=function(e,t){if(t!=null)for(var r=0;r<t.length;r++)this.vb(e,t[r]);};c.prototype.writeRepeatedUint64String=c.prototype.Xd;c.prototype.Md=function(e,t){if(t!=null)for(var r=0;r<t.length;r++){var n=t[r];n!=null&&(J(this,e,0),this.a.wa(n));}};c.prototype.writeRepeatedSint32=c.prototype.Md;c.prototype.Nd=function(e,t){if(t!=null)for(var r=0;r<t.length;r++){var n=t[r];n!=null&&(J(this,e,0),this.a.xa(n));}};c.prototype.writeRepeatedSint64=c.prototype.Nd;c.prototype.Od=function(e,t){if(t!=null)for(var r=0;r<t.length;r++){var n=t[r];n!=null&&(J(this,e,0),this.a.Ta(n));}};c.prototype.writeRepeatedSint64String=c.prototype.Od;c.prototype.Pd=function(e,t){if(t!=null)for(var r=0;r<t.length;r++){var n=t[r];n!=null&&(J(this,e,0),this.a.W(n));}};c.prototype.writeRepeatedSintHash64=c.prototype.Pd;c.prototype.yd=function(e,t){if(t!=null)for(var r=0;r<t.length;r++)this.Pa(e,t[r]);};c.prototype.writeRepeatedFixed32=c.prototype.yd;c.prototype.zd=function(e,t){if(t!=null)for(var r=0;r<t.length;r++)this.Qa(e,t[r]);};c.prototype.writeRepeatedFixed64=c.prototype.zd;c.prototype.Ad=function(e,t){if(t!=null)for(var r=0;r<t.length;r++)this.nb(e,t[r]);};c.prototype.writeRepeatedFixed64String=c.prototype.Ad;c.prototype.Jd=function(e,t){if(t!=null)for(var r=0;r<t.length;r++)this.Ra(e,t[r]);};c.prototype.writeRepeatedSfixed32=c.prototype.Jd;c.prototype.Kd=function(e,t){if(t!=null)for(var r=0;r<t.length;r++)this.Sa(e,t[r]);};c.prototype.writeRepeatedSfixed64=c.prototype.Kd;c.prototype.Ld=function(e,t){if(t!=null)for(var r=0;r<t.length;r++)this.qb(e,t[r]);};c.prototype.writeRepeatedSfixed64String=c.prototype.Ld;c.prototype.Cd=function(e,t){if(t!=null)for(var r=0;r<t.length;r++)this.L(e,t[r]);};c.prototype.writeRepeatedFloat=c.prototype.Cd;c.prototype.wd=function(e,t){if(t!=null)for(var r=0;r<t.length;r++)this.J(e,t[r]);};c.prototype.writeRepeatedDouble=c.prototype.wd;c.prototype.ud=function(e,t){if(t!=null)for(var r=0;r<t.length;r++)this.I(e,t[r]);};c.prototype.writeRepeatedBool=c.prototype.ud;c.prototype.xd=function(e,t){if(t!=null)for(var r=0;r<t.length;r++)this.R(e,t[r]);};c.prototype.writeRepeatedEnum=c.prototype.xd;c.prototype.Td=function(e,t){if(t!=null)for(var r=0;r<t.length;r++)this.U(e,t[r]);};c.prototype.writeRepeatedString=c.prototype.Td;c.prototype.vd=function(e,t){if(t!=null)for(var r=0;r<t.length;r++)this.ja(e,t[r]);};c.prototype.writeRepeatedBytes=c.prototype.vd;c.prototype.Id=function(e,t,r){if(t!=null)for(var n=0;n<t.length;n++){var o=Re(this,e);r(t[n],this),Ce(this,o);}};c.prototype.writeRepeatedMessage=c.prototype.Id;c.prototype.Dd=function(e,t,r){if(t!=null)for(var n=0;n<t.length;n++)J(this,e,3),r(t[n],this),J(this,e,4);};c.prototype.writeRepeatedGroup=c.prototype.Dd;c.prototype.Bd=function(e,t){if(t!=null)for(var r=0;r<t.length;r++)this.K(e,t[r]);};c.prototype.writeRepeatedFixedHash64=c.prototype.Bd;c.prototype.Yd=function(e,t){if(t!=null)for(var r=0;r<t.length;r++)this.N(e,t[r]);};c.prototype.writeRepeatedVarintHash64=c.prototype.Yd;c.prototype.ad=function(e,t){if(t!=null&&t.length){e=Re(this,e);for(var r=0;r<t.length;r++)this.a.M(t[r]);Ce(this,e);}};c.prototype.writePackedInt32=c.prototype.ad;c.prototype.bd=function(e,t){if(t!=null&&t.length){e=Re(this,e);for(var r=0;r<t.length;r++)this.a.M(parseInt(t[r],10));Ce(this,e);}};c.prototype.writePackedInt32String=c.prototype.bd;c.prototype.cd=function(e,t){if(t!=null&&t.length){e=Re(this,e);for(var r=0;r<t.length;r++)this.a.ua(t[r]);Ce(this,e);}};c.prototype.writePackedInt64=c.prototype.cd;c.prototype.md=function(e,t,r,n){if(t!=null){e=Re(this,e);for(var o=0;o<t.length;o++)this.a.A(r(t[o]),n(t[o]));Ce(this,e);}};c.prototype.writePackedSplitFixed64=c.prototype.md;c.prototype.nd=function(e,t,r,n){if(t!=null){e=Re(this,e);for(var o=0;o<t.length;o++)this.a.l(r(t[o]),n(t[o]));Ce(this,e);}};c.prototype.writePackedSplitVarint64=c.prototype.nd;c.prototype.od=function(e,t,r,n){if(t!=null){e=Re(this,e);for(var o=this.a,s=0;s<t.length;s++)Lo(r(t[s]),n(t[s]),function(a,i){o.l(a>>>0,i>>>0);});Ce(this,e);}};c.prototype.writePackedSplitZigzagVarint64=c.prototype.od;c.prototype.dd=function(e,t){if(t!=null&&t.length){e=Re(this,e);for(var r=0;r<t.length;r++){var n=Yo(t[r]);this.a.l(n.lo,n.hi);}Ce(this,e);}};c.prototype.writePackedInt64String=c.prototype.dd;c.prototype.pd=function(e,t){if(t!=null&&t.length){e=Re(this,e);for(var r=0;r<t.length;r++)this.a.j(t[r]);Ce(this,e);}};c.prototype.writePackedUint32=c.prototype.pd;c.prototype.qd=function(e,t){if(t!=null&&t.length){e=Re(this,e);for(var r=0;r<t.length;r++)this.a.j(parseInt(t[r],10));Ce(this,e);}};c.prototype.writePackedUint32String=c.prototype.qd;c.prototype.rd=function(e,t){if(t!=null&&t.length){e=Re(this,e);for(var r=0;r<t.length;r++)this.a.va(t[r]);Ce(this,e);}};c.prototype.writePackedUint64=c.prototype.rd;c.prototype.sd=function(e,t){if(t!=null&&t.length){e=Re(this,e);for(var r=0;r<t.length;r++){var n=on(t[r]);this.a.l(n.lo,n.hi);}Ce(this,e);}};c.prototype.writePackedUint64String=c.prototype.sd;c.prototype.hd=function(e,t){if(t!=null&&t.length){e=Re(this,e);for(var r=0;r<t.length;r++)this.a.wa(t[r]);Ce(this,e);}};c.prototype.writePackedSint32=c.prototype.hd;c.prototype.jd=function(e,t){if(t!=null&&t.length){e=Re(this,e);for(var r=0;r<t.length;r++)this.a.xa(t[r]);Ce(this,e);}};c.prototype.writePackedSint64=c.prototype.jd;c.prototype.kd=function(e,t){if(t!=null&&t.length){e=Re(this,e);for(var r=0;r<t.length;r++)this.a.W(Kn(t[r]));Ce(this,e);}};c.prototype.writePackedSint64String=c.prototype.kd;c.prototype.ld=function(e,t){if(t!=null&&t.length){e=Re(this,e);for(var r=0;r<t.length;r++)this.a.W(t[r]);Ce(this,e);}};c.prototype.writePackedSintHash64=c.prototype.ld;c.prototype.Wc=function(e,t){if(t!=null&&t.length)for(J(this,e,2),this.a.j(4*t.length),e=0;e<t.length;e++)this.a.s(t[e]);};c.prototype.writePackedFixed32=c.prototype.Wc;c.prototype.Xc=function(e,t){if(t!=null&&t.length)for(J(this,e,2),this.a.j(8*t.length),e=0;e<t.length;e++)this.a.V(t[e]);};c.prototype.writePackedFixed64=c.prototype.Xc;c.prototype.Yc=function(e,t){if(t!=null&&t.length)for(J(this,e,2),this.a.j(8*t.length),e=0;e<t.length;e++){var r=on(t[e]);this.a.A(r.lo,r.hi);}};c.prototype.writePackedFixed64String=c.prototype.Yc;c.prototype.ed=function(e,t){if(t!=null&&t.length)for(J(this,e,2),this.a.j(4*t.length),e=0;e<t.length;e++)this.a.S(t[e]);};c.prototype.writePackedSfixed32=c.prototype.ed;c.prototype.fd=function(e,t){if(t!=null&&t.length)for(J(this,e,2),this.a.j(8*t.length),e=0;e<t.length;e++)this.a.T(t[e]);};c.prototype.writePackedSfixed64=c.prototype.fd;c.prototype.gd=function(e,t){if(t!=null&&t.length)for(J(this,e,2),this.a.j(8*t.length),e=0;e<t.length;e++)this.a.ka(t[e]);};c.prototype.writePackedSfixed64String=c.prototype.gd;c.prototype.$c=function(e,t){if(t!=null&&t.length)for(J(this,e,2),this.a.j(4*t.length),e=0;e<t.length;e++)this.a.L(t[e]);};c.prototype.writePackedFloat=c.prototype.$c;c.prototype.Uc=function(e,t){if(t!=null&&t.length)for(J(this,e,2),this.a.j(8*t.length),e=0;e<t.length;e++)this.a.J(t[e]);};c.prototype.writePackedDouble=c.prototype.Uc;c.prototype.Tc=function(e,t){if(t!=null&&t.length)for(J(this,e,2),this.a.j(t.length),e=0;e<t.length;e++)this.a.I(t[e]);};c.prototype.writePackedBool=c.prototype.Tc;c.prototype.Vc=function(e,t){if(t!=null&&t.length){e=Re(this,e);for(var r=0;r<t.length;r++)this.a.R(t[r]);Ce(this,e);}};c.prototype.writePackedEnum=c.prototype.Vc;c.prototype.Zc=function(e,t){if(t!=null&&t.length)for(J(this,e,2),this.a.j(8*t.length),e=0;e<t.length;e++)this.a.K(t[e]);};c.prototype.writePackedFixedHash64=c.prototype.Zc;c.prototype.td=function(e,t){if(t!=null&&t.length){e=Re(this,e);for(var r=0;r<t.length;r++)this.a.N(t[r]);Ce(this,e);}};c.prototype.writePackedVarintHash64=c.prototype.td;typeof Ve=="object"&&(Ve.debug=kt,Ve.Map=G,Ve.Message=j,Ve.BinaryReader=f,Ve.BinaryWriter=c,Ve.ExtensionFieldInfo=zn,Ve.ExtensionFieldBinaryInfo=up,Ve.exportSymbol=bg,Ve.inherits=wg,Ve.object={extend:xg},Ve.typeOf=Ht);});var ae;(function(e){e.assertEqual=o=>o;function t(o){}e.assertIs=t;function r(o){throw new Error}e.assertNever=r,e.arrayToEnum=o=>{let s={};for(let a of o)s[a]=a;return s},e.getValidEnumValues=o=>{let s=e.objectKeys(o).filter(i=>typeof o[o[i]]!="number"),a={};for(let i of s)a[i]=o[i];return e.objectValues(a)},e.objectValues=o=>e.objectKeys(o).map(function(s){return o[s]}),e.objectKeys=typeof Object.keys=="function"?o=>Object.keys(o):o=>{let s=[];for(let a in o)Object.prototype.hasOwnProperty.call(o,a)&&s.push(a);return s},e.find=(o,s)=>{for(let a of o)if(s(a))return a},e.isInteger=typeof Number.isInteger=="function"?o=>Number.isInteger(o):o=>typeof o=="number"&&isFinite(o)&&Math.floor(o)===o;function n(o,s=" | "){return o.map(a=>typeof a=="string"?`'${a}'`:a).join(s)}e.joinValues=n,e.jsonStringifyReplacer=(o,s)=>typeof s=="bigint"?s.toString():s;})(ae||(ae={}));var ls;(function(e){e.mergeShapes=(t,r)=>d(d({},t),r);})(ls||(ls={}));var D=ae.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Bt=e=>{switch(typeof e){case "undefined":return D.undefined;case "string":return D.string;case "number":return isNaN(e)?D.nan:D.number;case "boolean":return D.boolean;case "function":return D.function;case "bigint":return D.bigint;case "symbol":return D.symbol;case "object":return Array.isArray(e)?D.array:e===null?D.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?D.promise:typeof Map!="undefined"&&e instanceof Map?D.map:typeof Set!="undefined"&&e instanceof Set?D.set:typeof Date!="undefined"&&e instanceof Date?D.date:D.object;default:return D.unknown}},I=ae.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),Cp=e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:"),at=class e extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n];},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n];};let r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=t;}format(t){let r=t||function(s){return s.message},n={_errors:[]},o=s=>{for(let a of s.issues)if(a.code==="invalid_union")a.unionErrors.map(o);else if(a.code==="invalid_return_type")o(a.returnTypeError);else if(a.code==="invalid_arguments")o(a.argumentsError);else if(a.path.length===0)n._errors.push(r(a));else {let i=n,u=0;for(;u<a.path.length;){let p=a.path[u];u===a.path.length-1?(i[p]=i[p]||{_errors:[]},i[p]._errors.push(r(a))):i[p]=i[p]||{_errors:[]},i=i[p],u++;}}};return o(this),n}static assert(t){if(!(t instanceof e))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,ae.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=r=>r.message){let r={},n=[];for(let o of this.issues)o.path.length>0?(r[o.path[0]]=r[o.path[0]]||[],r[o.path[0]].push(t(o))):n.push(t(o));return {formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}};at.create=e=>new at(e);var Ur=(e,t)=>{let r;switch(e.code){case I.invalid_type:e.received===D.undefined?r="Required":r=`Expected ${e.expected}, received ${e.received}`;break;case I.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(e.expected,ae.jsonStringifyReplacer)}`;break;case I.unrecognized_keys:r=`Unrecognized key(s) in object: ${ae.joinValues(e.keys,", ")}`;break;case I.invalid_union:r="Invalid input";break;case I.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${ae.joinValues(e.options)}`;break;case I.invalid_enum_value:r=`Invalid enum value. Expected ${ae.joinValues(e.options)}, received '${e.received}'`;break;case I.invalid_arguments:r="Invalid function arguments";break;case I.invalid_return_type:r="Invalid function return type";break;case I.invalid_date:r="Invalid date";break;case I.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(r=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?r=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?r=`Invalid input: must end with "${e.validation.endsWith}"`:ae.assertNever(e.validation):e.validation!=="regex"?r=`Invalid ${e.validation}`:r="Invalid";break;case I.too_small:e.type==="array"?r=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?r=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?r=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?r=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:r="Invalid input";break;case I.too_big:e.type==="array"?r=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?r=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?r=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?r=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?r=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:r="Invalid input";break;case I.custom:r="Invalid input";break;case I.invalid_intersection_types:r="Intersection results could not be merged";break;case I.not_multiple_of:r=`Number must be a multiple of ${e.multipleOf}`;break;case I.not_finite:r="Number must be finite";break;default:r=t.defaultError,ae.assertNever(e);}return {message:r}},va=Ur;function jp(e){va=e;}function po(){return va}var co=e=>{let{data:t,path:r,errorMaps:n,issueData:o}=e,s=[...r,...o.path||[]],a=g(d({},o),{path:s});if(o.message!==void 0)return g(d({},o),{path:s,message:o.message});let i="",u=n.filter(p=>!!p).slice().reverse();for(let p of u)i=p(a,{data:t,defaultError:i}).message;return g(d({},o),{path:s,message:i})},Op=[];function P(e,t){let r=po(),n=co({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,r,r===Ur?void 0:Ur].filter(o=>!!o)});e.common.issues.push(n);}var He=class e{constructor(){this.value="valid";}dirty(){this.value==="valid"&&(this.value="dirty");}abort(){this.value!=="aborted"&&(this.value="aborted");}static mergeArray(t,r){let n=[];for(let o of r){if(o.status==="aborted")return H;o.status==="dirty"&&t.dirty(),n.push(o.value);}return {status:t.value,value:n}}static mergeObjectAsync(t,r){return E(this,null,function*(){let n=[];for(let o of r){let s=yield o.key,a=yield o.value;n.push({key:s,value:a});}return e.mergeObjectSync(t,n)})}static mergeObjectSync(t,r){let n={};for(let o of r){let{key:s,value:a}=o;if(s.status==="aborted"||a.status==="aborted")return H;s.status==="dirty"&&t.dirty(),a.status==="dirty"&&t.dirty(),s.value!=="__proto__"&&(typeof a.value!="undefined"||o.alwaysSet)&&(n[s.value]=a.value);}return {status:t.value,value:n}}},H=Object.freeze({status:"aborted"}),Fr=e=>({status:"dirty",value:e}),Ye=e=>({status:"valid",value:e}),us=e=>e.status==="aborted",ps=e=>e.status==="dirty",dr=e=>e.status==="valid",_n=e=>typeof Promise!="undefined"&&e instanceof Promise;function fo(e,t,r,n){if(typeof t=="function"?e!==t||true:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t.get(e)}function _a(e,t,r,n,o){if(typeof t=="function"?e!==t||true:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(e,r),r}var B;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t==null?void 0:t.message;})(B||(B={}));var yn,vn,dt=class{constructor(t,r,n,o){this._cachedPath=[],this.parent=t,this.data=r,this._path=n,this._key=o;}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},ma=(e,t)=>{if(dr(t))return {success:true,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return {success:false,get error(){if(this._error)return this._error;let r=new at(e.common.issues);return this._error=r,this._error}}};function Q(e){if(!e)return {};let{errorMap:t,invalid_type_error:r,required_error:n,description:o}=e;if(t&&(r||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:o}:{errorMap:(a,i)=>{var u,p;let{message:h}=e;return a.code==="invalid_enum_value"?{message:h!=null?h:i.defaultError}:typeof i.data=="undefined"?{message:(u=h!=null?h:n)!==null&&u!==void 0?u:i.defaultError}:a.code!=="invalid_type"?{message:i.defaultError}:{message:(p=h!=null?h:r)!==null&&p!==void 0?p:i.defaultError}},description:o}}var ee=class{get description(){return this._def.description}_getType(t){return Bt(t.data)}_getOrReturnCtx(t,r){return r||{common:t.parent.common,data:t.data,parsedType:Bt(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return {status:new He,ctx:{common:t.parent.common,data:t.data,parsedType:Bt(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){let r=this._parse(t);if(_n(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(t){let r=this._parse(t);return Promise.resolve(r)}parse(t,r){let n=this.safeParse(t,r);if(n.success)return n.data;throw n.error}safeParse(t,r){var n;let o={common:{issues:[],async:(n=r==null?void 0:r.async)!==null&&n!==void 0?n:false,contextualErrorMap:r==null?void 0:r.errorMap},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Bt(t)},s=this._parseSync({data:t,path:o.path,parent:o});return ma(o,s)}"~validate"(t){var r,n;let o={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Bt(t)};if(!this["~standard"].async)try{let s=this._parseSync({data:t,path:[],parent:o});return dr(s)?{value:s.value}:{issues:o.common.issues}}catch(s){!((n=(r=s==null?void 0:s.message)===null||r===void 0?void 0:r.toLowerCase())===null||n===void 0)&&n.includes("encountered")&&(this["~standard"].async=true),o.common={issues:[],async:true};}return this._parseAsync({data:t,path:[],parent:o}).then(s=>dr(s)?{value:s.value}:{issues:o.common.issues})}parseAsync(t,r){return E(this,null,function*(){let n=yield this.safeParseAsync(t,r);if(n.success)return n.data;throw n.error})}safeParseAsync(t,r){return E(this,null,function*(){let n={common:{issues:[],contextualErrorMap:r==null?void 0:r.errorMap,async:true},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Bt(t)},o=this._parse({data:t,path:n.path,parent:n}),s=yield _n(o)?o:Promise.resolve(o);return ma(n,s)})}refine(t,r){let n=o=>typeof r=="string"||typeof r=="undefined"?{message:r}:typeof r=="function"?r(o):r;return this._refinement((o,s)=>{let a=t(o),i=()=>s.addIssue(d({code:I.custom},n(o)));return typeof Promise!="undefined"&&a instanceof Promise?a.then(u=>u?true:(i(),false)):a?true:(i(),false)})}refinement(t,r){return this._refinement((n,o)=>t(n)?true:(o.addIssue(typeof r=="function"?r(n,o):r),false))}_refinement(t){return new it({schema:this,typeName:k.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)};}optional(){return nt.create(this,this._def)}nullable(){return Pt.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Lt.create(this)}promise(){return tr.create(this,this._def)}or(t){return _r.create([this,t],this._def)}and(t){return br.create(this,t,this._def)}transform(t){return new it(g(d({},Q(this._def)),{schema:this,typeName:k.ZodEffects,effect:{type:"transform",transform:t}}))}default(t){let r=typeof t=="function"?t:()=>t;return new Ir(g(d({},Q(this._def)),{innerType:this,defaultValue:r,typeName:k.ZodDefault}))}brand(){return new bn(d({typeName:k.ZodBranded,type:this},Q(this._def)))}catch(t){let r=typeof t=="function"?t:()=>t;return new kr(g(d({},Q(this._def)),{innerType:this,catchValue:r,typeName:k.ZodCatch}))}describe(t){let r=this.constructor;return new r(g(d({},this._def),{description:t}))}pipe(t){return wn.create(this,t)}readonly(){return Ar.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},Pp=/^c[^\s-]{8,}$/i,Mp=/^[0-9a-z]+$/,Np=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Dp=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Fp=/^[a-z0-9_-]{21}$/i,Up=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,$p=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,qp=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Bp="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",is,zp=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Lp=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Vp=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Zp=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Jp=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Wp=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,ba="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Gp=new RegExp(`^${ba}$`);function wa(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`);let r=e.precision?"+":"?";return `([01]\\d|2[0-3]):[0-5]\\d(:${t})${r}`}function Hp(e){return new RegExp(`^${wa(e)}$`)}function xa(e){let t=`${ba}T${wa(e)}`,r=[];return r.push(e.local?"Z?":"Z"),e.offset&&r.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${r.join("|")})`,new RegExp(`^${t}$`)}function Kp(e,t){return !!((t==="v4"||!t)&&zp.test(e)||(t==="v6"||!t)&&Vp.test(e))}function Yp(e,t){if(!Up.test(e))return  false;try{let[r]=e.split("."),n=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),o=JSON.parse(atob(n));return !(typeof o!="object"||o===null||!o.typ||!o.alg||t&&o.alg!==t)}catch(r){return  false}}function Xp(e,t){return !!((t==="v4"||!t)&&Lp.test(e)||(t==="v6"||!t)&&Zp.test(e))}var Qt=class e extends ee{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==D.string){let s=this._getOrReturnCtx(t);return P(s,{code:I.invalid_type,expected:D.string,received:s.parsedType}),H}let n=new He,o;for(let s of this._def.checks)if(s.kind==="min")t.data.length<s.value&&(o=this._getOrReturnCtx(t,o),P(o,{code:I.too_small,minimum:s.value,type:"string",inclusive:true,exact:false,message:s.message}),n.dirty());else if(s.kind==="max")t.data.length>s.value&&(o=this._getOrReturnCtx(t,o),P(o,{code:I.too_big,maximum:s.value,type:"string",inclusive:true,exact:false,message:s.message}),n.dirty());else if(s.kind==="length"){let a=t.data.length>s.value,i=t.data.length<s.value;(a||i)&&(o=this._getOrReturnCtx(t,o),a?P(o,{code:I.too_big,maximum:s.value,type:"string",inclusive:true,exact:true,message:s.message}):i&&P(o,{code:I.too_small,minimum:s.value,type:"string",inclusive:true,exact:true,message:s.message}),n.dirty());}else if(s.kind==="email")qp.test(t.data)||(o=this._getOrReturnCtx(t,o),P(o,{validation:"email",code:I.invalid_string,message:s.message}),n.dirty());else if(s.kind==="emoji")is||(is=new RegExp(Bp,"u")),is.test(t.data)||(o=this._getOrReturnCtx(t,o),P(o,{validation:"emoji",code:I.invalid_string,message:s.message}),n.dirty());else if(s.kind==="uuid")Dp.test(t.data)||(o=this._getOrReturnCtx(t,o),P(o,{validation:"uuid",code:I.invalid_string,message:s.message}),n.dirty());else if(s.kind==="nanoid")Fp.test(t.data)||(o=this._getOrReturnCtx(t,o),P(o,{validation:"nanoid",code:I.invalid_string,message:s.message}),n.dirty());else if(s.kind==="cuid")Pp.test(t.data)||(o=this._getOrReturnCtx(t,o),P(o,{validation:"cuid",code:I.invalid_string,message:s.message}),n.dirty());else if(s.kind==="cuid2")Mp.test(t.data)||(o=this._getOrReturnCtx(t,o),P(o,{validation:"cuid2",code:I.invalid_string,message:s.message}),n.dirty());else if(s.kind==="ulid")Np.test(t.data)||(o=this._getOrReturnCtx(t,o),P(o,{validation:"ulid",code:I.invalid_string,message:s.message}),n.dirty());else if(s.kind==="url")try{new URL(t.data);}catch(a){o=this._getOrReturnCtx(t,o),P(o,{validation:"url",code:I.invalid_string,message:s.message}),n.dirty();}else s.kind==="regex"?(s.regex.lastIndex=0,s.regex.test(t.data)||(o=this._getOrReturnCtx(t,o),P(o,{validation:"regex",code:I.invalid_string,message:s.message}),n.dirty())):s.kind==="trim"?t.data=t.data.trim():s.kind==="includes"?t.data.includes(s.value,s.position)||(o=this._getOrReturnCtx(t,o),P(o,{code:I.invalid_string,validation:{includes:s.value,position:s.position},message:s.message}),n.dirty()):s.kind==="toLowerCase"?t.data=t.data.toLowerCase():s.kind==="toUpperCase"?t.data=t.data.toUpperCase():s.kind==="startsWith"?t.data.startsWith(s.value)||(o=this._getOrReturnCtx(t,o),P(o,{code:I.invalid_string,validation:{startsWith:s.value},message:s.message}),n.dirty()):s.kind==="endsWith"?t.data.endsWith(s.value)||(o=this._getOrReturnCtx(t,o),P(o,{code:I.invalid_string,validation:{endsWith:s.value},message:s.message}),n.dirty()):s.kind==="datetime"?xa(s).test(t.data)||(o=this._getOrReturnCtx(t,o),P(o,{code:I.invalid_string,validation:"datetime",message:s.message}),n.dirty()):s.kind==="date"?Gp.test(t.data)||(o=this._getOrReturnCtx(t,o),P(o,{code:I.invalid_string,validation:"date",message:s.message}),n.dirty()):s.kind==="time"?Hp(s).test(t.data)||(o=this._getOrReturnCtx(t,o),P(o,{code:I.invalid_string,validation:"time",message:s.message}),n.dirty()):s.kind==="duration"?$p.test(t.data)||(o=this._getOrReturnCtx(t,o),P(o,{validation:"duration",code:I.invalid_string,message:s.message}),n.dirty()):s.kind==="ip"?Kp(t.data,s.version)||(o=this._getOrReturnCtx(t,o),P(o,{validation:"ip",code:I.invalid_string,message:s.message}),n.dirty()):s.kind==="jwt"?Yp(t.data,s.alg)||(o=this._getOrReturnCtx(t,o),P(o,{validation:"jwt",code:I.invalid_string,message:s.message}),n.dirty()):s.kind==="cidr"?Xp(t.data,s.version)||(o=this._getOrReturnCtx(t,o),P(o,{validation:"cidr",code:I.invalid_string,message:s.message}),n.dirty()):s.kind==="base64"?Jp.test(t.data)||(o=this._getOrReturnCtx(t,o),P(o,{validation:"base64",code:I.invalid_string,message:s.message}),n.dirty()):s.kind==="base64url"?Wp.test(t.data)||(o=this._getOrReturnCtx(t,o),P(o,{validation:"base64url",code:I.invalid_string,message:s.message}),n.dirty()):ae.assertNever(s);return {status:n.value,value:t.data}}_regex(t,r,n){return this.refinement(o=>t.test(o),d({validation:r,code:I.invalid_string},B.errToObj(n)))}_addCheck(t){return new e(g(d({},this._def),{checks:[...this._def.checks,t]}))}email(t){return this._addCheck(d({kind:"email"},B.errToObj(t)))}url(t){return this._addCheck(d({kind:"url"},B.errToObj(t)))}emoji(t){return this._addCheck(d({kind:"emoji"},B.errToObj(t)))}uuid(t){return this._addCheck(d({kind:"uuid"},B.errToObj(t)))}nanoid(t){return this._addCheck(d({kind:"nanoid"},B.errToObj(t)))}cuid(t){return this._addCheck(d({kind:"cuid"},B.errToObj(t)))}cuid2(t){return this._addCheck(d({kind:"cuid2"},B.errToObj(t)))}ulid(t){return this._addCheck(d({kind:"ulid"},B.errToObj(t)))}base64(t){return this._addCheck(d({kind:"base64"},B.errToObj(t)))}base64url(t){return this._addCheck(d({kind:"base64url"},B.errToObj(t)))}jwt(t){return this._addCheck(d({kind:"jwt"},B.errToObj(t)))}ip(t){return this._addCheck(d({kind:"ip"},B.errToObj(t)))}cidr(t){return this._addCheck(d({kind:"cidr"},B.errToObj(t)))}datetime(t){var r,n;return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:false,local:false,message:t}):this._addCheck(d({kind:"datetime",precision:typeof(t==null?void 0:t.precision)=="undefined"?null:t==null?void 0:t.precision,offset:(r=t==null?void 0:t.offset)!==null&&r!==void 0?r:false,local:(n=t==null?void 0:t.local)!==null&&n!==void 0?n:false},B.errToObj(t==null?void 0:t.message)))}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck(d({kind:"time",precision:typeof(t==null?void 0:t.precision)=="undefined"?null:t==null?void 0:t.precision},B.errToObj(t==null?void 0:t.message)))}duration(t){return this._addCheck(d({kind:"duration"},B.errToObj(t)))}regex(t,r){return this._addCheck(d({kind:"regex",regex:t},B.errToObj(r)))}includes(t,r){return this._addCheck(d({kind:"includes",value:t,position:r==null?void 0:r.position},B.errToObj(r==null?void 0:r.message)))}startsWith(t,r){return this._addCheck(d({kind:"startsWith",value:t},B.errToObj(r)))}endsWith(t,r){return this._addCheck(d({kind:"endsWith",value:t},B.errToObj(r)))}min(t,r){return this._addCheck(d({kind:"min",value:t},B.errToObj(r)))}max(t,r){return this._addCheck(d({kind:"max",value:t},B.errToObj(r)))}length(t,r){return this._addCheck(d({kind:"length",value:t},B.errToObj(r)))}nonempty(t){return this.min(1,B.errToObj(t))}trim(){return new e(g(d({},this._def),{checks:[...this._def.checks,{kind:"trim"}]}))}toLowerCase(){return new e(g(d({},this._def),{checks:[...this._def.checks,{kind:"toLowerCase"}]}))}toUpperCase(){return new e(g(d({},this._def),{checks:[...this._def.checks,{kind:"toUpperCase"}]}))}get isDatetime(){return !!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return !!this._def.checks.find(t=>t.kind==="date")}get isTime(){return !!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return !!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return !!this._def.checks.find(t=>t.kind==="email")}get isURL(){return !!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return !!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return !!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return !!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return !!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return !!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return !!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return !!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return !!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return !!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return !!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(let r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxLength(){let t=null;for(let r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}};Qt.create=e=>{var t;return new Qt(d({checks:[],typeName:k.ZodString,coerce:(t=e==null?void 0:e.coerce)!==null&&t!==void 0?t:false},Q(e)))};function Qp(e,t){let r=(e.toString().split(".")[1]||"").length,n=(t.toString().split(".")[1]||"").length,o=r>n?r:n,s=parseInt(e.toFixed(o).replace(".","")),a=parseInt(t.toFixed(o).replace(".",""));return s%a/Math.pow(10,o)}var fr=class e extends ee{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf;}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==D.number){let s=this._getOrReturnCtx(t);return P(s,{code:I.invalid_type,expected:D.number,received:s.parsedType}),H}let n,o=new He;for(let s of this._def.checks)s.kind==="int"?ae.isInteger(t.data)||(n=this._getOrReturnCtx(t,n),P(n,{code:I.invalid_type,expected:"integer",received:"float",message:s.message}),o.dirty()):s.kind==="min"?(s.inclusive?t.data<s.value:t.data<=s.value)&&(n=this._getOrReturnCtx(t,n),P(n,{code:I.too_small,minimum:s.value,type:"number",inclusive:s.inclusive,exact:false,message:s.message}),o.dirty()):s.kind==="max"?(s.inclusive?t.data>s.value:t.data>=s.value)&&(n=this._getOrReturnCtx(t,n),P(n,{code:I.too_big,maximum:s.value,type:"number",inclusive:s.inclusive,exact:false,message:s.message}),o.dirty()):s.kind==="multipleOf"?Qp(t.data,s.value)!==0&&(n=this._getOrReturnCtx(t,n),P(n,{code:I.not_multiple_of,multipleOf:s.value,message:s.message}),o.dirty()):s.kind==="finite"?Number.isFinite(t.data)||(n=this._getOrReturnCtx(t,n),P(n,{code:I.not_finite,message:s.message}),o.dirty()):ae.assertNever(s);return {status:o.value,value:t.data}}gte(t,r){return this.setLimit("min",t,true,B.toString(r))}gt(t,r){return this.setLimit("min",t,false,B.toString(r))}lte(t,r){return this.setLimit("max",t,true,B.toString(r))}lt(t,r){return this.setLimit("max",t,false,B.toString(r))}setLimit(t,r,n,o){return new e(g(d({},this._def),{checks:[...this._def.checks,{kind:t,value:r,inclusive:n,message:B.toString(o)}]}))}_addCheck(t){return new e(g(d({},this._def),{checks:[...this._def.checks,t]}))}int(t){return this._addCheck({kind:"int",message:B.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:false,message:B.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:false,message:B.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:true,message:B.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:true,message:B.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:B.toString(r)})}finite(t){return this._addCheck({kind:"finite",message:B.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:true,value:Number.MIN_SAFE_INTEGER,message:B.toString(t)})._addCheck({kind:"max",inclusive:true,value:Number.MAX_SAFE_INTEGER,message:B.toString(t)})}get minValue(){let t=null;for(let r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(let r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}get isInt(){return !!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&ae.isInteger(t.value))}get isFinite(){let t=null,r=null;for(let n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return  true;n.kind==="min"?(r===null||n.value>r)&&(r=n.value):n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);}return Number.isFinite(r)&&Number.isFinite(t)}};fr.create=e=>new fr(d({checks:[],typeName:k.ZodNumber,coerce:(e==null?void 0:e.coerce)||false},Q(e)));var hr=class e extends ee{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte;}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data);}catch(s){return this._getInvalidInput(t)}if(this._getType(t)!==D.bigint)return this._getInvalidInput(t);let n,o=new He;for(let s of this._def.checks)s.kind==="min"?(s.inclusive?t.data<s.value:t.data<=s.value)&&(n=this._getOrReturnCtx(t,n),P(n,{code:I.too_small,type:"bigint",minimum:s.value,inclusive:s.inclusive,message:s.message}),o.dirty()):s.kind==="max"?(s.inclusive?t.data>s.value:t.data>=s.value)&&(n=this._getOrReturnCtx(t,n),P(n,{code:I.too_big,type:"bigint",maximum:s.value,inclusive:s.inclusive,message:s.message}),o.dirty()):s.kind==="multipleOf"?t.data%s.value!==BigInt(0)&&(n=this._getOrReturnCtx(t,n),P(n,{code:I.not_multiple_of,multipleOf:s.value,message:s.message}),o.dirty()):ae.assertNever(s);return {status:o.value,value:t.data}}_getInvalidInput(t){let r=this._getOrReturnCtx(t);return P(r,{code:I.invalid_type,expected:D.bigint,received:r.parsedType}),H}gte(t,r){return this.setLimit("min",t,true,B.toString(r))}gt(t,r){return this.setLimit("min",t,false,B.toString(r))}lte(t,r){return this.setLimit("max",t,true,B.toString(r))}lt(t,r){return this.setLimit("max",t,false,B.toString(r))}setLimit(t,r,n,o){return new e(g(d({},this._def),{checks:[...this._def.checks,{kind:t,value:r,inclusive:n,message:B.toString(o)}]}))}_addCheck(t){return new e(g(d({},this._def),{checks:[...this._def.checks,t]}))}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:false,message:B.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:false,message:B.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:true,message:B.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:true,message:B.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:B.toString(r)})}get minValue(){let t=null;for(let r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(let r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}};hr.create=e=>{var t;return new hr(d({checks:[],typeName:k.ZodBigInt,coerce:(t=e==null?void 0:e.coerce)!==null&&t!==void 0?t:false},Q(e)))};var mr=class extends ee{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==D.boolean){let n=this._getOrReturnCtx(t);return P(n,{code:I.invalid_type,expected:D.boolean,received:n.parsedType}),H}return Ye(t.data)}};mr.create=e=>new mr(d({typeName:k.ZodBoolean,coerce:(e==null?void 0:e.coerce)||false},Q(e)));var gr=class e extends ee{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==D.date){let s=this._getOrReturnCtx(t);return P(s,{code:I.invalid_type,expected:D.date,received:s.parsedType}),H}if(isNaN(t.data.getTime())){let s=this._getOrReturnCtx(t);return P(s,{code:I.invalid_date}),H}let n=new He,o;for(let s of this._def.checks)s.kind==="min"?t.data.getTime()<s.value&&(o=this._getOrReturnCtx(t,o),P(o,{code:I.too_small,message:s.message,inclusive:true,exact:false,minimum:s.value,type:"date"}),n.dirty()):s.kind==="max"?t.data.getTime()>s.value&&(o=this._getOrReturnCtx(t,o),P(o,{code:I.too_big,message:s.message,inclusive:true,exact:false,maximum:s.value,type:"date"}),n.dirty()):ae.assertNever(s);return {status:n.value,value:new Date(t.data.getTime())}}_addCheck(t){return new e(g(d({},this._def),{checks:[...this._def.checks,t]}))}min(t,r){return this._addCheck({kind:"min",value:t.getTime(),message:B.toString(r)})}max(t,r){return this._addCheck({kind:"max",value:t.getTime(),message:B.toString(r)})}get minDate(){let t=null;for(let r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(let r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t!=null?new Date(t):null}};gr.create=e=>new gr(d({checks:[],coerce:(e==null?void 0:e.coerce)||false,typeName:k.ZodDate},Q(e)));var $r=class extends ee{_parse(t){if(this._getType(t)!==D.symbol){let n=this._getOrReturnCtx(t);return P(n,{code:I.invalid_type,expected:D.symbol,received:n.parsedType}),H}return Ye(t.data)}};$r.create=e=>new $r(d({typeName:k.ZodSymbol},Q(e)));var yr=class extends ee{_parse(t){if(this._getType(t)!==D.undefined){let n=this._getOrReturnCtx(t);return P(n,{code:I.invalid_type,expected:D.undefined,received:n.parsedType}),H}return Ye(t.data)}};yr.create=e=>new yr(d({typeName:k.ZodUndefined},Q(e)));var vr=class extends ee{_parse(t){if(this._getType(t)!==D.null){let n=this._getOrReturnCtx(t);return P(n,{code:I.invalid_type,expected:D.null,received:n.parsedType}),H}return Ye(t.data)}};vr.create=e=>new vr(d({typeName:k.ZodNull},Q(e)));var er=class extends ee{constructor(){super(...arguments),this._any=true;}_parse(t){return Ye(t.data)}};er.create=e=>new er(d({typeName:k.ZodAny},Q(e)));var zt=class extends ee{constructor(){super(...arguments),this._unknown=true;}_parse(t){return Ye(t.data)}};zt.create=e=>new zt(d({typeName:k.ZodUnknown},Q(e)));var vt=class extends ee{_parse(t){let r=this._getOrReturnCtx(t);return P(r,{code:I.invalid_type,expected:D.never,received:r.parsedType}),H}};vt.create=e=>new vt(d({typeName:k.ZodNever},Q(e)));var qr=class extends ee{_parse(t){if(this._getType(t)!==D.undefined){let n=this._getOrReturnCtx(t);return P(n,{code:I.invalid_type,expected:D.void,received:n.parsedType}),H}return Ye(t.data)}};qr.create=e=>new qr(d({typeName:k.ZodVoid},Q(e)));var Lt=class e extends ee{_parse(t){let{ctx:r,status:n}=this._processInputParams(t),o=this._def;if(r.parsedType!==D.array)return P(r,{code:I.invalid_type,expected:D.array,received:r.parsedType}),H;if(o.exactLength!==null){let a=r.data.length>o.exactLength.value,i=r.data.length<o.exactLength.value;(a||i)&&(P(r,{code:a?I.too_big:I.too_small,minimum:i?o.exactLength.value:void 0,maximum:a?o.exactLength.value:void 0,type:"array",inclusive:true,exact:true,message:o.exactLength.message}),n.dirty());}if(o.minLength!==null&&r.data.length<o.minLength.value&&(P(r,{code:I.too_small,minimum:o.minLength.value,type:"array",inclusive:true,exact:false,message:o.minLength.message}),n.dirty()),o.maxLength!==null&&r.data.length>o.maxLength.value&&(P(r,{code:I.too_big,maximum:o.maxLength.value,type:"array",inclusive:true,exact:false,message:o.maxLength.message}),n.dirty()),r.common.async)return Promise.all([...r.data].map((a,i)=>o.type._parseAsync(new dt(r,a,r.path,i)))).then(a=>He.mergeArray(n,a));let s=[...r.data].map((a,i)=>o.type._parseSync(new dt(r,a,r.path,i)));return He.mergeArray(n,s)}get element(){return this._def.type}min(t,r){return new e(g(d({},this._def),{minLength:{value:t,message:B.toString(r)}}))}max(t,r){return new e(g(d({},this._def),{maxLength:{value:t,message:B.toString(r)}}))}length(t,r){return new e(g(d({},this._def),{exactLength:{value:t,message:B.toString(r)}}))}nonempty(t){return this.min(1,t)}};Lt.create=(e,t)=>new Lt(d({type:e,minLength:null,maxLength:null,exactLength:null,typeName:k.ZodArray},Q(t)));function Dr(e){if(e instanceof ot){let t={};for(let r in e.shape){let n=e.shape[r];t[r]=nt.create(Dr(n));}return new ot(g(d({},e._def),{shape:()=>t}))}else return e instanceof Lt?new Lt(g(d({},e._def),{type:Dr(e.element)})):e instanceof nt?nt.create(Dr(e.unwrap())):e instanceof Pt?Pt.create(Dr(e.unwrap())):e instanceof Ot?Ot.create(e.items.map(t=>Dr(t))):e}var ot=class e extends ee{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend;}_getCached(){if(this._cached!==null)return this._cached;let t=this._def.shape(),r=ae.objectKeys(t);return this._cached={shape:t,keys:r}}_parse(t){if(this._getType(t)!==D.object){let p=this._getOrReturnCtx(t);return P(p,{code:I.invalid_type,expected:D.object,received:p.parsedType}),H}let{status:n,ctx:o}=this._processInputParams(t),{shape:s,keys:a}=this._getCached(),i=[];if(!(this._def.catchall instanceof vt&&this._def.unknownKeys==="strip"))for(let p in o.data)a.includes(p)||i.push(p);let u=[];for(let p of a){let h=s[p],m=o.data[p];u.push({key:{status:"valid",value:p},value:h._parse(new dt(o,m,o.path,p)),alwaysSet:p in o.data});}if(this._def.catchall instanceof vt){let p=this._def.unknownKeys;if(p==="passthrough")for(let h of i)u.push({key:{status:"valid",value:h},value:{status:"valid",value:o.data[h]}});else if(p==="strict")i.length>0&&(P(o,{code:I.unrecognized_keys,keys:i}),n.dirty());else if(p!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else {let p=this._def.catchall;for(let h of i){let m=o.data[h];u.push({key:{status:"valid",value:h},value:p._parse(new dt(o,m,o.path,h)),alwaysSet:h in o.data});}}return o.common.async?Promise.resolve().then(()=>E(this,null,function*(){let p=[];for(let h of u){let m=yield h.key,_=yield h.value;p.push({key:m,value:_,alwaysSet:h.alwaysSet});}return p})).then(p=>He.mergeObjectSync(n,p)):He.mergeObjectSync(n,u)}get shape(){return this._def.shape()}strict(t){return B.errToObj,new e(d(g(d({},this._def),{unknownKeys:"strict"}),t!==void 0?{errorMap:(r,n)=>{var o,s,a,i;let u=(a=(s=(o=this._def).errorMap)===null||s===void 0?void 0:s.call(o,r,n).message)!==null&&a!==void 0?a:n.defaultError;return r.code==="unrecognized_keys"?{message:(i=B.errToObj(t).message)!==null&&i!==void 0?i:u}:{message:u}}}:{}))}strip(){return new e(g(d({},this._def),{unknownKeys:"strip"}))}passthrough(){return new e(g(d({},this._def),{unknownKeys:"passthrough"}))}extend(t){return new e(g(d({},this._def),{shape:()=>d(d({},this._def.shape()),t)}))}merge(t){return new e({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>d(d({},this._def.shape()),t._def.shape()),typeName:k.ZodObject})}setKey(t,r){return this.augment({[t]:r})}catchall(t){return new e(g(d({},this._def),{catchall:t}))}pick(t){let r={};return ae.objectKeys(t).forEach(n=>{t[n]&&this.shape[n]&&(r[n]=this.shape[n]);}),new e(g(d({},this._def),{shape:()=>r}))}omit(t){let r={};return ae.objectKeys(this.shape).forEach(n=>{t[n]||(r[n]=this.shape[n]);}),new e(g(d({},this._def),{shape:()=>r}))}deepPartial(){return Dr(this)}partial(t){let r={};return ae.objectKeys(this.shape).forEach(n=>{let o=this.shape[n];t&&!t[n]?r[n]=o:r[n]=o.optional();}),new e(g(d({},this._def),{shape:()=>r}))}required(t){let r={};return ae.objectKeys(this.shape).forEach(n=>{if(t&&!t[n])r[n]=this.shape[n];else {let s=this.shape[n];for(;s instanceof nt;)s=s._def.innerType;r[n]=s;}}),new e(g(d({},this._def),{shape:()=>r}))}keyof(){return Sa(ae.objectKeys(this.shape))}};ot.create=(e,t)=>new ot(d({shape:()=>e,unknownKeys:"strip",catchall:vt.create(),typeName:k.ZodObject},Q(t)));ot.strictCreate=(e,t)=>new ot(d({shape:()=>e,unknownKeys:"strict",catchall:vt.create(),typeName:k.ZodObject},Q(t)));ot.lazycreate=(e,t)=>new ot(d({shape:e,unknownKeys:"strip",catchall:vt.create(),typeName:k.ZodObject},Q(t)));var _r=class extends ee{_parse(t){let{ctx:r}=this._processInputParams(t),n=this._def.options;function o(s){for(let i of s)if(i.result.status==="valid")return i.result;for(let i of s)if(i.result.status==="dirty")return r.common.issues.push(...i.ctx.common.issues),i.result;let a=s.map(i=>new at(i.ctx.common.issues));return P(r,{code:I.invalid_union,unionErrors:a}),H}if(r.common.async)return Promise.all(n.map(s=>E(this,null,function*(){let a=g(d({},r),{common:g(d({},r.common),{issues:[]}),parent:null});return {result:yield s._parseAsync({data:r.data,path:r.path,parent:a}),ctx:a}}))).then(o);{let s,a=[];for(let u of n){let p=g(d({},r),{common:g(d({},r.common),{issues:[]}),parent:null}),h=u._parseSync({data:r.data,path:r.path,parent:p});if(h.status==="valid")return h;h.status==="dirty"&&!s&&(s={result:h,ctx:p}),p.common.issues.length&&a.push(p.common.issues);}if(s)return r.common.issues.push(...s.ctx.common.issues),s.result;let i=a.map(u=>new at(u));return P(r,{code:I.invalid_union,unionErrors:i}),H}}get options(){return this._def.options}};_r.create=(e,t)=>new _r(d({options:e,typeName:k.ZodUnion},Q(t)));var qt=e=>e instanceof wr?qt(e.schema):e instanceof it?qt(e.innerType()):e instanceof xr?[e.value]:e instanceof Sr?e.options:e instanceof Tr?ae.objectValues(e.enum):e instanceof Ir?qt(e._def.innerType):e instanceof yr?[void 0]:e instanceof vr?[null]:e instanceof nt?[void 0,...qt(e.unwrap())]:e instanceof Pt?[null,...qt(e.unwrap())]:e instanceof bn||e instanceof Ar?qt(e.unwrap()):e instanceof kr?qt(e._def.innerType):[],ho=class e extends ee{_parse(t){let{ctx:r}=this._processInputParams(t);if(r.parsedType!==D.object)return P(r,{code:I.invalid_type,expected:D.object,received:r.parsedType}),H;let n=this.discriminator,o=r.data[n],s=this.optionsMap.get(o);return s?r.common.async?s._parseAsync({data:r.data,path:r.path,parent:r}):s._parseSync({data:r.data,path:r.path,parent:r}):(P(r,{code:I.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),H)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,r,n){let o=new Map;for(let s of r){let a=qt(s.shape[t]);if(!a.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(let i of a){if(o.has(i))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(i)}`);o.set(i,s);}}return new e(d({typeName:k.ZodDiscriminatedUnion,discriminator:t,options:r,optionsMap:o},Q(n)))}};function cs(e,t){let r=Bt(e),n=Bt(t);if(e===t)return {valid:true,data:e};if(r===D.object&&n===D.object){let o=ae.objectKeys(t),s=ae.objectKeys(e).filter(i=>o.indexOf(i)!==-1),a=d(d({},e),t);for(let i of s){let u=cs(e[i],t[i]);if(!u.valid)return {valid:false};a[i]=u.data;}return {valid:true,data:a}}else if(r===D.array&&n===D.array){if(e.length!==t.length)return {valid:false};let o=[];for(let s=0;s<e.length;s++){let a=e[s],i=t[s],u=cs(a,i);if(!u.valid)return {valid:false};o.push(u.data);}return {valid:true,data:o}}else return r===D.date&&n===D.date&&+e==+t?{valid:true,data:e}:{valid:false}}var br=class extends ee{_parse(t){let{status:r,ctx:n}=this._processInputParams(t),o=(s,a)=>{if(us(s)||us(a))return H;let i=cs(s.value,a.value);return i.valid?((ps(s)||ps(a))&&r.dirty(),{status:r.value,value:i.data}):(P(n,{code:I.invalid_intersection_types}),H)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([s,a])=>o(s,a)):o(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}};br.create=(e,t,r)=>new br(d({left:e,right:t,typeName:k.ZodIntersection},Q(r)));var Ot=class e extends ee{_parse(t){let{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==D.array)return P(n,{code:I.invalid_type,expected:D.array,received:n.parsedType}),H;if(n.data.length<this._def.items.length)return P(n,{code:I.too_small,minimum:this._def.items.length,inclusive:true,exact:false,type:"array"}),H;!this._def.rest&&n.data.length>this._def.items.length&&(P(n,{code:I.too_big,maximum:this._def.items.length,inclusive:true,exact:false,type:"array"}),r.dirty());let s=[...n.data].map((a,i)=>{let u=this._def.items[i]||this._def.rest;return u?u._parse(new dt(n,a,n.path,i)):null}).filter(a=>!!a);return n.common.async?Promise.all(s).then(a=>He.mergeArray(r,a)):He.mergeArray(r,s)}get items(){return this._def.items}rest(t){return new e(g(d({},this._def),{rest:t}))}};Ot.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Ot(d({items:e,typeName:k.ZodTuple,rest:null},Q(t)))};var mo=class e extends ee{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){let{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==D.object)return P(n,{code:I.invalid_type,expected:D.object,received:n.parsedType}),H;let o=[],s=this._def.keyType,a=this._def.valueType;for(let i in n.data)o.push({key:s._parse(new dt(n,i,n.path,i)),value:a._parse(new dt(n,n.data[i],n.path,i)),alwaysSet:i in n.data});return n.common.async?He.mergeObjectAsync(r,o):He.mergeObjectSync(r,o)}get element(){return this._def.valueType}static create(t,r,n){return r instanceof ee?new e(d({keyType:t,valueType:r,typeName:k.ZodRecord},Q(n))):new e(d({keyType:Qt.create(),valueType:t,typeName:k.ZodRecord},Q(r)))}},Br=class extends ee{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){let{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==D.map)return P(n,{code:I.invalid_type,expected:D.map,received:n.parsedType}),H;let o=this._def.keyType,s=this._def.valueType,a=[...n.data.entries()].map(([i,u],p)=>({key:o._parse(new dt(n,i,n.path,[p,"key"])),value:s._parse(new dt(n,u,n.path,[p,"value"]))}));if(n.common.async){let i=new Map;return Promise.resolve().then(()=>E(this,null,function*(){for(let u of a){let p=yield u.key,h=yield u.value;if(p.status==="aborted"||h.status==="aborted")return H;(p.status==="dirty"||h.status==="dirty")&&r.dirty(),i.set(p.value,h.value);}return {status:r.value,value:i}}))}else {let i=new Map;for(let u of a){let p=u.key,h=u.value;if(p.status==="aborted"||h.status==="aborted")return H;(p.status==="dirty"||h.status==="dirty")&&r.dirty(),i.set(p.value,h.value);}return {status:r.value,value:i}}}};Br.create=(e,t,r)=>new Br(d({valueType:t,keyType:e,typeName:k.ZodMap},Q(r)));var zr=class e extends ee{_parse(t){let{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==D.set)return P(n,{code:I.invalid_type,expected:D.set,received:n.parsedType}),H;let o=this._def;o.minSize!==null&&n.data.size<o.minSize.value&&(P(n,{code:I.too_small,minimum:o.minSize.value,type:"set",inclusive:true,exact:false,message:o.minSize.message}),r.dirty()),o.maxSize!==null&&n.data.size>o.maxSize.value&&(P(n,{code:I.too_big,maximum:o.maxSize.value,type:"set",inclusive:true,exact:false,message:o.maxSize.message}),r.dirty());let s=this._def.valueType;function a(u){let p=new Set;for(let h of u){if(h.status==="aborted")return H;h.status==="dirty"&&r.dirty(),p.add(h.value);}return {status:r.value,value:p}}let i=[...n.data.values()].map((u,p)=>s._parse(new dt(n,u,n.path,p)));return n.common.async?Promise.all(i).then(u=>a(u)):a(i)}min(t,r){return new e(g(d({},this._def),{minSize:{value:t,message:B.toString(r)}}))}max(t,r){return new e(g(d({},this._def),{maxSize:{value:t,message:B.toString(r)}}))}size(t,r){return this.min(t,r).max(t,r)}nonempty(t){return this.min(1,t)}};zr.create=(e,t)=>new zr(d({valueType:e,minSize:null,maxSize:null,typeName:k.ZodSet},Q(t)));var go=class e extends ee{constructor(){super(...arguments),this.validate=this.implement;}_parse(t){let{ctx:r}=this._processInputParams(t);if(r.parsedType!==D.function)return P(r,{code:I.invalid_type,expected:D.function,received:r.parsedType}),H;function n(i,u){return co({data:i,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,po(),Ur].filter(p=>!!p),issueData:{code:I.invalid_arguments,argumentsError:u}})}function o(i,u){return co({data:i,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,po(),Ur].filter(p=>!!p),issueData:{code:I.invalid_return_type,returnTypeError:u}})}let s={errorMap:r.common.contextualErrorMap},a=r.data;if(this._def.returns instanceof tr){let i=this;return Ye(function(...u){return E(this,null,function*(){let p=new at([]),h=yield i._def.args.parseAsync(u,s).catch(S=>{throw p.addIssue(n(u,S)),p}),m=yield Reflect.apply(a,this,h);return yield i._def.returns._def.type.parseAsync(m,s).catch(S=>{throw p.addIssue(o(m,S)),p})})})}else {let i=this;return Ye(function(...u){let p=i._def.args.safeParse(u,s);if(!p.success)throw new at([n(u,p.error)]);let h=Reflect.apply(a,this,p.data),m=i._def.returns.safeParse(h,s);if(!m.success)throw new at([o(h,m.error)]);return m.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...t){return new e(g(d({},this._def),{args:Ot.create(t).rest(zt.create())}))}returns(t){return new e(g(d({},this._def),{returns:t}))}implement(t){return this.parse(t)}strictImplement(t){return this.parse(t)}static create(t,r,n){return new e(d({args:t||Ot.create([]).rest(zt.create()),returns:r||zt.create(),typeName:k.ZodFunction},Q(n)))}},wr=class extends ee{get schema(){return this._def.getter()}_parse(t){let{ctx:r}=this._processInputParams(t);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}};wr.create=(e,t)=>new wr(d({getter:e,typeName:k.ZodLazy},Q(t)));var xr=class extends ee{_parse(t){if(t.data!==this._def.value){let r=this._getOrReturnCtx(t);return P(r,{received:r.data,code:I.invalid_literal,expected:this._def.value}),H}return {status:"valid",value:t.data}}get value(){return this._def.value}};xr.create=(e,t)=>new xr(d({value:e,typeName:k.ZodLiteral},Q(t)));function Sa(e,t){return new Sr(d({values:e,typeName:k.ZodEnum},Q(t)))}var Sr=class e extends ee{constructor(){super(...arguments),yn.set(this,void 0);}_parse(t){if(typeof t.data!="string"){let r=this._getOrReturnCtx(t),n=this._def.values;return P(r,{expected:ae.joinValues(n),received:r.parsedType,code:I.invalid_type}),H}if(fo(this,yn)||_a(this,yn,new Set(this._def.values)),!fo(this,yn).has(t.data)){let r=this._getOrReturnCtx(t),n=this._def.values;return P(r,{received:r.data,code:I.invalid_enum_value,options:n}),H}return Ye(t.data)}get options(){return this._def.values}get enum(){let t={};for(let r of this._def.values)t[r]=r;return t}get Values(){let t={};for(let r of this._def.values)t[r]=r;return t}get Enum(){let t={};for(let r of this._def.values)t[r]=r;return t}extract(t,r=this._def){return e.create(t,d(d({},this._def),r))}exclude(t,r=this._def){return e.create(this.options.filter(n=>!t.includes(n)),d(d({},this._def),r))}};yn=new WeakMap;Sr.create=Sa;var Tr=class extends ee{constructor(){super(...arguments),vn.set(this,void 0);}_parse(t){let r=ae.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(t);if(n.parsedType!==D.string&&n.parsedType!==D.number){let o=ae.objectValues(r);return P(n,{expected:ae.joinValues(o),received:n.parsedType,code:I.invalid_type}),H}if(fo(this,vn)||_a(this,vn,new Set(ae.getValidEnumValues(this._def.values))),!fo(this,vn).has(t.data)){let o=ae.objectValues(r);return P(n,{received:n.data,code:I.invalid_enum_value,options:o}),H}return Ye(t.data)}get enum(){return this._def.values}};vn=new WeakMap;Tr.create=(e,t)=>new Tr(d({values:e,typeName:k.ZodNativeEnum},Q(t)));var tr=class extends ee{unwrap(){return this._def.type}_parse(t){let{ctx:r}=this._processInputParams(t);if(r.parsedType!==D.promise&&r.common.async===false)return P(r,{code:I.invalid_type,expected:D.promise,received:r.parsedType}),H;let n=r.parsedType===D.promise?r.data:Promise.resolve(r.data);return Ye(n.then(o=>this._def.type.parseAsync(o,{path:r.path,errorMap:r.common.contextualErrorMap})))}};tr.create=(e,t)=>new tr(d({type:e,typeName:k.ZodPromise},Q(t)));var it=class extends ee{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===k.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){let{status:r,ctx:n}=this._processInputParams(t),o=this._def.effect||null,s={addIssue:a=>{P(n,a),a.fatal?r.abort():r.dirty();},get path(){return n.path}};if(s.addIssue=s.addIssue.bind(s),o.type==="preprocess"){let a=o.transform(n.data,s);if(n.common.async)return Promise.resolve(a).then(i=>E(this,null,function*(){if(r.value==="aborted")return H;let u=yield this._def.schema._parseAsync({data:i,path:n.path,parent:n});return u.status==="aborted"?H:u.status==="dirty"||r.value==="dirty"?Fr(u.value):u}));{if(r.value==="aborted")return H;let i=this._def.schema._parseSync({data:a,path:n.path,parent:n});return i.status==="aborted"?H:i.status==="dirty"||r.value==="dirty"?Fr(i.value):i}}if(o.type==="refinement"){let a=i=>{let u=o.refinement(i,s);if(n.common.async)return Promise.resolve(u);if(u instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return i};if(n.common.async===false){let i=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return i.status==="aborted"?H:(i.status==="dirty"&&r.dirty(),a(i.value),{status:r.value,value:i.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(i=>i.status==="aborted"?H:(i.status==="dirty"&&r.dirty(),a(i.value).then(()=>({status:r.value,value:i.value}))))}if(o.type==="transform")if(n.common.async===false){let a=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!dr(a))return a;let i=o.transform(a.value,s);if(i instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return {status:r.value,value:i}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(a=>dr(a)?Promise.resolve(o.transform(a.value,s)).then(i=>({status:r.value,value:i})):a);ae.assertNever(o);}};it.create=(e,t,r)=>new it(d({schema:e,typeName:k.ZodEffects,effect:t},Q(r)));it.createWithPreprocess=(e,t,r)=>new it(d({schema:t,effect:{type:"preprocess",transform:e},typeName:k.ZodEffects},Q(r)));var nt=class extends ee{_parse(t){return this._getType(t)===D.undefined?Ye(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}};nt.create=(e,t)=>new nt(d({innerType:e,typeName:k.ZodOptional},Q(t)));var Pt=class extends ee{_parse(t){return this._getType(t)===D.null?Ye(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}};Pt.create=(e,t)=>new Pt(d({innerType:e,typeName:k.ZodNullable},Q(t)));var Ir=class extends ee{_parse(t){let{ctx:r}=this._processInputParams(t),n=r.data;return r.parsedType===D.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:r.path,parent:r})}removeDefault(){return this._def.innerType}};Ir.create=(e,t)=>new Ir(d({innerType:e,typeName:k.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default},Q(t)));var kr=class extends ee{_parse(t){let{ctx:r}=this._processInputParams(t),n=g(d({},r),{common:g(d({},r.common),{issues:[]})}),o=this._def.innerType._parse({data:n.data,path:n.path,parent:d({},n)});return _n(o)?o.then(s=>({status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new at(n.common.issues)},input:n.data})})):{status:"valid",value:o.status==="valid"?o.value:this._def.catchValue({get error(){return new at(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}};kr.create=(e,t)=>new kr(d({innerType:e,typeName:k.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch},Q(t)));var Lr=class extends ee{_parse(t){if(this._getType(t)!==D.nan){let n=this._getOrReturnCtx(t);return P(n,{code:I.invalid_type,expected:D.nan,received:n.parsedType}),H}return {status:"valid",value:t.data}}};Lr.create=e=>new Lr(d({typeName:k.ZodNaN},Q(e)));var ec=Symbol("zod_brand"),bn=class extends ee{_parse(t){let{ctx:r}=this._processInputParams(t),n=r.data;return this._def.type._parse({data:n,path:r.path,parent:r})}unwrap(){return this._def.type}},wn=class e extends ee{_parse(t){let{status:r,ctx:n}=this._processInputParams(t);if(n.common.async)return E(this,null,function*(){let s=yield this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return s.status==="aborted"?H:s.status==="dirty"?(r.dirty(),Fr(s.value)):this._def.out._parseAsync({data:s.value,path:n.path,parent:n})});{let o=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return o.status==="aborted"?H:o.status==="dirty"?(r.dirty(),{status:"dirty",value:o.value}):this._def.out._parseSync({data:o.value,path:n.path,parent:n})}}static create(t,r){return new e({in:t,out:r,typeName:k.ZodPipeline})}},Ar=class extends ee{_parse(t){let r=this._def.innerType._parse(t),n=o=>(dr(o)&&(o.value=Object.freeze(o.value)),o);return _n(r)?r.then(o=>n(o)):n(r)}unwrap(){return this._def.innerType}};Ar.create=(e,t)=>new Ar(d({innerType:e,typeName:k.ZodReadonly},Q(t)));function ga(e,t){let r=typeof e=="function"?e(t):typeof e=="string"?{message:e}:e;return typeof r=="string"?{message:r}:r}function Ta(e,t={},r){return e?er.create().superRefine((n,o)=>{var s,a;let i=e(n);if(i instanceof Promise)return i.then(u=>{var p,h;if(!u){let m=ga(t,n),_=(h=(p=m.fatal)!==null&&p!==void 0?p:r)!==null&&h!==void 0?h:true;o.addIssue(g(d({code:"custom"},m),{fatal:_}));}});if(!i){let u=ga(t,n),p=(a=(s=u.fatal)!==null&&s!==void 0?s:r)!==null&&a!==void 0?a:true;o.addIssue(g(d({code:"custom"},u),{fatal:p}));}}):er.create()}var tc={object:ot.lazycreate},k;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly";})(k||(k={}));var rc=(e,t={message:`Input not instance of ${e.name}`})=>Ta(r=>r instanceof e,t),Ia=Qt.create,ka=fr.create,nc=Lr.create,oc=hr.create,Aa=mr.create,sc=gr.create,ac=$r.create,ic=yr.create,lc=vr.create,uc=er.create,pc=zt.create,cc=vt.create,dc=qr.create,fc=Lt.create,hc=ot.create,mc=ot.strictCreate,gc=_r.create,yc=ho.create,vc=br.create,_c=Ot.create,bc=mo.create,wc=Br.create,xc=zr.create,Sc=go.create,Tc=wr.create,Ic=xr.create,kc=Sr.create,Ac=Tr.create,Ec=tr.create,ya=it.create,Rc=nt.create,Cc=Pt.create,jc=it.createWithPreprocess,Oc=wn.create,Pc=()=>Ia().optional(),Mc=()=>ka().optional(),Nc=()=>Aa().optional(),Dc={string:e=>Qt.create(g(d({},e),{coerce:true})),number:e=>fr.create(g(d({},e),{coerce:true})),boolean:e=>mr.create(g(d({},e),{coerce:true})),bigint:e=>hr.create(g(d({},e),{coerce:true})),date:e=>gr.create(g(d({},e),{coerce:true}))},Fc=H,l=Object.freeze({__proto__:null,defaultErrorMap:Ur,setErrorMap:jp,getErrorMap:po,makeIssue:co,EMPTY_PATH:Op,addIssueToContext:P,ParseStatus:He,INVALID:H,DIRTY:Fr,OK:Ye,isAborted:us,isDirty:ps,isValid:dr,isAsync:_n,get util(){return ae},get objectUtil(){return ls},ZodParsedType:D,getParsedType:Bt,ZodType:ee,datetimeRegex:xa,ZodString:Qt,ZodNumber:fr,ZodBigInt:hr,ZodBoolean:mr,ZodDate:gr,ZodSymbol:$r,ZodUndefined:yr,ZodNull:vr,ZodAny:er,ZodUnknown:zt,ZodNever:vt,ZodVoid:qr,ZodArray:Lt,ZodObject:ot,ZodUnion:_r,ZodDiscriminatedUnion:ho,ZodIntersection:br,ZodTuple:Ot,ZodRecord:mo,ZodMap:Br,ZodSet:zr,ZodFunction:go,ZodLazy:wr,ZodLiteral:xr,ZodEnum:Sr,ZodNativeEnum:Tr,ZodPromise:tr,ZodEffects:it,ZodTransformer:it,ZodOptional:nt,ZodNullable:Pt,ZodDefault:Ir,ZodCatch:kr,ZodNaN:Lr,BRAND:ec,ZodBranded:bn,ZodPipeline:wn,ZodReadonly:Ar,custom:Ta,Schema:ee,ZodSchema:ee,late:tc,get ZodFirstPartyTypeKind(){return k},coerce:Dc,any:uc,array:fc,bigint:oc,boolean:Aa,date:sc,discriminatedUnion:yc,effect:ya,enum:kc,function:Sc,instanceof:rc,intersection:vc,lazy:Tc,literal:Ic,map:wc,nan:nc,nativeEnum:Ac,never:cc,null:lc,nullable:Cc,number:ka,object:hc,oboolean:Nc,onumber:Mc,optional:Rc,ostring:Pc,pipeline:Oc,preprocess:jc,promise:Ec,record:bc,set:xc,strictObject:mc,string:Ia,symbol:ac,transformer:ya,tuple:_c,undefined:ic,union:gc,unknown:pc,void:dc,NEVER:Fc,ZodIssueCode:I,quotelessJson:Cp,ZodError:at});var xn=class{static convert(t){return this.parseSchema(t)}static matchesCondition(t,r){if(!r.properties)return  true;if(typeof t!="object"||t===null||Array.isArray(t))return  false;let n=t;for(let[o,s]of Object.entries(r.properties)){if(!(o in n)){if("const"in s)return  false;continue}let a=n[o];if("const"in s&&a!==s.const||"minimum"in s&&typeof a=="number"&&a<s.minimum||"maximum"in s&&typeof a=="number"&&a>s.maximum)return  false}return  true}static validateConditionalSchema(t,r,n){this.validateRequiredProperties(t,r,n),this.validatePropertyPatterns(t,r,n),this.validateNestedConditions(t,r,n);}static validateRequiredProperties(t,r,n){if(r.required){if(typeof t!="object"||t===null){for(let o of r.required)n.addIssue({code:l.ZodIssueCode.custom,message:`Required property '${o}' is missing`,path:[o]});return}for(let o of r.required)o in t||n.addIssue({code:l.ZodIssueCode.custom,message:`Required property '${o}' is missing`,path:[o]});}}static validatePropertyPatterns(t,r,n){if(!r.properties||typeof t!="object"||t===null||Array.isArray(t))return;let o=t;for(let[s,a]of Object.entries(r.properties)){if(!(s in o))continue;let i=o[s];a.pattern&&typeof i=="string"&&(new RegExp(a.pattern).test(i)||n.addIssue({code:l.ZodIssueCode.custom,message:`String '${i}' does not match pattern '${a.pattern}'`,path:[s]}));}}static validateNestedConditions(t,r,n){if(!r.if||!r.then)return;this.matchesCondition(t,r.if)?this.validateConditionalSchema(t,r.then,n):r.else&&this.validateConditionalSchema(t,r.else,n);}static parseSchema(t){return Array.isArray(t.type)?this.handleTypeArray(t):t.oneOf||t.anyOf||t.allOf?this.parseCombinator(t):t.if&&t.then?this.parseObject(t):t.properties&&(!t.type||t.type==="object")?this.parseObject(t):this.handleSingleType(t)}static handleTypeArray(t){if(!Array.isArray(t.type))throw new Error("Expected schema.type to be an array");return t.type.includes("null")?this.handleNullableType(t):this.createUnionFromTypes(t.type,t)}static handleNullableType(t){if(!Array.isArray(t.type))throw new Error("Expected schema.type to be an array");let r=d({},t);return r.type=t.type.filter(o=>o!=="null"),r.type.length===1?this.handleSingleType(g(d({},t),{type:r.type[0]})).nullable():this.parseSchema(r).nullable()}static createUnionFromTypes(t,r){let n=t.map(o=>{let s=g(d({},r),{type:o});return this.parseSchema(s)});return l.union(n)}static handleSingleType(t){if(t.type===void 0)return t.oneOf||t.anyOf||t.allOf?this.parseCombinator(t):t.properties?this.parseObject(t):l.any();switch(t.type){case "string":return this.parseString(t);case "number":case "integer":return this.parseNumberSchema(t);case "boolean":return l.boolean();case "array":return this.parseArray(t);case "object":return this.parseObject(t);default:throw new Error("Unsupported schema type")}}static parseNumberSchema(t){let r=l.number(),n=r;return n=this.applyNumberBounds(r,t),n=this.applyNumberMultipleOf(r,t),n=this.applyNumberEnum(r,t),n=this.applyIntegerConstraint(r,t),n}static applyNumberBounds(t,r){let n=t;return r.minimum!==void 0&&(n=r.exclusiveMinimum?n.gt(r.minimum):n.gte(r.minimum)),r.maximum!==void 0&&(n=r.exclusiveMaximum?n.lt(r.maximum):n.lte(r.maximum)),n}static applyNumberMultipleOf(t,r){return r.multipleOf===void 0?t:t.refine(n=>n%r.multipleOf===0,{message:`Number must be a multiple of ${r.multipleOf}`})}static applyNumberEnum(t,r){if(!r.enum)return t;let n=r.enum.filter(o=>typeof o=="number");return n.length===0?t:t.refine(o=>n.includes(o),{message:`Number must be one of: ${n.join(", ")}`})}static applyIntegerConstraint(t,r){return r.type!=="integer"?t:t.refine(n=>Number.isInteger(n),{message:"Number must be an integer"})}static parseString(t){let r=l.string(),n=r;return t.format?this.applyStringFormat(r,t):(n=this.applyStringPattern(r,t),n=this.applyStringLength(r,t),n=this.applyStringEnum(r,t),n)}static applyStringFormat(t,r){if(!r.format)return t;switch(r.format){case "email":return t.email();case "date-time":return t.datetime();case "uri":return t.url();case "uuid":return t.uuid();case "date":return t.date();default:return t}}static applyStringPattern(t,r){if(!r.pattern)return t;let n=new RegExp(r.pattern);return t.regex(n,{message:`String must match pattern: ${r.pattern}`})}static applyStringLength(t,r){let n=t;return r.minLength!==void 0&&(t=t.min(r.minLength)),r.maxLength!==void 0&&(t=t.max(r.maxLength)),n}static applyStringEnum(t,r){var n;return r.enum?t.refine(o=>{var s;return (s=r.enum)==null?void 0:s.includes(o)},{message:`Value must be one of: ${(n=r.enum)==null?void 0:n.join(", ")}`}):t}static parseArray(t){if(Array.isArray(t.items)){let s=t.items.map(a=>this.parseSchema(a));return l.union(s)}let r=t.items?this.parseSchema(t.items):l.any(),n=l.array(r),o=n;return o=this.applyArrayConstraints(n,t),o}static applyArrayConstraints(t,r){return r.minItems!==void 0&&(t=t.min(r.minItems)),r.maxItems!==void 0&&(t=t.max(r.maxItems)),r.uniqueItems?t.refine(n=>new Set(n).size===n.length,{message:"Array items must be unique"}):t}static parseObject(t){if(t.if&&t.then)return this.parseConditional(t);let r={};return this.processObjectProperties(t,r),this.processAdditionalProperties(t,l.object(r))}static processObjectProperties(t,r){let n=new Set(t.required||[]);if(t.properties)for(let[o,s]of Object.entries(t.properties)){let a=this.parseSchema(s);r[o]=n.has(o)?a:a.optional();}}static processAdditionalProperties(t,r){if(t.additionalProperties===true)return r.passthrough();if(t.additionalProperties&&typeof t.additionalProperties=="object"){let n=this.parseSchema(t.additionalProperties);return r.catchall(n)}else return r.strict()}static parseConditional(t){let r=this.createBaseObjectSchema(t),n=t.if,o=t.then,s=t.else;return r.superRefine((a,i)=>{let u=this.applyDefaultValues(a,t);this.matchesCondition(u,n)?this.validateConditionalSchema(u,o,i):s&&this.validateConditionalSchema(u,s,i);})}static createBaseObjectSchema(t){let r={},n=new Set(t.required||[]);for(let[s,a]of Object.entries(t.properties||{})){let i=this.parseSchema(a);r[s]=n.has(s)?i:i.optional();}let o=l.object(r);return this.processAdditionalProperties(t,o)}static applyDefaultValues(t,r){if(typeof t!="object"||t===null||Array.isArray(t))return t;let o=d({},t);if(!r.properties)return o;for(let[s,a]of Object.entries(r.properties))!(s in o)&&"default"in a&&(o[s]=a.default);return o}static parseCombinator(t){if(t.oneOf)return this.parseOneOf(t.oneOf);if(t.anyOf)return this.parseAnyOf(t.anyOf);if(t.allOf)return this.parseAllOf(t.allOf);throw new Error("Unsupported schema type")}static parseOneOf(t){return this.createUnionFromSchemas(t)}static parseAnyOf(t){return this.createUnionFromSchemas(t)}static createUnionFromSchemas(t){if(t.length===0)return l.any();if(t.length===1)return this.parseSchema(t[0]);let r=[];for(let n of t)n.type==="null"?r.push(l.null()):r.push(this.parseSchema(n));return r.length>=2?l.union(r):r.length===1?r[0]:l.any()}static parseAllOf(t){if(t.length===0)return l.any();if(t.length===1)return this.parseSchema(t[0]);let r=t.reduce((n,o)=>this.mergeSchemas(n,o));return this.parseSchema(r)}static mergeSchemas(t,r){let n=d(d({},t),r);if(t.properties&&r.properties){let o=d(d({},t.properties),r.properties);n.properties=o;}if(t.required&&r.required){let o=[...new Set([...t.required,...r.required])];n.required=o;}return n}};var Ea="vercel.ai.error",Uc=Symbol.for(Ea),Ra,$c=class Ca extends Error{constructor({name:t,message:r,cause:n}){super(r),this[Ra]=true,this.name=t,this.cause=n;}static isInstance(t){return Ca.hasMarker(t,Ea)}static hasMarker(t,r){let n=Symbol.for(r);return t!=null&&typeof t=="object"&&n in t&&typeof t[n]=="boolean"&&t[n]===true}};Ra=Uc;var q=$c,ja="AI_APICallError",Oa=`vercel.ai.error.${ja}`,qc=Symbol.for(Oa),Pa,Xe=class extends q{constructor({message:e,url:t,requestBodyValues:r,statusCode:n,responseHeaders:o,responseBody:s,cause:a,isRetryable:i=n!=null&&(n===408||n===409||n===429||n>=500),data:u}){super({name:ja,message:e,cause:a}),this[Pa]=true,this.url=t,this.requestBodyValues=r,this.statusCode=n,this.responseHeaders=o,this.responseBody=s,this.isRetryable=i,this.data=u;}static isInstance(e){return q.hasMarker(e,Oa)}};Pa=qc;var Ma="AI_EmptyResponseBodyError",Na=`vercel.ai.error.${Ma}`,Bc=Symbol.for(Na),Da,Fa=class extends q{constructor({message:e="Empty response body"}={}){super({name:Ma,message:e}),this[Da]=true;}static isInstance(e){return q.hasMarker(e,Na)}};Da=Bc;function rr(e){return e==null?"unknown error":typeof e=="string"?e:e instanceof Error?e.message:JSON.stringify(e)}var Ua="AI_InvalidArgumentError",$a=`vercel.ai.error.${Ua}`,zc=Symbol.for($a),qa,vo=class extends q{constructor({message:e,cause:t,argument:r}){super({name:Ua,message:e,cause:t}),this[qa]=true,this.argument=r;}static isInstance(e){return q.hasMarker(e,$a)}};qa=zc;var Ba="AI_InvalidPromptError",za=`vercel.ai.error.${Ba}`,Lc=Symbol.for(za),La,_t=class extends q{constructor({prompt:e,message:t,cause:r}){super({name:Ba,message:`Invalid prompt: ${t}`,cause:r}),this[La]=true,this.prompt=e;}static isInstance(e){return q.hasMarker(e,za)}};La=Lc;var Va="AI_InvalidResponseDataError",Za=`vercel.ai.error.${Va}`,Vc=Symbol.for(Za),Ja,_o=class extends q{constructor({data:e,message:t=`Invalid response data: ${JSON.stringify(e)}.`}){super({name:Va,message:t}),this[Ja]=true,this.data=e;}static isInstance(e){return q.hasMarker(e,Za)}};Ja=Vc;var Wa="AI_JSONParseError",Ga=`vercel.ai.error.${Wa}`,Zc=Symbol.for(Ga),Ha,Er=class extends q{constructor({text:e,cause:t}){super({name:Wa,message:`JSON parsing failed: Text: ${e}.
Error message: ${rr(t)}`,cause:t}),this[Ha]=true,this.text=e;}static isInstance(e){return q.hasMarker(e,Ga)}};Ha=Zc;var Ka="AI_LoadAPIKeyError",Ya=`vercel.ai.error.${Ka}`,Jc=Symbol.for(Ya),Xa,Sn=class extends q{constructor({message:e}){super({name:Ka,message:e}),this[Xa]=true;}static isInstance(e){return q.hasMarker(e,Ya)}};Xa=Jc;var Qa="AI_TooManyEmbeddingValuesForCallError",ei=`vercel.ai.error.${Qa}`,sd=Symbol.for(ei),ti,ri=class extends q{constructor(e){super({name:Qa,message:`Too many values for a single embedding call. The ${e.provider} model "${e.modelId}" can only embed up to ${e.maxEmbeddingsPerCall} values per call, but ${e.values.length} values were provided.`}),this[ti]=true,this.provider=e.provider,this.modelId=e.modelId,this.maxEmbeddingsPerCall=e.maxEmbeddingsPerCall,this.values=e.values;}static isInstance(e){return q.hasMarker(e,ei)}};ti=sd;var ni="AI_TypeValidationError",oi=`vercel.ai.error.${ni}`,ad=Symbol.for(oi),si,id=class ds extends q{constructor({value:t,cause:r}){super({name:ni,message:`Type validation failed: Value: ${JSON.stringify(t)}.
Error message: ${rr(r)}`,cause:r}),this[si]=true,this.value=t;}static isInstance(t){return q.hasMarker(t,oi)}static wrap({value:t,cause:r}){return ds.isInstance(r)&&r.value===t?r:new ds({value:t,cause:r})}};si=ad;var lt=id,ai="AI_UnsupportedFunctionalityError",ii=`vercel.ai.error.${ai}`,ld=Symbol.for(ii),li,fe=class extends q{constructor({functionality:e,message:t=`'${e}' functionality not supported.`}){super({name:ai,message:t}),this[li]=true,this.functionality=e;}static isInstance(e){return q.hasMarker(e,ii)}};li=ld;function yo(e){return e===null||typeof e=="string"||typeof e=="number"||typeof e=="boolean"?true:Array.isArray(e)?e.every(yo):typeof e=="object"?Object.entries(e).every(([t,r])=>typeof t=="string"&&yo(r)):false}function fs(e){return Array.isArray(e)&&e.every(yo)}function bo(e){return e!=null&&typeof e=="object"&&Object.entries(e).every(([t,r])=>typeof t=="string"&&yo(r))}var ui=(e,t=21)=>(r=t)=>{let n="",o=r|0;for(;o--;)n+=e[Math.random()*e.length|0];return n};var wo=ha(hi());function Le(...e){return e.reduce((t,r)=>d(d({},t),r!=null?r:{}),{})}function mi(e){return new ReadableStream({pull(r){return E(this,null,function*(){try{let{value:n,done:o}=yield e.next();o?r.close():r.enqueue(n);}catch(n){r.error(n);}})},cancel(){}})}function gi(e){return E(this,null,function*(){return e==null?Promise.resolve():new Promise(t=>setTimeout(t,e))})}function cd(){let e="",t,r=[],n,o;function s(u,p){if(u===""){a(p);return}if(u.startsWith(":"))return;let h=u.indexOf(":");if(h===-1){i(u,"");return}let m=u.slice(0,h),_=h+1,S=_<u.length&&u[_]===" "?u.slice(_+1):u.slice(_);i(m,S);}function a(u){r.length>0&&(u.enqueue({event:t,data:r.join(`
`),id:n,retry:o}),r=[],t=void 0,o=void 0);}function i(u,p){switch(u){case "event":t=p;break;case "data":r.push(p);break;case "id":n=p;break;case "retry":let h=parseInt(p,10);isNaN(h)||(o=h);break}}return new TransformStream({transform(u,p){let{lines:h,incompleteLine:m}=dd(e,u);e=m;for(let _=0;_<h.length;_++)s(h[_],p);},flush(u){s(e,u),a(u);}})}function dd(e,t){let r=[],n=e;for(let o=0;o<t.length;){let s=t[o++];s===`
`?(r.push(n),n=""):s==="\r"?(r.push(n),n="",t[o+1]===`
`&&o++):n+=s;}return {lines:r,incompleteLine:n}}function kn(e){let t={};return e.headers.forEach((r,n)=>{t[n]=r;}),t}var bt=({prefix:e,size:t=16,alphabet:r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:n="-"}={})=>{let o=ui(r,t);if(e==null)return o;if(r.includes(n))throw new vo({argument:"separator",message:`The separator "${n}" must not be part of the alphabet "${r}".`});return s=>`${e}${n}${o(s)}`},ft=bt();function yi(e){return e==null?"unknown error":typeof e=="string"?e:e instanceof Error?e.message:JSON.stringify(e)}function fd(e){return Object.fromEntries(Object.entries(e).filter(([t,r])=>r!=null))}function Tn(e){return e instanceof Error&&(e.name==="AbortError"||e.name==="TimeoutError")}function vi({apiKey:e,environmentVariableName:t,apiKeyParameterName:r="apiKey",description:n}){if(typeof e=="string")return e;if(e!=null)throw new Sn({message:`${n} API key must be a string.`});if(typeof process=="undefined")throw new Sn({message:`${n} API key is missing. Pass it using the '${r}' parameter. Environment variables is not supported in this environment.`});if(e=process.env[t],e==null)throw new Sn({message:`${n} API key is missing. Pass it using the '${r}' parameter or the ${t} environment variable.`});if(typeof e!="string")throw new Sn({message:`${n} API key must be a string. The value of the ${t} environment variable is not a string.`});return e}var In=Symbol.for("vercel.ai.validator");function hd(e){return {[In]:true,validate:e}}function md(e){return typeof e=="object"&&e!==null&&In in e&&e[In]===true&&"validate"in e}function gd(e){return md(e)?e:yd(e)}function yd(e){return hd(t=>{let r=e.safeParse(t);return r.success?{success:true,value:r.data}:{success:false,error:r.error}})}function vd({value:e,schema:t}){let r=ut({value:e,schema:t});if(!r.success)throw lt.wrap({value:e,cause:r.error});return r.value}function ut({value:e,schema:t}){let r=gd(t);try{if(r.validate==null)return {success:!0,value:e};let n=r.validate(e);return n.success?n:{success:!1,error:lt.wrap({value:e,cause:n.error})}}catch(n){return {success:false,error:lt.wrap({value:e,cause:n})}}}function _d({text:e,schema:t}){try{let r=wo.default.parse(e);return t==null?r:vd({value:r,schema:t})}catch(r){throw Er.isInstance(r)||lt.isInstance(r)?r:new Er({text:e,cause:r})}}function wt({text:e,schema:t}){try{let r=wo.default.parse(e);if(t==null)return {success:!0,value:r,rawValue:r};let n=ut({value:r,schema:t});return n.success?g(d({},n),{rawValue:r}):n}catch(r){return {success:false,error:Er.isInstance(r)?r:new Er({text:e,cause:r})}}}function ms(e){try{return wo.default.parse(e),!0}catch(t){return  false}}function Zr({provider:e,providerOptions:t,schema:r}){if((t==null?void 0:t[e])==null)return;let n=ut({value:t[e],schema:r});if(!n.success)throw new vo({argument:"providerOptions",message:`invalid ${e} provider options`,cause:n.error});return n.value}var bd=()=>globalThis.fetch,Qe=i=>E(null,[i],function*({url:e,headers:t,body:r,failedResponseHandler:n,successfulResponseHandler:o,abortSignal:s,fetch:a}){return bi({url:e,headers:d({"Content-Type":"application/json"},t),body:{content:JSON.stringify(r),values:r},failedResponseHandler:n,successfulResponseHandler:o,abortSignal:s,fetch:a})}),_i=i=>E(null,[i],function*({url:e,headers:t,formData:r,failedResponseHandler:n,successfulResponseHandler:o,abortSignal:s,fetch:a}){return bi({url:e,headers:t,body:{content:r,values:Object.fromEntries(r.entries())},failedResponseHandler:n,successfulResponseHandler:o,abortSignal:s,fetch:a})}),bi=i=>E(null,[i],function*({url:e,headers:t={},body:r,successfulResponseHandler:n,failedResponseHandler:o,abortSignal:s,fetch:a=bd()}){try{let u=yield a(e,{method:"POST",headers:fd(t),body:r.content,signal:s}),p=kn(u);if(!u.ok){let h;try{h=yield o({response:u,url:e,requestBodyValues:r.values});}catch(m){throw Tn(m)||Xe.isInstance(m)?m:new Xe({message:"Failed to process error response",cause:m,statusCode:u.status,url:e,responseHeaders:p,requestBodyValues:r.values})}throw h.value}try{return yield n({response:u,url:e,requestBodyValues:r.values})}catch(h){throw h instanceof Error&&(Tn(h)||Xe.isInstance(h))?h:new Xe({message:"Failed to process successful response",cause:h,statusCode:u.status,url:e,responseHeaders:p,requestBodyValues:r.values})}}catch(u){if(Tn(u))throw u;if(u instanceof TypeError&&u.message==="fetch failed"){let p=u.cause;if(p!=null)throw new Xe({message:`Cannot connect to API: ${p.message}`,cause:p,url:e,requestBodyValues:r.values,isRetryable:true})}throw u}});var wi=({errorSchema:e,errorToMessage:t,isRetryable:r})=>a=>E(null,[a],function*({response:n,url:o,requestBodyValues:s}){let i=yield n.text(),u=kn(n);if(i.trim()==="")return {responseHeaders:u,value:new Xe({message:n.statusText,url:o,requestBodyValues:s,statusCode:n.status,responseHeaders:u,responseBody:i,isRetryable:r==null?void 0:r(n)})};try{let p=_d({text:i,schema:e});return {responseHeaders:u,value:new Xe({message:t(p),url:o,requestBodyValues:s,statusCode:n.status,responseHeaders:u,responseBody:i,data:p,isRetryable:r==null?void 0:r(n,p)})}}catch(p){return {responseHeaders:u,value:new Xe({message:n.statusText,url:o,requestBodyValues:s,statusCode:n.status,responseHeaders:u,responseBody:i,isRetryable:r==null?void 0:r(n)})}}}),Jr=e=>r=>E(null,[r],function*({response:t}){let n=kn(t);if(t.body==null)throw new Fa({});return {responseHeaders:n,value:t.body.pipeThrough(new TextDecoderStream).pipeThrough(cd()).pipeThrough(new TransformStream({transform({data:o},s){o!=="[DONE]"&&s.enqueue(wt({text:o,schema:e}));}}))}});var ht=e=>o=>E(null,[o],function*({response:t,url:r,requestBodyValues:n}){let s=yield t.text(),a=wt({text:s,schema:e}),i=kn(t);if(!a.success)throw new Xe({message:"Invalid JSON response",cause:a.error,statusCode:t.status,responseHeaders:i,responseBody:s,url:r,requestBodyValues:n});return {responseHeaders:i,value:a.value,rawValue:a.rawValue}}),xi=()=>n=>E(null,[n],function*({response:e,url:t,requestBodyValues:r}){let o=kn(e);if(!e.body)throw new Xe({message:"Response body is empty",url:t,requestBodyValues:r,statusCode:e.status,responseHeaders:o,responseBody:void 0});try{let s=yield e.arrayBuffer();return {responseHeaders:o,value:new Uint8Array(s)}}catch(s){throw new Xe({message:"Failed to read response as array buffer",url:t,requestBodyValues:r,statusCode:e.status,responseHeaders:o,responseBody:void 0,cause:s})}});var{btoa:wd,atob:xd}=globalThis;function nr(e){let t=e.replace(/-/g,"+").replace(/_/g,"/"),r=xd(t);return Uint8Array.from(r,n=>n.codePointAt(0))}function Vt(e){let t="";for(let r=0;r<e.length;r++)t+=String.fromCodePoint(e[r]);return wd(t)}function Si(e){return e==null?void 0:e.replace(/\/$/,"")}var Ii=Symbol("Let zodToJsonSchema decide on which parser to use");var Ti={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:true,rejectedAdditionalProperties:false,definitionPath:"definitions",target:"jsonSchema7",strictUnions:false,definitions:{},errorMessages:false,markdownDescription:false,patternStrategy:"escape",applyRegexFlags:false,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},ki=e=>typeof e=="string"?g(d({},Ti),{name:e}):d(d({},Ti),e);var Ai=e=>{let t=ki(e),r=t.name!==void 0?[...t.basePath,t.definitionPath,t.name]:t.basePath;return g(d({},t),{currentPath:r,propertyPath:void 0,seen:new Map(Object.entries(t.definitions).map(([n,o])=>[o._def,{def:o._def,path:[...t.basePath,t.definitionPath,n],jsonSchema:void 0}]))})};function gs(e,t,r,n){n!=null&&n.errorMessages&&r&&(e.errorMessage=g(d({},e.errorMessage),{[t]:r}));}function se(e,t,r,n,o){e[t]=r,gs(e,t,n,o);}function Ei(){return {}}function Ri(e,t){var n,o,s;let r={type:"array"};return (n=e.type)!=null&&n._def&&((s=(o=e.type)==null?void 0:o._def)==null?void 0:s.typeName)!==k.ZodAny&&(r.items=W(e.type._def,g(d({},t),{currentPath:[...t.currentPath,"items"]}))),e.minLength&&se(r,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&se(r,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&(se(r,"minItems",e.exactLength.value,e.exactLength.message,t),se(r,"maxItems",e.exactLength.value,e.exactLength.message,t)),r}function Ci(e,t){let r={type:"integer",format:"int64"};if(!e.checks)return r;for(let n of e.checks)switch(n.kind){case "min":t.target==="jsonSchema7"?n.inclusive?se(r,"minimum",n.value,n.message,t):se(r,"exclusiveMinimum",n.value,n.message,t):(n.inclusive||(r.exclusiveMinimum=true),se(r,"minimum",n.value,n.message,t));break;case "max":t.target==="jsonSchema7"?n.inclusive?se(r,"maximum",n.value,n.message,t):se(r,"exclusiveMaximum",n.value,n.message,t):(n.inclusive||(r.exclusiveMaximum=true),se(r,"maximum",n.value,n.message,t));break;case "multipleOf":se(r,"multipleOf",n.value,n.message,t);break}return r}function ji(){return {type:"boolean"}}function xo(e,t){return W(e.type._def,t)}var Oi=(e,t)=>W(e.innerType._def,t);function ys(e,t,r){let n=r!=null?r:t.dateStrategy;if(Array.isArray(n))return {anyOf:n.map((o,s)=>ys(e,t,o))};switch(n){case "string":case "format:date-time":return {type:"string",format:"date-time"};case "format:date":return {type:"string",format:"date"};case "integer":return Sd(e,t)}}var Sd=(e,t)=>{let r={type:"integer",format:"unix-time"};if(t.target==="openApi3")return r;for(let n of e.checks)switch(n.kind){case "min":se(r,"minimum",n.value,n.message,t);break;case "max":se(r,"maximum",n.value,n.message,t);break}return r};function Pi(e,t){return g(d({},W(e.innerType._def,t)),{default:e.defaultValue()})}function Mi(e,t){return t.effectStrategy==="input"?W(e.schema._def,t):{}}function Ni(e){return {type:"string",enum:Array.from(e.values)}}var Td=e=>"type"in e&&e.type==="string"?false:"allOf"in e;function Di(e,t){let r=[W(e.left._def,g(d({},t),{currentPath:[...t.currentPath,"allOf","0"]})),W(e.right._def,g(d({},t),{currentPath:[...t.currentPath,"allOf","1"]}))].filter(s=>!!s),n=t.target==="jsonSchema2019-09"?{unevaluatedProperties:false}:void 0,o=[];return r.forEach(s=>{if(Td(s))o.push(...s.allOf),s.unevaluatedProperties===void 0&&(n=void 0);else {let i=s;if("additionalProperties"in s&&s.additionalProperties===false){let a=s,{additionalProperties:u}=a;i=Ge(a,["additionalProperties"]);}else n=void 0;o.push(i);}}),o.length?d({allOf:o},n):void 0}function Fi(e,t){let r=typeof e.value;return r!=="bigint"&&r!=="number"&&r!=="boolean"&&r!=="string"?{type:Array.isArray(e.value)?"array":"object"}:t.target==="openApi3"?{type:r==="bigint"?"integer":r,enum:[e.value]}:{type:r==="bigint"?"integer":r,const:e.value}}var vs,xt={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(vs===void 0&&(vs=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),vs),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function So(e,t){let r={type:"string"};if(e.checks)for(let n of e.checks)switch(n.kind){case "min":se(r,"minLength",typeof r.minLength=="number"?Math.max(r.minLength,n.value):n.value,n.message,t);break;case "max":se(r,"maxLength",typeof r.maxLength=="number"?Math.min(r.maxLength,n.value):n.value,n.message,t);break;case "email":switch(t.emailStrategy){case "format:email":St(r,"email",n.message,t);break;case "format:idn-email":St(r,"idn-email",n.message,t);break;case "pattern:zod":et(r,xt.email,n.message,t);break}break;case "url":St(r,"uri",n.message,t);break;case "uuid":St(r,"uuid",n.message,t);break;case "regex":et(r,n.regex,n.message,t);break;case "cuid":et(r,xt.cuid,n.message,t);break;case "cuid2":et(r,xt.cuid2,n.message,t);break;case "startsWith":et(r,RegExp(`^${_s(n.value,t)}`),n.message,t);break;case "endsWith":et(r,RegExp(`${_s(n.value,t)}$`),n.message,t);break;case "datetime":St(r,"date-time",n.message,t);break;case "date":St(r,"date",n.message,t);break;case "time":St(r,"time",n.message,t);break;case "duration":St(r,"duration",n.message,t);break;case "length":se(r,"minLength",typeof r.minLength=="number"?Math.max(r.minLength,n.value):n.value,n.message,t),se(r,"maxLength",typeof r.maxLength=="number"?Math.min(r.maxLength,n.value):n.value,n.message,t);break;case "includes":{et(r,RegExp(_s(n.value,t)),n.message,t);break}case "ip":{n.version!=="v6"&&St(r,"ipv4",n.message,t),n.version!=="v4"&&St(r,"ipv6",n.message,t);break}case "base64url":et(r,xt.base64url,n.message,t);break;case "jwt":et(r,xt.jwt,n.message,t);break;case "cidr":{n.version!=="v6"&&et(r,xt.ipv4Cidr,n.message,t),n.version!=="v4"&&et(r,xt.ipv6Cidr,n.message,t);break}case "emoji":et(r,xt.emoji(),n.message,t);break;case "ulid":{et(r,xt.ulid,n.message,t);break}case "base64":{switch(t.base64Strategy){case "format:binary":{St(r,"binary",n.message,t);break}case "contentEncoding:base64":{se(r,"contentEncoding","base64",n.message,t);break}case "pattern:zod":{et(r,xt.base64,n.message,t);break}}break}case "nanoid":et(r,xt.nanoid,n.message,t);}return r}function _s(e,t){return t.patternStrategy==="escape"?kd(e):e}var Id=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function kd(e){let t="";for(let r=0;r<e.length;r++)Id.has(e[r])||(t+="\\"),t+=e[r];return t}function St(e,t,r,n){var o;e.format||(o=e.anyOf)!=null&&o.some(s=>s.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push(d({format:e.format},e.errorMessage&&n.errorMessages&&{errorMessage:{format:e.errorMessage.format}})),delete e.format,e.errorMessage&&(delete e.errorMessage.format,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.anyOf.push(d({format:t},r&&n.errorMessages&&{errorMessage:{format:r}}))):se(e,"format",t,r,n);}function et(e,t,r,n){var o;e.pattern||(o=e.allOf)!=null&&o.some(s=>s.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push(d({pattern:e.pattern},e.errorMessage&&n.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}})),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.allOf.push(d({pattern:Ui(t,n)},r&&n.errorMessages&&{errorMessage:{pattern:r}}))):se(e,"pattern",Ui(t,n),r,n);}function Ui(e,t){var u;if(!t.applyRegexFlags||!e.flags)return e.source;let r={i:e.flags.includes("i"),m:e.flags.includes("m"),s:e.flags.includes("s")},n=r.i?e.source.toLowerCase():e.source,o="",s=false,a=false,i=false;for(let p=0;p<n.length;p++){if(s){o+=n[p],s=false;continue}if(r.i){if(a){if(n[p].match(/[a-z]/)){i?(o+=n[p],o+=`${n[p-2]}-${n[p]}`.toUpperCase(),i=false):n[p+1]==="-"&&((u=n[p+2])!=null&&u.match(/[a-z]/))?(o+=n[p],i=true):o+=`${n[p]}${n[p].toUpperCase()}`;continue}}else if(n[p].match(/[a-z]/)){o+=`[${n[p]}${n[p].toUpperCase()}]`;continue}}if(r.m){if(n[p]==="^"){o+=`(^|(?<=[\r
]))`;continue}else if(n[p]==="$"){o+=`($|(?=[\r
]))`;continue}}if(r.s&&n[p]==="."){o+=a?`${n[p]}\r
`:`[${n[p]}\r
]`;continue}o+=n[p],n[p]==="\\"?s=true:a&&n[p]==="]"?a=false:!a&&n[p]==="["&&(a=true);}try{new RegExp(o);}catch(p){return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),e.source}return o}function To(e,t){var n,o,s,a,u,p,h;if(t.target==="openAi"&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),t.target==="openApi3"&&((n=e.keyType)==null?void 0:n._def.typeName)===k.ZodEnum)return {type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((_,S)=>{var A;return g(d({},_),{[S]:(A=W(e.valueType._def,g(d({},t),{currentPath:[...t.currentPath,"properties",S]})))!=null?A:{}})},{}),additionalProperties:t.rejectedAdditionalProperties};let r={type:"object",additionalProperties:(o=W(e.valueType._def,g(d({},t),{currentPath:[...t.currentPath,"additionalProperties"]})))!=null?o:t.allowedAdditionalProperties};if(t.target==="openApi3")return r;if(((s=e.keyType)==null?void 0:s._def.typeName)===k.ZodString&&((a=e.keyType._def.checks)!=null&&a.length)){let i=So(e.keyType._def,t),{type:_}=i,S=Ge(i,["type"]);return g(d({},r),{propertyNames:S})}else {if(((u=e.keyType)==null?void 0:u._def.typeName)===k.ZodEnum)return g(d({},r),{propertyNames:{enum:e.keyType._def.values}});if(((p=e.keyType)==null?void 0:p._def.typeName)===k.ZodBranded&&e.keyType._def.type._def.typeName===k.ZodString&&((h=e.keyType._def.type._def.checks)!=null&&h.length)){let m=xo(e.keyType._def,t),{type:_}=m,S=Ge(m,["type"]);return g(d({},r),{propertyNames:S})}}return r}function $i(e,t){if(t.mapStrategy==="record")return To(e,t);let r=W(e.keyType._def,g(d({},t),{currentPath:[...t.currentPath,"items","items","0"]}))||{},n=W(e.valueType._def,g(d({},t),{currentPath:[...t.currentPath,"items","items","1"]}))||{};return {type:"array",maxItems:125,items:{type:"array",items:[r,n],minItems:2,maxItems:2}}}function qi(e){let t=e.values,n=Object.keys(e.values).filter(s=>typeof t[t[s]]!="number").map(s=>t[s]),o=Array.from(new Set(n.map(s=>typeof s)));return {type:o.length===1?o[0]==="string"?"string":"number":["string","number"],enum:n}}function Bi(){return {not:{}}}function zi(e){return e.target==="openApi3"?{enum:["null"],nullable:true}:{type:"null"}}var An={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function Vi(e,t){if(t.target==="openApi3")return Li(e,t);let r=e.options instanceof Map?Array.from(e.options.values()):e.options;if(r.every(n=>n._def.typeName in An&&(!n._def.checks||!n._def.checks.length))){let n=r.reduce((o,s)=>{let a=An[s._def.typeName];return a&&!o.includes(a)?[...o,a]:o},[]);return {type:n.length>1?n:n[0]}}else if(r.every(n=>n._def.typeName==="ZodLiteral"&&!n.description)){let n=r.reduce((o,s)=>{let a=typeof s._def.value;switch(a){case "string":case "number":case "boolean":return [...o,a];case "bigint":return [...o,"integer"];case "object":if(s._def.value===null)return [...o,"null"];case "symbol":case "undefined":case "function":default:return o}},[]);if(n.length===r.length){let o=n.filter((s,a,i)=>i.indexOf(s)===a);return {type:o.length>1?o:o[0],enum:r.reduce((s,a)=>s.includes(a._def.value)?s:[...s,a._def.value],[])}}}else if(r.every(n=>n._def.typeName==="ZodEnum"))return {type:"string",enum:r.reduce((n,o)=>[...n,...o._def.values.filter(s=>!n.includes(s))],[])};return Li(e,t)}var Li=(e,t)=>{let r=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((n,o)=>W(n._def,g(d({},t),{currentPath:[...t.currentPath,"anyOf",`${o}`]}))).filter(n=>!!n&&(!t.strictUnions||typeof n=="object"&&Object.keys(n).length>0));return r.length?{anyOf:r}:void 0};function Zi(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return t.target==="openApi3"?{type:An[e.innerType._def.typeName],nullable:true}:{type:[An[e.innerType._def.typeName],"null"]};if(t.target==="openApi3"){let n=W(e.innerType._def,g(d({},t),{currentPath:[...t.currentPath]}));return n&&"$ref"in n?{allOf:[n],nullable:true}:n&&g(d({},n),{nullable:true})}let r=W(e.innerType._def,g(d({},t),{currentPath:[...t.currentPath,"anyOf","0"]}));return r&&{anyOf:[r,{type:"null"}]}}function Ji(e,t){let r={type:"number"};if(!e.checks)return r;for(let n of e.checks)switch(n.kind){case "int":r.type="integer",gs(r,"type",n.message,t);break;case "min":t.target==="jsonSchema7"?n.inclusive?se(r,"minimum",n.value,n.message,t):se(r,"exclusiveMinimum",n.value,n.message,t):(n.inclusive||(r.exclusiveMinimum=true),se(r,"minimum",n.value,n.message,t));break;case "max":t.target==="jsonSchema7"?n.inclusive?se(r,"maximum",n.value,n.message,t):se(r,"exclusiveMaximum",n.value,n.message,t):(n.inclusive||(r.exclusiveMaximum=true),se(r,"maximum",n.value,n.message,t));break;case "multipleOf":se(r,"multipleOf",n.value,n.message,t);break}return r}function Wi(e,t){let r=t.target==="openAi",n={type:"object",properties:{}},o=[],s=e.shape();for(let i in s){let u=s[i];if(u===void 0||u._def===void 0)continue;let p=Ed(u);p&&r&&(u instanceof nt&&(u=u._def.innerType),u.isNullable()||(u=u.nullable()),p=false);let h=W(u._def,g(d({},t),{currentPath:[...t.currentPath,"properties",i],propertyPath:[...t.currentPath,"properties",i]}));h!==void 0&&(n.properties[i]=h,p||o.push(i));}o.length&&(n.required=o);let a=Ad(e,t);return a!==void 0&&(n.additionalProperties=a),n}function Ad(e,t){if(e.catchall._def.typeName!=="ZodNever")return W(e.catchall._def,g(d({},t),{currentPath:[...t.currentPath,"additionalProperties"]}));switch(e.unknownKeys){case "passthrough":return t.allowedAdditionalProperties;case "strict":return t.rejectedAdditionalProperties;case "strip":return t.removeAdditionalStrategy==="strict"?t.allowedAdditionalProperties:t.rejectedAdditionalProperties}}function Ed(e){try{return e.isOptional()}catch(t){return  true}}var Gi=(e,t)=>{var n;if(t.currentPath.toString()===((n=t.propertyPath)==null?void 0:n.toString()))return W(e.innerType._def,t);let r=W(e.innerType._def,g(d({},t),{currentPath:[...t.currentPath,"anyOf","1"]}));return r?{anyOf:[{not:{}},r]}:{}};var Hi=(e,t)=>{if(t.pipeStrategy==="input")return W(e.in._def,t);if(t.pipeStrategy==="output")return W(e.out._def,t);let r=W(e.in._def,g(d({},t),{currentPath:[...t.currentPath,"allOf","0"]})),n=W(e.out._def,g(d({},t),{currentPath:[...t.currentPath,"allOf",r?"1":"0"]}));return {allOf:[r,n].filter(o=>o!==void 0)}};function Ki(e,t){return W(e.type._def,t)}function Yi(e,t){let n={type:"array",uniqueItems:true,items:W(e.valueType._def,g(d({},t),{currentPath:[...t.currentPath,"items"]}))};return e.minSize&&se(n,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&se(n,"maxItems",e.maxSize.value,e.maxSize.message,t),n}function Xi(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((r,n)=>W(r._def,g(d({},t),{currentPath:[...t.currentPath,"items",`${n}`]}))).reduce((r,n)=>n===void 0?r:[...r,n],[]),additionalItems:W(e.rest._def,g(d({},t),{currentPath:[...t.currentPath,"additionalItems"]}))}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((r,n)=>W(r._def,g(d({},t),{currentPath:[...t.currentPath,"items",`${n}`]}))).reduce((r,n)=>n===void 0?r:[...r,n],[])}}function Qi(){return {not:{}}}function el(){return {}}var tl=(e,t)=>W(e.innerType._def,t);var rl=(e,t,r)=>{switch(t){case k.ZodString:return So(e,r);case k.ZodNumber:return Ji(e,r);case k.ZodObject:return Wi(e,r);case k.ZodBigInt:return Ci(e,r);case k.ZodBoolean:return ji();case k.ZodDate:return ys(e,r);case k.ZodUndefined:return Qi();case k.ZodNull:return zi(r);case k.ZodArray:return Ri(e,r);case k.ZodUnion:case k.ZodDiscriminatedUnion:return Vi(e,r);case k.ZodIntersection:return Di(e,r);case k.ZodTuple:return Xi(e,r);case k.ZodRecord:return To(e,r);case k.ZodLiteral:return Fi(e,r);case k.ZodEnum:return Ni(e);case k.ZodNativeEnum:return qi(e);case k.ZodNullable:return Zi(e,r);case k.ZodOptional:return Gi(e,r);case k.ZodMap:return $i(e,r);case k.ZodSet:return Yi(e,r);case k.ZodLazy:return ()=>e.getter()._def;case k.ZodPromise:return Ki(e,r);case k.ZodNaN:case k.ZodNever:return Bi();case k.ZodEffects:return Mi(e,r);case k.ZodAny:return Ei();case k.ZodUnknown:return el();case k.ZodDefault:return Pi(e,r);case k.ZodBranded:return xo(e,r);case k.ZodReadonly:return tl(e,r);case k.ZodCatch:return Oi(e,r);case k.ZodPipeline:return Hi(e,r);case k.ZodFunction:case k.ZodVoid:case k.ZodSymbol:return;default:return (n=>{})()}};function W(e,t,r=false){var i;let n=t.seen.get(e);if(t.override){let u=(i=t.override)==null?void 0:i.call(t,e,t,n,r);if(u!==Ii)return u}if(n&&!r){let u=Rd(n,t);if(u!==void 0)return u}let o={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,o);let s=rl(e,e.typeName,t),a=typeof s=="function"?W(s(),t):s;if(a&&jd(e,t,a),t.postProcess){let u=t.postProcess(a,e,t);return o.jsonSchema=a,u}return o.jsonSchema=a,a}var Rd=(e,t)=>{switch(t.$refStrategy){case "root":return {$ref:e.path.join("/")};case "relative":return {$ref:Cd(t.currentPath,e.path)};case "none":case "seen":return e.path.length<t.currentPath.length&&e.path.every((r,n)=>t.currentPath[n]===r)?(console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{}):t.$refStrategy==="seen"?{}:void 0}},Cd=(e,t)=>{let r=0;for(;r<e.length&&r<t.length&&e[r]===t[r];r++);return [(e.length-r).toString(),...t.slice(r)].join("/")},jd=(e,t,r)=>(e.description&&(r.description=e.description,t.markdownDescription&&(r.markdownDescription=e.description)),r);var nl=(e,t)=>{var u;let r=Ai(t),n=typeof t=="object"&&t.definitions?Object.entries(t.definitions).reduce((p,[h,m])=>{var _;return g(d({},p),{[h]:(_=W(m._def,g(d({},r),{currentPath:[...r.basePath,r.definitionPath,h]}),true))!=null?_:{}})},{}):void 0,o=typeof t=="string"?t:(t==null?void 0:t.nameStrategy)==="title"||t==null?void 0:t.name,s=(u=W(e._def,o===void 0?r:g(d({},r),{currentPath:[...r.basePath,r.definitionPath,o]}),false))!=null?u:{},a=typeof t=="object"&&t.name!==void 0&&t.nameStrategy==="title"?t.name:void 0;a!==void 0&&(s.title=a);let i=o===void 0?n?g(d({},s),{[r.definitionPath]:n}):s:{$ref:[...r.$refStrategy==="relative"?[]:r.basePath,r.definitionPath,o].join("/"),[r.definitionPath]:g(d({},n),{[o]:s})};return r.target==="jsonSchema7"?i.$schema="http://json-schema.org/draft-07/schema#":(r.target==="jsonSchema2019-09"||r.target==="openAi")&&(i.$schema="https://json-schema.org/draft/2019-09/schema#"),r.target==="openAi"&&("anyOf"in i||"oneOf"in i||"allOf"in i||"type"in i&&Array.isArray(i.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),i};var ol=nl;var En={code:"0",name:"text",parse:e=>{if(typeof e!="string")throw new Error('"text" parts expect a string value.');return {type:"text",value:e}}},Rn={code:"3",name:"error",parse:e=>{if(typeof e!="string")throw new Error('"error" parts expect a string value.');return {type:"error",value:e}}},Cn={code:"4",name:"assistant_message",parse:e=>{if(e==null||typeof e!="object"||!("id"in e)||!("role"in e)||!("content"in e)||typeof e.id!="string"||typeof e.role!="string"||e.role!=="assistant"||!Array.isArray(e.content)||!e.content.every(t=>t!=null&&typeof t=="object"&&"type"in t&&t.type==="text"&&"text"in t&&t.text!=null&&typeof t.text=="object"&&"value"in t.text&&typeof t.text.value=="string"))throw new Error('"assistant_message" parts expect an object with an "id", "role", and "content" property.');return {type:"assistant_message",value:e}}},jn={code:"5",name:"assistant_control_data",parse:e=>{if(e==null||typeof e!="object"||!("threadId"in e)||!("messageId"in e)||typeof e.threadId!="string"||typeof e.messageId!="string")throw new Error('"assistant_control_data" parts expect an object with a "threadId" and "messageId" property.');return {type:"assistant_control_data",value:{threadId:e.threadId,messageId:e.messageId}}}},On={code:"6",name:"data_message",parse:e=>{if(e==null||typeof e!="object"||!("role"in e)||!("data"in e)||typeof e.role!="string"||e.role!=="data")throw new Error('"data_message" parts expect an object with a "role" and "data" property.');return {type:"data_message",value:e}}},Od=[En,Rn,Cn,jn,On];({[En.code]:En,[Rn.code]:Rn,[Cn.code]:Cn,[jn.code]:jn,[On.code]:On});({[En.name]:En.code,[Rn.name]:Rn.code,[Cn.name]:Cn.code,[jn.name]:jn.code,[On.name]:On.code});Od.map(e=>e.code);function Pd(e){let t=["ROOT"],r=-1,n=null;function o(u,p,h){switch(u){case '"':{r=p,t.pop(),t.push(h),t.push("INSIDE_STRING");break}case "f":case "t":case "n":{r=p,n=p,t.pop(),t.push(h),t.push("INSIDE_LITERAL");break}case "-":{t.pop(),t.push(h),t.push("INSIDE_NUMBER");break}case "0":case "1":case "2":case "3":case "4":case "5":case "6":case "7":case "8":case "9":{r=p,t.pop(),t.push(h),t.push("INSIDE_NUMBER");break}case "{":{r=p,t.pop(),t.push(h),t.push("INSIDE_OBJECT_START");break}case "[":{r=p,t.pop(),t.push(h),t.push("INSIDE_ARRAY_START");break}}}function s(u,p){switch(u){case ",":{t.pop(),t.push("INSIDE_OBJECT_AFTER_COMMA");break}case "}":{r=p,t.pop();break}}}function a(u,p){switch(u){case ",":{t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break}case "]":{r=p,t.pop();break}}}for(let u=0;u<e.length;u++){let p=e[u];switch(t[t.length-1]){case "ROOT":o(p,u,"FINISH");break;case "INSIDE_OBJECT_START":{switch(p){case '"':{t.pop(),t.push("INSIDE_OBJECT_KEY");break}case "}":{r=u,t.pop();break}}break}case "INSIDE_OBJECT_AFTER_COMMA":{switch(p){case '"':{t.pop(),t.push("INSIDE_OBJECT_KEY");break}}break}case "INSIDE_OBJECT_KEY":{switch(p){case '"':{t.pop(),t.push("INSIDE_OBJECT_AFTER_KEY");break}}break}case "INSIDE_OBJECT_AFTER_KEY":{switch(p){case ":":{t.pop(),t.push("INSIDE_OBJECT_BEFORE_VALUE");break}}break}case "INSIDE_OBJECT_BEFORE_VALUE":{o(p,u,"INSIDE_OBJECT_AFTER_VALUE");break}case "INSIDE_OBJECT_AFTER_VALUE":{s(p,u);break}case "INSIDE_STRING":{switch(p){case '"':{t.pop(),r=u;break}case "\\":{t.push("INSIDE_STRING_ESCAPE");break}default:r=u;}break}case "INSIDE_ARRAY_START":{switch(p){case "]":{r=u,t.pop();break}default:{r=u,o(p,u,"INSIDE_ARRAY_AFTER_VALUE");break}}break}case "INSIDE_ARRAY_AFTER_VALUE":{switch(p){case ",":{t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break}case "]":{r=u,t.pop();break}default:{r=u;break}}break}case "INSIDE_ARRAY_AFTER_COMMA":{o(p,u,"INSIDE_ARRAY_AFTER_VALUE");break}case "INSIDE_STRING_ESCAPE":{t.pop(),r=u;break}case "INSIDE_NUMBER":{switch(p){case "0":case "1":case "2":case "3":case "4":case "5":case "6":case "7":case "8":case "9":{r=u;break}case "e":case "E":case "-":case ".":break;case ",":{t.pop(),t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&a(p,u),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"&&s(p,u);break}case "}":{t.pop(),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"&&s(p,u);break}case "]":{t.pop(),t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&a(p,u);break}default:{t.pop();break}}break}case "INSIDE_LITERAL":{let m=e.substring(n,u+1);!"false".startsWith(m)&&!"true".startsWith(m)&&!"null".startsWith(m)?(t.pop(),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"?s(p,u):t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&a(p,u)):r=u;break}}}let i=e.slice(0,r+1);for(let u=t.length-1;u>=0;u--)switch(t[u]){case "INSIDE_STRING":{i+='"';break}case "INSIDE_OBJECT_KEY":case "INSIDE_OBJECT_AFTER_KEY":case "INSIDE_OBJECT_AFTER_COMMA":case "INSIDE_OBJECT_START":case "INSIDE_OBJECT_BEFORE_VALUE":case "INSIDE_OBJECT_AFTER_VALUE":{i+="}";break}case "INSIDE_ARRAY_START":case "INSIDE_ARRAY_AFTER_COMMA":case "INSIDE_ARRAY_AFTER_VALUE":{i+="]";break}case "INSIDE_LITERAL":{let h=e.substring(n,e.length);"true".startsWith(h)?i+="true".slice(h.length):"false".startsWith(h)?i+="false".slice(h.length):"null".startsWith(h)&&(i+="null".slice(h.length));}}return i}function Io(e){if(e===void 0)return {value:void 0,state:"undefined-input"};let t=wt({text:e});return t.success?{value:t.value,state:"successful-parse"}:(t=wt({text:Pd(e)}),t.success?{value:t.value,state:"repaired-parse"}:{value:void 0,state:"failed-parse"})}var Md={code:"0",name:"text",parse:e=>{if(typeof e!="string")throw new Error('"text" parts expect a string value.');return {type:"text",value:e}}},Nd={code:"2",name:"data",parse:e=>{if(!Array.isArray(e))throw new Error('"data" parts expect an array value.');return {type:"data",value:e}}},Dd={code:"3",name:"error",parse:e=>{if(typeof e!="string")throw new Error('"error" parts expect a string value.');return {type:"error",value:e}}},Fd={code:"8",name:"message_annotations",parse:e=>{if(!Array.isArray(e))throw new Error('"message_annotations" parts expect an array value.');return {type:"message_annotations",value:e}}},Ud={code:"9",name:"tool_call",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("toolName"in e)||typeof e.toolName!="string"||!("args"in e)||typeof e.args!="object")throw new Error('"tool_call" parts expect an object with a "toolCallId", "toolName", and "args" property.');return {type:"tool_call",value:e}}},$d={code:"a",name:"tool_result",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("result"in e))throw new Error('"tool_result" parts expect an object with a "toolCallId" and a "result" property.');return {type:"tool_result",value:e}}},qd={code:"b",name:"tool_call_streaming_start",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("toolName"in e)||typeof e.toolName!="string")throw new Error('"tool_call_streaming_start" parts expect an object with a "toolCallId" and "toolName" property.');return {type:"tool_call_streaming_start",value:e}}},Bd={code:"c",name:"tool_call_delta",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("argsTextDelta"in e)||typeof e.argsTextDelta!="string")throw new Error('"tool_call_delta" parts expect an object with a "toolCallId" and "argsTextDelta" property.');return {type:"tool_call_delta",value:e}}},zd={code:"d",name:"finish_message",parse:e=>{if(e==null||typeof e!="object"||!("finishReason"in e)||typeof e.finishReason!="string")throw new Error('"finish_message" parts expect an object with a "finishReason" property.');let t={finishReason:e.finishReason};return "usage"in e&&e.usage!=null&&typeof e.usage=="object"&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:typeof e.usage.promptTokens=="number"?e.usage.promptTokens:Number.NaN,completionTokens:typeof e.usage.completionTokens=="number"?e.usage.completionTokens:Number.NaN}),{type:"finish_message",value:t}}},Ld={code:"e",name:"finish_step",parse:e=>{if(e==null||typeof e!="object"||!("finishReason"in e)||typeof e.finishReason!="string")throw new Error('"finish_step" parts expect an object with a "finishReason" property.');let t={finishReason:e.finishReason,isContinued:false};return "usage"in e&&e.usage!=null&&typeof e.usage=="object"&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:typeof e.usage.promptTokens=="number"?e.usage.promptTokens:Number.NaN,completionTokens:typeof e.usage.completionTokens=="number"?e.usage.completionTokens:Number.NaN}),"isContinued"in e&&typeof e.isContinued=="boolean"&&(t.isContinued=e.isContinued),{type:"finish_step",value:t}}},Vd={code:"f",name:"start_step",parse:e=>{if(e==null||typeof e!="object"||!("messageId"in e)||typeof e.messageId!="string")throw new Error('"start_step" parts expect an object with an "id" property.');return {type:"start_step",value:{messageId:e.messageId}}}},Zd={code:"g",name:"reasoning",parse:e=>{if(typeof e!="string")throw new Error('"reasoning" parts expect a string value.');return {type:"reasoning",value:e}}},Jd={code:"h",name:"source",parse:e=>{if(e==null||typeof e!="object")throw new Error('"source" parts expect a Source object.');return {type:"source",value:e}}},Wd={code:"i",name:"redacted_reasoning",parse:e=>{if(e==null||typeof e!="object"||!("data"in e)||typeof e.data!="string")throw new Error('"redacted_reasoning" parts expect an object with a "data" property.');return {type:"redacted_reasoning",value:{data:e.data}}}},Gd={code:"j",name:"reasoning_signature",parse:e=>{if(e==null||typeof e!="object"||!("signature"in e)||typeof e.signature!="string")throw new Error('"reasoning_signature" parts expect an object with a "signature" property.');return {type:"reasoning_signature",value:{signature:e.signature}}}},Hd={code:"k",name:"file",parse:e=>{if(e==null||typeof e!="object"||!("data"in e)||typeof e.data!="string"||!("mimeType"in e)||typeof e.mimeType!="string")throw new Error('"file" parts expect an object with a "data" and "mimeType" property.');return {type:"file",value:e}}},ko=[Md,Nd,Dd,Fd,Ud,$d,qd,Bd,zd,Ld,Vd,Zd,Jd,Wd,Gd,Hd];Object.fromEntries(ko.map(e=>[e.code,e]));Object.fromEntries(ko.map(e=>[e.name,e.code]));ko.map(e=>e.code);function $e(e,t){let r=ko.find(n=>n.name===e);if(!r)throw new Error(`Invalid stream part type: ${e}`);return `${r.code}:${JSON.stringify(t)}
`}function Pn(e,t){if(e===t)return  true;if(e==null||t==null)return  false;if(typeof e!="object"&&typeof t!="object")return e===t;if(e.constructor!==t.constructor)return  false;if(e instanceof Date&&t instanceof Date)return e.getTime()===t.getTime();if(Array.isArray(e)){if(e.length!==t.length)return  false;for(let o=0;o<e.length;o++)if(!Pn(e[o],t[o]))return  false;return  true}let r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return  false;for(let o of r)if(!n.includes(o)||!Pn(e[o],t[o]))return  false;return  true}function Kd(e,t){var r;let n=(r=void 0)!=null?r:false;return Yd(ol(e,{$refStrategy:n?"root":"none",target:"jsonSchema7"}),{validate:o=>{let s=e.safeParse(o);return s.success?{success:true,value:s.data}:{success:false,error:s.error}}})}var bs=Symbol.for("vercel.ai.schema");function Yd(e,{validate:t}={}){return {[bs]:true,_type:void 0,[In]:true,jsonSchema:e,validate:t}}function Xd(e){return typeof e=="object"&&e!==null&&bs in e&&e[bs]===true&&"jsonSchema"in e&&"validate"in e}function Mt(e){return Xd(e)?e:Kd(e)}var sl=typeof globalThis=="object"?globalThis:typeof self=="object"?self:typeof window=="object"?window:typeof global=="object"?global:{};var Zt="1.9.0";var al=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/;function Qd(e){var t=new Set([e]),r=new Set,n=e.match(al);if(!n)return function(){return  false};var o={major:+n[1],minor:+n[2],patch:+n[3],prerelease:n[4]};if(o.prerelease!=null)return function(u){return u===e};function s(i){return r.add(i),false}function a(i){return t.add(i),true}return function(u){if(t.has(u))return  true;if(r.has(u))return  false;var p=u.match(al);if(!p)return s(u);var h={major:+p[1],minor:+p[2],patch:+p[3],prerelease:p[4]};return h.prerelease!=null||o.major!==h.major?s(u):o.major===0?o.minor===h.minor&&o.patch<=h.patch?a(u):s(u):o.minor<=h.minor?a(u):s(u)}}var il=Qd(Zt);var ef=Zt.split(".")[0],Mn=Symbol.for("opentelemetry.js.api."+ef),Nn=sl;function Wr(e,t,r,n){var o;n===void 0&&(n=false);var s=Nn[Mn]=(o=Nn[Mn])!==null&&o!==void 0?o:{version:Zt};if(!n&&s[e]){var a=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+e);return r.error(a.stack||a.message),false}if(s.version!==Zt){var a=new Error("@opentelemetry/api: Registration of version v"+s.version+" for "+e+" does not match previously registered API v"+Zt);return r.error(a.stack||a.message),false}return s[e]=t,r.debug("@opentelemetry/api: Registered a global for "+e+" v"+Zt+"."),true}function Jt(e){var t,r,n=(t=Nn[Mn])===null||t===void 0?void 0:t.version;if(!(!n||!il(n)))return (r=Nn[Mn])===null||r===void 0?void 0:r[e]}function Gr(e,t){t.debug("@opentelemetry/api: Unregistering a global for "+e+" v"+Zt+".");var r=Nn[Mn];r&&delete r[e];}var tf=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,s=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)s.push(o.value);}catch(i){a={error:i};}finally{try{o&&!o.done&&(r=n.return)&&r.call(n);}finally{if(a)throw a.error}}return s},rf=function(e,t,r){if(arguments.length===2)for(var n=0,o=t.length,s;n<o;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))},ll=function(){function e(t){this._namespace=t.namespace||"DiagComponentLogger";}return e.prototype.debug=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return Dn("debug",this._namespace,t)},e.prototype.error=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return Dn("error",this._namespace,t)},e.prototype.info=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return Dn("info",this._namespace,t)},e.prototype.warn=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return Dn("warn",this._namespace,t)},e.prototype.verbose=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return Dn("verbose",this._namespace,t)},e}();function Dn(e,t,r){var n=Jt("diag");if(n)return r.unshift(t),n[e].apply(n,rf([],tf(r),false))}var tt;(function(e){e[e.NONE=0]="NONE",e[e.ERROR=30]="ERROR",e[e.WARN=50]="WARN",e[e.INFO=60]="INFO",e[e.DEBUG=70]="DEBUG",e[e.VERBOSE=80]="VERBOSE",e[e.ALL=9999]="ALL";})(tt||(tt={}));function ul(e,t){e<tt.NONE?e=tt.NONE:e>tt.ALL&&(e=tt.ALL),t=t||{};function r(n,o){var s=t[n];return typeof s=="function"&&e>=o?s.bind(t):function(){}}return {error:r("error",tt.ERROR),warn:r("warn",tt.WARN),info:r("info",tt.INFO),debug:r("debug",tt.DEBUG),verbose:r("verbose",tt.VERBOSE)}}var nf=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,s=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)s.push(o.value);}catch(i){a={error:i};}finally{try{o&&!o.done&&(r=n.return)&&r.call(n);}finally{if(a)throw a.error}}return s},of=function(e,t,r){if(arguments.length===2)for(var n=0,o=t.length,s;n<o;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))},sf="diag",Hr=function(){function e(){function t(o){return function(){for(var s=[],a=0;a<arguments.length;a++)s[a]=arguments[a];var i=Jt("diag");if(i)return i[o].apply(i,of([],nf(s),false))}}var r=this,n=function(o,s){var a,i,u;if(s===void 0&&(s={logLevel:tt.INFO}),o===r){var p=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return r.error((a=p.stack)!==null&&a!==void 0?a:p.message),false}typeof s=="number"&&(s={logLevel:s});var h=Jt("diag"),m=ul((i=s.logLevel)!==null&&i!==void 0?i:tt.INFO,o);if(h&&!s.suppressOverrideMessage){var _=(u=new Error().stack)!==null&&u!==void 0?u:"<failed to generate stacktrace>";h.warn("Current logger will be overwritten from "+_),m.warn("Current logger will overwrite one already registered from "+_);}return Wr("diag",m,r,true)};r.setLogger=n,r.disable=function(){Gr(sf,r);},r.createComponentLogger=function(o){return new ll(o)},r.verbose=t("verbose"),r.debug=t("debug"),r.info=t("info"),r.warn=t("warn"),r.error=t("error");}return e.instance=function(){return this._instance||(this._instance=new e),this._instance},e}();function pl(e){return Symbol.for(e)}var af=function(){function e(t){var r=this;r._currentContext=t?new Map(t):new Map,r.getValue=function(n){return r._currentContext.get(n)},r.setValue=function(n,o){var s=new e(r._currentContext);return s._currentContext.set(n,o),s},r.deleteValue=function(n){var o=new e(r._currentContext);return o._currentContext.delete(n),o};}return e}(),cl=new af;var lf=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,s=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)s.push(o.value);}catch(i){a={error:i};}finally{try{o&&!o.done&&(r=n.return)&&r.call(n);}finally{if(a)throw a.error}}return s},uf=function(e,t,r){if(arguments.length===2)for(var n=0,o=t.length,s;n<o;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))},dl=function(){function e(){}return e.prototype.active=function(){return cl},e.prototype.with=function(t,r,n){for(var o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return r.call.apply(r,uf([n],lf(o),false))},e.prototype.bind=function(t,r){return r},e.prototype.enable=function(){return this},e.prototype.disable=function(){return this},e}();var pf=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,s=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)s.push(o.value);}catch(i){a={error:i};}finally{try{o&&!o.done&&(r=n.return)&&r.call(n);}finally{if(a)throw a.error}}return s},cf=function(e,t,r){if(arguments.length===2)for(var n=0,o=t.length,s;n<o;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))},ws="context",df=new dl,Ao=function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalContextManager=function(t){return Wr(ws,t,Hr.instance())},e.prototype.active=function(){return this._getContextManager().active()},e.prototype.with=function(t,r,n){for(var o,s=[],a=3;a<arguments.length;a++)s[a-3]=arguments[a];return (o=this._getContextManager()).with.apply(o,cf([t,r,n],pf(s),false))},e.prototype.bind=function(t,r){return this._getContextManager().bind(t,r)},e.prototype._getContextManager=function(){return Jt(ws)||df},e.prototype.disable=function(){this._getContextManager().disable(),Gr(ws,Hr.instance());},e}();var Eo;(function(e){e[e.NONE=0]="NONE",e[e.SAMPLED=1]="SAMPLED";})(Eo||(Eo={}));var xs="0000000000000000",Ss="00000000000000000000000000000000",fl={traceId:Ss,spanId:xs,traceFlags:Eo.NONE};var or=function(){function e(t){t===void 0&&(t=fl),this._spanContext=t;}return e.prototype.spanContext=function(){return this._spanContext},e.prototype.setAttribute=function(t,r){return this},e.prototype.setAttributes=function(t){return this},e.prototype.addEvent=function(t,r){return this},e.prototype.addLink=function(t){return this},e.prototype.addLinks=function(t){return this},e.prototype.setStatus=function(t){return this},e.prototype.updateName=function(t){return this},e.prototype.end=function(t){},e.prototype.isRecording=function(){return  false},e.prototype.recordException=function(t,r){},e}();var Ts=pl("OpenTelemetry Context Key SPAN");function Ro(e){return e.getValue(Ts)||void 0}function hl(){return Ro(Ao.getInstance().active())}function Fn(e,t){return e.setValue(Ts,t)}function ml(e){return e.deleteValue(Ts)}function gl(e,t){return Fn(e,new or(t))}function Co(e){var t;return (t=Ro(e))===null||t===void 0?void 0:t.spanContext()}var ff=/^([0-9a-f]{32})$/i,hf=/^[0-9a-f]{16}$/i;function mf(e){return ff.test(e)&&e!==Ss}function gf(e){return hf.test(e)&&e!==xs}function jo(e){return mf(e.traceId)&&gf(e.spanId)}function yl(e){return new or(e)}var Is=Ao.getInstance(),Oo=function(){function e(){}return e.prototype.startSpan=function(t,r,n){n===void 0&&(n=Is.active());var o=!!(r!=null&&r.root);if(o)return new or;var s=n&&Co(n);return yf(s)&&jo(s)?new or(s):new or},e.prototype.startActiveSpan=function(t,r,n,o){var s,a,i;if(!(arguments.length<2)){arguments.length===2?i=r:arguments.length===3?(s=r,i=n):(s=r,a=n,i=o);var u=a!=null?a:Is.active(),p=this.startSpan(t,s,u),h=Fn(u,p);return Is.with(h,i,void 0,p)}},e}();function yf(e){return typeof e=="object"&&typeof e.spanId=="string"&&typeof e.traceId=="string"&&typeof e.traceFlags=="number"}var vf=new Oo,vl=function(){function e(t,r,n,o){this._provider=t,this.name=r,this.version=n,this.options=o;}return e.prototype.startSpan=function(t,r,n){return this._getTracer().startSpan(t,r,n)},e.prototype.startActiveSpan=function(t,r,n,o){var s=this._getTracer();return Reflect.apply(s.startActiveSpan,s,arguments)},e.prototype._getTracer=function(){if(this._delegate)return this._delegate;var t=this._provider.getDelegateTracer(this.name,this.version,this.options);return t?(this._delegate=t,this._delegate):vf},e}();var _l=function(){function e(){}return e.prototype.getTracer=function(t,r,n){return new Oo},e}();var _f=new _l,ks=function(){function e(){}return e.prototype.getTracer=function(t,r,n){var o;return (o=this.getDelegateTracer(t,r,n))!==null&&o!==void 0?o:new vl(this,t,r,n)},e.prototype.getDelegate=function(){var t;return (t=this._delegate)!==null&&t!==void 0?t:_f},e.prototype.setDelegate=function(t){this._delegate=t;},e.prototype.getDelegateTracer=function(t,r,n){var o;return (o=this._delegate)===null||o===void 0?void 0:o.getTracer(t,r,n)},e}();var Kr;(function(e){e[e.UNSET=0]="UNSET",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR";})(Kr||(Kr={}));var As="trace",bl=function(){function e(){this._proxyTracerProvider=new ks,this.wrapSpanContext=yl,this.isSpanContextValid=jo,this.deleteSpan=ml,this.getSpan=Ro,this.getActiveSpan=hl,this.getSpanContext=Co,this.setSpan=Fn,this.setSpanContext=gl;}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalTracerProvider=function(t){var r=Wr(As,this._proxyTracerProvider,Hr.instance());return r&&this._proxyTracerProvider.setDelegate(t),r},e.prototype.getTracerProvider=function(){return Jt(As)||this._proxyTracerProvider},e.prototype.getTracer=function(t,r){return this.getTracerProvider().getTracer(t,r)},e.prototype.disable=function(){Gr(As,Hr.instance()),this._proxyTracerProvider=new ks;},e}();var Es=bl.getInstance();var bf=Object.defineProperty,Us=(e,t)=>{for(var r in t)bf(e,r,{get:t[r],enumerable:true});};function Yr(e,{contentType:t,dataStreamVersion:r}){let n=new Headers(e!=null?e:{});return n.has("Content-Type")||n.set("Content-Type",t),r!==void 0&&n.set("X-Vercel-AI-Data-Stream",r),n}function Os(e,{contentType:t,dataStreamVersion:r}){let n={};if(e!=null)for(let[o,s]of Object.entries(e))n[o]=s;return n["Content-Type"]==null&&(n["Content-Type"]=t),r!==void 0&&(n["X-Vercel-AI-Data-Stream"]=r),n}function Ps({response:e,status:t,statusText:r,headers:n,stream:o}){e.writeHead(t!=null?t:200,r,n);let s=o.getReader();E(null,null,function*(){try{for(;;){let{done:i,value:u}=yield s.read();if(i)break;e.write(u);}}catch(i){throw i}finally{e.end();}});}var El="AI_InvalidArgumentError",Rl=`vercel.ai.error.${El}`,wf=Symbol.for(Rl),Cl,ve=class extends q{constructor({parameter:e,value:t,message:r}){super({name:El,message:`Invalid argument for parameter ${e}: ${r}`}),this[Cl]=true,this.parameter=e,this.value=t;}static isInstance(e){return q.hasMarker(e,Rl)}};Cl=wf;var jl="AI_RetryError",Ol=`vercel.ai.error.${jl}`,xf=Symbol.for(Ol),Pl,wl=class extends q{constructor({message:e,reason:t,errors:r}){super({name:jl,message:e}),this[Pl]=true,this.reason=t,this.errors=r,this.lastError=r[r.length-1];}static isInstance(e){return q.hasMarker(e,Ol)}};Pl=xf;var Sf=({maxRetries:e=2,initialDelayInMs:t=2e3,backoffFactor:r=2}={})=>n=>E(null,null,function*(){return Ml(n,{maxRetries:e,delayInMs:t,backoffFactor:r})});function Ml(s,a){return E(this,arguments,function*(e,{maxRetries:t,delayInMs:r,backoffFactor:n},o=[]){try{return yield e()}catch(i){if(Tn(i)||t===0)throw i;let u=yi(i),p=[...o,i],h=p.length;if(h>t)throw new wl({message:`Failed after ${h} attempts. Last error: ${u}`,reason:"maxRetriesExceeded",errors:p});if(i instanceof Error&&Xe.isInstance(i)&&i.isRetryable===true&&h<=t)return yield gi(r),Ml(e,{maxRetries:t,delayInMs:n*r,backoffFactor:n},p);throw h===1?i:new wl({message:`Failed after ${h} attempts with non-retryable error: '${u}'`,reason:"errorNotRetryable",errors:p})}})}function No({maxRetries:e}){if(e!=null){if(!Number.isInteger(e))throw new ve({parameter:"maxRetries",value:e,message:"maxRetries must be an integer"});if(e<0)throw new ve({parameter:"maxRetries",value:e,message:"maxRetries must be >= 0"})}let t=e!=null?e:2;return {maxRetries:t,retry:Sf({maxRetries:t})}}function Tt({operationId:e,telemetry:t}){return {"operation.name":`${e}${(t==null?void 0:t.functionId)!=null?` ${t.functionId}`:""}`,"resource.name":t==null?void 0:t.functionId,"ai.operationId":e,"ai.telemetry.functionId":t==null?void 0:t.functionId}}function Do({model:e,settings:t,telemetry:r,headers:n}){var o;return d(d(d({"ai.model.provider":e.provider,"ai.model.id":e.modelId},Object.entries(t).reduce((s,[a,i])=>(s[`ai.settings.${a}`]=i,s),{})),Object.entries((o=r==null?void 0:r.metadata)!=null?o:{}).reduce((s,[a,i])=>(s[`ai.telemetry.metadata.${a}`]=i,s),{})),Object.entries(n!=null?n:{}).reduce((s,[a,i])=>(i!==void 0&&(s[`ai.request.headers.${a}`]=i),s),{}))}var Tf={startSpan(){return Po},startActiveSpan(e,t,r,n){if(typeof t=="function")return t(Po);if(typeof r=="function")return r(Po);if(typeof n=="function")return n(Po)}},Po={spanContext(){return If},setAttribute(){return this},setAttributes(){return this},addEvent(){return this},addLink(){return this},addLinks(){return this},setStatus(){return this},updateName(){return this},end(){return this},isRecording(){return  false},recordException(){return this}},If={traceId:"",spanId:"",traceFlags:0};function Fo({isEnabled:e=false,tracer:t}={}){return e?t||Es.getTracer("ai"):Tf}function It({name:e,tracer:t,attributes:r,fn:n,endWhenDone:o=true}){return t.startActiveSpan(e,{attributes:r},s=>E(null,null,function*(){try{let a=yield n(s);return o&&s.end(),a}catch(a){try{a instanceof Error?(s.recordException({name:a.name,message:a.message,stack:a.stack}),s.setStatus({code:Kr.ERROR,message:a.message})):s.setStatus({code:Kr.ERROR});}finally{s.end();}throw a}}))}function Ae({telemetry:e,attributes:t}){return (e==null?void 0:e.isEnabled)!==true?{}:Object.entries(t).reduce((r,[n,o])=>{if(o===void 0)return r;if(typeof o=="object"&&"input"in o&&typeof o.input=="function"){if((e==null?void 0:e.recordInputs)===false)return r;let s=o.input();return s===void 0?r:g(d({},r),{[n]:s})}if(typeof o=="object"&&"output"in o&&typeof o.output=="function"){if((e==null?void 0:e.recordOutputs)===false)return r;let s=o.output();return s===void 0?r:g(d({},r),{[n]:s})}return g(d({},r),{[n]:o})},{})}var Nl=class{constructor({data:e,mimeType:t}){let r=e instanceof Uint8Array;this.base64Data=r?void 0:e,this.uint8ArrayData=r?e:void 0,this.mimeType=t;}get base64(){return this.base64Data==null&&(this.base64Data=Vt(this.uint8ArrayData)),this.base64Data}get uint8Array(){return this.uint8ArrayData==null&&(this.uint8ArrayData=nr(this.base64Data)),this.uint8ArrayData}},Cf=class extends Nl{constructor(e){super(e),this.type="file";}},jf=[{mimeType:"image/gif",bytesPrefix:[71,73,70],base64Prefix:"R0lG"},{mimeType:"image/png",bytesPrefix:[137,80,78,71],base64Prefix:"iVBORw"},{mimeType:"image/jpeg",bytesPrefix:[255,216],base64Prefix:"/9j/"},{mimeType:"image/webp",bytesPrefix:[82,73,70,70],base64Prefix:"UklGRg"},{mimeType:"image/bmp",bytesPrefix:[66,77],base64Prefix:"Qk"},{mimeType:"image/tiff",bytesPrefix:[73,73,42,0],base64Prefix:"SUkqAA"},{mimeType:"image/tiff",bytesPrefix:[77,77,0,42],base64Prefix:"TU0AKg"},{mimeType:"image/avif",bytesPrefix:[0,0,0,32,102,116,121,112,97,118,105,102],base64Prefix:"AAAAIGZ0eXBhdmlm"},{mimeType:"image/heic",bytesPrefix:[0,0,0,32,102,116,121,112,104,101,105,99],base64Prefix:"AAAAIGZ0eXBoZWlj"}];var Of=e=>{let t=typeof e=="string"?nr(e):e,r=(t[6]&127)<<21|(t[7]&127)<<14|(t[8]&127)<<7|t[9]&127;return t.slice(r+10)};function Pf(e){return typeof e=="string"&&e.startsWith("SUQz")||typeof e!="string"&&e.length>10&&e[0]===73&&e[1]===68&&e[2]===51?Of(e):e}function Mf({data:e,signatures:t}){let r=Pf(e);for(let n of t)if(typeof r=="string"?r.startsWith(n.base64Prefix):r.length>=n.bytesPrefix.length&&n.bytesPrefix.every((o,s)=>r[s]===o))return n.mimeType}var Dl="AI_NoObjectGeneratedError",Fl=`vercel.ai.error.${Dl}`,Nf=Symbol.for(Fl),Ul,Gt=class extends q{constructor({message:e="No object generated.",cause:t,text:r,response:n,usage:o,finishReason:s}){super({name:Dl,message:e,cause:t}),this[Ul]=true,this.text=r,this.response=n,this.usage=o,this.finishReason=s;}static isInstance(e){return q.hasMarker(e,Fl)}};Ul=Nf;var $l="AI_DownloadError",ql=`vercel.ai.error.${$l}`,Df=Symbol.for(ql),Bl,Rs=class extends q{constructor({url:e,statusCode:t,statusText:r,cause:n,message:o=n==null?`Failed to download ${e}: ${t} ${r}`:`Failed to download ${e}: ${n}`}){super({name:$l,message:o,cause:n}),this[Bl]=true,this.url=e,this.statusCode=t,this.statusText=r;}static isInstance(e){return q.hasMarker(e,ql)}};Bl=Df;function Ff(t){return E(this,arguments,function*({url:e}){var r;let n=e.toString();try{let o=yield fetch(n);if(!o.ok)throw new Rs({url:n,statusCode:o.status,statusText:o.statusText});return {data:new Uint8Array(yield o.arrayBuffer()),mimeType:(r=o.headers.get("content-type"))!=null?r:void 0}}catch(o){throw Rs.isInstance(o)?o:new Rs({url:n,cause:o})}})}var zl="AI_InvalidDataContentError",Ll=`vercel.ai.error.${zl}`,Uf=Symbol.for(Ll),Vl,xl=class extends q{constructor({content:e,cause:t,message:r=`Invalid data content. Expected a base64 string, Uint8Array, ArrayBuffer, or Buffer, but got ${typeof e}.`}){super({name:zl,message:r,cause:t}),this[Vl]=true,this.content=e;}static isInstance(e){return q.hasMarker(e,Ll)}};Vl=Uf;var Zl=l.union([l.string(),l.instanceof(Uint8Array),l.instanceof(ArrayBuffer),l.custom(e=>{var t,r;return (r=(t=globalThis.Buffer)==null?void 0:t.isBuffer(e))!=null?r:false},{message:"Must be a Buffer"})]);function Jl(e){return typeof e=="string"?e:e instanceof ArrayBuffer?Vt(new Uint8Array(e)):Vt(e)}function Mo(e){if(e instanceof Uint8Array)return e;if(typeof e=="string")try{return nr(e)}catch(t){throw new xl({message:"Invalid data content. Content string is not a base64-encoded media.",content:e,cause:t})}if(e instanceof ArrayBuffer)return new Uint8Array(e);throw new xl({content:e})}function $f(e){try{return new TextDecoder().decode(e)}catch(t){throw new Error("Error decoding Uint8Array to text")}}var Wl="AI_InvalidMessageRoleError",Gl=`vercel.ai.error.${Wl}`,qf=Symbol.for(Gl),Hl,Bf=class extends q{constructor({role:e,message:t=`Invalid message role: '${e}'. Must be one of: "system", "user", "assistant", "tool".`}){super({name:Wl,message:t}),this[Hl]=true,this.role=e;}static isInstance(e){return q.hasMarker(e,Gl)}};Hl=qf;function zf(e){try{let[t,r]=e.split(",");return {mimeType:t.split(";")[0].split(":")[1],base64Content:r}}catch(t){return {mimeType:void 0,base64Content:void 0}}}function Xr(o){return E(this,arguments,function*({prompt:e,modelSupportsImageUrls:t=true,modelSupportsUrl:r=()=>false,downloadImplementation:n=Ff}){let s=yield Vf(e.messages,n,t,r);return [...e.system!=null?[{role:"system",content:e.system}]:[],...e.messages.map(a=>Lf(a,s))]})}function Lf(e,t){var r,n,o,s,a,i;let u=e.role;switch(u){case "system":return {role:"system",content:e.content,providerMetadata:(r=e.providerOptions)!=null?r:e.experimental_providerMetadata};case "user":return typeof e.content=="string"?{role:"user",content:[{type:"text",text:e.content}],providerMetadata:(n=e.providerOptions)!=null?n:e.experimental_providerMetadata}:{role:"user",content:e.content.map(p=>Zf(p,t)).filter(p=>p.type!=="text"||p.text!==""),providerMetadata:(o=e.providerOptions)!=null?o:e.experimental_providerMetadata};case "assistant":return typeof e.content=="string"?{role:"assistant",content:[{type:"text",text:e.content}],providerMetadata:(s=e.providerOptions)!=null?s:e.experimental_providerMetadata}:{role:"assistant",content:e.content.filter(p=>p.type!=="text"||p.text!=="").map(p=>{var h;let m=(h=p.providerOptions)!=null?h:p.experimental_providerMetadata;switch(p.type){case "file":return {type:"file",data:p.data instanceof URL?p.data:Jl(p.data),filename:p.filename,mimeType:p.mimeType,providerMetadata:m};case "reasoning":return {type:"reasoning",text:p.text,signature:p.signature,providerMetadata:m};case "redacted-reasoning":return {type:"redacted-reasoning",data:p.data,providerMetadata:m};case "text":return {type:"text",text:p.text,providerMetadata:m};case "tool-call":return {type:"tool-call",toolCallId:p.toolCallId,toolName:p.toolName,args:p.args,providerMetadata:m}}}),providerMetadata:(a=e.providerOptions)!=null?a:e.experimental_providerMetadata};case "tool":return {role:"tool",content:e.content.map(p=>{var h;return {type:"tool-result",toolCallId:p.toolCallId,toolName:p.toolName,result:p.result,content:p.experimental_content,isError:p.isError,providerMetadata:(h=p.providerOptions)!=null?h:p.experimental_providerMetadata}}),providerMetadata:(i=e.providerOptions)!=null?i:e.experimental_providerMetadata};default:{let p=u;throw new Bf({role:p})}}}function Vf(e,t,r,n){return E(this,null,function*(){let o=e.filter(a=>a.role==="user").map(a=>a.content).filter(a=>Array.isArray(a)).flat().filter(a=>a.type==="image"||a.type==="file").filter(a=>!(a.type==="image"&&r===true)).map(a=>a.type==="image"?a.image:a.data).map(a=>typeof a=="string"&&(a.startsWith("http:")||a.startsWith("https:"))?new URL(a):a).filter(a=>a instanceof URL).filter(a=>!n(a)),s=yield Promise.all(o.map(a=>E(null,null,function*(){return {url:a,data:yield t({url:a})}})));return Object.fromEntries(s.map(({url:a,data:i})=>[a.toString(),i]))})}function Zf(e,t){var r,n,o,s;if(e.type==="text")return {type:"text",text:e.text,providerMetadata:(r=e.providerOptions)!=null?r:e.experimental_providerMetadata};let a=e.mimeType,i,u,p,h=e.type;switch(h){case "image":i=e.image;break;case "file":i=e.data;break;default:throw new Error(`Unsupported part type: ${h}`)}try{u=typeof i=="string"?new URL(i):i;}catch(m){u=i;}if(u instanceof URL)if(u.protocol==="data:"){let{mimeType:m,base64Content:_}=zf(u.toString());if(m==null||_==null)throw new Error(`Invalid data URL format in part ${h}`);a=m,p=Mo(_);}else {let m=t[u.toString()];m?(p=m.data,a!=null||(a=m.mimeType)):p=u;}else p=Mo(u);switch(h){case "image":return p instanceof Uint8Array&&(a=(n=Mf({data:p,signatures:jf}))!=null?n:a),{type:"image",image:p,mimeType:a,providerMetadata:(o=e.providerOptions)!=null?o:e.experimental_providerMetadata};case "file":{if(a==null)throw new Error("Mime type is missing for file part");return {type:"file",data:p instanceof Uint8Array?Jl(p):p,filename:e.filename,mimeType:a,providerMetadata:(s=e.providerOptions)!=null?s:e.experimental_providerMetadata}}}}function Qr({maxTokens:e,temperature:t,topP:r,topK:n,presencePenalty:o,frequencyPenalty:s,stopSequences:a,seed:i}){if(e!=null){if(!Number.isInteger(e))throw new ve({parameter:"maxTokens",value:e,message:"maxTokens must be an integer"});if(e<1)throw new ve({parameter:"maxTokens",value:e,message:"maxTokens must be >= 1"})}if(t!=null&&typeof t!="number")throw new ve({parameter:"temperature",value:t,message:"temperature must be a number"});if(r!=null&&typeof r!="number")throw new ve({parameter:"topP",value:r,message:"topP must be a number"});if(n!=null&&typeof n!="number")throw new ve({parameter:"topK",value:n,message:"topK must be a number"});if(o!=null&&typeof o!="number")throw new ve({parameter:"presencePenalty",value:o,message:"presencePenalty must be a number"});if(s!=null&&typeof s!="number")throw new ve({parameter:"frequencyPenalty",value:s,message:"frequencyPenalty must be a number"});if(i!=null&&!Number.isInteger(i))throw new ve({parameter:"seed",value:i,message:"seed must be an integer"});return {maxTokens:e,temperature:t!=null?t:0,topP:r,topK:n,presencePenalty:o,frequencyPenalty:s,stopSequences:a!=null&&a.length>0?a:void 0,seed:i}}function Sl(e){var t,r,n;let o=[];for(let s of e){let a;try{a=new URL(s.url);}catch(i){throw new Error(`Invalid URL: ${s.url}`)}switch(a.protocol){case "http:":case "https:":{if((t=s.contentType)!=null&&t.startsWith("image/"))o.push({type:"image",image:a});else {if(!s.contentType)throw new Error("If the attachment is not an image, it must specify a content type");o.push({type:"file",data:a,mimeType:s.contentType});}break}case "data:":{let i,u,p;try{[i,u]=s.url.split(","),p=i.split(";")[0].split(":")[1];}catch(h){throw new Error(`Error processing data URL: ${s.url}`)}if(p==null||u==null)throw new Error(`Invalid data URL format: ${s.url}`);if((r=s.contentType)!=null&&r.startsWith("image/"))o.push({type:"image",image:Mo(u)});else if((n=s.contentType)!=null&&n.startsWith("text/"))o.push({type:"text",text:$f(Mo(u))});else {if(!s.contentType)throw new Error("If the attachment is not an image or text, it must specify a content type");o.push({type:"file",data:u,mimeType:s.contentType});}break}default:throw new Error(`Unsupported URL protocol: ${a.protocol}`)}}return o}var Kl="AI_MessageConversionError",Yl=`vercel.ai.error.${Kl}`,Jf=Symbol.for(Yl),Xl,Cs=class extends q{constructor({originalMessage:e,message:t}){super({name:Kl,message:t}),this[Xl]=true,this.originalMessage=e;}static isInstance(e){return q.hasMarker(e,Yl)}};Xl=Jf;function Wf(e,t){var r,n;let o=(r=t==null?void 0:t.tools)!=null?r:{},s=[];for(let i=0;i<e.length;i++){let u=e[i],p=i===e.length-1,{role:h,content:m,experimental_attachments:_}=u;switch(h){case "system":{s.push({role:"system",content:m});break}case "user":{if(u.parts==null)s.push({role:"user",content:_?[{type:"text",text:m},...Sl(_)]:m});else {let S=u.parts.filter(A=>A.type==="text").map(A=>({type:"text",text:A.text}));s.push({role:"user",content:_?[...S,...Sl(_)]:S});}break}case "assistant":{if(u.parts!=null){let C=function(){let x=[];for(let U of O)switch(U.type){case "file":case "text":{x.push(U);break}case "reasoning":{for(let M of U.details)switch(M.type){case "text":x.push({type:"reasoning",text:M.text,signature:M.signature});break;case "redacted":x.push({type:"redacted-reasoning",data:M.data});break}break}case "tool-invocation":x.push({type:"tool-call",toolCallId:U.toolInvocation.toolCallId,toolName:U.toolInvocation.toolName,args:U.toolInvocation.args});break;default:{let M=U;throw new Error(`Unsupported part: ${M}`)}}s.push({role:"assistant",content:x});let F=O.filter(U=>U.type==="tool-invocation").map(U=>U.toolInvocation);F.length>0&&s.push({role:"tool",content:F.map(U=>{if(!("result"in U))throw new Cs({originalMessage:u,message:"ToolInvocation must have a result: "+JSON.stringify(U)});let{toolCallId:M,toolName:ne,result:N}=U,L=o[ne];return (L==null?void 0:L.experimental_toToolResultContent)!=null?{type:"tool-result",toolCallId:M,toolName:ne,result:L.experimental_toToolResultContent(N),experimental_content:L.experimental_toToolResultContent(N)}:{type:"tool-result",toolCallId:M,toolName:ne,result:N}})}),O=[],T=false,b++;};let b=0,T=false,O=[];for(let x of u.parts)switch(x.type){case "text":{T&&C(),O.push(x);break}case "file":case "reasoning":{O.push(x);break}case "tool-invocation":{((n=x.toolInvocation.step)!=null?n:0)!==b&&C(),O.push(x),T=true;break}}C();break}let S=u.toolInvocations;if(S==null||S.length===0){s.push({role:"assistant",content:m});break}let A=S.reduce((C,b)=>{var T;return Math.max(C,(T=b.step)!=null?T:0)},0);for(let C=0;C<=A;C++){let b=S.filter(T=>{var O;return ((O=T.step)!=null?O:0)===C});b.length!==0&&(s.push({role:"assistant",content:[...p&&m&&C===0?[{type:"text",text:m}]:[],...b.map(({toolCallId:T,toolName:O,args:x})=>({type:"tool-call",toolCallId:T,toolName:O,args:x}))]}),s.push({role:"tool",content:b.map(T=>{if(!("result"in T))throw new Cs({originalMessage:u,message:"ToolInvocation must have a result: "+JSON.stringify(T)});let{toolCallId:O,toolName:x,result:F}=T,U=o[x];return (U==null?void 0:U.experimental_toToolResultContent)!=null?{type:"tool-result",toolCallId:O,toolName:x,result:U.experimental_toToolResultContent(F),experimental_content:U.experimental_toToolResultContent(F)}:{type:"tool-result",toolCallId:O,toolName:x,result:F}})}));}m&&!p&&s.push({role:"assistant",content:m});break}case "data":break;default:{let S=h;throw new Cs({originalMessage:u,message:`Unsupported role: ${S}`})}}}return s}var Ms=l.lazy(()=>l.union([l.null(),l.string(),l.number(),l.boolean(),l.record(l.string(),Ms),l.array(Ms)])),Ee=l.record(l.string(),l.record(l.string(),Ms)),Gf=l.array(l.union([l.object({type:l.literal("text"),text:l.string()}),l.object({type:l.literal("image"),data:l.string(),mimeType:l.string().optional()})])),Ql=l.object({type:l.literal("text"),text:l.string(),providerOptions:Ee.optional(),experimental_providerMetadata:Ee.optional()}),Hf=l.object({type:l.literal("image"),image:l.union([Zl,l.instanceof(URL)]),mimeType:l.string().optional(),providerOptions:Ee.optional(),experimental_providerMetadata:Ee.optional()}),eu=l.object({type:l.literal("file"),data:l.union([Zl,l.instanceof(URL)]),filename:l.string().optional(),mimeType:l.string(),providerOptions:Ee.optional(),experimental_providerMetadata:Ee.optional()}),Kf=l.object({type:l.literal("reasoning"),text:l.string(),providerOptions:Ee.optional(),experimental_providerMetadata:Ee.optional()}),Yf=l.object({type:l.literal("redacted-reasoning"),data:l.string(),providerOptions:Ee.optional(),experimental_providerMetadata:Ee.optional()}),Xf=l.object({type:l.literal("tool-call"),toolCallId:l.string(),toolName:l.string(),args:l.unknown(),providerOptions:Ee.optional(),experimental_providerMetadata:Ee.optional()}),Qf=l.object({type:l.literal("tool-result"),toolCallId:l.string(),toolName:l.string(),result:l.unknown(),content:Gf.optional(),isError:l.boolean().optional(),providerOptions:Ee.optional(),experimental_providerMetadata:Ee.optional()}),eh=l.object({role:l.literal("system"),content:l.string(),providerOptions:Ee.optional(),experimental_providerMetadata:Ee.optional()}),th=l.object({role:l.literal("user"),content:l.union([l.string(),l.array(l.union([Ql,Hf,eu]))]),providerOptions:Ee.optional(),experimental_providerMetadata:Ee.optional()}),rh=l.object({role:l.literal("assistant"),content:l.union([l.string(),l.array(l.union([Ql,eu,Kf,Yf,Xf]))]),providerOptions:Ee.optional(),experimental_providerMetadata:Ee.optional()}),nh=l.object({role:l.literal("tool"),content:l.array(Qf),providerOptions:Ee.optional(),experimental_providerMetadata:Ee.optional()}),oh=l.union([eh,th,rh,nh]);function en({prompt:e,tools:t}){if(e.prompt==null&&e.messages==null)throw new _t({prompt:e,message:"prompt or messages must be defined"});if(e.prompt!=null&&e.messages!=null)throw new _t({prompt:e,message:"prompt and messages cannot be defined at the same time"});if(e.system!=null&&typeof e.system!="string")throw new _t({prompt:e,message:"system must be a string"});if(e.prompt!=null){if(typeof e.prompt!="string")throw new _t({prompt:e,message:"prompt must be a string"});return {type:"prompt",system:e.system,messages:[{role:"user",content:e.prompt}]}}if(e.messages!=null){let n=sh(e.messages)==="ui-messages"?Wf(e.messages,{tools:t}):e.messages;if(n.length===0)throw new _t({prompt:e,message:"messages must not be empty"});let o=ut({value:n,schema:l.array(oh)});if(!o.success)throw new _t({prompt:e,message:["message must be a CoreMessage or a UI message",`Validation error: ${o.error.message}`].join(`
`),cause:o.error});return {type:"messages",messages:n,system:e.system}}throw new Error("unreachable")}function sh(e){if(!Array.isArray(e))throw new _t({prompt:e,message:["messages must be an array of CoreMessage or UIMessage",`Received non-array value: ${JSON.stringify(e)}`].join(`
`),cause:e});if(e.length===0)return "messages";let t=e.map(ah);if(t.some(n=>n==="has-ui-specific-parts"))return "ui-messages";let r=t.findIndex(n=>n!=="has-core-specific-parts"&&n!=="message");if(r===-1)return "messages";throw new _t({prompt:e,message:["messages must be an array of CoreMessage or UIMessage",`Received message of type: "${t[r]}" at index ${r}`,`messages[${r}]: ${JSON.stringify(e[r])}`].join(`
`),cause:e})}function ah(e){return typeof e=="object"&&e!==null&&(e.role==="function"||e.role==="data"||"toolInvocations"in e||"parts"in e||"experimental_attachments"in e)?"has-ui-specific-parts":typeof e=="object"&&e!==null&&"content"in e&&(Array.isArray(e.content)||"experimental_providerMetadata"in e||"providerOptions"in e)?"has-core-specific-parts":typeof e=="object"&&e!==null&&"role"in e&&"content"in e&&typeof e.content=="string"&&["system","user","assistant","tool"].includes(e.role)?"message":"other"}function Wt({promptTokens:e,completionTokens:t}){return {promptTokens:e,completionTokens:t,totalTokens:e+t}}function tu(e,t){return {promptTokens:e.promptTokens+t.promptTokens,completionTokens:e.completionTokens+t.completionTokens,totalTokens:e.totalTokens+t.totalTokens}}var ih="JSON schema:",lh="You MUST answer with a JSON object that matches the JSON schema above.",uh="You MUST answer with JSON.";function Un({prompt:e,schema:t,schemaPrefix:r=t!=null?ih:void 0,schemaSuffix:n=t!=null?lh:uh}){return [e!=null&&e.length>0?e:void 0,e!=null&&e.length>0?"":void 0,r,t!=null?JSON.stringify(t):void 0,n].filter(o=>o!=null).join(`
`)}function Rr(e){let t=e.pipeThrough(new TransformStream);return t[Symbol.asyncIterator]=()=>{let r=t.getReader();return {next(){return E(this,null,function*(){let{done:o,value:s}=yield r.read();return o?{done:true,value:void 0}:{done:false,value:s}})}}},t}var ph={type:"no-schema",jsonSchema:void 0,validatePartialResult({value:e,textDelta:t}){return {success:true,value:{partial:e,textDelta:t}}},validateFinalResult(e,t){return e===void 0?{success:false,error:new Gt({message:"No object generated: response did not match schema.",text:t.text,response:t.response,usage:t.usage,finishReason:t.finishReason})}:{success:true,value:e}},createElementStream(){throw new fe({functionality:"element streams in no-schema mode"})}},ch=e=>({type:"object",jsonSchema:e.jsonSchema,validatePartialResult({value:t,textDelta:r}){return {success:true,value:{partial:t,textDelta:r}}},validateFinalResult(t){return ut({value:t,schema:e})},createElementStream(){throw new fe({functionality:"element streams in object mode"})}}),dh=e=>{let n=e.jsonSchema,{$schema:t}=n;return {type:"enum",jsonSchema:{$schema:"http://json-schema.org/draft-07/schema#",type:"object",properties:{elements:{type:"array",items:Ge(n,["$schema"])}},required:["elements"],additionalProperties:false},validatePartialResult({value:o,latestObject:s,isFirstDelta:a,isFinalDelta:i}){var u;if(!bo(o)||!fs(o.elements))return {success:false,error:new lt({value:o,cause:"value must be an object that contains an array of elements"})};let p=o.elements,h=[];for(let S=0;S<p.length;S++){let A=p[S],C=ut({value:A,schema:e});if(!(S===p.length-1&&!i)){if(!C.success)return C;h.push(C.value);}}let m=(u=s==null?void 0:s.length)!=null?u:0,_="";return a&&(_+="["),m>0&&(_+=","),_+=h.slice(m).map(S=>JSON.stringify(S)).join(","),i&&(_+="]"),{success:true,value:{partial:h,textDelta:_}}},validateFinalResult(o){if(!bo(o)||!fs(o.elements))return {success:false,error:new lt({value:o,cause:"value must be an object that contains an array of elements"})};let s=o.elements;for(let a of s){let i=ut({value:a,schema:e});if(!i.success)return i}return {success:true,value:s}},createElementStream(o){let s=0;return Rr(o.pipeThrough(new TransformStream({transform(a,i){switch(a.type){case "object":{let u=a.object;for(;s<u.length;s++)i.enqueue(u[s]);break}case "text-delta":case "finish":case "error":break;default:{let u=a;throw new Error(`Unsupported chunk type: ${u}`)}}}})))}}},fh=e=>({type:"enum",jsonSchema:{$schema:"http://json-schema.org/draft-07/schema#",type:"object",properties:{result:{type:"string",enum:e}},required:["result"],additionalProperties:false},validateFinalResult(t){if(!bo(t)||typeof t.result!="string")return {success:false,error:new lt({value:t,cause:'value must be an object that contains a string in the "result" property.'})};let r=t.result;return e.includes(r)?{success:true,value:r}:{success:false,error:new lt({value:t,cause:"value must be a string in the enum"})}},validatePartialResult(){throw new fe({functionality:"partial results in enum mode"})},createElementStream(){throw new fe({functionality:"element streams in enum mode"})}});function ru({output:e,schema:t,enumValues:r}){switch(e){case "object":return ch(Mt(t));case "array":return dh(Mt(t));case "enum":return fh(r);case "no-schema":return ph;default:{let n=e;throw new Error(`Unsupported output: ${n}`)}}}function nu({output:e,mode:t,schema:r,schemaName:n,schemaDescription:o,enumValues:s}){if(e!=null&&e!=="object"&&e!=="array"&&e!=="enum"&&e!=="no-schema")throw new ve({parameter:"output",value:e,message:"Invalid output type."});if(e==="no-schema"){if(t==="auto"||t==="tool")throw new ve({parameter:"mode",value:t,message:'Mode must be "json" for no-schema output.'});if(r!=null)throw new ve({parameter:"schema",value:r,message:"Schema is not supported for no-schema output."});if(o!=null)throw new ve({parameter:"schemaDescription",value:o,message:"Schema description is not supported for no-schema output."});if(n!=null)throw new ve({parameter:"schemaName",value:n,message:"Schema name is not supported for no-schema output."});if(s!=null)throw new ve({parameter:"enumValues",value:s,message:"Enum values are not supported for no-schema output."})}if(e==="object"){if(r==null)throw new ve({parameter:"schema",value:r,message:"Schema is required for object output."});if(s!=null)throw new ve({parameter:"enumValues",value:s,message:"Enum values are not supported for object output."})}if(e==="array"){if(r==null)throw new ve({parameter:"schema",value:r,message:"Element schema is required for array output."});if(s!=null)throw new ve({parameter:"enumValues",value:s,message:"Enum values are not supported for array output."})}if(e==="enum"){if(r!=null)throw new ve({parameter:"schema",value:r,message:"Schema is not supported for enum output."});if(o!=null)throw new ve({parameter:"schemaDescription",value:o,message:"Schema description is not supported for enum output."});if(n!=null)throw new ve({parameter:"schemaName",value:n,message:"Schema name is not supported for enum output."});if(s==null)throw new ve({parameter:"enumValues",value:s,message:"Enum values are required for enum output."});for(let a of s)if(typeof a!="string")throw new ve({parameter:"enumValues",value:a,message:"Enum values must be strings."})}}var hh=bt({prefix:"aiobj",size:24});function ou(F){return E(this,null,function*(){var U=F,{model:e,enum:t,schema:r,schemaName:n,schemaDescription:o,mode:s,output:a="object",system:i,prompt:u,messages:p,maxRetries:h,abortSignal:m,headers:_,experimental_repairText:S,experimental_telemetry:A,experimental_providerMetadata:C,providerOptions:b=C,_internal:{generateId:T=hh,currentDate:O=()=>new Date}={}}=U,x=Ge(U,["model","enum","schema","schemaName","schemaDescription","mode","output","system","prompt","messages","maxRetries","abortSignal","headers","experimental_repairText","experimental_telemetry","experimental_providerMetadata","providerOptions","_internal"]);nu({output:a,mode:s,schema:r,schemaName:n,schemaDescription:o,enumValues:t});let{maxRetries:M,retry:ne}=No({maxRetries:h}),N=ru({output:a,schema:r,enumValues:t});N.type==="no-schema"&&s===void 0&&(s="json");let L=Do({model:e,telemetry:A,headers:_,settings:g(d({},x),{maxRetries:M})}),ue=Fo(A);return It({name:"ai.generateObject",attributes:Ae({telemetry:A,attributes:g(d(d({},Tt({operationId:"ai.generateObject",telemetry:A})),L),{"ai.prompt":{input:()=>JSON.stringify({system:i,prompt:u,messages:p})},"ai.schema":N.jsonSchema!=null?{input:()=>JSON.stringify(N.jsonSchema)}:void 0,"ai.schema.name":n,"ai.schema.description":o,"ai.settings.output":N.type,"ai.settings.mode":s})}),tracer:ue,fn:Se=>E(null,null,function*(){var Fe,Te,me,Ie;(s==="auto"||s==null)&&(s=e.defaultObjectGenerationMode);let Pe,ge,je,pe,_e,Y,X,Ke,Ze;switch(s){case "json":{let ie=en({prompt:{system:N.jsonSchema==null?Un({prompt:i}):e.supportsStructuredOutputs?i:Un({prompt:i,schema:N.jsonSchema}),prompt:u,messages:p},tools:void 0}),le=yield Xr({prompt:ie,modelSupportsImageUrls:e.supportsImageUrls,modelSupportsUrl:(Fe=e.supportsUrl)==null?void 0:Fe.bind(e)}),he=yield ne(()=>It({name:"ai.generateObject.doGenerate",attributes:Ae({telemetry:A,attributes:g(d(d({},Tt({operationId:"ai.generateObject.doGenerate",telemetry:A})),L),{"ai.prompt.format":{input:()=>ie.type},"ai.prompt.messages":{input:()=>JSON.stringify(le)},"ai.settings.mode":s,"gen_ai.system":e.provider,"gen_ai.request.model":e.modelId,"gen_ai.request.frequency_penalty":x.frequencyPenalty,"gen_ai.request.max_tokens":x.maxTokens,"gen_ai.request.presence_penalty":x.presencePenalty,"gen_ai.request.temperature":x.temperature,"gen_ai.request.top_k":x.topK,"gen_ai.request.top_p":x.topP})}),tracer:ue,fn:ke=>E(null,null,function*(){var K,Ue,ze,rt,re,V;let oe=yield e.doGenerate(g(d({mode:{type:"object-json",schema:N.jsonSchema,name:n,description:o}},Qr(x)),{inputFormat:ie.type,prompt:le,providerMetadata:b,abortSignal:m,headers:_})),ye={id:(Ue=(K=oe.response)==null?void 0:K.id)!=null?Ue:T(),timestamp:(rt=(ze=oe.response)==null?void 0:ze.timestamp)!=null?rt:O(),modelId:(V=(re=oe.response)==null?void 0:re.modelId)!=null?V:e.modelId};if(oe.text===void 0)throw new Gt({message:"No object generated: the model did not return a response.",response:ye,usage:Wt(oe.usage),finishReason:oe.finishReason});return ke.setAttributes(Ae({telemetry:A,attributes:{"ai.response.finishReason":oe.finishReason,"ai.response.object":{output:()=>oe.text},"ai.response.id":ye.id,"ai.response.model":ye.modelId,"ai.response.timestamp":ye.timestamp.toISOString(),"ai.usage.promptTokens":oe.usage.promptTokens,"ai.usage.completionTokens":oe.usage.completionTokens,"gen_ai.response.finish_reasons":[oe.finishReason],"gen_ai.response.id":ye.id,"gen_ai.response.model":ye.modelId,"gen_ai.usage.prompt_tokens":oe.usage.promptTokens,"gen_ai.usage.completion_tokens":oe.usage.completionTokens}})),g(d({},oe),{objectText:oe.text,responseData:ye})})}));Pe=he.objectText,ge=he.finishReason,je=he.usage,pe=he.warnings,_e=he.rawResponse,Ke=he.logprobs,Ze=he.providerMetadata,X=(Te=he.request)!=null?Te:{},Y=he.responseData;break}case "tool":{let ie=en({prompt:{system:i,prompt:u,messages:p},tools:void 0}),le=yield Xr({prompt:ie,modelSupportsImageUrls:e.supportsImageUrls,modelSupportsUrl:(me=e.supportsUrl)==null?void 0:me.bind(e)}),he=ie.type,ke=yield ne(()=>It({name:"ai.generateObject.doGenerate",attributes:Ae({telemetry:A,attributes:g(d(d({},Tt({operationId:"ai.generateObject.doGenerate",telemetry:A})),L),{"ai.prompt.format":{input:()=>he},"ai.prompt.messages":{input:()=>JSON.stringify(le)},"ai.settings.mode":s,"gen_ai.system":e.provider,"gen_ai.request.model":e.modelId,"gen_ai.request.frequency_penalty":x.frequencyPenalty,"gen_ai.request.max_tokens":x.maxTokens,"gen_ai.request.presence_penalty":x.presencePenalty,"gen_ai.request.temperature":x.temperature,"gen_ai.request.top_k":x.topK,"gen_ai.request.top_p":x.topP})}),tracer:ue,fn:K=>E(null,null,function*(){var Ue,ze,rt,re,V,oe,ye,Ne;let w=yield e.doGenerate(g(d({mode:{type:"object-tool",tool:{type:"function",name:n!=null?n:"json",description:o!=null?o:"Respond with a JSON object.",parameters:N.jsonSchema}}},Qr(x)),{inputFormat:he,prompt:le,providerMetadata:b,abortSignal:m,headers:_})),be=(ze=(Ue=w.toolCalls)==null?void 0:Ue[0])==null?void 0:ze.args,we={id:(re=(rt=w.response)==null?void 0:rt.id)!=null?re:T(),timestamp:(oe=(V=w.response)==null?void 0:V.timestamp)!=null?oe:O(),modelId:(Ne=(ye=w.response)==null?void 0:ye.modelId)!=null?Ne:e.modelId};if(be===void 0)throw new Gt({message:"No object generated: the tool was not called.",response:we,usage:Wt(w.usage),finishReason:w.finishReason});return K.setAttributes(Ae({telemetry:A,attributes:{"ai.response.finishReason":w.finishReason,"ai.response.object":{output:()=>be},"ai.response.id":we.id,"ai.response.model":we.modelId,"ai.response.timestamp":we.timestamp.toISOString(),"ai.usage.promptTokens":w.usage.promptTokens,"ai.usage.completionTokens":w.usage.completionTokens,"gen_ai.response.finish_reasons":[w.finishReason],"gen_ai.response.id":we.id,"gen_ai.response.model":we.modelId,"gen_ai.usage.input_tokens":w.usage.promptTokens,"gen_ai.usage.output_tokens":w.usage.completionTokens}})),g(d({},w),{objectText:be,responseData:we})})}));Pe=ke.objectText,ge=ke.finishReason,je=ke.usage,pe=ke.warnings,_e=ke.rawResponse,Ke=ke.logprobs,Ze=ke.providerMetadata,X=(Ie=ke.request)!=null?Ie:{},Y=ke.responseData;break}case void 0:throw new Error("Model does not have a default object generation mode.");default:{let ie=s;throw new Error(`Unsupported mode: ${ie}`)}}function ct(ie){let le=wt({text:ie});if(!le.success)throw new Gt({message:"No object generated: could not parse the response.",cause:le.error,text:ie,response:Y,usage:Wt(je),finishReason:ge});let he=N.validateFinalResult(le.value,{text:ie,response:Y,usage:Wt(je)});if(!he.success)throw new Gt({message:"No object generated: response did not match schema.",cause:he.error,text:ie,response:Y,usage:Wt(je),finishReason:ge});return he.value}let Me;try{Me=ct(Pe);}catch(ie){if(S!=null&&Gt.isInstance(ie)&&(Er.isInstance(ie.cause)||lt.isInstance(ie.cause))){let le=yield S({text:Pe,error:ie.cause});if(le===null)throw ie;Me=ct(le);}else throw ie}return Se.setAttributes(Ae({telemetry:A,attributes:{"ai.response.finishReason":ge,"ai.response.object":{output:()=>JSON.stringify(Me)},"ai.usage.promptTokens":je.promptTokens,"ai.usage.completionTokens":je.completionTokens}})),new mh({object:Me,finishReason:ge,usage:Wt(je),warnings:pe,request:X,response:g(d({},Y),{headers:_e==null?void 0:_e.headers,body:_e==null?void 0:_e.body}),logprobs:Ke,providerMetadata:Ze})})})})}var mh=class{constructor(e){this.object=e.object,this.finishReason=e.finishReason,this.usage=e.usage,this.warnings=e.warnings,this.providerMetadata=e.providerMetadata,this.experimental_providerMetadata=e.providerMetadata,this.response=e.response,this.request=e.request,this.logprobs=e.logprobs;}toJsonResponse(e){var t;return new Response(JSON.stringify(this.object),{status:(t=e==null?void 0:e.status)!=null?t:200,headers:Yr(e==null?void 0:e.headers,{contentType:"application/json; charset=utf-8"})})}},De=class{constructor(){this.status={type:"pending"},this._resolve=void 0,this._reject=void 0;}get value(){return this.promise?this.promise:(this.promise=new Promise((e,t)=>{this.status.type==="resolved"?e(this.status.value):this.status.type==="rejected"&&t(this.status.error),this._resolve=e,this._reject=t;}),this.promise)}resolve(e){var t;this.status={type:"resolved",value:e},this.promise&&((t=this._resolve)==null||t.call(this,e));}reject(e){var t;this.status={type:"rejected",error:e},this.promise&&((t=this._reject)==null||t.call(this,e));}};function Tl(){let e,t;return {promise:new Promise((n,o)=>{e=n,t=o;}),resolve:e,reject:t}}function su(){let e=[],t=null,r=false,n=Tl(),o=()=>E(null,null,function*(){if(r&&e.length===0){t==null||t.close();return}if(e.length===0)return n=Tl(),yield n.promise,o();try{let{value:a,done:i}=yield e[0].read();i?(e.shift(),e.length>0?yield o():r&&(t==null||t.close())):t==null||t.enqueue(a);}catch(a){t==null||t.error(a),e.shift(),r&&e.length===0&&(t==null||t.close());}});return {stream:new ReadableStream({start(a){t=a;},pull:o,cancel(){return E(this,null,function*(){for(let a of e)yield a.cancel();e=[],r=true;})}}),addStream:a=>{if(r)throw new Error("Cannot add inner stream: outer stream is closed");e.push(a.getReader()),n.resolve();},close:()=>{r=true,n.resolve(),e.length===0&&(t==null||t.close());},terminate:()=>{r=true,n.resolve(),e.forEach(a=>a.cancel()),e=[],t==null||t.close();}}}function au(){var e,t;return (t=(e=globalThis==null?void 0:globalThis.performance)==null?void 0:e.now())!=null?t:Date.now()}var gh=bt({prefix:"aiobj",size:24});function iu(U){var M=U,{model:e,schema:t,schemaName:r,schemaDescription:n,mode:o,output:s="object",system:a,prompt:i,messages:u,maxRetries:p,abortSignal:h,headers:m,experimental_telemetry:_,experimental_providerMetadata:S,providerOptions:A=S,onError:C,onFinish:b,_internal:{generateId:T=gh,currentDate:O=()=>new Date,now:x=au}={}}=M,F=Ge(M,["model","schema","schemaName","schemaDescription","mode","output","system","prompt","messages","maxRetries","abortSignal","headers","experimental_telemetry","experimental_providerMetadata","providerOptions","onError","onFinish","_internal"]);nu({output:s,mode:o,schema:t,schemaName:r,schemaDescription:n});let ne=ru({output:s,schema:t});return ne.type==="no-schema"&&o===void 0&&(o="json"),new yh({model:e,telemetry:_,headers:m,settings:F,maxRetries:p,abortSignal:h,outputStrategy:ne,system:a,prompt:i,messages:u,schemaName:r,schemaDescription:n,providerOptions:A,mode:o,onError:C,onFinish:b,generateId:T,currentDate:O,now:x})}var yh=class{constructor({model:e,headers:t,telemetry:r,settings:n,maxRetries:o,abortSignal:s,outputStrategy:a,system:i,prompt:u,messages:p,schemaName:h,schemaDescription:m,providerOptions:_,mode:S,onError:A,onFinish:C,generateId:b,currentDate:T,now:O}){this.objectPromise=new De,this.usagePromise=new De,this.providerMetadataPromise=new De,this.warningsPromise=new De,this.requestPromise=new De,this.responsePromise=new De;let{maxRetries:x,retry:F}=No({maxRetries:o}),U=Do({model:e,telemetry:r,headers:t,settings:g(d({},n),{maxRetries:x})}),M=Fo(r),ne=this,N=su(),L=new TransformStream({transform(ue,Se){Se.enqueue(ue),ue.type==="error"&&(A==null||A({error:ue.error}));}});this.baseStream=N.stream.pipeThrough(L),It({name:"ai.streamObject",attributes:Ae({telemetry:r,attributes:g(d(d({},Tt({operationId:"ai.streamObject",telemetry:r})),U),{"ai.prompt":{input:()=>JSON.stringify({system:i,prompt:u,messages:p})},"ai.schema":a.jsonSchema!=null?{input:()=>JSON.stringify(a.jsonSchema)}:void 0,"ai.schema.name":h,"ai.schema.description":m,"ai.settings.output":a.type,"ai.settings.mode":S})}),tracer:M,endWhenDone:!1,fn:ue=>E(this,null,function*(){var Se,Fe;(S==="auto"||S==null)&&(S=e.defaultObjectGenerationMode);let Te,me;switch(S){case "json":{let re=en({prompt:{system:a.jsonSchema==null?Un({prompt:i}):e.supportsStructuredOutputs?i:Un({prompt:i,schema:a.jsonSchema}),prompt:u,messages:p},tools:void 0});Te=g(d({mode:{type:"object-json",schema:a.jsonSchema,name:h,description:m}},Qr(n)),{inputFormat:re.type,prompt:yield Xr({prompt:re,modelSupportsImageUrls:e.supportsImageUrls,modelSupportsUrl:(Se=e.supportsUrl)==null?void 0:Se.bind(e)}),providerMetadata:_,abortSignal:s,headers:t}),me={transform:(V,oe)=>{switch(V.type){case "text-delta":oe.enqueue(V.textDelta);break;case "response-metadata":case "finish":case "error":oe.enqueue(V);break}}};break}case "tool":{let re=en({prompt:{system:i,prompt:u,messages:p},tools:void 0});Te=g(d({mode:{type:"object-tool",tool:{type:"function",name:h!=null?h:"json",description:m!=null?m:"Respond with a JSON object.",parameters:a.jsonSchema}}},Qr(n)),{inputFormat:re.type,prompt:yield Xr({prompt:re,modelSupportsImageUrls:e.supportsImageUrls,modelSupportsUrl:(Fe=e.supportsUrl)==null?void 0:Fe.bind(e)}),providerMetadata:_,abortSignal:s,headers:t}),me={transform(V,oe){switch(V.type){case "tool-call-delta":oe.enqueue(V.argsTextDelta);break;case "response-metadata":case "finish":case "error":oe.enqueue(V);break}}};break}case void 0:throw new Error("Model does not have a default object generation mode.");default:{let re=S;throw new Error(`Unsupported mode: ${re}`)}}let{result:{stream:Ie,warnings:Pe,rawResponse:ge,request:je},doStreamSpan:pe,startTimestampMs:_e}=yield F(()=>It({name:"ai.streamObject.doStream",attributes:Ae({telemetry:r,attributes:g(d(d({},Tt({operationId:"ai.streamObject.doStream",telemetry:r})),U),{"ai.prompt.format":{input:()=>Te.inputFormat},"ai.prompt.messages":{input:()=>JSON.stringify(Te.prompt)},"ai.settings.mode":S,"gen_ai.system":e.provider,"gen_ai.request.model":e.modelId,"gen_ai.request.frequency_penalty":n.frequencyPenalty,"gen_ai.request.max_tokens":n.maxTokens,"gen_ai.request.presence_penalty":n.presencePenalty,"gen_ai.request.temperature":n.temperature,"gen_ai.request.top_k":n.topK,"gen_ai.request.top_p":n.topP})}),tracer:M,endWhenDone:!1,fn:re=>E(this,null,function*(){return {startTimestampMs:O(),doStreamSpan:re,result:yield e.doStream(Te)}})}));ne.requestPromise.resolve(je!=null?je:{});let Y,X,Ke,Ze,ct,Me="",ie="",le={id:b(),timestamp:T(),modelId:e.modelId},he,ke,K=!0,Ue=!0,ze=Ie.pipeThrough(new TransformStream(me)).pipeThrough(new TransformStream({transform(re,V){return E(this,null,function*(){var oe,ye,Ne;if(K){let w=O()-_e;K=!1,pe.addEvent("ai.stream.firstChunk",{"ai.stream.msToFirstChunk":w}),pe.setAttributes({"ai.stream.msToFirstChunk":w});}if(typeof re=="string"){Me+=re,ie+=re;let{value:w,state:be}=Io(Me);if(w!==void 0&&!Pn(he,w)){let we=a.validatePartialResult({value:w,textDelta:ie,latestObject:ke,isFirstDelta:Ue,isFinalDelta:be==="successful-parse"});we.success&&!Pn(ke,we.value.partial)&&(he=w,ke=we.value.partial,V.enqueue({type:"object",object:ke}),V.enqueue({type:"text-delta",textDelta:we.value.textDelta}),ie="",Ue=!1);}return}switch(re.type){case "response-metadata":{le={id:(oe=re.id)!=null?oe:le.id,timestamp:(ye=re.timestamp)!=null?ye:le.timestamp,modelId:(Ne=re.modelId)!=null?Ne:le.modelId};break}case "finish":{ie!==""&&V.enqueue({type:"text-delta",textDelta:ie}),X=re.finishReason,Y=Wt(re.usage),Ke=re.providerMetadata,V.enqueue(g(d({},re),{usage:Y,response:le})),ne.usagePromise.resolve(Y),ne.providerMetadataPromise.resolve(Ke),ne.responsePromise.resolve(g(d({},le),{headers:ge==null?void 0:ge.headers}));let w=a.validateFinalResult(he,{text:Me,response:le,usage:Y});w.success?(Ze=w.value,ne.objectPromise.resolve(Ze)):(ct=new Gt({message:"No object generated: response did not match schema.",cause:w.error,text:Me,response:le,usage:Y,finishReason:X}),ne.objectPromise.reject(ct));break}default:{V.enqueue(re);break}}})},flush(re){return E(this,null,function*(){try{let V=Y!=null?Y:{promptTokens:NaN,completionTokens:NaN,totalTokens:NaN};pe.setAttributes(Ae({telemetry:r,attributes:{"ai.response.finishReason":X,"ai.response.object":{output:()=>JSON.stringify(Ze)},"ai.response.id":le.id,"ai.response.model":le.modelId,"ai.response.timestamp":le.timestamp.toISOString(),"ai.usage.promptTokens":V.promptTokens,"ai.usage.completionTokens":V.completionTokens,"gen_ai.response.finish_reasons":[X],"gen_ai.response.id":le.id,"gen_ai.response.model":le.modelId,"gen_ai.usage.input_tokens":V.promptTokens,"gen_ai.usage.output_tokens":V.completionTokens}})),pe.end(),ue.setAttributes(Ae({telemetry:r,attributes:{"ai.usage.promptTokens":V.promptTokens,"ai.usage.completionTokens":V.completionTokens,"ai.response.object":{output:()=>JSON.stringify(Ze)}}})),yield C==null?void 0:C({usage:V,object:Ze,error:ct,response:g(d({},le),{headers:ge==null?void 0:ge.headers}),warnings:Pe,providerMetadata:Ke,experimental_providerMetadata:Ke});}catch(V){re.enqueue({type:"error",error:V});}finally{ue.end();}})}}));N.addStream(ze);})}).catch(ue=>{N.addStream(new ReadableStream({start(Se){Se.enqueue({type:"error",error:ue}),Se.close();}}));}).finally(()=>{N.close();}),this.outputStrategy=a;}get object(){return this.objectPromise.value}get usage(){return this.usagePromise.value}get experimental_providerMetadata(){return this.providerMetadataPromise.value}get providerMetadata(){return this.providerMetadataPromise.value}get warnings(){return this.warningsPromise.value}get request(){return this.requestPromise.value}get response(){return this.responsePromise.value}get partialObjectStream(){return Rr(this.baseStream.pipeThrough(new TransformStream({transform(e,t){switch(e.type){case "object":t.enqueue(e.object);break;case "text-delta":case "finish":case "error":break;default:{let r=e;throw new Error(`Unsupported chunk type: ${r}`)}}}})))}get elementStream(){return this.outputStrategy.createElementStream(this.baseStream)}get textStream(){return Rr(this.baseStream.pipeThrough(new TransformStream({transform(e,t){switch(e.type){case "text-delta":t.enqueue(e.textDelta);break;case "object":case "finish":case "error":break;default:{let r=e;throw new Error(`Unsupported chunk type: ${r}`)}}}})))}get fullStream(){return Rr(this.baseStream)}pipeTextStreamToResponse(e,t){Ps({response:e,status:t==null?void 0:t.status,statusText:t==null?void 0:t.statusText,headers:Os(t==null?void 0:t.headers,{contentType:"text/plain; charset=utf-8"}),stream:this.textStream.pipeThrough(new TextEncoderStream)});}toTextStreamResponse(e){var t;return new Response(this.textStream.pipeThrough(new TextEncoderStream),{status:(t=e==null?void 0:e.status)!=null?t:200,headers:Yr(e==null?void 0:e.headers,{contentType:"text/plain; charset=utf-8"})})}},lu="AI_NoOutputSpecifiedError",uu=`vercel.ai.error.${lu}`,vh=Symbol.for(uu),pu,cu=class extends q{constructor({message:e="No output specified."}={}){super({name:lu,message:e}),this[pu]=true;}static isInstance(e){return q.hasMarker(e,uu)}};pu=vh;var du="AI_ToolExecutionError",fu=`vercel.ai.error.${du}`,_h=Symbol.for(fu),hu,mu=class extends q{constructor({toolArgs:e,toolName:t,toolCallId:r,cause:n,message:o=`Error executing tool ${t}: ${rr(n)}`}){super({name:du,message:o,cause:n}),this[hu]=true,this.toolArgs=e,this.toolName=t,this.toolCallId=r;}static isInstance(e){return q.hasMarker(e,fu)}};hu=_h;function bh(e){return e!=null&&Object.keys(e).length>0}function gu({tools:e,toolChoice:t,activeTools:r}){return bh(e)?{tools:(r!=null?Object.entries(e).filter(([o])=>r.includes(o)):Object.entries(e)).map(([o,s])=>{let a=s.type;switch(a){case void 0:case "function":return {type:"function",name:o,description:s.description,parameters:Mt(s.parameters).jsonSchema};case "provider-defined":return {type:"provider-defined",name:o,id:s.id,args:s.args};default:{let i=a;throw new Error(`Unsupported tool type: ${i}`)}}}),toolChoice:t==null?{type:"auto"}:typeof t=="string"?{type:t}:{type:"tool",toolName:t.toolName}}:{tools:void 0,toolChoice:void 0}}var wh=/^([\s\S]*?)(\s+)(\S*)$/;function yu(e){let t=e.match(wh);return t?{prefix:t[1],whitespace:t[2],suffix:t[3]}:void 0}function xh(e){let t=yu(e);return t?t.prefix+t.whitespace:e}var vu="AI_InvalidToolArgumentsError",_u=`vercel.ai.error.${vu}`,Sh=Symbol.for(_u),bu,wu=class extends q{constructor({toolArgs:e,toolName:t,cause:r,message:n=`Invalid arguments for tool ${t}: ${rr(r)}`}){super({name:vu,message:n,cause:r}),this[bu]=true,this.toolArgs=e,this.toolName=t;}static isInstance(e){return q.hasMarker(e,_u)}};bu=Sh;var xu="AI_NoSuchToolError",Su=`vercel.ai.error.${xu}`,Th=Symbol.for(Su),Tu,Ns=class extends q{constructor({toolName:e,availableTools:t=void 0,message:r=`Model tried to call unavailable tool '${e}'. ${t===void 0?"No tools are available.":`Available tools: ${t.join(", ")}.`}`}){super({name:xu,message:r}),this[Tu]=true,this.toolName=e,this.availableTools=t;}static isInstance(e){return q.hasMarker(e,Su)}};Tu=Th;var Iu="AI_ToolCallRepairError",ku=`vercel.ai.error.${Iu}`,Ih=Symbol.for(ku),Au,kh=class extends q{constructor({cause:e,originalError:t,message:r=`Error repairing tool call: ${rr(e)}`}){super({name:Iu,message:r,cause:e}),this[Au]=true,this.originalError=t;}static isInstance(e){return q.hasMarker(e,ku)}};Au=Ih;function Eu(s){return E(this,arguments,function*({toolCall:e,tools:t,repairToolCall:r,system:n,messages:o}){if(t==null)throw new Ns({toolName:e.toolName});try{return yield Il({toolCall:e,tools:t})}catch(a){if(r==null||!(Ns.isInstance(a)||wu.isInstance(a)))throw a;let i=null;try{i=yield r({toolCall:e,tools:t,parameterSchema:({toolName:u})=>Mt(t[u].parameters).jsonSchema,system:n,messages:o,error:a});}catch(u){throw new kh({cause:u,originalError:a})}if(i==null)throw a;return yield Il({toolCall:i,tools:t})}})}function Il(r){return E(this,arguments,function*({toolCall:e,tools:t}){let n=e.toolName,o=t[n];if(o==null)throw new Ns({toolName:e.toolName,availableTools:Object.keys(t)});let s=Mt(o.parameters),a=e.args.trim()===""?ut({value:{},schema:s}):wt({text:e.args,schema:s});if(a.success===false)throw new wu({toolName:n,toolArgs:e.args,cause:a.error});return {type:"tool-call",toolCallId:e.toolCallId,toolName:n,args:a.value}})}function Ds(e){let t=e.filter(r=>r.type==="text").map(r=>r.text).join("");return t.length>0?t:void 0}function Fs({text:e="",files:t,reasoning:r,tools:n,toolCalls:o,toolResults:s,messageId:a,generateMessageId:i}){let u=[],p=[];return r.length>0&&p.push(...r.map(h=>h.type==="text"?g(d({},h),{type:"reasoning"}):g(d({},h),{type:"redacted-reasoning"}))),t.length>0&&p.push(...t.map(h=>({type:"file",data:h.base64,mimeType:h.mimeType}))),e.length>0&&p.push({type:"text",text:e}),o.length>0&&p.push(...o),p.length>0&&u.push({role:"assistant",content:p,id:a}),s.length>0&&u.push({role:"tool",id:i(),content:s.map(h=>{let m=n[h.toolName];return (m==null?void 0:m.experimental_toToolResultContent)!=null?{type:"tool-result",toolCallId:h.toolCallId,toolName:h.toolName,result:m.experimental_toToolResultContent(h.result),experimental_content:m.experimental_toToolResultContent(h.result)}:{type:"tool-result",toolCallId:h.toolCallId,toolName:h.toolName,result:h.result}})}),u}var Ah=bt({prefix:"aitxt",size:24}),Eh=bt({prefix:"msg",size:24});function $s(ne){return E(this,null,function*(){var N=ne,{model:e,tools:t,toolChoice:r,system:n,prompt:o,messages:s,maxRetries:a,abortSignal:i,headers:u,maxSteps:p=1,experimental_generateMessageId:h=Eh,experimental_output:m,experimental_continueSteps:_=false,experimental_telemetry:S,experimental_providerMetadata:A,providerOptions:C=A,experimental_activeTools:b,experimental_prepareStep:T,experimental_repairToolCall:O,_internal:{generateId:x=Ah,currentDate:F=()=>new Date}={},onStepFinish:U}=N,M=Ge(N,["model","tools","toolChoice","system","prompt","messages","maxRetries","abortSignal","headers","maxSteps","experimental_generateMessageId","experimental_output","experimental_continueSteps","experimental_telemetry","experimental_providerMetadata","providerOptions","experimental_activeTools","experimental_prepareStep","experimental_repairToolCall","_internal","onStepFinish"]);var L;if(p<1)throw new ve({parameter:"maxSteps",value:p,message:"maxSteps must be at least 1"});let{maxRetries:ue,retry:Se}=No({maxRetries:a}),Fe=Do({model:e,telemetry:S,headers:u,settings:g(d({},M),{maxRetries:ue})}),Te=en({prompt:{system:(L=m==null?void 0:m.injectIntoSystemPrompt({system:n,model:e}))!=null?L:n,prompt:o,messages:s},tools:t}),me=Fo(S);return It({name:"ai.generateText",attributes:Ae({telemetry:S,attributes:g(d(d({},Tt({operationId:"ai.generateText",telemetry:S})),Fe),{"ai.model.provider":e.provider,"ai.model.id":e.modelId,"ai.prompt":{input:()=>JSON.stringify({system:n,prompt:o,messages:s})},"ai.settings.maxSteps":p})}),tracer:me,fn:Ie=>E(null,null,function*(){var Pe,ge,je,pe,_e,Y,X,Ke,Ze,ct,Me,ie,le,he;let ke=Qr(M),K,Ue=[],ze=[],rt=[],re=0,V=[],oe="",ye=[],Ne=[],w={completionTokens:0,promptTokens:0,totalTokens:0},be="initial";do{let we=re===0?Te.type:"messages",Je=[...Te.messages,...V],mt=yield T==null?void 0:T({model:e,steps:Ne,maxSteps:p,stepNumber:re}),rs=(Pe=mt==null?void 0:mt.toolChoice)!=null?Pe:r,Or=(ge=mt==null?void 0:mt.experimental_activeTools)!=null?ge:b,Dt=(je=mt==null?void 0:mt.model)!=null?je:e,pn=yield Xr({prompt:{type:we,system:Te.system,messages:Je},modelSupportsImageUrls:Dt.supportsImageUrls,modelSupportsUrl:(pe=Dt.supportsUrl)==null?void 0:pe.bind(Dt)}),Yt=d({type:"regular"},gu({tools:t,toolChoice:rs,activeTools:Or}));K=yield Se(()=>It({name:"ai.generateText.doGenerate",attributes:Ae({telemetry:S,attributes:g(d(d({},Tt({operationId:"ai.generateText.doGenerate",telemetry:S})),Fe),{"ai.model.provider":Dt.provider,"ai.model.id":Dt.modelId,"ai.prompt.format":{input:()=>we},"ai.prompt.messages":{input:()=>JSON.stringify(pn)},"ai.prompt.tools":{input:()=>{var st;return (st=Yt.tools)==null?void 0:st.map(gt=>JSON.stringify(gt))}},"ai.prompt.toolChoice":{input:()=>Yt.toolChoice!=null?JSON.stringify(Yt.toolChoice):void 0},"gen_ai.system":Dt.provider,"gen_ai.request.model":Dt.modelId,"gen_ai.request.frequency_penalty":M.frequencyPenalty,"gen_ai.request.max_tokens":M.maxTokens,"gen_ai.request.presence_penalty":M.presencePenalty,"gen_ai.request.stop_sequences":M.stopSequences,"gen_ai.request.temperature":M.temperature,"gen_ai.request.top_k":M.topK,"gen_ai.request.top_p":M.topP})}),tracer:me,fn:st=>E(null,null,function*(){var gt,dn,ao,fn,Et,Pr;let We=yield Dt.doGenerate(g(d({mode:Yt},ke),{inputFormat:we,responseFormat:m==null?void 0:m.responseFormat({model:e}),prompt:pn,providerMetadata:C,abortSignal:i,headers:u})),$t={id:(dn=(gt=We.response)==null?void 0:gt.id)!=null?dn:x(),timestamp:(fn=(ao=We.response)==null?void 0:ao.timestamp)!=null?fn:F(),modelId:(Pr=(Et=We.response)==null?void 0:Et.modelId)!=null?Pr:Dt.modelId};return st.setAttributes(Ae({telemetry:S,attributes:{"ai.response.finishReason":We.finishReason,"ai.response.text":{output:()=>We.text},"ai.response.toolCalls":{output:()=>JSON.stringify(We.toolCalls)},"ai.response.id":$t.id,"ai.response.model":$t.modelId,"ai.response.timestamp":$t.timestamp.toISOString(),"ai.usage.promptTokens":We.usage.promptTokens,"ai.usage.completionTokens":We.usage.completionTokens,"gen_ai.response.finish_reasons":[We.finishReason],"gen_ai.response.id":$t.id,"gen_ai.response.model":$t.modelId,"gen_ai.usage.input_tokens":We.usage.promptTokens,"gen_ai.usage.output_tokens":We.usage.completionTokens}})),g(d({},We),{response:$t})})})),Ue=yield Promise.all(((_e=K.toolCalls)!=null?_e:[]).map(st=>Eu({toolCall:st,tools:t,repairToolCall:O,system:n,messages:Je}))),ze=t==null?[]:yield Rh({toolCalls:Ue,tools:t,tracer:me,telemetry:S,messages:Je,abortSignal:i});let cn=Wt(K.usage);w=tu(w,cn);let Ft="done";++re<p&&(_&&K.finishReason==="length"&&Ue.length===0?Ft="continue":Ue.length>0&&ze.length===Ue.length&&(Ft="tool-result"));let ir=(Y=K.text)!=null?Y:"",so=be==="continue"&&oe.trimEnd()!==oe?ir.trimStart():ir,Ut=Ft==="continue"?xh(so):so;if(oe=Ft==="continue"||be==="continue"?oe+Ut:Ut,rt=kl(K.reasoning),ye.push(...(X=K.sources)!=null?X:[]),be==="continue"){let st=V[V.length-1];typeof st.content=="string"?st.content+=Ut:st.content.push({text:Ut,type:"text"});}else V.push(...Fs({text:oe,files:js(K.files),reasoning:kl(K.reasoning),tools:t!=null?t:{},toolCalls:Ue,toolResults:ze,messageId:h(),generateMessageId:h}));let lr={stepType:be,text:Ut,reasoning:Ds(rt),reasoningDetails:rt,files:js(K.files),sources:(Ke=K.sources)!=null?Ke:[],toolCalls:Ue,toolResults:ze,finishReason:K.finishReason,usage:cn,warnings:K.warnings,logprobs:K.logprobs,request:(Ze=K.request)!=null?Ze:{},response:g(d({},K.response),{headers:(ct=K.rawResponse)==null?void 0:ct.headers,body:(Me=K.rawResponse)==null?void 0:Me.body,messages:structuredClone(V)}),providerMetadata:K.providerMetadata,experimental_providerMetadata:K.providerMetadata,isContinued:Ft==="continue"};Ne.push(lr),yield U==null?void 0:U(lr),be=Ft;}while(be!=="done");return Ie.setAttributes(Ae({telemetry:S,attributes:{"ai.response.finishReason":K.finishReason,"ai.response.text":{output:()=>K.text},"ai.response.toolCalls":{output:()=>JSON.stringify(K.toolCalls)},"ai.usage.promptTokens":K.usage.promptTokens,"ai.usage.completionTokens":K.usage.completionTokens}})),new Ch({text:oe,files:js(K.files),reasoning:Ds(rt),reasoningDetails:rt,sources:ye,outputResolver:()=>{if(m==null)throw new cu;return m.parseOutput({text:oe},{response:K.response,usage:w,finishReason:K.finishReason})},toolCalls:Ue,toolResults:ze,finishReason:K.finishReason,usage:w,warnings:K.warnings,request:(ie=K.request)!=null?ie:{},response:g(d({},K.response),{headers:(le=K.rawResponse)==null?void 0:le.headers,body:(he=K.rawResponse)==null?void 0:he.body,messages:V}),logprobs:K.logprobs,steps:Ne,providerMetadata:K.providerMetadata})})})})}function Rh(a){return E(this,arguments,function*({toolCalls:e,tools:t,tracer:r,telemetry:n,messages:o,abortSignal:s}){return (yield Promise.all(e.map(m=>E(null,[m],function*({toolCallId:u,toolName:p,args:h}){let _=t[p];if((_==null?void 0:_.execute)==null)return;let S=yield It({name:"ai.toolCall",attributes:Ae({telemetry:n,attributes:g(d({},Tt({operationId:"ai.toolCall",telemetry:n})),{"ai.toolCall.name":p,"ai.toolCall.id":u,"ai.toolCall.args":{output:()=>JSON.stringify(h)}})}),tracer:r,fn:A=>E(null,null,function*(){try{let C=yield _.execute(h,{toolCallId:u,messages:o,abortSignal:s});try{A.setAttributes(Ae({telemetry:n,attributes:{"ai.toolCall.result":{output:()=>JSON.stringify(C)}}}));}catch(b){}return C}catch(C){throw new mu({toolCallId:u,toolName:p,toolArgs:h,cause:C})}})});return {type:"tool-result",toolCallId:u,toolName:p,args:h,result:S}})))).filter(u=>u!=null)})}var Ch=class{constructor(e){this.text=e.text,this.files=e.files,this.reasoning=e.reasoning,this.reasoningDetails=e.reasoningDetails,this.toolCalls=e.toolCalls,this.toolResults=e.toolResults,this.finishReason=e.finishReason,this.usage=e.usage,this.warnings=e.warnings,this.request=e.request,this.response=e.response,this.steps=e.steps,this.experimental_providerMetadata=e.providerMetadata,this.providerMetadata=e.providerMetadata,this.logprobs=e.logprobs,this.outputResolver=e.outputResolver,this.sources=e.sources;}get experimental_output(){return this.outputResolver()}};function kl(e){return e==null?[]:typeof e=="string"?[{type:"text",text:e}]:e}function js(e){var t;return (t=e==null?void 0:e.map(r=>new Nl(r)))!=null?t:[]}var jh={};Us(jh,{object:()=>$h,text:()=>Uh});var Ru="AI_InvalidStreamPartError",Cu=`vercel.ai.error.${Ru}`,Oh=Symbol.for(Cu),ju,Ph=class extends q{constructor({chunk:e,message:t}){super({name:Ru,message:t}),this[ju]=true,this.chunk=e;}static isInstance(e){return q.hasMarker(e,Cu)}};ju=Oh;var Uh=()=>({type:"text",responseFormat:()=>({type:"text"}),injectIntoSystemPrompt({system:e}){return e},parsePartial({text:e}){return {partial:e}},parseOutput({text:e}){return e}}),$h=({schema:e})=>{let t=Mt(e);return {type:"object",responseFormat:({model:r})=>({type:"json",schema:r.supportsStructuredOutputs?t.jsonSchema:void 0}),injectIntoSystemPrompt({system:r,model:n}){return n.supportsStructuredOutputs?r:Un({prompt:r,schema:t.jsonSchema})},parsePartial({text:r}){let n=Io(r);switch(n.state){case "failed-parse":case "undefined-input":return;case "repaired-parse":case "successful-parse":return {partial:n.value};default:{let o=n.state;throw new Error(`Unsupported parse state: ${o}`)}}},parseOutput({text:r},n){let o=wt({text:r});if(!o.success)throw new Gt({message:"No object generated: could not parse the response.",cause:o.error,text:r,response:n.response,usage:n.usage,finishReason:n.finishReason});let s=ut({value:o.value,schema:t});if(!s.success)throw new Gt({message:"No object generated: response did not match schema.",cause:s.error,text:r,response:n.response,usage:n.usage,finishReason:n.finishReason});return s.value}}};function qh(e){return e===void 0?[]:Array.isArray(e)?e:[e]}function Bh(r){return E(this,arguments,function*({stream:e,onError:t}){let n=e.getReader();try{for(;;){let{done:o}=yield n.read();if(o)break}}catch(o){t==null||t(o);}finally{n.releaseLock();}})}function qs(e,t){let r=e.getReader(),n=t.getReader(),o,s,a=false,i=false;function u(m){return E(this,null,function*(){try{o==null&&(o=r.read());let _=yield o;o=void 0,_.done?m.close():m.enqueue(_.value);}catch(_){m.error(_);}})}function p(m){return E(this,null,function*(){try{s==null&&(s=n.read());let _=yield s;s=void 0,_.done?m.close():m.enqueue(_.value);}catch(_){m.error(_);}})}return new ReadableStream({pull(m){return E(this,null,function*(){try{if(a){yield p(m);return}if(i){yield u(m);return}o==null&&(o=r.read()),s==null&&(s=n.read());let{result:_,reader:S}=yield Promise.race([o.then(A=>({result:A,reader:r})),s.then(A=>({result:A,reader:n}))]);_.done||m.enqueue(_.value),S===r?(o=void 0,_.done&&(yield p(m),a=!0)):(s=void 0,_.done&&(i=!0,yield u(m)));}catch(_){m.error(_);}})},cancel(){r.cancel(),n.cancel();}})}function zh({tools:e,generatorStream:t,toolCallStreaming:r,tracer:n,telemetry:o,system:s,messages:a,abortSignal:i,repairToolCall:u}){let p=null,h=new ReadableStream({start(x){p=x;}}),m={},_=new Set,S=false,A;function C(){S&&_.size===0&&(A!=null&&p.enqueue(A),p.close());}let b=new TransformStream({transform(x,F){return E(this,null,function*(){let U=x.type;switch(U){case "text-delta":case "reasoning":case "reasoning-signature":case "redacted-reasoning":case "source":case "response-metadata":case "error":{F.enqueue(x);break}case "file":{F.enqueue(new Cf({data:x.data,mimeType:x.mimeType}));break}case "tool-call-delta":{r&&(m[x.toolCallId]||(F.enqueue({type:"tool-call-streaming-start",toolCallId:x.toolCallId,toolName:x.toolName}),m[x.toolCallId]=true),F.enqueue({type:"tool-call-delta",toolCallId:x.toolCallId,toolName:x.toolName,argsTextDelta:x.argsTextDelta}));break}case "tool-call":{try{let M=yield Eu({toolCall:x,tools:e,repairToolCall:u,system:s,messages:a});F.enqueue(M);let ne=e[M.toolName];if(ne.execute!=null){let N=ft();_.add(N),It({name:"ai.toolCall",attributes:Ae({telemetry:o,attributes:g(d({},Tt({operationId:"ai.toolCall",telemetry:o})),{"ai.toolCall.name":M.toolName,"ai.toolCall.id":M.toolCallId,"ai.toolCall.args":{output:()=>JSON.stringify(M.args)}})}),tracer:n,fn:L=>E(null,null,function*(){return ne.execute(M.args,{toolCallId:M.toolCallId,messages:a,abortSignal:i}).then(ue=>{p.enqueue(g(d({},M),{type:"tool-result",result:ue})),_.delete(N),C();try{L.setAttributes(Ae({telemetry:o,attributes:{"ai.toolCall.result":{output:()=>JSON.stringify(ue)}}}));}catch(Se){}},ue=>{p.enqueue({type:"error",error:new mu({toolCallId:M.toolCallId,toolName:M.toolName,toolArgs:M.args,cause:ue})}),_.delete(N),C();})})});}}catch(M){p.enqueue({type:"error",error:M});}break}case "finish":{A={type:"finish",finishReason:x.finishReason,logprobs:x.logprobs,usage:Wt(x.usage),experimental_providerMetadata:x.providerMetadata};break}default:{let M=U;throw new Error(`Unhandled chunk type: ${M}`)}}})},flush(){S=true,C();}});return new ReadableStream({start(x){return E(this,null,function*(){return Promise.all([t.pipeThrough(b).pipeTo(new WritableStream({write(F){x.enqueue(F);},close(){}})),h.pipeTo(new WritableStream({write(F){x.enqueue(F);},close(){x.close();}}))])})}})}var Lh=bt({prefix:"aitxt",size:24}),Vh=bt({prefix:"msg",size:24});function Ou(Te){var me=Te,{model:e,tools:t,toolChoice:r,system:n,prompt:o,messages:s,maxRetries:a,abortSignal:i,headers:u,maxSteps:p=1,experimental_generateMessageId:h=Vh,experimental_output:m,experimental_continueSteps:_=false,experimental_telemetry:S,experimental_providerMetadata:A,providerOptions:C=A,experimental_toolCallStreaming:b=false,toolCallStreaming:T=b,experimental_activeTools:O,experimental_repairToolCall:x,experimental_transform:F,onChunk:U,onError:M,onFinish:ne,onStepFinish:N,_internal:{now:L=au,generateId:ue=Lh,currentDate:Se=()=>new Date}={}}=me,Fe=Ge(me,["model","tools","toolChoice","system","prompt","messages","maxRetries","abortSignal","headers","maxSteps","experimental_generateMessageId","experimental_output","experimental_continueSteps","experimental_telemetry","experimental_providerMetadata","providerOptions","experimental_toolCallStreaming","toolCallStreaming","experimental_activeTools","experimental_repairToolCall","experimental_transform","onChunk","onError","onFinish","onStepFinish","_internal"]);return new Jh({model:e,telemetry:S,headers:u,settings:Fe,maxRetries:a,abortSignal:i,system:n,prompt:o,messages:s,tools:t,toolChoice:r,toolCallStreaming:T,transforms:qh(F),activeTools:O,repairToolCall:x,maxSteps:p,output:m,continueSteps:_,providerOptions:C,onChunk:U,onError:M,onFinish:ne,onStepFinish:N,now:L,currentDate:Se,generateId:ue,generateMessageId:h})}function Zh(e){if(!e)return new TransformStream({transform(s,a){a.enqueue({part:s,partialOutput:void 0});}});let t="",r="",n="";function o({controller:s,partialOutput:a=void 0}){s.enqueue({part:{type:"text-delta",textDelta:r},partialOutput:a}),r="";}return new TransformStream({transform(s,a){if(s.type==="step-finish"&&o({controller:a}),s.type!=="text-delta"){a.enqueue({part:s,partialOutput:void 0});return}t+=s.textDelta,r+=s.textDelta;let i=e.parsePartial({text:t});if(i!=null){let u=JSON.stringify(i.partial);u!==n&&(o({controller:a,partialOutput:i.partial}),n=u);}},flush(s){r.length>0&&o({controller:s});}})}var Jh=class{constructor({model:e,telemetry:t,headers:r,settings:n,maxRetries:o,abortSignal:s,system:a,prompt:i,messages:u,tools:p,toolChoice:h,toolCallStreaming:m,transforms:_,activeTools:S,repairToolCall:A,maxSteps:C,output:b,continueSteps:T,providerOptions:O,now:x,currentDate:F,generateId:U,generateMessageId:M,onChunk:ne,onError:N,onFinish:L,onStepFinish:ue}){this.warningsPromise=new De,this.usagePromise=new De,this.finishReasonPromise=new De,this.providerMetadataPromise=new De,this.textPromise=new De,this.reasoningPromise=new De,this.reasoningDetailsPromise=new De,this.sourcesPromise=new De,this.filesPromise=new De,this.toolCallsPromise=new De,this.toolResultsPromise=new De,this.requestPromise=new De,this.responsePromise=new De,this.stepsPromise=new De;var Se;if(C<1)throw new ve({parameter:"maxSteps",value:C,message:"maxSteps must be at least 1"});this.output=b;let Fe="",Te="",me="",Ie=[],Pe=[],ge,je=[],pe=[],_e={id:U(),timestamp:F(),modelId:e.modelId,messages:[]},Y=[],X=[],Ke,Ze,ct="initial",Me=[],ie,le=new TransformStream({transform(ye,Ne){return E(this,null,function*(){Ne.enqueue(ye);let{part:w}=ye;if((w.type==="text-delta"||w.type==="reasoning"||w.type==="source"||w.type==="tool-call"||w.type==="tool-result"||w.type==="tool-call-streaming-start"||w.type==="tool-call-delta")&&(yield ne==null?void 0:ne({chunk:w})),w.type==="error"&&(yield N==null?void 0:N({error:w.error})),w.type==="text-delta"&&(Fe+=w.textDelta,Te+=w.textDelta,me+=w.textDelta),w.type==="reasoning"&&(ge==null?(ge={type:"text",text:w.textDelta},Ie.push(ge)):ge.text+=w.textDelta),w.type==="reasoning-signature"){if(ge==null)throw new q({name:"InvalidStreamPart",message:"reasoning-signature without reasoning"});ge.signature=w.signature,ge=void 0;}if(w.type==="redacted-reasoning"&&Ie.push({type:"redacted",data:w.data}),w.type==="file"&&Pe.push(w),w.type==="source"&&(pe.push(w.source),je.push(w.source)),w.type==="tool-call"&&Y.push(w),w.type==="tool-result"&&X.push(w),w.type==="step-finish"){let be=Fs({text:Te,files:Pe,reasoning:Ie,tools:p!=null?p:{},toolCalls:Y,toolResults:X,messageId:w.messageId,generateMessageId:M}),we=Me.length,Je="done";we+1<C&&(T&&w.finishReason==="length"&&Y.length===0?Je="continue":Y.length>0&&X.length===Y.length&&(Je="tool-result"));let mt={stepType:ct,text:Fe,reasoning:Ds(Ie),reasoningDetails:Ie,files:Pe,sources:je,toolCalls:Y,toolResults:X,finishReason:w.finishReason,usage:w.usage,warnings:w.warnings,logprobs:w.logprobs,request:w.request,response:g(d({},w.response),{messages:[..._e.messages,...be]}),providerMetadata:w.experimental_providerMetadata,experimental_providerMetadata:w.experimental_providerMetadata,isContinued:w.isContinued};yield ue==null?void 0:ue(mt),Me.push(mt),Y=[],X=[],Fe="",je=[],Ie=[],Pe=[],ge=void 0,Je!=="done"&&(ct=Je),Je!=="continue"&&(_e.messages.push(...be),Te="");}w.type==="finish"&&(_e.id=w.response.id,_e.timestamp=w.response.timestamp,_e.modelId=w.response.modelId,_e.headers=w.response.headers,Ze=w.usage,Ke=w.finishReason);})},flush(ye){return E(this,null,function*(){var Ne;try{if(Me.length===0)return;let w=Me[Me.length-1];V.warningsPromise.resolve(w.warnings),V.requestPromise.resolve(w.request),V.responsePromise.resolve(w.response),V.toolCallsPromise.resolve(w.toolCalls),V.toolResultsPromise.resolve(w.toolResults),V.providerMetadataPromise.resolve(w.experimental_providerMetadata),V.reasoningPromise.resolve(w.reasoning),V.reasoningDetailsPromise.resolve(w.reasoningDetails);let be=Ke!=null?Ke:"unknown",we=Ze!=null?Ze:{completionTokens:NaN,promptTokens:NaN,totalTokens:NaN};V.finishReasonPromise.resolve(be),V.usagePromise.resolve(we),V.textPromise.resolve(me),V.sourcesPromise.resolve(pe),V.filesPromise.resolve(w.files),V.stepsPromise.resolve(Me),yield L==null?void 0:L({finishReason:be,logprobs:void 0,usage:we,text:me,reasoning:w.reasoning,reasoningDetails:w.reasoningDetails,files:w.files,sources:w.sources,toolCalls:w.toolCalls,toolResults:w.toolResults,request:(Ne=w.request)!=null?Ne:{},response:w.response,warnings:w.warnings,providerMetadata:w.providerMetadata,experimental_providerMetadata:w.experimental_providerMetadata,steps:Me}),ie.setAttributes(Ae({telemetry:t,attributes:{"ai.response.finishReason":be,"ai.response.text":{output:()=>me},"ai.response.toolCalls":{output:()=>{var Je;return (Je=w.toolCalls)!=null&&Je.length?JSON.stringify(w.toolCalls):void 0}},"ai.usage.promptTokens":we.promptTokens,"ai.usage.completionTokens":we.completionTokens}}));}catch(w){ye.error(w);}finally{ie.end();}})}}),he=su();this.addStream=he.addStream,this.closeStream=he.close;let ke=he.stream;for(let ye of _)ke=ke.pipeThrough(ye({tools:p,stopStream(){he.terminate();}}));this.baseStream=ke.pipeThrough(Zh(b)).pipeThrough(le);let{maxRetries:K,retry:Ue}=No({maxRetries:o}),ze=Fo(t),rt=Do({model:e,telemetry:t,headers:r,settings:g(d({},n),{maxRetries:K})}),re=en({prompt:{system:(Se=b==null?void 0:b.injectIntoSystemPrompt({system:a,model:e}))!=null?Se:a,prompt:i,messages:u},tools:p}),V=this;It({name:"ai.streamText",attributes:Ae({telemetry:t,attributes:g(d(d({},Tt({operationId:"ai.streamText",telemetry:t})),rt),{"ai.prompt":{input:()=>JSON.stringify({system:a,prompt:i,messages:u})},"ai.settings.maxSteps":C})}),tracer:ze,endWhenDone:!1,fn:ye=>E(this,null,function*(){ie=ye;function Ne(Dt){return E(this,arguments,function*({currentStep:w,responseMessages:be,usage:we,stepType:Je,previousStepText:mt,hasLeadingWhitespace:rs,messageId:Or}){var pn;let Yt=be.length===0?re.type:"messages",cn=[...re.messages,...be],Ft=yield Xr({prompt:{type:Yt,system:re.system,messages:cn},modelSupportsImageUrls:e.supportsImageUrls,modelSupportsUrl:(pn=e.supportsUrl)==null?void 0:pn.bind(e)}),ir=d({type:"regular"},gu({tools:p,toolChoice:h,activeTools:S})),{result:{stream:so,warnings:Ut,rawResponse:lr,request:st},doStreamSpan:gt,startTimestampMs:dn}=yield Ue(()=>It({name:"ai.streamText.doStream",attributes:Ae({telemetry:t,attributes:g(d(d({},Tt({operationId:"ai.streamText.doStream",telemetry:t})),rt),{"ai.prompt.format":{input:()=>Yt},"ai.prompt.messages":{input:()=>JSON.stringify(Ft)},"ai.prompt.tools":{input:()=>{var te;return (te=ir.tools)==null?void 0:te.map(Oe=>JSON.stringify(Oe))}},"ai.prompt.toolChoice":{input:()=>ir.toolChoice!=null?JSON.stringify(ir.toolChoice):void 0},"gen_ai.system":e.provider,"gen_ai.request.model":e.modelId,"gen_ai.request.frequency_penalty":n.frequencyPenalty,"gen_ai.request.max_tokens":n.maxTokens,"gen_ai.request.presence_penalty":n.presencePenalty,"gen_ai.request.stop_sequences":n.stopSequences,"gen_ai.request.temperature":n.temperature,"gen_ai.request.top_k":n.topK,"gen_ai.request.top_p":n.topP})}),tracer:ze,endWhenDone:!1,fn:te=>E(null,null,function*(){return {startTimestampMs:x(),doStreamSpan:te,result:yield e.doStream(g(d({mode:ir},Qr(n)),{inputFormat:Yt,responseFormat:b==null?void 0:b.responseFormat({model:e}),prompt:Ft,providerMetadata:O,abortSignal:s,headers:r}))}})})),ao=zh({tools:p,generatorStream:so,toolCallStreaming:m,tracer:ze,telemetry:t,system:a,messages:cn,repairToolCall:A,abortSignal:s}),fn=st!=null?st:{},Et=[],Pr=[],We=[],$t=[],ur,pr="unknown",Xt={promptTokens:0,completionTokens:0,totalTokens:0},hn,na=!0,mn="",oa=Je==="continue"?mt:"",ns,yt={id:U(),timestamp:F(),modelId:e.modelId},Mr="",sa=!1,aa=!0,ia=!1;function os(Rt){return E(this,arguments,function*({controller:te,chunk:Oe}){te.enqueue(Oe),mn+=Oe.textDelta,oa+=Oe.textDelta,sa=!0,ia=Oe.textDelta.trimEnd()!==Oe.textDelta;})}V.addStream(ao.pipeThrough(new TransformStream({transform(te,Oe){return E(this,null,function*(){var Rt,gn,cr;if(na){let Ct=x()-dn;na=!1,gt.addEvent("ai.stream.firstChunk",{"ai.response.msToFirstChunk":Ct}),gt.setAttributes({"ai.response.msToFirstChunk":Ct}),Oe.enqueue({type:"step-start",messageId:Or,request:fn,warnings:Ut!=null?Ut:[]});}if(te.type==="text-delta"&&te.textDelta.length===0)return;let la=te.type;switch(la){case "text-delta":{if(T){let Ct=aa&&rs?te.textDelta.trimStart():te.textDelta;if(Ct.length===0)break;aa=!1,Mr+=Ct;let io=yu(Mr);io!=null&&(Mr=io.suffix,yield os({controller:Oe,chunk:{type:"text-delta",textDelta:io.prefix+io.whitespace}}));}else yield os({controller:Oe,chunk:te});break}case "reasoning":{Oe.enqueue(te),ur==null?(ur={type:"text",text:te.textDelta},We.push(ur)):ur.text+=te.textDelta;break}case "reasoning-signature":{if(Oe.enqueue(te),ur==null)throw new Ph({chunk:te,message:"reasoning-signature without reasoning"});ur.signature=te.signature,ur=void 0;break}case "redacted-reasoning":{Oe.enqueue(te),We.push({type:"redacted",data:te.data});break}case "tool-call":{Oe.enqueue(te),Et.push(te);break}case "tool-result":{Oe.enqueue(te),Pr.push(te);break}case "response-metadata":{yt={id:(Rt=te.id)!=null?Rt:yt.id,timestamp:(gn=te.timestamp)!=null?gn:yt.timestamp,modelId:(cr=te.modelId)!=null?cr:yt.modelId};break}case "finish":{Xt=te.usage,pr=te.finishReason,hn=te.experimental_providerMetadata,ns=te.logprobs;let Ct=x()-dn;gt.addEvent("ai.stream.finish"),gt.setAttributes({"ai.response.msToFinish":Ct,"ai.response.avgCompletionTokensPerSecond":1e3*Xt.completionTokens/Ct});break}case "file":{$t.push(te),Oe.enqueue(te);break}case "source":case "tool-call-streaming-start":case "tool-call-delta":{Oe.enqueue(te);break}case "error":{Oe.enqueue(te),pr="error";break}default:{let Ct=la;throw new Error(`Unknown chunk type: ${Ct}`)}}})},flush(te){return E(this,null,function*(){let Oe=Et.length>0?JSON.stringify(Et):void 0,Rt="done";w+1<C&&(T&&pr==="length"&&Et.length===0?Rt="continue":Et.length>0&&Pr.length===Et.length&&(Rt="tool-result")),T&&Mr.length>0&&(Rt!=="continue"||Je==="continue"&&!sa)&&(yield os({controller:te,chunk:{type:"text-delta",textDelta:Mr}}),Mr="");try{gt.setAttributes(Ae({telemetry:t,attributes:{"ai.response.finishReason":pr,"ai.response.text":{output:()=>mn},"ai.response.toolCalls":{output:()=>Oe},"ai.response.id":yt.id,"ai.response.model":yt.modelId,"ai.response.timestamp":yt.timestamp.toISOString(),"ai.usage.promptTokens":Xt.promptTokens,"ai.usage.completionTokens":Xt.completionTokens,"gen_ai.response.finish_reasons":[pr],"gen_ai.response.id":yt.id,"gen_ai.response.model":yt.modelId,"gen_ai.usage.input_tokens":Xt.promptTokens,"gen_ai.usage.output_tokens":Xt.completionTokens}}));}catch(cr){}finally{gt.end();}te.enqueue({type:"step-finish",finishReason:pr,usage:Xt,providerMetadata:hn,experimental_providerMetadata:hn,logprobs:ns,request:fn,response:g(d({},yt),{headers:lr==null?void 0:lr.headers}),warnings:Ut,isContinued:Rt==="continue",messageId:Or});let gn=tu(we,Xt);if(Rt==="done")te.enqueue({type:"finish",finishReason:pr,usage:gn,providerMetadata:hn,experimental_providerMetadata:hn,logprobs:ns,response:g(d({},yt),{headers:lr==null?void 0:lr.headers})}),V.closeStream();else {if(Je==="continue"){let cr=be[be.length-1];typeof cr.content=="string"?cr.content+=mn:cr.content.push({text:mn,type:"text"});}else be.push(...Fs({text:mn,files:$t,reasoning:We,tools:p!=null?p:{},toolCalls:Et,toolResults:Pr,messageId:Or,generateMessageId:M}));yield Ne({currentStep:w+1,responseMessages:be,usage:gn,stepType:Rt,previousStepText:oa,hasLeadingWhitespace:ia,messageId:Rt==="continue"?Or:M()});}})}})));})}yield Ne({currentStep:0,responseMessages:[],usage:{promptTokens:0,completionTokens:0,totalTokens:0},previousStepText:"",stepType:"initial",hasLeadingWhitespace:!1,messageId:M()});})}).catch(ye=>{V.addStream(new ReadableStream({start(Ne){Ne.enqueue({type:"error",error:ye}),Ne.close();}})),V.closeStream();});}get warnings(){return this.warningsPromise.value}get usage(){return this.usagePromise.value}get finishReason(){return this.finishReasonPromise.value}get experimental_providerMetadata(){return this.providerMetadataPromise.value}get providerMetadata(){return this.providerMetadataPromise.value}get text(){return this.textPromise.value}get reasoning(){return this.reasoningPromise.value}get reasoningDetails(){return this.reasoningDetailsPromise.value}get sources(){return this.sourcesPromise.value}get files(){return this.filesPromise.value}get toolCalls(){return this.toolCallsPromise.value}get toolResults(){return this.toolResultsPromise.value}get request(){return this.requestPromise.value}get response(){return this.responsePromise.value}get steps(){return this.stepsPromise.value}teeStream(){let[e,t]=this.baseStream.tee();return this.baseStream=t,e}get textStream(){return Rr(this.teeStream().pipeThrough(new TransformStream({transform({part:e},t){e.type==="text-delta"&&t.enqueue(e.textDelta);}})))}get fullStream(){return Rr(this.teeStream().pipeThrough(new TransformStream({transform({part:e},t){t.enqueue(e);}})))}consumeStream(e){return E(this,null,function*(){var t;try{yield Bh({stream:this.fullStream,onError:e==null?void 0:e.onError});}catch(r){(t=e==null?void 0:e.onError)==null||t.call(e,r);}})}get experimental_partialOutputStream(){if(this.output==null)throw new cu;return Rr(this.teeStream().pipeThrough(new TransformStream({transform({partialOutput:e},t){e!=null&&t.enqueue(e);}})))}toDataStreamInternal({getErrorMessage:e=()=>"An error occurred.",sendUsage:t=true,sendReasoning:r=false,sendSources:n=false,experimental_sendFinish:o=true}){return this.fullStream.pipeThrough(new TransformStream({transform:(s,a)=>E(this,null,function*(){let i=s.type;switch(i){case "text-delta":{a.enqueue($e("text",s.textDelta));break}case "reasoning":{r&&a.enqueue($e("reasoning",s.textDelta));break}case "redacted-reasoning":{r&&a.enqueue($e("redacted_reasoning",{data:s.data}));break}case "reasoning-signature":{r&&a.enqueue($e("reasoning_signature",{signature:s.signature}));break}case "file":{a.enqueue($e("file",{mimeType:s.mimeType,data:s.base64}));break}case "source":{n&&a.enqueue($e("source",s.source));break}case "tool-call-streaming-start":{a.enqueue($e("tool_call_streaming_start",{toolCallId:s.toolCallId,toolName:s.toolName}));break}case "tool-call-delta":{a.enqueue($e("tool_call_delta",{toolCallId:s.toolCallId,argsTextDelta:s.argsTextDelta}));break}case "tool-call":{a.enqueue($e("tool_call",{toolCallId:s.toolCallId,toolName:s.toolName,args:s.args}));break}case "tool-result":{a.enqueue($e("tool_result",{toolCallId:s.toolCallId,result:s.result}));break}case "error":{a.enqueue($e("error",e(s.error)));break}case "step-start":{a.enqueue($e("start_step",{messageId:s.messageId}));break}case "step-finish":{a.enqueue($e("finish_step",{finishReason:s.finishReason,usage:t?{promptTokens:s.usage.promptTokens,completionTokens:s.usage.completionTokens}:void 0,isContinued:s.isContinued}));break}case "finish":{o&&a.enqueue($e("finish_message",{finishReason:s.finishReason,usage:t?{promptTokens:s.usage.promptTokens,completionTokens:s.usage.completionTokens}:void 0}));break}default:{let u=i;throw new Error(`Unknown chunk type: ${u}`)}}})}))}pipeDataStreamToResponse(e,{status:t,statusText:r,headers:n,data:o,getErrorMessage:s,sendUsage:a,sendReasoning:i,sendSources:u,experimental_sendFinish:p}={}){Ps({response:e,status:t,statusText:r,headers:Os(n,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"}),stream:this.toDataStream({data:o,getErrorMessage:s,sendUsage:a,sendReasoning:i,sendSources:u,experimental_sendFinish:p})});}pipeTextStreamToResponse(e,t){Ps({response:e,status:t==null?void 0:t.status,statusText:t==null?void 0:t.statusText,headers:Os(t==null?void 0:t.headers,{contentType:"text/plain; charset=utf-8"}),stream:this.textStream.pipeThrough(new TextEncoderStream)});}toDataStream(e){let t=this.toDataStreamInternal({getErrorMessage:e==null?void 0:e.getErrorMessage,sendUsage:e==null?void 0:e.sendUsage,sendReasoning:e==null?void 0:e.sendReasoning,sendSources:e==null?void 0:e.sendSources,experimental_sendFinish:e==null?void 0:e.experimental_sendFinish}).pipeThrough(new TextEncoderStream);return e!=null&&e.data?qs(e==null?void 0:e.data.stream,t):t}mergeIntoDataStream(e,t){e.merge(this.toDataStreamInternal({getErrorMessage:e.onError,sendUsage:t==null?void 0:t.sendUsage,sendReasoning:t==null?void 0:t.sendReasoning,sendSources:t==null?void 0:t.sendSources,experimental_sendFinish:t==null?void 0:t.experimental_sendFinish}));}toDataStreamResponse({headers:e,status:t,statusText:r,data:n,getErrorMessage:o,sendUsage:s,sendReasoning:a,sendSources:i,experimental_sendFinish:u}={}){return new Response(this.toDataStream({data:n,getErrorMessage:o,sendUsage:s,sendReasoning:a,sendSources:i,experimental_sendFinish:u}),{status:t,statusText:r,headers:Yr(e,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}toTextStreamResponse(e){var t;return new Response(this.textStream.pipeThrough(new TextEncoderStream),{status:(t=e==null?void 0:e.status)!=null?t:200,headers:Yr(e==null?void 0:e.headers,{contentType:"text/plain; charset=utf-8"})})}};var Yh=l.object({name:l.string(),version:l.string()}).passthrough(),Bs=l.object({_meta:l.optional(l.object({}).passthrough())}).passthrough(),$n=Bs,Xh=l.object({method:l.string(),params:l.optional(Bs)}),Qh=l.object({experimental:l.optional(l.object({}).passthrough()),logging:l.optional(l.object({}).passthrough()),prompts:l.optional(l.object({listChanged:l.optional(l.boolean())}).passthrough()),resources:l.optional(l.object({subscribe:l.optional(l.boolean()),listChanged:l.optional(l.boolean())}).passthrough()),tools:l.optional(l.object({listChanged:l.optional(l.boolean())}).passthrough())}).passthrough();$n.extend({protocolVersion:l.string(),capabilities:Qh,serverInfo:Yh,instructions:l.optional(l.string())});var em=$n.extend({nextCursor:l.optional(l.string())}),tm=l.object({name:l.string(),description:l.optional(l.string()),inputSchema:l.object({type:l.literal("object"),properties:l.optional(l.object({}).passthrough())}).passthrough()}).passthrough();em.extend({tools:l.array(tm)});var rm=l.object({type:l.literal("text"),text:l.string()}).passthrough(),nm=l.object({type:l.literal("image"),data:l.string().base64(),mimeType:l.string()}).passthrough(),Pu=l.object({uri:l.string(),mimeType:l.optional(l.string())}).passthrough(),om=Pu.extend({text:l.string()}),sm=Pu.extend({blob:l.string().base64()}),am=l.object({type:l.literal("resource"),resource:l.union([om,sm])}).passthrough();$n.extend({content:l.array(l.union([rm,nm,am])),isError:l.boolean().default(false).optional()}).or($n.extend({toolResult:l.unknown()}));var Uo="2.0",im=l.object({jsonrpc:l.literal(Uo),id:l.union([l.string(),l.number().int()])}).merge(Xh).strict(),lm=l.object({jsonrpc:l.literal(Uo),id:l.union([l.string(),l.number().int()]),result:$n}).strict(),um=l.object({jsonrpc:l.literal(Uo),id:l.union([l.string(),l.number().int()]),error:l.object({code:l.number().int(),message:l.string(),data:l.optional(l.unknown())})}).strict(),pm=l.object({jsonrpc:l.literal(Uo)}).merge(l.object({method:l.string(),params:l.optional(Bs)})).strict();l.union([im,pm,lm,um]);var cm={};Us(cm,{mergeIntoDataStream:()=>hm,toDataStream:()=>dm,toDataStreamResponse:()=>fm});function Mu(e={}){let t=new TextEncoder,r="";return new TransformStream({start(){return E(this,null,function*(){e.onStart&&(yield e.onStart());})},transform(o,s){return E(this,null,function*(){s.enqueue(t.encode(o)),r+=o,e.onToken&&(yield e.onToken(o)),e.onText&&typeof o=="string"&&(yield e.onText(o));})},flush(){return E(this,null,function*(){e.onCompletion&&(yield e.onCompletion(r)),e.onFinal&&(yield e.onFinal(r));})}})}function zs(e,t){return e.pipeThrough(new TransformStream({transform:(r,n)=>E(null,null,function*(){var o;if(typeof r=="string"){n.enqueue(r);return}if("event"in r){r.event==="on_chat_model_stream"&&Al((o=r.data)==null?void 0:o.chunk,n);return}Al(r,n);})})).pipeThrough(Mu(t)).pipeThrough(new TextDecoderStream).pipeThrough(new TransformStream({transform:(r,n)=>E(null,null,function*(){n.enqueue($e("text",r));})}))}function dm(e,t){return zs(e,t).pipeThrough(new TextEncoderStream)}function fm(e,t){var r;let n=zs(e,t==null?void 0:t.callbacks).pipeThrough(new TextEncoderStream),o=t==null?void 0:t.data,s=t==null?void 0:t.init,a=o?qs(o.stream,n):n;return new Response(a,{status:(r=s==null?void 0:s.status)!=null?r:200,statusText:s==null?void 0:s.statusText,headers:Yr(s==null?void 0:s.headers,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}function hm(e,t){t.dataStream.merge(zs(e,t.callbacks));}function Al(e,t){if(typeof e.content=="string")t.enqueue(e.content);else {let r=e.content;for(let n of r)n.type==="text"&&t.enqueue(n.text);}}var mm={};Us(mm,{mergeIntoDataStream:()=>vm,toDataStream:()=>gm,toDataStreamResponse:()=>ym});function Ls(e,t){let r=_m();return mi(e[Symbol.asyncIterator]()).pipeThrough(new TransformStream({transform(o,s){return E(this,null,function*(){s.enqueue(r(o.delta));})}})).pipeThrough(Mu(t)).pipeThrough(new TextDecoderStream).pipeThrough(new TransformStream({transform:(o,s)=>E(null,null,function*(){s.enqueue($e("text",o));})}))}function gm(e,t){return Ls(e,t).pipeThrough(new TextEncoderStream)}function ym(e,t={}){var r;let{init:n,data:o,callbacks:s}=t,a=Ls(e,s).pipeThrough(new TextEncoderStream),i=o?qs(o.stream,a):a;return new Response(i,{status:(r=n==null?void 0:n.status)!=null?r:200,statusText:n==null?void 0:n.statusText,headers:Yr(n==null?void 0:n.headers,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}function vm(e,t){t.dataStream.merge(Ls(e,t.callbacks));}function _m(){let e=true;return t=>(e&&(t=t.trimStart(),t&&(e=false)),t)}function bm({prompt:e,useLegacyFunctionCalling:t=false,systemMessageMode:r="system"}){let n=[],o=[];for(let{role:s,content:a}of e)switch(s){case "system":{switch(r){case "system":{n.push({role:"system",content:a});break}case "developer":{n.push({role:"developer",content:a});break}case "remove":{o.push({type:"other",message:"system messages are removed for this model"});break}default:{let i=r;throw new Error(`Unsupported system message mode: ${i}`)}}break}case "user":{if(a.length===1&&a[0].type==="text"){n.push({role:"user",content:a[0].text});break}n.push({role:"user",content:a.map((i,u)=>{var p,h,m,_;switch(i.type){case "text":return {type:"text",text:i.text};case "image":return {type:"image_url",image_url:{url:i.image instanceof URL?i.image.toString():`data:${(p=i.mimeType)!=null?p:"image/jpeg"};base64,${Vt(i.image)}`,detail:(m=(h=i.providerMetadata)==null?void 0:h.openai)==null?void 0:m.imageDetail}};case "file":{if(i.data instanceof URL)throw new fe({functionality:"'File content parts with URL data' functionality not supported."});switch(i.mimeType){case "audio/wav":return {type:"input_audio",input_audio:{data:i.data,format:"wav"}};case "audio/mp3":case "audio/mpeg":return {type:"input_audio",input_audio:{data:i.data,format:"mp3"}};case "application/pdf":return {type:"file",file:{filename:(_=i.filename)!=null?_:`part-${u}.pdf`,file_data:`data:application/pdf;base64,${i.data}`}};default:throw new fe({functionality:`File content part type ${i.mimeType} in user messages`})}}}})});break}case "assistant":{let i="",u=[];for(let p of a)switch(p.type){case "text":{i+=p.text;break}case "tool-call":{u.push({id:p.toolCallId,type:"function",function:{name:p.toolName,arguments:JSON.stringify(p.args)}});break}}if(t){if(u.length>1)throw new fe({functionality:"useLegacyFunctionCalling with multiple tool calls in one message"});n.push({role:"assistant",content:i,function_call:u.length>0?u[0].function:void 0});}else n.push({role:"assistant",content:i,tool_calls:u.length>0?u:void 0});break}case "tool":{for(let i of a)t?n.push({role:"function",name:i.toolName,content:JSON.stringify(i.result)}):n.push({role:"tool",tool_call_id:i.toolCallId,content:JSON.stringify(i.result)});break}default:{let i=s;throw new Error(`Unsupported role: ${i}`)}}return {messages:n,warnings:o}}function Nu(e){var t,r;return (r=(t=e==null?void 0:e.content)==null?void 0:t.map(({token:n,logprob:o,top_logprobs:s})=>({token:n,logprob:o,topLogprobs:s?s.map(({token:a,logprob:i})=>({token:a,logprob:i})):[]})))!=null?r:void 0}function $o(e){switch(e){case "stop":return "stop";case "length":return "length";case "content_filter":return "content-filter";case "function_call":case "tool_calls":return "tool-calls";default:return "unknown"}}var Zs=l.object({error:l.object({message:l.string(),type:l.string().nullish(),param:l.any().nullish(),code:l.union([l.string(),l.number()]).nullish()})}),Nt=wi({errorSchema:Zs,errorToMessage:e=>e.error.message});function qo({id:e,model:t,created:r}){return {id:e!=null?e:void 0,modelId:t!=null?t:void 0,timestamp:r!=null?new Date(r*1e3):void 0}}function wm({mode:e,useLegacyFunctionCalling:t=false,structuredOutputs:r}){var n;let o=(n=e.tools)!=null&&n.length?e.tools:void 0,s=[];if(o==null)return {tools:void 0,tool_choice:void 0,toolWarnings:s};let a=e.toolChoice;if(t){let p=[];for(let m of o)m.type==="provider-defined"?s.push({type:"unsupported-tool",tool:m}):p.push({name:m.name,description:m.description,parameters:m.parameters});if(a==null)return {functions:p,function_call:void 0,toolWarnings:s};switch(a.type){case "auto":case "none":case void 0:return {functions:p,function_call:void 0,toolWarnings:s};case "required":throw new fe({functionality:"useLegacyFunctionCalling and toolChoice: required"});default:return {functions:p,function_call:{name:a.toolName},toolWarnings:s}}}let i=[];for(let p of o)p.type==="provider-defined"?s.push({type:"unsupported-tool",tool:p}):i.push({type:"function",function:{name:p.name,description:p.description,parameters:p.parameters,strict:r?true:void 0}});if(a==null)return {tools:i,tool_choice:void 0,toolWarnings:s};let u=a.type;switch(u){case "auto":case "none":case "required":return {tools:i,tool_choice:u,toolWarnings:s};case "tool":return {tools:i,tool_choice:{type:"function",function:{name:a.toolName}},toolWarnings:s};default:{let p=u;throw new fe({functionality:`Unsupported tool choice type: ${p}`})}}}var xm=class{constructor(e,t,r){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=r;}get supportsStructuredOutputs(){var e;return (e=this.settings.structuredOutputs)!=null?e:Vs(this.modelId)}get defaultObjectGenerationMode(){return Im(this.modelId)?"tool":this.supportsStructuredOutputs?"json":"tool"}get provider(){return this.config.provider}get supportsImageUrls(){return !this.settings.downloadImages}getArgs({mode:e,prompt:t,maxTokens:r,temperature:n,topP:o,topK:s,frequencyPenalty:a,presencePenalty:i,stopSequences:u,responseFormat:p,seed:h,providerMetadata:m}){var _,S,A,C,b,T,O,x;let F=e.type,U=[];s!=null&&U.push({type:"unsupported-setting",setting:"topK"}),(p==null?void 0:p.type)==="json"&&p.schema!=null&&!this.supportsStructuredOutputs&&U.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format schema is only supported with structuredOutputs"});let M=this.settings.useLegacyFunctionCalling;if(M&&this.settings.parallelToolCalls===true)throw new fe({functionality:"useLegacyFunctionCalling with parallelToolCalls"});if(M&&this.supportsStructuredOutputs)throw new fe({functionality:"structuredOutputs with useLegacyFunctionCalling"});let{messages:ne,warnings:N}=bm({prompt:t,useLegacyFunctionCalling:M,systemMessageMode:km(this.modelId)});U.push(...N);let L={model:this.modelId,logit_bias:this.settings.logitBias,logprobs:this.settings.logprobs===true||typeof this.settings.logprobs=="number"?true:void 0,top_logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,user:this.settings.user,parallel_tool_calls:this.settings.parallelToolCalls,max_tokens:r,temperature:n,top_p:o,frequency_penalty:a,presence_penalty:i,response_format:(p==null?void 0:p.type)==="json"?this.supportsStructuredOutputs&&p.schema!=null?{type:"json_schema",json_schema:{schema:p.schema,strict:true,name:(_=p.name)!=null?_:"response",description:p.description}}:{type:"json_object"}:void 0,stop:u,seed:h,max_completion_tokens:(S=m==null?void 0:m.openai)==null?void 0:S.maxCompletionTokens,store:(A=m==null?void 0:m.openai)==null?void 0:A.store,metadata:(C=m==null?void 0:m.openai)==null?void 0:C.metadata,prediction:(b=m==null?void 0:m.openai)==null?void 0:b.prediction,reasoning_effort:(O=(T=m==null?void 0:m.openai)==null?void 0:T.reasoningEffort)!=null?O:this.settings.reasoningEffort,messages:ne};switch(Vs(this.modelId)?(L.temperature!=null&&(L.temperature=void 0,U.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for reasoning models"})),L.top_p!=null&&(L.top_p=void 0,U.push({type:"unsupported-setting",setting:"topP",details:"topP is not supported for reasoning models"})),L.frequency_penalty!=null&&(L.frequency_penalty=void 0,U.push({type:"unsupported-setting",setting:"frequencyPenalty",details:"frequencyPenalty is not supported for reasoning models"})),L.presence_penalty!=null&&(L.presence_penalty=void 0,U.push({type:"unsupported-setting",setting:"presencePenalty",details:"presencePenalty is not supported for reasoning models"})),L.logit_bias!=null&&(L.logit_bias=void 0,U.push({type:"other",message:"logitBias is not supported for reasoning models"})),L.logprobs!=null&&(L.logprobs=void 0,U.push({type:"other",message:"logprobs is not supported for reasoning models"})),L.top_logprobs!=null&&(L.top_logprobs=void 0,U.push({type:"other",message:"topLogprobs is not supported for reasoning models"})),L.max_tokens!=null&&(L.max_completion_tokens==null&&(L.max_completion_tokens=L.max_tokens),L.max_tokens=void 0)):(this.modelId.startsWith("gpt-4o-search-preview")||this.modelId.startsWith("gpt-4o-mini-search-preview"))&&L.temperature!=null&&(L.temperature=void 0,U.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for the search preview models and has been removed."})),F){case "regular":{let{tools:ue,tool_choice:Se,functions:Fe,function_call:Te,toolWarnings:me}=wm({mode:e,useLegacyFunctionCalling:M,structuredOutputs:this.supportsStructuredOutputs});return {args:g(d({},L),{tools:ue,tool_choice:Se,functions:Fe,function_call:Te}),warnings:[...U,...me]}}case "object-json":return {args:g(d({},L),{response_format:this.supportsStructuredOutputs&&e.schema!=null?{type:"json_schema",json_schema:{schema:e.schema,strict:true,name:(x=e.name)!=null?x:"response",description:e.description}}:{type:"json_object"}}),warnings:U};case "object-tool":return {args:M?g(d({},L),{function_call:{name:e.tool.name},functions:[{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters}]}):g(d({},L),{tool_choice:{type:"function",function:{name:e.tool.name}},tools:[{type:"function",function:{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters,strict:this.supportsStructuredOutputs?true:void 0}}]}),warnings:U};default:{let ue=F;throw new Error(`Unsupported type: ${ue}`)}}}doGenerate(e){return E(this,null,function*(){var t,r,n,o,s,a,i,u;let{args:p,warnings:h}=this.getArgs(e),{responseHeaders:m,value:_,rawValue:S}=yield Qe({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Le(this.config.headers(),e.headers),body:p,failedResponseHandler:Nt,successfulResponseHandler:ht(Sm),abortSignal:e.abortSignal,fetch:this.config.fetch}),F=p,{messages:A}=F,C=Ge(F,["messages"]),b=_.choices[0],T=(t=_.usage)==null?void 0:t.completion_tokens_details,O=(r=_.usage)==null?void 0:r.prompt_tokens_details,x={openai:{}};return (T==null?void 0:T.reasoning_tokens)!=null&&(x.openai.reasoningTokens=T==null?void 0:T.reasoning_tokens),(T==null?void 0:T.accepted_prediction_tokens)!=null&&(x.openai.acceptedPredictionTokens=T==null?void 0:T.accepted_prediction_tokens),(T==null?void 0:T.rejected_prediction_tokens)!=null&&(x.openai.rejectedPredictionTokens=T==null?void 0:T.rejected_prediction_tokens),(O==null?void 0:O.cached_tokens)!=null&&(x.openai.cachedPromptTokens=O==null?void 0:O.cached_tokens),{text:(n=b.message.content)!=null?n:void 0,toolCalls:this.settings.useLegacyFunctionCalling&&b.message.function_call?[{toolCallType:"function",toolCallId:ft(),toolName:b.message.function_call.name,args:b.message.function_call.arguments}]:(o=b.message.tool_calls)==null?void 0:o.map(U=>{var M;return {toolCallType:"function",toolCallId:(M=U.id)!=null?M:ft(),toolName:U.function.name,args:U.function.arguments}}),finishReason:$o(b.finish_reason),usage:{promptTokens:(a=(s=_.usage)==null?void 0:s.prompt_tokens)!=null?a:NaN,completionTokens:(u=(i=_.usage)==null?void 0:i.completion_tokens)!=null?u:NaN},rawCall:{rawPrompt:A,rawSettings:C},rawResponse:{headers:m,body:S},request:{body:JSON.stringify(p)},response:qo(_),warnings:h,logprobs:Nu(b.logprobs),providerMetadata:x}})}doStream(e){return E(this,null,function*(){if(this.settings.simulateStreaming){let b=yield this.doGenerate(e);return {stream:new ReadableStream({start(O){if(O.enqueue(d({type:"response-metadata"},b.response)),b.text&&O.enqueue({type:"text-delta",textDelta:b.text}),b.toolCalls)for(let x of b.toolCalls)O.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:x.toolCallId,toolName:x.toolName,argsTextDelta:x.args}),O.enqueue(d({type:"tool-call"},x));O.enqueue({type:"finish",finishReason:b.finishReason,usage:b.usage,logprobs:b.logprobs,providerMetadata:b.providerMetadata}),O.close();}}),rawCall:b.rawCall,rawResponse:b.rawResponse,warnings:b.warnings}}let{args:t,warnings:r}=this.getArgs(e),n=g(d({},t),{stream:true,stream_options:this.config.compatibility==="strict"?{include_usage:true}:void 0}),{responseHeaders:o,value:s}=yield Qe({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Le(this.config.headers(),e.headers),body:n,failedResponseHandler:Nt,successfulResponseHandler:Jr(Tm),abortSignal:e.abortSignal,fetch:this.config.fetch}),C=t,{messages:a}=C,i=Ge(C,["messages"]),u=[],p="unknown",h={promptTokens:void 0,completionTokens:void 0},m,_=true,{useLegacyFunctionCalling:S}=this.settings,A={openai:{}};return {stream:s.pipeThrough(new TransformStream({transform(b,T){var O,x,F,U,M,ne,N,L,ue,Se,Fe,Te;if(!b.success){p="error",T.enqueue({type:"error",error:b.error});return}let me=b.value;if("error"in me){p="error",T.enqueue({type:"error",error:me.error});return}if(_&&(_=false,T.enqueue(d({type:"response-metadata"},qo(me)))),me.usage!=null){let{prompt_tokens:pe,completion_tokens:_e,prompt_tokens_details:Y,completion_tokens_details:X}=me.usage;h={promptTokens:pe!=null?pe:void 0,completionTokens:_e!=null?_e:void 0},(X==null?void 0:X.reasoning_tokens)!=null&&(A.openai.reasoningTokens=X==null?void 0:X.reasoning_tokens),(X==null?void 0:X.accepted_prediction_tokens)!=null&&(A.openai.acceptedPredictionTokens=X==null?void 0:X.accepted_prediction_tokens),(X==null?void 0:X.rejected_prediction_tokens)!=null&&(A.openai.rejectedPredictionTokens=X==null?void 0:X.rejected_prediction_tokens),(Y==null?void 0:Y.cached_tokens)!=null&&(A.openai.cachedPromptTokens=Y==null?void 0:Y.cached_tokens);}let Ie=me.choices[0];if((Ie==null?void 0:Ie.finish_reason)!=null&&(p=$o(Ie.finish_reason)),(Ie==null?void 0:Ie.delta)==null)return;let Pe=Ie.delta;Pe.content!=null&&T.enqueue({type:"text-delta",textDelta:Pe.content});let ge=Nu(Ie==null?void 0:Ie.logprobs);ge!=null&&ge.length&&(m===void 0&&(m=[]),m.push(...ge));let je=S&&Pe.function_call!=null?[{type:"function",id:ft(),function:Pe.function_call,index:0}]:Pe.tool_calls;if(je!=null)for(let pe of je){let _e=pe.index;if(u[_e]==null){if(pe.type!=="function")throw new _o({data:pe,message:"Expected 'function' type."});if(pe.id==null)throw new _o({data:pe,message:"Expected 'id' to be a string."});if(((O=pe.function)==null?void 0:O.name)==null)throw new _o({data:pe,message:"Expected 'function.name' to be a string."});u[_e]={id:pe.id,type:"function",function:{name:pe.function.name,arguments:(x=pe.function.arguments)!=null?x:""},hasFinished:false};let X=u[_e];((F=X.function)==null?void 0:F.name)!=null&&((U=X.function)==null?void 0:U.arguments)!=null&&(X.function.arguments.length>0&&T.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:X.id,toolName:X.function.name,argsTextDelta:X.function.arguments}),ms(X.function.arguments)&&(T.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(M=X.id)!=null?M:ft(),toolName:X.function.name,args:X.function.arguments}),X.hasFinished=true));continue}let Y=u[_e];Y.hasFinished||(((ne=pe.function)==null?void 0:ne.arguments)!=null&&(Y.function.arguments+=(L=(N=pe.function)==null?void 0:N.arguments)!=null?L:""),T.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:Y.id,toolName:Y.function.name,argsTextDelta:(ue=pe.function.arguments)!=null?ue:""}),((Se=Y.function)==null?void 0:Se.name)!=null&&((Fe=Y.function)==null?void 0:Fe.arguments)!=null&&ms(Y.function.arguments)&&(T.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(Te=Y.id)!=null?Te:ft(),toolName:Y.function.name,args:Y.function.arguments}),Y.hasFinished=true));}},flush(b){var T,O;b.enqueue(d({type:"finish",finishReason:p,logprobs:m,usage:{promptTokens:(T=h.promptTokens)!=null?T:NaN,completionTokens:(O=h.completionTokens)!=null?O:NaN}},A!=null?{providerMetadata:A}:{}));}})),rawCall:{rawPrompt:a,rawSettings:i},rawResponse:{headers:o},request:{body:JSON.stringify(n)},warnings:r}})}},$u=l.object({prompt_tokens:l.number().nullish(),completion_tokens:l.number().nullish(),prompt_tokens_details:l.object({cached_tokens:l.number().nullish()}).nullish(),completion_tokens_details:l.object({reasoning_tokens:l.number().nullish(),accepted_prediction_tokens:l.number().nullish(),rejected_prediction_tokens:l.number().nullish()}).nullish()}).nullish(),Sm=l.object({id:l.string().nullish(),created:l.number().nullish(),model:l.string().nullish(),choices:l.array(l.object({message:l.object({role:l.literal("assistant").nullish(),content:l.string().nullish(),function_call:l.object({arguments:l.string(),name:l.string()}).nullish(),tool_calls:l.array(l.object({id:l.string().nullish(),type:l.literal("function"),function:l.object({name:l.string(),arguments:l.string()})})).nullish()}),index:l.number(),logprobs:l.object({content:l.array(l.object({token:l.string(),logprob:l.number(),top_logprobs:l.array(l.object({token:l.string(),logprob:l.number()}))})).nullable()}).nullish(),finish_reason:l.string().nullish()})),usage:$u}),Tm=l.union([l.object({id:l.string().nullish(),created:l.number().nullish(),model:l.string().nullish(),choices:l.array(l.object({delta:l.object({role:l.enum(["assistant"]).nullish(),content:l.string().nullish(),function_call:l.object({name:l.string().optional(),arguments:l.string().optional()}).nullish(),tool_calls:l.array(l.object({index:l.number(),id:l.string().nullish(),type:l.literal("function").nullish(),function:l.object({name:l.string().nullish(),arguments:l.string().nullish()})})).nullish()}).nullish(),logprobs:l.object({content:l.array(l.object({token:l.string(),logprob:l.number(),top_logprobs:l.array(l.object({token:l.string(),logprob:l.number()}))})).nullable()}).nullish(),finish_reason:l.string().nullish(),index:l.number()})),usage:$u}),Zs]);function Vs(e){return e.startsWith("o")}function Im(e){return e.startsWith("gpt-4o-audio-preview")}function km(e){var t,r;return Vs(e)?(r=(t=Am[e])==null?void 0:t.systemMessageMode)!=null?r:"developer":"system"}var Am={"o1-mini":{systemMessageMode:"remove"},"o1-mini-2024-09-12":{systemMessageMode:"remove"},"o1-preview":{systemMessageMode:"remove"},"o1-preview-2024-09-12":{systemMessageMode:"remove"},o3:{systemMessageMode:"developer"},"o3-2025-04-16":{systemMessageMode:"developer"},"o3-mini":{systemMessageMode:"developer"},"o3-mini-2025-01-31":{systemMessageMode:"developer"},"o4-mini":{systemMessageMode:"developer"},"o4-mini-2025-04-16":{systemMessageMode:"developer"}};function Em({prompt:e,inputFormat:t,user:r="user",assistant:n="assistant"}){if(t==="prompt"&&e.length===1&&e[0].role==="user"&&e[0].content.length===1&&e[0].content[0].type==="text")return {prompt:e[0].content[0].text};let o="";e[0].role==="system"&&(o+=`${e[0].content}

`,e=e.slice(1));for(let{role:s,content:a}of e)switch(s){case "system":throw new _t({message:"Unexpected system message in prompt: ${content}",prompt:e});case "user":{let i=a.map(u=>{switch(u.type){case "text":return u.text;case "image":throw new fe({functionality:"images"})}}).join("");o+=`${r}:
${i}

`;break}case "assistant":{let i=a.map(u=>{switch(u.type){case "text":return u.text;case "tool-call":throw new fe({functionality:"tool-call messages"})}}).join("");o+=`${n}:
${i}

`;break}case "tool":throw new fe({functionality:"tool messages"});default:{let i=s;throw new Error(`Unsupported role: ${i}`)}}return o+=`${n}:
`,{prompt:o,stopSequences:[`
${r}:`]}}function Du(e){return e==null?void 0:e.tokens.map((t,r)=>({token:t,logprob:e.token_logprobs[r],topLogprobs:e.top_logprobs?Object.entries(e.top_logprobs[r]).map(([n,o])=>({token:n,logprob:o})):[]}))}var Rm=class{constructor(e,t,r){this.specificationVersion="v1",this.defaultObjectGenerationMode=void 0,this.modelId=e,this.settings=t,this.config=r;}get provider(){return this.config.provider}getArgs({mode:e,inputFormat:t,prompt:r,maxTokens:n,temperature:o,topP:s,topK:a,frequencyPenalty:i,presencePenalty:u,stopSequences:p,responseFormat:h,seed:m}){var _;let S=e.type,A=[];a!=null&&A.push({type:"unsupported-setting",setting:"topK"}),h!=null&&h.type!=="text"&&A.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format is not supported."});let{prompt:C,stopSequences:b}=Em({prompt:r,inputFormat:t}),T=[...b!=null?b:[],...p!=null?p:[]],O={model:this.modelId,echo:this.settings.echo,logit_bias:this.settings.logitBias,logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,suffix:this.settings.suffix,user:this.settings.user,max_tokens:n,temperature:o,top_p:s,frequency_penalty:i,presence_penalty:u,seed:m,prompt:C,stop:T.length>0?T:void 0};switch(S){case "regular":{if((_=e.tools)!=null&&_.length)throw new fe({functionality:"tools"});if(e.toolChoice)throw new fe({functionality:"toolChoice"});return {args:O,warnings:A}}case "object-json":throw new fe({functionality:"object-json mode"});case "object-tool":throw new fe({functionality:"object-tool mode"});default:{let x=S;throw new Error(`Unsupported type: ${x}`)}}}doGenerate(e){return E(this,null,function*(){let{args:t,warnings:r}=this.getArgs(e),{responseHeaders:n,value:o,rawValue:s}=yield Qe({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Le(this.config.headers(),e.headers),body:t,failedResponseHandler:Nt,successfulResponseHandler:ht(Cm),abortSignal:e.abortSignal,fetch:this.config.fetch}),p=t,{prompt:a}=p,i=Ge(p,["prompt"]),u=o.choices[0];return {text:u.text,usage:{promptTokens:o.usage.prompt_tokens,completionTokens:o.usage.completion_tokens},finishReason:$o(u.finish_reason),logprobs:Du(u.logprobs),rawCall:{rawPrompt:a,rawSettings:i},rawResponse:{headers:n,body:s},response:qo(o),warnings:r,request:{body:JSON.stringify(t)}}})}doStream(e){return E(this,null,function*(){let{args:t,warnings:r}=this.getArgs(e),n=g(d({},t),{stream:true,stream_options:this.config.compatibility==="strict"?{include_usage:true}:void 0}),{responseHeaders:o,value:s}=yield Qe({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Le(this.config.headers(),e.headers),body:n,failedResponseHandler:Nt,successfulResponseHandler:Jr(jm),abortSignal:e.abortSignal,fetch:this.config.fetch}),_=t,{prompt:a}=_,i=Ge(_,["prompt"]),u="unknown",p={promptTokens:Number.NaN,completionTokens:Number.NaN},h,m=true;return {stream:s.pipeThrough(new TransformStream({transform(S,A){if(!S.success){u="error",A.enqueue({type:"error",error:S.error});return}let C=S.value;if("error"in C){u="error",A.enqueue({type:"error",error:C.error});return}m&&(m=false,A.enqueue(d({type:"response-metadata"},qo(C)))),C.usage!=null&&(p={promptTokens:C.usage.prompt_tokens,completionTokens:C.usage.completion_tokens});let b=C.choices[0];(b==null?void 0:b.finish_reason)!=null&&(u=$o(b.finish_reason)),(b==null?void 0:b.text)!=null&&A.enqueue({type:"text-delta",textDelta:b.text});let T=Du(b==null?void 0:b.logprobs);T!=null&&T.length&&(h===void 0&&(h=[]),h.push(...T));},flush(S){S.enqueue({type:"finish",finishReason:u,logprobs:h,usage:p});}})),rawCall:{rawPrompt:a,rawSettings:i},rawResponse:{headers:o},warnings:r,request:{body:JSON.stringify(n)}}})}},Cm=l.object({id:l.string().nullish(),created:l.number().nullish(),model:l.string().nullish(),choices:l.array(l.object({text:l.string(),finish_reason:l.string(),logprobs:l.object({tokens:l.array(l.string()),token_logprobs:l.array(l.number()),top_logprobs:l.array(l.record(l.string(),l.number())).nullable()}).nullish()})),usage:l.object({prompt_tokens:l.number(),completion_tokens:l.number()})}),jm=l.union([l.object({id:l.string().nullish(),created:l.number().nullish(),model:l.string().nullish(),choices:l.array(l.object({text:l.string(),finish_reason:l.string().nullish(),index:l.number(),logprobs:l.object({tokens:l.array(l.string()),token_logprobs:l.array(l.number()),top_logprobs:l.array(l.record(l.string(),l.number())).nullable()}).nullish()})),usage:l.object({prompt_tokens:l.number(),completion_tokens:l.number()}).nullish()}),Zs]),Om=class{constructor(e,t,r){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=r;}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){var e;return (e=this.settings.maxEmbeddingsPerCall)!=null?e:2048}get supportsParallelCalls(){var e;return (e=this.settings.supportsParallelCalls)!=null?e:true}doEmbed(n){return E(this,arguments,function*({values:e,headers:t,abortSignal:r}){if(e.length>this.maxEmbeddingsPerCall)throw new ri({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:e});let{responseHeaders:o,value:s}=yield Qe({url:this.config.url({path:"/embeddings",modelId:this.modelId}),headers:Le(this.config.headers(),t),body:{model:this.modelId,input:e,encoding_format:"float",dimensions:this.settings.dimensions,user:this.settings.user},failedResponseHandler:Nt,successfulResponseHandler:ht(Pm),abortSignal:r,fetch:this.config.fetch});return {embeddings:s.data.map(a=>a.embedding),usage:s.usage?{tokens:s.usage.prompt_tokens}:void 0,rawResponse:{headers:o}}})}},Pm=l.object({data:l.array(l.object({embedding:l.array(l.number())})),usage:l.object({prompt_tokens:l.number()}).nullish()}),Mm={"dall-e-3":1,"dall-e-2":10,"gpt-image-1":10},Nm=new Set(["gpt-image-1"]),Dm=class{constructor(e,t,r){this.modelId=e,this.settings=t,this.config=r,this.specificationVersion="v1";}get maxImagesPerCall(){var e,t;return (t=(e=this.settings.maxImagesPerCall)!=null?e:Mm[this.modelId])!=null?t:1}get provider(){return this.config.provider}doGenerate(u){return E(this,arguments,function*({prompt:e,n:t,size:r,aspectRatio:n,seed:o,providerOptions:s,headers:a,abortSignal:i}){var p,h,m,_;let S=[];n!=null&&S.push({type:"unsupported-setting",setting:"aspectRatio",details:"This model does not support aspect ratio. Use `size` instead."}),o!=null&&S.push({type:"unsupported-setting",setting:"seed"});let A=(m=(h=(p=this.config._internal)==null?void 0:p.currentDate)==null?void 0:h.call(p))!=null?m:new Date,{value:C,responseHeaders:b}=yield Qe({url:this.config.url({path:"/images/generations",modelId:this.modelId}),headers:Le(this.config.headers(),a),body:d(d({model:this.modelId,prompt:e,n:t,size:r},(_=s.openai)!=null?_:{}),Nm.has(this.modelId)?{}:{response_format:"b64_json"}),failedResponseHandler:Nt,successfulResponseHandler:ht(Fm),abortSignal:i,fetch:this.config.fetch});return {images:C.data.map(T=>T.b64_json),warnings:S,response:{timestamp:A,modelId:this.modelId,headers:b}}})}},Fm=l.object({data:l.array(l.object({b64_json:l.string()}))}),Um=l.object({include:l.array(l.string()).nullish(),language:l.string().nullish(),prompt:l.string().nullish(),temperature:l.number().min(0).max(1).nullish().default(0),timestampGranularities:l.array(l.enum(["word","segment"])).nullish().default(["segment"])}),Fu={afrikaans:"af",arabic:"ar",armenian:"hy",azerbaijani:"az",belarusian:"be",bosnian:"bs",bulgarian:"bg",catalan:"ca",chinese:"zh",croatian:"hr",czech:"cs",danish:"da",dutch:"nl",english:"en",estonian:"et",finnish:"fi",french:"fr",galician:"gl",german:"de",greek:"el",hebrew:"he",hindi:"hi",hungarian:"hu",icelandic:"is",indonesian:"id",italian:"it",japanese:"ja",kannada:"kn",kazakh:"kk",korean:"ko",latvian:"lv",lithuanian:"lt",macedonian:"mk",malay:"ms",marathi:"mr",maori:"mi",nepali:"ne",norwegian:"no",persian:"fa",polish:"pl",portuguese:"pt",romanian:"ro",russian:"ru",serbian:"sr",slovak:"sk",slovenian:"sl",spanish:"es",swahili:"sw",swedish:"sv",tagalog:"tl",tamil:"ta",thai:"th",turkish:"tr",ukrainian:"uk",urdu:"ur",vietnamese:"vi",welsh:"cy"},$m=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v1";}get provider(){return this.config.provider}getArgs({audio:e,mediaType:t,providerOptions:r}){var n,o,s,a,i;let u=[],p=Zr({provider:"openai",providerOptions:r,schema:Um}),h=new FormData,m=e instanceof Uint8Array?new Blob([e]):new Blob([nr(e)]);if(h.append("model",this.modelId),h.append("file",new File([m],"audio",{type:t})),p){let _={include:(n=p.include)!=null?n:void 0,language:(o=p.language)!=null?o:void 0,prompt:(s=p.prompt)!=null?s:void 0,temperature:(a=p.temperature)!=null?a:void 0,timestamp_granularities:(i=p.timestampGranularities)!=null?i:void 0};for(let S in _){let A=_[S];A!==void 0&&h.append(S,String(A));}}return {formData:h,warnings:u}}doGenerate(e){return E(this,null,function*(){var t,r,n,o,s,a;let i=(n=(r=(t=this.config._internal)==null?void 0:t.currentDate)==null?void 0:r.call(t))!=null?n:new Date,{formData:u,warnings:p}=this.getArgs(e),{value:h,responseHeaders:m,rawValue:_}=yield _i({url:this.config.url({path:"/audio/transcriptions",modelId:this.modelId}),headers:Le(this.config.headers(),e.headers),formData:u,failedResponseHandler:Nt,successfulResponseHandler:ht(qm),abortSignal:e.abortSignal,fetch:this.config.fetch}),S=h.language!=null&&h.language in Fu?Fu[h.language]:void 0;return {text:h.text,segments:(s=(o=h.words)==null?void 0:o.map(A=>({text:A.word,startSecond:A.start,endSecond:A.end})))!=null?s:[],language:S,durationInSeconds:(a=h.duration)!=null?a:void 0,warnings:p,response:{timestamp:i,modelId:this.modelId,headers:m,body:_}}})}},qm=l.object({text:l.string(),language:l.string().nullish(),duration:l.number().nullish(),words:l.array(l.object({word:l.string(),start:l.number(),end:l.number()})).nullish()});function Bm({prompt:e,systemMessageMode:t}){let r=[],n=[];for(let{role:o,content:s}of e)switch(o){case "system":{switch(t){case "system":{r.push({role:"system",content:s});break}case "developer":{r.push({role:"developer",content:s});break}case "remove":{n.push({type:"other",message:"system messages are removed for this model"});break}default:{let a=t;throw new Error(`Unsupported system message mode: ${a}`)}}break}case "user":{r.push({role:"user",content:s.map((a,i)=>{var u,p,h,m;switch(a.type){case "text":return {type:"input_text",text:a.text};case "image":return {type:"input_image",image_url:a.image instanceof URL?a.image.toString():`data:${(u=a.mimeType)!=null?u:"image/jpeg"};base64,${Vt(a.image)}`,detail:(h=(p=a.providerMetadata)==null?void 0:p.openai)==null?void 0:h.imageDetail};case "file":{if(a.data instanceof URL)throw new fe({functionality:"File URLs in user messages"});switch(a.mimeType){case "application/pdf":return {type:"input_file",filename:(m=a.filename)!=null?m:`part-${i}.pdf`,file_data:`data:application/pdf;base64,${a.data}`};default:throw new fe({functionality:"Only PDF files are supported in user messages"})}}}})});break}case "assistant":{for(let a of s)switch(a.type){case "text":{r.push({role:"assistant",content:[{type:"output_text",text:a.text}]});break}case "tool-call":{r.push({type:"function_call",call_id:a.toolCallId,name:a.toolName,arguments:JSON.stringify(a.args)});break}}break}case "tool":{for(let a of s)r.push({type:"function_call_output",call_id:a.toolCallId,output:JSON.stringify(a.result)});break}default:{let a=o;throw new Error(`Unsupported role: ${a}`)}}return {messages:r,warnings:n}}function Uu({finishReason:e,hasToolCalls:t}){switch(e){case void 0:case null:return t?"tool-calls":"stop";case "max_output_tokens":return "length";case "content_filter":return "content-filter";default:return t?"tool-calls":"unknown"}}function zm({mode:e,strict:t}){var r;let n=(r=e.tools)!=null&&r.length?e.tools:void 0,o=[];if(n==null)return {tools:void 0,tool_choice:void 0,toolWarnings:o};let s=e.toolChoice,a=[];for(let u of n)switch(u.type){case "function":a.push({type:"function",name:u.name,description:u.description,parameters:u.parameters,strict:t?true:void 0});break;case "provider-defined":switch(u.id){case "openai.web_search_preview":a.push({type:"web_search_preview",search_context_size:u.args.searchContextSize,user_location:u.args.userLocation});break;default:o.push({type:"unsupported-tool",tool:u});break}break;default:o.push({type:"unsupported-tool",tool:u});break}if(s==null)return {tools:a,tool_choice:void 0,toolWarnings:o};let i=s.type;switch(i){case "auto":case "none":case "required":return {tools:a,tool_choice:i,toolWarnings:o};case "tool":return s.toolName==="web_search_preview"?{tools:a,tool_choice:{type:"web_search_preview"},toolWarnings:o}:{tools:a,tool_choice:{type:"function",name:s.toolName},toolWarnings:o};default:{let u=i;throw new fe({functionality:`Unsupported tool choice type: ${u}`})}}}var Lm=class{constructor(e,t){this.specificationVersion="v1",this.defaultObjectGenerationMode="json",this.supportsStructuredOutputs=true,this.modelId=e,this.config=t;}get provider(){return this.config.provider}getArgs({mode:e,maxTokens:t,temperature:r,stopSequences:n,topP:o,topK:s,presencePenalty:a,frequencyPenalty:i,seed:u,prompt:p,providerMetadata:h,responseFormat:m}){var _,S,A;let C=[],b=ig(this.modelId),T=e.type;s!=null&&C.push({type:"unsupported-setting",setting:"topK"}),u!=null&&C.push({type:"unsupported-setting",setting:"seed"}),a!=null&&C.push({type:"unsupported-setting",setting:"presencePenalty"}),i!=null&&C.push({type:"unsupported-setting",setting:"frequencyPenalty"}),n!=null&&C.push({type:"unsupported-setting",setting:"stopSequences"});let{messages:O,warnings:x}=Bm({prompt:p,systemMessageMode:b.systemMessageMode});C.push(...x);let F=Zr({provider:"openai",providerOptions:h,schema:lg}),U=(_=F==null?void 0:F.strictSchemas)!=null?_:true,M=d(d(g(d({model:this.modelId,input:O,temperature:r,top_p:o,max_output_tokens:t},(m==null?void 0:m.type)==="json"&&{text:{format:m.schema!=null?{type:"json_schema",strict:U,name:(S=m.name)!=null?S:"response",description:m.description,schema:m.schema}:{type:"json_object"}}}),{metadata:F==null?void 0:F.metadata,parallel_tool_calls:F==null?void 0:F.parallelToolCalls,previous_response_id:F==null?void 0:F.previousResponseId,store:F==null?void 0:F.store,user:F==null?void 0:F.user,instructions:F==null?void 0:F.instructions}),b.isReasoningModel&&((F==null?void 0:F.reasoningEffort)!=null||(F==null?void 0:F.reasoningSummary)!=null)&&{reasoning:d(d({},(F==null?void 0:F.reasoningEffort)!=null&&{effort:F.reasoningEffort}),(F==null?void 0:F.reasoningSummary)!=null&&{summary:F.reasoningSummary})}),b.requiredAutoTruncation&&{truncation:"auto"});switch(b.isReasoningModel&&(M.temperature!=null&&(M.temperature=void 0,C.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for reasoning models"})),M.top_p!=null&&(M.top_p=void 0,C.push({type:"unsupported-setting",setting:"topP",details:"topP is not supported for reasoning models"}))),T){case "regular":{let{tools:ne,tool_choice:N,toolWarnings:L}=zm({mode:e,strict:U});return {args:g(d({},M),{tools:ne,tool_choice:N}),warnings:[...C,...L]}}case "object-json":return {args:g(d({},M),{text:{format:e.schema!=null?{type:"json_schema",strict:U,name:(A=e.name)!=null?A:"response",description:e.description,schema:e.schema}:{type:"json_object"}}}),warnings:C};case "object-tool":return {args:g(d({},M),{tool_choice:{type:"function",name:e.tool.name},tools:[{type:"function",name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters,strict:U}]}),warnings:C};default:{let ne=T;throw new Error(`Unsupported type: ${ne}`)}}}doGenerate(e){return E(this,null,function*(){var t,r,n,o,s,a,i;let{args:u,warnings:p}=this.getArgs(e),{responseHeaders:h,value:m,rawValue:_}=yield Qe({url:this.config.url({path:"/responses",modelId:this.modelId}),headers:Le(this.config.headers(),e.headers),body:u,failedResponseHandler:Nt,successfulResponseHandler:ht(l.object({id:l.string(),created_at:l.number(),model:l.string(),output:l.array(l.discriminatedUnion("type",[l.object({type:l.literal("message"),role:l.literal("assistant"),content:l.array(l.object({type:l.literal("output_text"),text:l.string(),annotations:l.array(l.object({type:l.literal("url_citation"),start_index:l.number(),end_index:l.number(),url:l.string(),title:l.string()}))}))}),l.object({type:l.literal("function_call"),call_id:l.string(),name:l.string(),arguments:l.string()}),l.object({type:l.literal("web_search_call")}),l.object({type:l.literal("computer_call")}),l.object({type:l.literal("reasoning"),summary:l.array(l.object({type:l.literal("summary_text"),text:l.string()}))})])),incomplete_details:l.object({reason:l.string()}).nullable(),usage:qu})),abortSignal:e.abortSignal,fetch:this.config.fetch}),S=m.output.filter(b=>b.type==="message").flatMap(b=>b.content).filter(b=>b.type==="output_text"),A=m.output.filter(b=>b.type==="function_call").map(b=>({toolCallType:"function",toolCallId:b.call_id,toolName:b.name,args:b.arguments})),C=(r=(t=m.output.find(b=>b.type==="reasoning"))==null?void 0:t.summary)!=null?r:null;return {text:S.map(b=>b.text).join(`
`),sources:S.flatMap(b=>b.annotations.map(T=>{var O,x,F;return {sourceType:"url",id:(F=(x=(O=this.config).generateId)==null?void 0:x.call(O))!=null?F:ft(),url:T.url,title:T.title}})),finishReason:Uu({finishReason:(n=m.incomplete_details)==null?void 0:n.reason,hasToolCalls:A.length>0}),toolCalls:A.length>0?A:void 0,reasoning:C?C.map(b=>({type:"text",text:b.text})):void 0,usage:{promptTokens:m.usage.input_tokens,completionTokens:m.usage.output_tokens},rawCall:{rawPrompt:void 0,rawSettings:{}},rawResponse:{headers:h,body:_},request:{body:JSON.stringify(u)},response:{id:m.id,timestamp:new Date(m.created_at*1e3),modelId:m.model},providerMetadata:{openai:{responseId:m.id,cachedPromptTokens:(s=(o=m.usage.input_tokens_details)==null?void 0:o.cached_tokens)!=null?s:null,reasoningTokens:(i=(a=m.usage.output_tokens_details)==null?void 0:a.reasoning_tokens)!=null?i:null}},warnings:p}})}doStream(e){return E(this,null,function*(){let{args:t,warnings:r}=this.getArgs(e),{responseHeaders:n,value:o}=yield Qe({url:this.config.url({path:"/responses",modelId:this.modelId}),headers:Le(this.config.headers(),e.headers),body:g(d({},t),{stream:true}),failedResponseHandler:Nt,successfulResponseHandler:Jr(Xm),abortSignal:e.abortSignal,fetch:this.config.fetch}),s=this,a="unknown",i=NaN,u=NaN,p=null,h=null,m=null,_={},S=false;return {stream:o.pipeThrough(new TransformStream({transform(A,C){var b,T,O,x,F,U,M,ne;if(!A.success){a="error",C.enqueue({type:"error",error:A.error});return}let N=A.value;if(og(N))N.item.type==="function_call"&&(_[N.output_index]={toolName:N.item.name,toolCallId:N.item.call_id},C.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:N.item.call_id,toolName:N.item.name,argsTextDelta:N.item.arguments}));else if(ng(N)){let L=_[N.output_index];L!=null&&C.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:L.toolCallId,toolName:L.toolName,argsTextDelta:N.delta});}else rg(N)?(m=N.response.id,C.enqueue({type:"response-metadata",id:N.response.id,timestamp:new Date(N.response.created_at*1e3),modelId:N.response.model})):Qm(N)?C.enqueue({type:"text-delta",textDelta:N.delta}):ag(N)?C.enqueue({type:"reasoning",textDelta:N.delta}):eg(N)&&N.item.type==="function_call"?(_[N.output_index]=void 0,S=true,C.enqueue({type:"tool-call",toolCallType:"function",toolCallId:N.item.call_id,toolName:N.item.name,args:N.item.arguments})):tg(N)?(a=Uu({finishReason:(b=N.response.incomplete_details)==null?void 0:b.reason,hasToolCalls:S}),i=N.response.usage.input_tokens,u=N.response.usage.output_tokens,p=(O=(T=N.response.usage.input_tokens_details)==null?void 0:T.cached_tokens)!=null?O:p,h=(F=(x=N.response.usage.output_tokens_details)==null?void 0:x.reasoning_tokens)!=null?F:h):sg(N)&&C.enqueue({type:"source",source:{sourceType:"url",id:(ne=(M=(U=s.config).generateId)==null?void 0:M.call(U))!=null?ne:ft(),url:N.annotation.url,title:N.annotation.title}});},flush(A){A.enqueue(d({type:"finish",finishReason:a,usage:{promptTokens:i,completionTokens:u}},(p!=null||h!=null)&&{providerMetadata:{openai:{responseId:m,cachedPromptTokens:p,reasoningTokens:h}}}));}})),rawCall:{rawPrompt:void 0,rawSettings:{}},rawResponse:{headers:n},request:{body:JSON.stringify(t)},warnings:r}})}},qu=l.object({input_tokens:l.number(),input_tokens_details:l.object({cached_tokens:l.number().nullish()}).nullish(),output_tokens:l.number(),output_tokens_details:l.object({reasoning_tokens:l.number().nullish()}).nullish()}),Vm=l.object({type:l.literal("response.output_text.delta"),delta:l.string()}),Zm=l.object({type:l.enum(["response.completed","response.incomplete"]),response:l.object({incomplete_details:l.object({reason:l.string()}).nullish(),usage:qu})}),Jm=l.object({type:l.literal("response.created"),response:l.object({id:l.string(),created_at:l.number(),model:l.string()})}),Wm=l.object({type:l.literal("response.output_item.done"),output_index:l.number(),item:l.discriminatedUnion("type",[l.object({type:l.literal("message")}),l.object({type:l.literal("function_call"),id:l.string(),call_id:l.string(),name:l.string(),arguments:l.string(),status:l.literal("completed")})])}),Gm=l.object({type:l.literal("response.function_call_arguments.delta"),item_id:l.string(),output_index:l.number(),delta:l.string()}),Hm=l.object({type:l.literal("response.output_item.added"),output_index:l.number(),item:l.discriminatedUnion("type",[l.object({type:l.literal("message")}),l.object({type:l.literal("function_call"),id:l.string(),call_id:l.string(),name:l.string(),arguments:l.string()})])}),Km=l.object({type:l.literal("response.output_text.annotation.added"),annotation:l.object({type:l.literal("url_citation"),url:l.string(),title:l.string()})}),Ym=l.object({type:l.literal("response.reasoning_summary_text.delta"),item_id:l.string(),output_index:l.number(),summary_index:l.number(),delta:l.string()}),Xm=l.union([Vm,Zm,Jm,Wm,Gm,Hm,Km,Ym,l.object({type:l.string()}).passthrough()]);function Qm(e){return e.type==="response.output_text.delta"}function eg(e){return e.type==="response.output_item.done"}function tg(e){return e.type==="response.completed"||e.type==="response.incomplete"}function rg(e){return e.type==="response.created"}function ng(e){return e.type==="response.function_call_arguments.delta"}function og(e){return e.type==="response.output_item.added"}function sg(e){return e.type==="response.output_text.annotation.added"}function ag(e){return e.type==="response.reasoning_summary_text.delta"}function ig(e){return e.startsWith("o")?e.startsWith("o1-mini")||e.startsWith("o1-preview")?{isReasoningModel:true,systemMessageMode:"remove",requiredAutoTruncation:false}:{isReasoningModel:true,systemMessageMode:"developer",requiredAutoTruncation:false}:{isReasoningModel:false,systemMessageMode:"system",requiredAutoTruncation:false}}var lg=l.object({metadata:l.any().nullish(),parallelToolCalls:l.boolean().nullish(),previousResponseId:l.string().nullish(),store:l.boolean().nullish(),user:l.string().nullish(),reasoningEffort:l.string().nullish(),strictSchemas:l.boolean().nullish(),instructions:l.string().nullish(),reasoningSummary:l.string().nullish()}),ug=l.object({});function pg({searchContextSize:e,userLocation:t}={}){return {type:"provider-defined",id:"openai.web_search_preview",args:{searchContextSize:e,userLocation:t},parameters:ug}}var cg={webSearchPreview:pg},dg=l.object({instructions:l.string().nullish(),speed:l.number().min(.25).max(4).default(1).nullish()}),fg=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v1";}get provider(){return this.config.provider}getArgs({text:e,voice:t="alloy",outputFormat:r="mp3",speed:n,instructions:o,providerOptions:s}){let a=[],i=Zr({provider:"openai",providerOptions:s,schema:dg}),u={model:this.modelId,input:e,voice:t,response_format:"mp3",speed:n,instructions:o};if(r&&(["mp3","opus","aac","flac","wav","pcm"].includes(r)?u.response_format=r:a.push({type:"unsupported-setting",setting:"outputFormat",details:`Unsupported output format: ${r}. Using mp3 instead.`})),i){let p={};for(let h in p){let m=p[h];m!==void 0&&(u[h]=m);}}return {requestBody:u,warnings:a}}doGenerate(e){return E(this,null,function*(){var t,r,n;let o=(n=(r=(t=this.config._internal)==null?void 0:t.currentDate)==null?void 0:r.call(t))!=null?n:new Date,{requestBody:s,warnings:a}=this.getArgs(e),{value:i,responseHeaders:u,rawValue:p}=yield Qe({url:this.config.url({path:"/audio/speech",modelId:this.modelId}),headers:Le(this.config.headers(),e.headers),body:s,failedResponseHandler:Nt,successfulResponseHandler:xi(),abortSignal:e.abortSignal,fetch:this.config.fetch});return {audio:i,warnings:a,request:{body:JSON.stringify(s)},response:{timestamp:o,modelId:this.modelId,headers:u,body:p}}})}};function Js(e={}){var t,r,n;let o=(t=Si(e.baseURL))!=null?t:"https://api.openai.com/v1",s=(r=e.compatibility)!=null?r:"compatible",a=(n=e.name)!=null?n:"openai",i=()=>d({Authorization:`Bearer ${vi({apiKey:e.apiKey,environmentVariableName:"OPENAI_API_KEY",description:"OpenAI"})}`,"OpenAI-Organization":e.organization,"OpenAI-Project":e.project},e.headers),u=(T,O={})=>new xm(T,O,{provider:`${a}.chat`,url:({path:x})=>`${o}${x}`,headers:i,compatibility:s,fetch:e.fetch}),p=(T,O={})=>new Rm(T,O,{provider:`${a}.completion`,url:({path:x})=>`${o}${x}`,headers:i,compatibility:s,fetch:e.fetch}),h=(T,O={})=>new Om(T,O,{provider:`${a}.embedding`,url:({path:x})=>`${o}${x}`,headers:i,fetch:e.fetch}),m=(T,O={})=>new Dm(T,O,{provider:`${a}.image`,url:({path:x})=>`${o}${x}`,headers:i,fetch:e.fetch}),_=T=>new $m(T,{provider:`${a}.transcription`,url:({path:O})=>`${o}${O}`,headers:i,fetch:e.fetch}),S=T=>new fg(T,{provider:`${a}.speech`,url:({path:O})=>`${o}${O}`,headers:i,fetch:e.fetch}),A=(T,O)=>{if(new.target)throw new Error("The OpenAI model function cannot be called with the new keyword.");return T==="gpt-3.5-turbo-instruct"?p(T,O):u(T,O)},C=T=>new Lm(T,{provider:`${a}.responses`,url:({path:O})=>`${o}${O}`,headers:i,fetch:e.fetch}),b=function(T,O){return A(T,O)};return b.languageModel=A,b.chat=u,b.completion=p,b.responses=C,b.embedding=h,b.textEmbedding=h,b.textEmbeddingModel=h,b.image=m,b.imageModel=m,b.transcription=_,b.transcriptionModel=_,b.speech=S,b.speechModel=S,b.tools=cg,b}Js({compatibility:"strict"});var z=ha(wp());var Qo,eo=class eo extends z.Message{constructor(r){super();Nr(this,Qo,[]);z.Message.initialize(this,Array.isArray(r)?r:[],0,-1,[],jt(this,Qo)),!Array.isArray(r)&&typeof r=="object"&&("name"in r&&r.name!=null&&(this.name=r.name),"mime_type"in r&&r.mime_type!=null&&(this.mime_type=r.mime_type),"data"in r&&r.data!=null&&(this.data=r.data));}get name(){return z.Message.getFieldWithDefault(this,1,"")}set name(r){z.Message.setField(this,1,r);}get mime_type(){return z.Message.getFieldWithDefault(this,2,"")}set mime_type(r){z.Message.setField(this,2,r);}get data(){return z.Message.getFieldWithDefault(this,3,new Uint8Array(0))}set data(r){z.Message.setField(this,3,r);}static fromObject(r){let n=new eo({});return r.name!=null&&(n.name=r.name),r.mime_type!=null&&(n.mime_type=r.mime_type),r.data!=null&&(n.data=r.data),n}toObject(){let r={};return this.name!=null&&(r.name=this.name),this.mime_type!=null&&(r.mime_type=this.mime_type),this.data!=null&&(r.data=this.data),r}serialize(r){let n=r||new z.BinaryWriter;if(this.name.length&&n.writeString(1,this.name),this.mime_type.length&&n.writeString(2,this.mime_type),this.data.length&&n.writeBytes(3,this.data),!r)return n.getResultBuffer()}static deserialize(r){let n=r instanceof z.BinaryReader?r:new z.BinaryReader(r),o=new eo;for(;n.nextField()&&!n.isEndGroup();)switch(n.getFieldNumber()){case 1:o.name=n.readString();break;case 2:o.mime_type=n.readString();break;case 3:o.data=n.readBytes();break;default:n.skipField();}return o}serializeBinary(){return this.serialize()}static deserializeBinary(r){return eo.deserialize(r)}};Qo=new WeakMap;var Xn=eo;var es,to=class to extends z.Message{constructor(r){super();Nr(this,es,[]);z.Message.initialize(this,Array.isArray(r)?r:[],0,-1,[2],jt(this,es)),!Array.isArray(r)&&typeof r=="object"&&("role"in r&&r.role!=null&&(this.role=r.role),"content"in r&&r.content!=null&&(this.content=r.content));}get role(){return z.Message.getFieldWithDefault(this,1,"")}set role(r){z.Message.setField(this,1,r);}get content(){return z.Message.getRepeatedWrapperField(this,an,2)}set content(r){z.Message.setRepeatedWrapperField(this,2,r);}static fromObject(r){let n=new to({});return r.role!=null&&(n.role=r.role),r.content!=null&&(n.content=r.content.map(o=>an.fromObject(o))),n}toObject(){let r={};return this.role!=null&&(r.role=this.role),this.content!=null&&(r.content=this.content.map(n=>n.toObject())),r}serialize(r){let n=r||new z.BinaryWriter;if(this.role.length&&n.writeString(1,this.role),this.content.length&&n.writeRepeatedMessage(2,this.content,o=>o.serialize(n)),!r)return n.getResultBuffer()}static deserialize(r){let n=r instanceof z.BinaryReader?r:new z.BinaryReader(r),o=new to;for(;n.nextField()&&!n.isEndGroup();)switch(n.getFieldNumber()){case 1:o.role=n.readString();break;case 2:n.readMessage(o.content,()=>z.Message.addToRepeatedWrapperField(o,2,an.deserialize(n),an));break;default:n.skipField();}return o}serializeBinary(){return this.serialize()}static deserializeBinary(r){return to.deserialize(r)}};es=new WeakMap;var sn=to,ts,ro=class ro extends z.Message{constructor(r){super();Nr(this,ts,[]);z.Message.initialize(this,Array.isArray(r)?r:[],0,-1,[1],jt(this,ts)),!Array.isArray(r)&&typeof r=="object"&&"messages"in r&&r.messages!=null&&(this.messages=r.messages);}get messages(){return z.Message.getRepeatedWrapperField(this,sn,1)}set messages(r){z.Message.setRepeatedWrapperField(this,1,r);}static fromObject(r){let n=new ro({});return r.messages!=null&&(n.messages=r.messages.map(o=>sn.fromObject(o))),n}toObject(){let r={};return this.messages!=null&&(r.messages=this.messages.map(n=>n.toObject())),r}serialize(r){let n=r||new z.BinaryWriter;if(this.messages.length&&n.writeRepeatedMessage(1,this.messages,o=>o.serialize(n)),!r)return n.getResultBuffer()}static deserialize(r){let n=r instanceof z.BinaryReader?r:new z.BinaryReader(r),o=new ro;for(;n.nextField()&&!n.isEndGroup();)switch(n.getFieldNumber()){case 1:n.readMessage(o.messages,()=>z.Message.addToRepeatedWrapperField(o,1,sn.deserialize(n),sn));break;default:n.skipField();}return o}serializeBinary(){return this.serialize()}static deserializeBinary(r){return ro.deserialize(r)}};ts=new WeakMap;var Qn=ro,ln,no=class no extends z.Message{constructor(r){super();Nr(this,ln,[[1,2]]);z.Message.initialize(this,Array.isArray(r)?r:[],0,-1,[],jt(this,ln)),!Array.isArray(r)&&typeof r=="object"&&("text"in r&&r.text!=null&&(this.text=r.text),"file"in r&&r.file!=null&&(this.file=r.file));}get text(){return z.Message.getFieldWithDefault(this,1,"")}set text(r){z.Message.setOneofField(this,1,jt(this,ln)[0],r);}get has_text(){return z.Message.getField(this,1)!=null}get file(){return z.Message.getWrapperField(this,Xn,2)}set file(r){z.Message.setOneofWrapperField(this,2,jt(this,ln)[0],r);}get has_file(){return z.Message.getField(this,2)!=null}get input(){return {0:"none",1:"text",2:"file"}[z.Message.computeOneofCase(this,[1,2])]}static fromObject(r){let n=new no({});return r.text!=null&&(n.text=r.text),r.file!=null&&(n.file=Xn.fromObject(r.file)),n}toObject(){let r={};return this.text!=null&&(r.text=this.text),this.file!=null&&(r.file=this.file.toObject()),r}serialize(r){let n=r||new z.BinaryWriter;if(this.has_text&&n.writeString(1,this.text),this.has_file&&n.writeMessage(2,this.file,()=>this.file.serialize(n)),!r)return n.getResultBuffer()}static deserialize(r){let n=r instanceof z.BinaryReader?r:new z.BinaryReader(r),o=new no;for(;n.nextField()&&!n.isEndGroup();)switch(n.getFieldNumber()){case 1:o.text=n.readString();break;case 2:n.readMessage(o.file,()=>o.file=Xn.deserialize(n));break;default:n.skipField();}return o}serializeBinary(){return this.serialize()}static deserializeBinary(r){return no.deserialize(r)}};ln=new WeakMap;var an=no,un,oo=class oo extends z.Message{constructor(r){super();Nr(this,un,[[1,2]]);z.Message.initialize(this,Array.isArray(r)?r:[],0,-1,[],jt(this,un)),!Array.isArray(r)&&typeof r=="object"&&("prompt"in r&&r.prompt!=null&&(this.prompt=r.prompt),"messages"in r&&r.messages!=null&&(this.messages=r.messages));}get prompt(){return z.Message.getFieldWithDefault(this,1,"")}set prompt(r){z.Message.setOneofField(this,1,jt(this,un)[0],r);}get has_prompt(){return z.Message.getField(this,1)!=null}get messages(){return z.Message.getWrapperField(this,Qn,2)}set messages(r){z.Message.setOneofWrapperField(this,2,jt(this,un)[0],r);}get has_messages(){return z.Message.getField(this,2)!=null}get input(){return {0:"none",1:"prompt",2:"messages"}[z.Message.computeOneofCase(this,[1,2])]}static fromObject(r){let n=new oo({});return r.prompt!=null&&(n.prompt=r.prompt),r.messages!=null&&(n.messages=Qn.fromObject(r.messages)),n}toObject(){let r={};return this.prompt!=null&&(r.prompt=this.prompt),this.messages!=null&&(r.messages=this.messages.toObject()),r}serialize(r){let n=r||new z.BinaryWriter;if(this.has_prompt&&n.writeString(1,this.prompt),this.has_messages&&n.writeMessage(2,this.messages,()=>this.messages.serialize(n)),!r)return n.getResultBuffer()}static deserialize(r){let n=r instanceof z.BinaryReader?r:new z.BinaryReader(r),o=new oo;for(;n.nextField()&&!n.isEndGroup();)switch(n.getFieldNumber()){case 1:o.prompt=n.readString();break;case 2:n.readMessage(o.messages,()=>o.messages=Qn.deserialize(n));break;default:n.skipField();}return o}serializeBinary(){return this.serialize()}static deserializeBinary(r){return oo.deserialize(r)}};un=new WeakMap;var Xo=oo;var Eg=(e,t,r,n,o)=>E(null,null,function*(){let s=e.openAI.chat(r,d({},t)),a=Xo.deserializeBinary(n),i=[];a.has_messages&&(i=a.messages.messages.map(m=>({role:m.role,content:m.content.map(_=>_.has_file?{type:"file",data:_.file.data,filename:_.file.name,mimeType:_.file.mime_type}:{type:"text",text:_.text})})));let u=i.length===0?$s({model:s,prompt:a.prompt}):$s({model:s,messages:i}),{text:p}=yield u,h=new TextEncoder().encode(p);Dart.send_value(o,h);}),Rg=(e,t,r,n)=>E(null,null,function*(){let o=Ou({model:e.openAI.responses(t),prompt:r});try{for(var s=uo(o.fullStream),a,i,u;a=!(i=yield s.next()).done;a=!1){let p=i.value;if(p.type==="reasoning"||p.type==="text-delta"){let h=new TextEncoder().encode(p.textDelta);Dart.stream_value(n,h);}}}catch(i){u=[i];}finally{try{a&&(i=s.return)&&(yield i.call(s));}finally{if(u)throw u[0]}}Dart.stream_value_end(n);}),Cg=(e,t,r,n,o)=>E(null,null,function*(){let s=xn.convert(n),a=yield ou({model:e.openAI.responses(t),schema:s,prompt:r}),i=JsonPayload.encode(a.object);if(!i){Dart.send_error(o,"Failed to encode object");return}Dart.send_value(o,i);}),jg=(e,t,r,n,o)=>E(null,null,function*(){let s=xn.convert(n),{fullStream:a}=yield iu({model:e.openAI.responses(t),schema:s,prompt:r});try{for(var i=uo(a),u,p,h;u=!(p=yield i.next()).done;u=!1){let m=p.value;if(m.type!="object")continue;let _=JsonPayload.encode(m.object);if(!_){Dart.send_error(o,"Failed to encode object");return}Dart.stream_value(o,_);}}catch(p){h=[p];}finally{try{u&&(p=i.return)&&(yield p.call(i));}finally{if(h)throw h[0]}}Dart.stream_value_end(o);}),Lx={init:e=>({openAI:Js({apiKey:e,compatibility:"strict"})}),functions:{openai_chat_generate_text:Eg,openai_chat_generate_object:Cg,openai_chat_stream_text:Rg,openai_chat_stream_object:jg}};
export{Lx as default};
''';
