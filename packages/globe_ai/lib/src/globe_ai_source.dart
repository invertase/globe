// GENERATED FILE â€” DO NOT MODIFY BY HAND
// This file was generated from package.json

const packageVersion = '1.0.0';

const packageSource = r'''
var ec=Object.create;var vs=Object.defineProperty,tc=Object.defineProperties,rc=Object.getOwnPropertyDescriptor,nc=Object.getOwnPropertyDescriptors,oc=Object.getOwnPropertyNames,vo=Object.getOwnPropertySymbols,sc=Object.getPrototypeOf,bs=Object.prototype.hasOwnProperty,ja=Object.prototype.propertyIsEnumerable;var Ca=(e,t)=>(t=Symbol[e])?t:Symbol.for("Symbol."+e),Oa=e=>{throw TypeError(e)};var Ra=(e,t,r)=>t in e?vs(e,t,{enumerable:true,configurable:true,writable:true,value:r}):e[t]=r,d=(e,t)=>{for(var r in t||(t={}))bs.call(t,r)&&Ra(e,r,t[r]);if(vo)for(var r of vo(t))ja.call(t,r)&&Ra(e,r,t[r]);return e},g=(e,t)=>tc(e,nc(t));var qe=(e,t)=>{var r={};for(var n in e)bs.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&vo)for(var n of vo(e))t.indexOf(n)<0&&ja.call(e,n)&&(r[n]=e[n]);return r};var Pa=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var ac=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of oc(t))!bs.call(e,o)&&o!==r&&vs(e,o,{get:()=>t[o],enumerable:!(n=rc(t,o))||n.enumerable});return e};var _s=(e,t,r)=>(r=e!=null?ec(sc(e)):{},ac(vs(r,"default",{value:e,enumerable:true}),e));var ic=(e,t,r)=>t.has(e)||Oa("Cannot "+r);var Pt=(e,t,r)=>(ic(e,t,"read from private field"),r?r.call(e):t.get(e)),Br=(e,t,r)=>t.has(e)?Oa("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r);var A=(e,t,r)=>new Promise((n,o)=>{var s=u=>{try{l(r.next(u));}catch(p){o(p);}},a=u=>{try{l(r.throw(u));}catch(p){o(p);}},l=u=>u.done?n(u.value):Promise.resolve(u.value).then(s,a);l((r=r.apply(e,t)).next());});var vr=(e,t,r)=>(t=e[Ca("asyncIterator")])?t.call(e):(e=e[Ca("iterator")](),t={},r=(n,o)=>(o=e[n])&&(t[n]=s=>new Promise((a,l,u)=>(s=o.call(e,s),u=s.done,Promise.resolve(s.value).then(p=>a({value:p,done:u}),l)))),r("next"),r("return"),t);var Ts=Pa((Yy,zr)=>{var Pc=typeof Buffer!="undefined",fi=/"(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])"\s*:/,hi=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/;function mi(e,t,r){r==null&&t!==null&&typeof t=="object"&&(r=t,t=void 0),Pc&&Buffer.isBuffer(e)&&(e=e.toString()),e&&e.charCodeAt(0)===65279&&(e=e.slice(1));let n=JSON.parse(e,t);if(n===null||typeof n!="object")return n;let o=r&&r.protoAction||"error",s=r&&r.constructorAction||"error";if(o==="ignore"&&s==="ignore")return n;if(o!=="ignore"&&s!=="ignore"){if(fi.test(e)===false&&hi.test(e)===false)return n}else if(o!=="ignore"&&s==="ignore"){if(fi.test(e)===false)return n}else if(hi.test(e)===false)return n;return gi(n,{protoAction:o,constructorAction:s,safe:r&&r.safe})}function gi(e,{protoAction:t="error",constructorAction:r="error",safe:n}={}){let o=[e];for(;o.length;){let s=o;o=[];for(let a of s){if(t!=="ignore"&&Object.prototype.hasOwnProperty.call(a,"__proto__")){if(n===true)return null;if(t==="error")throw new SyntaxError("Object contains forbidden prototype property");delete a.__proto__;}if(r!=="ignore"&&Object.prototype.hasOwnProperty.call(a,"constructor")&&Object.prototype.hasOwnProperty.call(a.constructor,"prototype")){if(n===true)return null;if(r==="error")throw new SyntaxError("Object contains forbidden prototype property");delete a.constructor;}for(let l in a){let u=a[l];u&&typeof u=="object"&&o.push(u);}}}return e}function Ss(e,t,r){let n=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return mi(e,t,r)}finally{Error.stackTraceLimit=n;}}function Mc(e,t){let r=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return mi(e,t,{safe:!0})}catch(n){return null}finally{Error.stackTraceLimit=r;}}zr.exports=Ss;zr.exports.default=Ss;zr.exports.parse=Ss;zr.exports.safeParse=Mc;zr.exports.scan=gi;});var Pp=Pa(Ge=>{var ca=typeof Object.defineProperties=="function"?Object.defineProperty:function(e,t,r){e!=Array.prototype&&e!=Object.prototype&&(e[t]=r.value);},Dr=typeof window!="undefined"&&window===Ge?Ge:typeof global!="undefined"&&global!=null?global:Ge;function Zg(e,t){if(t){var r=Dr;e=e.split(".");for(var n=0;n<e.length-1;n++){var o=e[n];o in r||(r[o]={}),r=r[o];}e=e[e.length-1],n=r[e],t=t(n),t!=n&&t!=null&&ca(r,e,{configurable:true,writable:true,value:t});}}function Gg(e){var t=0;return function(){return t<e.length?{done:false,value:e[t++]}:{done:true}}}function op(){op=function(){},Dr.Symbol||(Dr.Symbol=Hg);}function sp(e,t){this.a=e,ca(this,"description",{configurable:true,writable:true,value:t});}sp.prototype.toString=function(){return this.a};var Hg=function(){function e(r){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new sp("jscomp_symbol_"+(r||"")+"_"+t++,r)}var t=0;return e}();function da(){op();var e=Dr.Symbol.iterator;e||(e=Dr.Symbol.iterator=Dr.Symbol("Symbol.iterator")),typeof Array.prototype[e]!="function"&&ca(Array.prototype,e,{configurable:true,writable:true,value:function(){return Wg(Gg(this))}}),da=function(){};}function Wg(e){return da(),e={next:e},e[Dr.Symbol.iterator]=function(){return this},e}function Kg(e,t){da(),e instanceof String&&(e+="");var r=0,n={next:function(){if(r<e.length){var o=r++;return {value:t(o,e[o]),done:false}}return n.next=function(){return {done:true,value:void 0}},n.next()}};return n[Symbol.iterator]=function(){return n},n}Zg("Array.prototype.entries",function(e){return e||function(){return Kg(this,function(t,r){return [t,r]})}});var Yg=Ge||self;function $(e,t,r){e=e.split("."),r=r||Yg,e[0]in r||typeof r.execScript=="undefined"||r.execScript("var "+e[0]);for(var n;e.length&&(n=e.shift());)e.length||t===void 0?r[n]&&r[n]!==Object.prototype[n]?r=r[n]:r=r[n]={}:r[n]=t;}function Xt(e){var t=typeof e;if(t=="object")if(e){if(e instanceof Array)return "array";if(e instanceof Object)return t;var r=Object.prototype.toString.call(e);if(r=="[object Window]")return "object";if(r=="[object Array]"||typeof e.length=="number"&&typeof e.splice!="undefined"&&typeof e.propertyIsEnumerable!="undefined"&&!e.propertyIsEnumerable("splice"))return "array";if(r=="[object Function]"||typeof e.call!="undefined"&&typeof e.propertyIsEnumerable!="undefined"&&!e.propertyIsEnumerable("call"))return "function"}else return "null";else if(t=="function"&&typeof e.call=="undefined")return "object";return t}function Qu(e){var t=typeof e;return t=="object"&&e!=null||t=="function"}function Xg(e,t,r){$(e,t,r);}function Qg(e,t){function r(){}r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e;}var ep="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ey(e,t){for(var r,n,o=1;o<arguments.length;o++){n=arguments[o];for(r in n)e[r]=n[r];for(var s=0;s<ep.length;s++)r=ep[s],Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r]);}}var ty=Array.prototype.forEach?function(e,t){Array.prototype.forEach.call(e,t,void 0);}:function(e,t){for(var r=e.length,n=typeof e=="string"?e.split(""):e,o=0;o<r;o++)o in n&&t.call(void 0,n[o],o,e);},Kn=Array.prototype.map?function(e,t){return Array.prototype.map.call(e,t,void 0)}:function(e,t){for(var r=e.length,n=Array(r),o=typeof e=="string"?e.split(""):e,s=0;s<r;s++)s in o&&(n[s]=t.call(void 0,o[s],s,e));return n};function ry(e,t,r){return 2>=arguments.length?Array.prototype.slice.call(e,t):Array.prototype.slice.call(e,t,r)}function es(e,t,r,n){var o="Assertion failed";if(r){o+=": "+r;var s=n;}else e&&(o+=": "+e,s=t);throw Error(o,s||[])}function w(e,t,r){for(var n=[],o=2;o<arguments.length;++o)n[o-2]=arguments[o];return e||es("",null,t,n),e}function ny(e,t,r){for(var n=[],o=2;o<arguments.length;++o)n[o-2]=arguments[o];typeof e!="string"&&es("Expected string but got %s: %s.",[Xt(e),e],t,n);}function oy(e,t,r){for(var n=[],o=2;o<arguments.length;++o)n[o-2]=arguments[o];Array.isArray(e)||es("Expected array but got %s: %s.",[Xt(e),e],t,n);}function Le(e,t){for(var r=[],n=1;n<arguments.length;++n)r[n-1]=arguments[n];throw Error("Failure"+(e?": "+e:""),r)}function Ct(e,t,r,n){for(var o=[],s=3;s<arguments.length;++s)o[s-3]=arguments[s];e instanceof t||es("Expected instanceof %s but got %s.",[tp(t),tp(e)],r,o);}function tp(e){return e instanceof Function?e.displayName||e.name||"unknown type name":e instanceof Object?e.constructor.displayName||e.constructor.name||Object.prototype.toString.call(e):e===null?"null":typeof e}function H(e,t){if(this.c=e,this.b=t,this.a={},this.arrClean=true,0<this.c.length){for(e=0;e<this.c.length;e++){t=this.c[e];var r=t[0];this.a[r.toString()]=new ap(r,t[1]);}this.arrClean=true;}}$("jspb.Map",H,void 0);H.prototype.g=function(){if(this.arrClean){if(this.b){var e=this.a,t;for(t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var r=e[t].a;r&&r.g();}}}else {for(this.c.length=0,e=pr(this),e.sort(),t=0;t<e.length;t++){var n=this.a[e[t]];(r=n.a)&&r.g(),this.c.push([n.key,n.value]);}this.arrClean=true;}return this.c};H.prototype.toArray=H.prototype.g;H.prototype.Mc=function(e,t){for(var r=this.g(),n=[],o=0;o<r.length;o++){var s=this.a[r[o][0].toString()];cn(this,s);var a=s.a;a?(w(t),n.push([s.key,t(e,a)])):n.push([s.key,s.value]);}return n};H.prototype.toObject=H.prototype.Mc;H.fromObject=function(e,t,r){t=new H([],t);for(var n=0;n<e.length;n++){var o=e[n][0],s=r(e[n][1]);t.set(o,s);}return t};function Yn(e){this.a=0,this.b=e;}Yn.prototype.next=function(){return this.a<this.b.length?{done:false,value:this.b[this.a++]}:{done:true,value:void 0}};typeof Symbol!="undefined"&&(Yn.prototype[Symbol.iterator]=function(){return this});H.prototype.Jb=function(){return pr(this).length};H.prototype.getLength=H.prototype.Jb;H.prototype.clear=function(){this.a={},this.arrClean=false;};H.prototype.clear=H.prototype.clear;H.prototype.Cb=function(e){e=e.toString();var t=this.a.hasOwnProperty(e);return delete this.a[e],this.arrClean=false,t};H.prototype.del=H.prototype.Cb;H.prototype.Eb=function(){var e=[],t=pr(this);t.sort();for(var r=0;r<t.length;r++){var n=this.a[t[r]];e.push([n.key,n.value]);}return e};H.prototype.getEntryList=H.prototype.Eb;H.prototype.entries=function(){var e=[],t=pr(this);t.sort();for(var r=0;r<t.length;r++){var n=this.a[t[r]];e.push([n.key,cn(this,n)]);}return new Yn(e)};H.prototype.entries=H.prototype.entries;H.prototype.keys=function(){var e=[],t=pr(this);t.sort();for(var r=0;r<t.length;r++)e.push(this.a[t[r]].key);return new Yn(e)};H.prototype.keys=H.prototype.keys;H.prototype.values=function(){var e=[],t=pr(this);t.sort();for(var r=0;r<t.length;r++)e.push(cn(this,this.a[t[r]]));return new Yn(e)};H.prototype.values=H.prototype.values;H.prototype.forEach=function(e,t){var r=pr(this);r.sort();for(var n=0;n<r.length;n++){var o=this.a[r[n]];e.call(t,cn(this,o),o.key,this);}};H.prototype.forEach=H.prototype.forEach;H.prototype.set=function(e,t){var r=new ap(e);return this.b?(r.a=t,r.value=t.g()):r.value=t,this.a[e.toString()]=r,this.arrClean=false,this};H.prototype.set=H.prototype.set;function cn(e,t){return e.b?(t.a||(t.a=new e.b(t.value)),t.a):t.value}H.prototype.get=function(e){if(e=this.a[e.toString()])return cn(this,e)};H.prototype.get=H.prototype.get;H.prototype.has=function(e){return e.toString()in this.a};H.prototype.has=H.prototype.has;H.prototype.Jc=function(e,t,r,n,o){var s=pr(this);s.sort();for(var a=0;a<s.length;a++){var l=this.a[s[a]];t.Va(e),r.call(t,1,l.key),this.b?n.call(t,2,cn(this,l),o):n.call(t,2,l.value),t.Ya();}};H.prototype.serializeBinary=H.prototype.Jc;H.deserializeBinary=function(e,t,r,n,o,s,a){for(;t.oa()&&!t.bb();){var l=t.c;l==1?s=r.call(t):l==2&&(e.b?(w(o),a||(a=new e.b),n.call(t,a,o)):a=n.call(t));}w(s!=null),w(a!=null),e.set(s,a);};function pr(e){e=e.a;var t=[],r;for(r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t}function ap(e,t){this.key=e,this.value=t,this.a=void 0;}function ip(e){if(8192>=e.length)return String.fromCharCode.apply(null,e);for(var t="",r=0;r<e.length;r+=8192)t+=String.fromCharCode.apply(null,ry(e,r,r+8192));return t}var ia={"\0":"\\0","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","\v":"\\x0B",'"':'\\"',"\\":"\\\\","<":"\\u003C"},Qo={"'":"\\'"},lp={},Zn=null;function up(e,t){t===void 0&&(t=0),cp(),t=lp[t];for(var r=[],n=0;n<e.length;n+=3){var o=e[n],s=n+1<e.length,a=s?e[n+1]:0,l=n+2<e.length,u=l?e[n+2]:0,p=o>>2;o=(o&3)<<4|a>>4,a=(a&15)<<2|u>>6,u&=63,l||(u=64,s||(a=64)),r.push(t[p],t[o],t[a]||"",t[u]||"");}return r.join("")}function pp(e){var t=e.length,r=3*t/4;r%3?r=Math.floor(r):"=.".indexOf(e[t-1])!=-1&&(r="=.".indexOf(e[t-2])!=-1?r-2:r-1);var n=new Uint8Array(r),o=0;return sy(e,function(s){n[o++]=s;}),n.subarray(0,o)}function sy(e,t){function r(u){for(;n<e.length;){var p=e.charAt(n++),f=Zn[p];if(f!=null)return f;if(!/^[\s\xa0]*$/.test(p))throw Error("Unknown base64 encoding at char: "+p)}return u}cp();for(var n=0;;){var o=r(-1),s=r(0),a=r(64),l=r(64);if(l===64&&o===-1)break;t(o<<2|s>>4),a!=64&&(t(s<<4&240|a>>2),l!=64&&t(a<<6&192|l));}}function cp(){if(!Zn){Zn={};for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),t=["+/=","+/","-_=","-_.","-_"],r=0;5>r;r++){var n=e.concat(t[r].split(""));lp[r]=n;for(var o=0;o<n.length;o++){var s=n[o];Zn[s]===void 0&&(Zn[s]=o);}}}}$("jspb.ConstBinaryMessage",function(){},void 0);$("jspb.BinaryMessage",function(){},void 0);$("jspb.BinaryConstants.FieldType",{yb:-1,ee:1,FLOAT:2,ke:3,te:4,je:5,xb:6,wb:7,BOOL:8,re:9,ie:10,le:11,ce:12,se:13,ge:14,me:15,ne:16,oe:17,pe:18,he:30,ve:31},void 0);$("jspb.BinaryConstants.WireType",{yb:-1,ue:0,xb:1,de:2,qe:3,fe:4,wb:5},void 0);$("jspb.BinaryConstants.FieldTypeToWireType",function(e){switch(e){case 5:case 3:case 13:case 4:case 17:case 18:case 8:case 14:case 31:return 0;case 1:case 6:case 16:case 30:return 1;case 9:case 11:case 12:return 2;case 2:case 7:case 15:return 5;default:return  -1}},void 0);$("jspb.BinaryConstants.INVALID_FIELD_NUMBER",-1,void 0);$("jspb.BinaryConstants.FLOAT32_EPS",1401298464324817e-60,void 0);$("jspb.BinaryConstants.FLOAT32_MIN",11754943508222875e-54,void 0);$("jspb.BinaryConstants.FLOAT32_MAX",34028234663852886e22,void 0);$("jspb.BinaryConstants.FLOAT64_EPS",5e-324,void 0);$("jspb.BinaryConstants.FLOAT64_MIN",22250738585072014e-324,void 0);$("jspb.BinaryConstants.FLOAT64_MAX",17976931348623157e292,void 0);$("jspb.BinaryConstants.TWO_TO_20",1048576,void 0);$("jspb.BinaryConstants.TWO_TO_23",8388608,void 0);$("jspb.BinaryConstants.TWO_TO_31",2147483648,void 0);$("jspb.BinaryConstants.TWO_TO_32",4294967296,void 0);$("jspb.BinaryConstants.TWO_TO_52",4503599627370496,void 0);$("jspb.BinaryConstants.TWO_TO_63",9223372036854776e3,void 0);$("jspb.BinaryConstants.TWO_TO_64",18446744073709552e3,void 0);$("jspb.BinaryConstants.ZERO_HASH","\0\0\0\0\0\0\0\0",void 0);var fe=0,me=0;$("jspb.utils.getSplit64Low",function(){return fe},void 0);$("jspb.utils.getSplit64High",function(){return me},void 0);function fa(e){var t=e>>>0;e=Math.floor((e-t)/4294967296)>>>0,fe=t,me=e;}$("jspb.utils.splitUint64",fa,void 0);function Xn(e){var t=0>e;e=Math.abs(e);var r=e>>>0;e=Math.floor((e-r)/4294967296),e>>>=0,t&&(e=~e>>>0,r=(~r>>>0)+1,4294967295<r&&(r=0,e++,4294967295<e&&(e=0))),fe=r,me=e;}$("jspb.utils.splitInt64",Xn,void 0);function dp(e){var t=0>e;e=2*Math.abs(e),fa(e),e=fe;var r=me;t&&(e==0?r==0?r=e=4294967295:(r--,e=4294967295):e--),fe=e,me=r;}$("jspb.utils.splitZigzag64",dp,void 0);function fp(e){var t=0>e?1:0;if(e=t?-e:e,e===0)0<1/e?fe=me=0:(me=0,fe=2147483648);else if(isNaN(e))me=0,fe=2147483647;else if(34028234663852886e22<e)me=0,fe=(t<<31|2139095040)>>>0;else if(11754943508222875e-54>e)e=Math.round(e/Math.pow(2,-149)),me=0,fe=(t<<31|e)>>>0;else {var r=Math.floor(Math.log(e)/Math.LN2);e*=Math.pow(2,-r),e=Math.round(8388608*e),16777216<=e&&++r,me=0,fe=(t<<31|r+127<<23|e&8388607)>>>0;}}$("jspb.utils.splitFloat32",fp,void 0);function hp(e){var t=0>e?1:0;if(e=t?-e:e,e===0)me=0<1/e?0:2147483648,fe=0;else if(isNaN(e))me=2147483647,fe=4294967295;else if(17976931348623157e292<e)me=(t<<31|2146435072)>>>0,fe=0;else if(22250738585072014e-324>e)e/=Math.pow(2,-1074),me=(t<<31|e/4294967296)>>>0,fe=e>>>0;else {var r=e,n=0;if(2<=r)for(;2<=r&&1023>n;)n++,r/=2;else for(;1>r&&-1022<n;)r*=2,n--;e*=Math.pow(2,-n),me=(t<<31|n+1023<<20|1048576*e&1048575)>>>0,fe=4503599627370496*e>>>0;}}$("jspb.utils.splitFloat64",hp,void 0);function cr(e){var t=e.charCodeAt(4),r=e.charCodeAt(5),n=e.charCodeAt(6),o=e.charCodeAt(7);fe=e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)>>>0,me=t+(r<<8)+(n<<16)+(o<<24)>>>0;}$("jspb.utils.splitHash64",cr,void 0);function dn(e,t){return 4294967296*t+(e>>>0)}$("jspb.utils.joinUint64",dn,void 0);function Qn(e,t){var r=t&2147483648;return r&&(e=~e+1>>>0,t=~t>>>0,e==0&&(t=t+1>>>0)),e=dn(e,t),r?-e:e}$("jspb.utils.joinInt64",Qn,void 0);function ts(e,t,r){var n=t>>31;return r(e<<1^n,(t<<1|e>>>31)^n)}$("jspb.utils.toZigzag64",ts,void 0);function mp(e,t){return rs(e,t,Qn)}$("jspb.utils.joinZigzag64",mp,void 0);function rs(e,t,r){var n=-(e&1);return r((e>>>1|t<<31)^n,t>>>1^n)}$("jspb.utils.fromZigzag64",rs,void 0);function gp(e){var t=2*(e>>31)+1,r=e>>>23&255;return e&=8388607,r==255?e?NaN:1/0*t:r==0?t*Math.pow(2,-149)*e:t*Math.pow(2,r-150)*(e+Math.pow(2,23))}$("jspb.utils.joinFloat32",gp,void 0);function yp(e,t){var r=2*(t>>31)+1,n=t>>>20&2047;return e=4294967296*(t&1048575)+e,n==2047?e?NaN:1/0*r:n==0?r*Math.pow(2,-1074)*e:r*Math.pow(2,n-1075)*(e+4503599627370496)}$("jspb.utils.joinFloat64",yp,void 0);function ns(e,t){return String.fromCharCode(e>>>0&255,e>>>8&255,e>>>16&255,e>>>24&255,t>>>0&255,t>>>8&255,t>>>16&255,t>>>24&255)}$("jspb.utils.joinHash64",ns,void 0);$("jspb.utils.DIGITS","0123456789abcdef".split(""),void 0);function eo(e,t){function r(o,s){return o=o?String(o):"",s?"0000000".slice(o.length)+o:o}if(2097151>=t)return ""+dn(e,t);var n=(e>>>24|t<<8)>>>0&16777215;return t=t>>16&65535,e=(e&16777215)+6777216*n+6710656*t,n+=8147497*t,t*=2,1e7<=e&&(n+=Math.floor(e/1e7),e%=1e7),1e7<=n&&(t+=Math.floor(n/1e7),n%=1e7),r(t,0)+r(n,t)+r(e,1)}$("jspb.utils.joinUnsignedDecimalString",eo,void 0);function to(e,t){var r=t&2147483648;return r&&(e=~e+1>>>0,t=~t+(e==0?1:0)>>>0),e=eo(e,t),r?"-"+e:e}$("jspb.utils.joinSignedDecimalString",to,void 0);function vp(e,t){cr(e),e=fe;var r=me;return t?to(e,r):eo(e,r)}$("jspb.utils.hash64ToDecimalString",vp,void 0);$("jspb.utils.hash64ArrayToDecimalStrings",function(e,t){for(var r=Array(e.length),n=0;n<e.length;n++)r[n]=vp(e[n],t);return r},void 0);function ro(e){function t(a,l){for(var u=0;8>u&&(a!==1||0<l);u++)l=a*o[u]+l,o[u]=l&255,l>>>=8;}function r(){for(var a=0;8>a;a++)o[a]=~o[a]&255;}w(0<e.length);var n=false;e[0]==="-"&&(n=true,e=e.slice(1));for(var o=[0,0,0,0,0,0,0,0],s=0;s<e.length;s++)t(10,e.charCodeAt(s)-48);return n&&(r(),t(1,1)),ip(o)}$("jspb.utils.decimalStringToHash64",ro,void 0);$("jspb.utils.splitDecimalString",function(e){cr(ro(e));},void 0);function rp(e){return String.fromCharCode(10>e?48+e:87+e)}function np(e){return 97<=e?e-97+10:e-48}$("jspb.utils.hash64ToHexString",function(e){var t=Array(18);t[0]="0",t[1]="x";for(var r=0;8>r;r++){var n=e.charCodeAt(7-r);t[2*r+2]=rp(n>>4),t[2*r+3]=rp(n&15);}return t.join("")},void 0);$("jspb.utils.hexStringToHash64",function(e){e=e.toLowerCase(),w(e.length==18),w(e[0]=="0"),w(e[1]=="x");for(var t="",r=0;8>r;r++)t=String.fromCharCode(16*np(e.charCodeAt(2*r+2))+np(e.charCodeAt(2*r+3)))+t;return t},void 0);$("jspb.utils.hash64ToNumber",function(e,t){cr(e),e=fe;var r=me;return t?Qn(e,r):dn(e,r)},void 0);$("jspb.utils.numberToHash64",function(e){return Xn(e),ns(fe,me)},void 0);$("jspb.utils.countVarints",function(e,t,r){for(var n=0,o=t;o<r;o++)n+=e[o]>>7;return r-t-n},void 0);$("jspb.utils.countVarintFields",function(e,t,r,n){var o=0;if(n*=8,128>n)for(;t<r&&e[t++]==n;)for(o++;;){var s=e[t++];if((s&128)==0)break}else for(;t<r;){for(s=n;128<s;){if(e[t]!=(s&127|128))return o;t++,s>>=7;}if(e[t++]!=s)break;for(o++;s=e[t++],(s&128)!=0;);}return o},void 0);function bp(e,t,r,n,o){var s=0;if(128>n)for(;t<r&&e[t++]==n;)s++,t+=o;else for(;t<r;){for(var a=n;128<a;){if(e[t++]!=(a&127|128))return s;a>>=7;}if(e[t++]!=a)break;s++,t+=o;}return s}$("jspb.utils.countFixed32Fields",function(e,t,r,n){return bp(e,t,r,8*n+5,4)},void 0);$("jspb.utils.countFixed64Fields",function(e,t,r,n){return bp(e,t,r,8*n+1,8)},void 0);$("jspb.utils.countDelimitedFields",function(e,t,r,n){var o=0;for(n=8*n+2;t<r;){for(var s=n;128<s;){if(e[t++]!=(s&127|128))return o;s>>=7;}if(e[t++]!=s)break;o++;for(var a=0,l=1;s=e[t++],a+=(s&127)*l,l*=128,(s&128)!=0;);t+=a;}return o},void 0);$("jspb.utils.debugBytesToTextFormat",function(e){var t='"';if(e){e=os(e);for(var r=0;r<e.length;r++)t+="\\x",16>e[r]&&(t+="0"),t+=e[r].toString(16);}return t+'"'},void 0);$("jspb.utils.debugScalarToTextFormat",function(e){if(typeof e=="string"){e=String(e);for(var t=['"'],r=0;r<e.length;r++){var n=e.charAt(r),o=n.charCodeAt(0),s=r+1,a;(a=ia[n])||(31<o&&127>o||(o=n,o in Qo?n=Qo[o]:o in ia?n=Qo[o]=ia[o]:(a=o.charCodeAt(0),31<a&&127>a?n=o:(256>a?(n="\\x",(16>a||256<a)&&(n+="0")):(n="\\u",4096>a&&(n+="0")),n+=a.toString(16).toUpperCase()),n=Qo[o]=n)),a=n),t[s]=a;}t.push('"'),e=t.join("");}else e=e.toString();return e},void 0);$("jspb.utils.stringToByteArray",function(e){for(var t=new Uint8Array(e.length),r=0;r<e.length;r++){var n=e.charCodeAt(r);if(255<n)throw Error("Conversion error: string contains codepoint outside of byte range");t[r]=n;}return t},void 0);function os(e){return e.constructor===Uint8Array?e:e.constructor===ArrayBuffer?new Uint8Array(e):e.constructor===Array?new Uint8Array(e):e.constructor===String?pp(e):e instanceof Uint8Array?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):(Le("Type not convertible to Uint8Array."),new Uint8Array(0))}$("jspb.utils.byteSourceToUint8Array",os,void 0);function b(e,t,r){this.b=null,this.a=this.c=this.h=0,this.v=false,e&&this.H(e,t,r);}$("jspb.BinaryDecoder",b,void 0);var Gn=[];b.getInstanceCacheLength=function(){return Gn.length};function ss(e,t,r){if(Gn.length){var n=Gn.pop();return e&&n.H(e,t,r),n}return new b(e,t,r)}b.alloc=ss;b.prototype.Ca=function(){this.clear(),100>Gn.length&&Gn.push(this);};b.prototype.free=b.prototype.Ca;b.prototype.clone=function(){return ss(this.b,this.h,this.c-this.h)};b.prototype.clone=b.prototype.clone;b.prototype.clear=function(){this.b=null,this.a=this.c=this.h=0,this.v=false;};b.prototype.clear=b.prototype.clear;b.prototype.Y=function(){return this.b};b.prototype.getBuffer=b.prototype.Y;b.prototype.H=function(e,t,r){this.b=os(e),this.h=t!==void 0?t:0,this.c=r!==void 0?this.h+r:this.b.length,this.a=this.h;};b.prototype.setBlock=b.prototype.H;b.prototype.Db=function(){return this.c};b.prototype.getEnd=b.prototype.Db;b.prototype.setEnd=function(e){this.c=e;};b.prototype.setEnd=b.prototype.setEnd;b.prototype.reset=function(){this.a=this.h;};b.prototype.reset=b.prototype.reset;b.prototype.B=function(){return this.a};b.prototype.getCursor=b.prototype.B;b.prototype.Ma=function(e){this.a=e;};b.prototype.setCursor=b.prototype.Ma;b.prototype.advance=function(e){this.a+=e,w(this.a<=this.c);};b.prototype.advance=b.prototype.advance;b.prototype.ya=function(){return this.a==this.c};b.prototype.atEnd=b.prototype.ya;b.prototype.Qb=function(){return this.a>this.c};b.prototype.pastEnd=b.prototype.Qb;b.prototype.getError=function(){return this.v||0>this.a||this.a>this.c};b.prototype.getError=b.prototype.getError;b.prototype.w=function(e){for(var t=128,r=0,n=0,o=0;4>o&&128<=t;o++)t=this.b[this.a++],r|=(t&127)<<7*o;if(128<=t&&(t=this.b[this.a++],r|=(t&127)<<28,n|=(t&127)>>4),128<=t)for(o=0;5>o&&128<=t;o++)t=this.b[this.a++],n|=(t&127)<<7*o+3;if(128>t)return e(r>>>0,n>>>0);Le("Failed to read varint, encoding is invalid."),this.v=true;};b.prototype.readSplitVarint64=b.prototype.w;b.prototype.ea=function(e){return this.w(function(t,r){return rs(t,r,e)})};b.prototype.readSplitZigzagVarint64=b.prototype.ea;b.prototype.ta=function(e){var t=this.b,r=this.a;this.a+=8;for(var n=0,o=0,s=r+7;s>=r;s--)n=n<<8|t[s],o=o<<8|t[s+4];return e(n,o)};b.prototype.readSplitFixed64=b.prototype.ta;b.prototype.kb=function(){for(;this.b[this.a]&128;)this.a++;this.a++;};b.prototype.skipVarint=b.prototype.kb;b.prototype.mb=function(e){for(;128<e;)this.a--,e>>>=7;this.a--;};b.prototype.unskipVarint=b.prototype.mb;b.prototype.o=function(){var e=this.b,t=e[this.a],r=t&127;return 128>t?(this.a+=1,w(this.a<=this.c),r):(t=e[this.a+1],r|=(t&127)<<7,128>t?(this.a+=2,w(this.a<=this.c),r):(t=e[this.a+2],r|=(t&127)<<14,128>t?(this.a+=3,w(this.a<=this.c),r):(t=e[this.a+3],r|=(t&127)<<21,128>t?(this.a+=4,w(this.a<=this.c),r):(t=e[this.a+4],r|=(t&15)<<28,128>t?(this.a+=5,w(this.a<=this.c),r>>>0):(this.a+=5,128<=e[this.a++]&&128<=e[this.a++]&&128<=e[this.a++]&&128<=e[this.a++]&&128<=e[this.a++]&&w(false),w(this.a<=this.c),r)))))};b.prototype.readUnsignedVarint32=b.prototype.o;b.prototype.da=function(){return ~~this.o()};b.prototype.readSignedVarint32=b.prototype.da;b.prototype.O=function(){return this.o().toString()};b.prototype.Ea=function(){return this.da().toString()};b.prototype.readSignedVarint32String=b.prototype.Ea;b.prototype.Ia=function(){var e=this.o();return e>>>1^-(e&1)};b.prototype.readZigzagVarint32=b.prototype.Ia;b.prototype.Ga=function(){return this.w(dn)};b.prototype.readUnsignedVarint64=b.prototype.Ga;b.prototype.Ha=function(){return this.w(eo)};b.prototype.readUnsignedVarint64String=b.prototype.Ha;b.prototype.sa=function(){return this.w(Qn)};b.prototype.readSignedVarint64=b.prototype.sa;b.prototype.Fa=function(){return this.w(to)};b.prototype.readSignedVarint64String=b.prototype.Fa;b.prototype.Ja=function(){return this.w(mp)};b.prototype.readZigzagVarint64=b.prototype.Ja;b.prototype.fb=function(){return this.ea(ns)};b.prototype.readZigzagVarintHash64=b.prototype.fb;b.prototype.Ka=function(){return this.ea(to)};b.prototype.readZigzagVarint64String=b.prototype.Ka;b.prototype.Gc=function(){var e=this.b[this.a];return this.a+=1,w(this.a<=this.c),e};b.prototype.readUint8=b.prototype.Gc;b.prototype.Ec=function(){var e=this.b[this.a],t=this.b[this.a+1];return this.a+=2,w(this.a<=this.c),e<<0|t<<8};b.prototype.readUint16=b.prototype.Ec;b.prototype.m=function(){var e=this.b[this.a],t=this.b[this.a+1],r=this.b[this.a+2],n=this.b[this.a+3];return this.a+=4,w(this.a<=this.c),(e<<0|t<<8|r<<16|n<<24)>>>0};b.prototype.readUint32=b.prototype.m;b.prototype.ga=function(){var e=this.m(),t=this.m();return dn(e,t)};b.prototype.readUint64=b.prototype.ga;b.prototype.ha=function(){var e=this.m(),t=this.m();return eo(e,t)};b.prototype.readUint64String=b.prototype.ha;b.prototype.Xb=function(){var e=this.b[this.a];return this.a+=1,w(this.a<=this.c),e<<24>>24};b.prototype.readInt8=b.prototype.Xb;b.prototype.Vb=function(){var e=this.b[this.a],t=this.b[this.a+1];return this.a+=2,w(this.a<=this.c),(e<<0|t<<8)<<16>>16};b.prototype.readInt16=b.prototype.Vb;b.prototype.P=function(){var e=this.b[this.a],t=this.b[this.a+1],r=this.b[this.a+2],n=this.b[this.a+3];return this.a+=4,w(this.a<=this.c),e<<0|t<<8|r<<16|n<<24};b.prototype.readInt32=b.prototype.P;b.prototype.ba=function(){var e=this.m(),t=this.m();return Qn(e,t)};b.prototype.readInt64=b.prototype.ba;b.prototype.ca=function(){var e=this.m(),t=this.m();return to(e,t)};b.prototype.readInt64String=b.prototype.ca;b.prototype.aa=function(){var e=this.m();return gp(e)};b.prototype.readFloat=b.prototype.aa;b.prototype.Z=function(){var e=this.m(),t=this.m();return yp(e,t)};b.prototype.readDouble=b.prototype.Z;b.prototype.pa=function(){return !!this.b[this.a++]};b.prototype.readBool=b.prototype.pa;b.prototype.ra=function(){return this.da()};b.prototype.readEnum=b.prototype.ra;b.prototype.fa=function(e){var t=this.b,r=this.a;e=r+e;for(var n=[],o="";r<e;){var s=t[r++];if(128>s)n.push(s);else {if(192>s)continue;if(224>s){var a=t[r++];n.push((s&31)<<6|a&63);}else if(240>s){a=t[r++];var l=t[r++];n.push((s&15)<<12|(a&63)<<6|l&63);}else if(248>s){a=t[r++],l=t[r++];var u=t[r++];s=(s&7)<<18|(a&63)<<12|(l&63)<<6|u&63,s-=65536,n.push((s>>10&1023)+55296,(s&1023)+56320);}}8192<=n.length&&(o+=String.fromCharCode.apply(null,n),n.length=0);}return o+=ip(n),this.a=r,o};b.prototype.readString=b.prototype.fa;b.prototype.Dc=function(){var e=this.o();return this.fa(e)};b.prototype.readStringWithLength=b.prototype.Dc;b.prototype.qa=function(e){if(0>e||this.a+e>this.b.length)return this.v=true,Le("Invalid byte length!"),new Uint8Array(0);var t=this.b.subarray(this.a,this.a+e);return this.a+=e,w(this.a<=this.c),t};b.prototype.readBytes=b.prototype.qa;b.prototype.ia=function(){return this.w(ns)};b.prototype.readVarintHash64=b.prototype.ia;b.prototype.$=function(){var e=this.b,t=this.a,r=e[t],n=e[t+1],o=e[t+2],s=e[t+3],a=e[t+4],l=e[t+5],u=e[t+6];return e=e[t+7],this.a+=8,String.fromCharCode(r,n,o,s,a,l,u,e)};b.prototype.readFixedHash64=b.prototype.$;function h(e,t,r){this.a=ss(e,t,r),this.O=this.a.B(),this.b=this.c=-1,this.h=false,this.v=null;}$("jspb.BinaryReader",h,void 0);var pn=[];h.clearInstanceCache=function(){pn=[];};h.getInstanceCacheLength=function(){return pn.length};function _p(e,t,r){if(pn.length){var n=pn.pop();return e&&n.a.H(e,t,r),n}return new h(e,t,r)}h.alloc=_p;h.prototype.zb=_p;h.prototype.alloc=h.prototype.zb;h.prototype.Ca=function(){this.a.clear(),this.b=this.c=-1,this.h=false,this.v=null,100>pn.length&&pn.push(this);};h.prototype.free=h.prototype.Ca;h.prototype.Fb=function(){return this.O};h.prototype.getFieldCursor=h.prototype.Fb;h.prototype.B=function(){return this.a.B()};h.prototype.getCursor=h.prototype.B;h.prototype.Y=function(){return this.a.Y()};h.prototype.getBuffer=h.prototype.Y;h.prototype.Hb=function(){return this.c};h.prototype.getFieldNumber=h.prototype.Hb;h.prototype.Lb=function(){return this.b};h.prototype.getWireType=h.prototype.Lb;h.prototype.Mb=function(){return this.b==2};h.prototype.isDelimited=h.prototype.Mb;h.prototype.bb=function(){return this.b==4};h.prototype.isEndGroup=h.prototype.bb;h.prototype.getError=function(){return this.h||this.a.getError()};h.prototype.getError=h.prototype.getError;h.prototype.H=function(e,t,r){this.a.H(e,t,r),this.b=this.c=-1;};h.prototype.setBlock=h.prototype.H;h.prototype.reset=function(){this.a.reset(),this.b=this.c=-1;};h.prototype.reset=h.prototype.reset;h.prototype.advance=function(e){this.a.advance(e);};h.prototype.advance=h.prototype.advance;h.prototype.oa=function(){if(this.a.ya())return  false;if(this.getError())return Le("Decoder hit an error"),false;this.O=this.a.B();var e=this.a.o(),t=e>>>3;return e&=7,e!=0&&e!=5&&e!=1&&e!=2&&e!=3&&e!=4?(Le("Invalid wire type: %s (at position %s)",e,this.O),this.h=true,false):(this.c=t,this.b=e,true)};h.prototype.nextField=h.prototype.oa;h.prototype.Oa=function(){this.a.mb(this.c<<3|this.b);};h.prototype.unskipHeader=h.prototype.Oa;h.prototype.Lc=function(){var e=this.c;for(this.Oa();this.oa()&&this.c==e;)this.C();this.a.ya()||this.Oa();};h.prototype.skipMatchingFields=h.prototype.Lc;h.prototype.lb=function(){this.b!=0?(Le("Invalid wire type for skipVarintField"),this.C()):this.a.kb();};h.prototype.skipVarintField=h.prototype.lb;h.prototype.gb=function(){if(this.b!=2)Le("Invalid wire type for skipDelimitedField"),this.C();else {var e=this.a.o();this.a.advance(e);}};h.prototype.skipDelimitedField=h.prototype.gb;h.prototype.hb=function(){this.b!=5?(Le("Invalid wire type for skipFixed32Field"),this.C()):this.a.advance(4);};h.prototype.skipFixed32Field=h.prototype.hb;h.prototype.ib=function(){this.b!=1?(Le("Invalid wire type for skipFixed64Field"),this.C()):this.a.advance(8);};h.prototype.skipFixed64Field=h.prototype.ib;h.prototype.jb=function(){var e=this.c;do{if(!this.oa()){Le("Unmatched start-group tag: stream EOF"),this.h=true;break}if(this.b==4){this.c!=e&&(Le("Unmatched end-group tag"),this.h=true);break}this.C();}while(true)};h.prototype.skipGroup=h.prototype.jb;h.prototype.C=function(){switch(this.b){case 0:this.lb();break;case 1:this.ib();break;case 2:this.gb();break;case 5:this.hb();break;case 3:this.jb();break;default:Le("Invalid wire encoding for field.");}};h.prototype.skipField=h.prototype.C;h.prototype.Hc=function(e,t){this.v===null&&(this.v={}),w(!this.v[e]),this.v[e]=t;};h.prototype.registerReadCallback=h.prototype.Hc;h.prototype.Ic=function(e){return w(this.v!==null),e=this.v[e],w(e),e(this)};h.prototype.runReadCallback=h.prototype.Ic;h.prototype.Yb=function(e,t){w(this.b==2);var r=this.a.c,n=this.a.o();n=this.a.B()+n,this.a.setEnd(n),t(e,this),this.a.Ma(n),this.a.setEnd(r);};h.prototype.readMessage=h.prototype.Yb;h.prototype.Ub=function(e,t,r){w(this.b==3),w(this.c==e),r(t,this),this.h||this.b==4||(Le("Group submessage did not end with an END_GROUP tag"),this.h=true);};h.prototype.readGroup=h.prototype.Ub;h.prototype.Gb=function(){w(this.b==2);var e=this.a.o(),t=this.a.B(),r=t+e;return e=ss(this.a.Y(),t,e),this.a.Ma(r),e};h.prototype.getFieldDecoder=h.prototype.Gb;h.prototype.P=function(){return w(this.b==0),this.a.da()};h.prototype.readInt32=h.prototype.P;h.prototype.Wb=function(){return w(this.b==0),this.a.Ea()};h.prototype.readInt32String=h.prototype.Wb;h.prototype.ba=function(){return w(this.b==0),this.a.sa()};h.prototype.readInt64=h.prototype.ba;h.prototype.ca=function(){return w(this.b==0),this.a.Fa()};h.prototype.readInt64String=h.prototype.ca;h.prototype.m=function(){return w(this.b==0),this.a.o()};h.prototype.readUint32=h.prototype.m;h.prototype.Fc=function(){return w(this.b==0),this.a.O()};h.prototype.readUint32String=h.prototype.Fc;h.prototype.ga=function(){return w(this.b==0),this.a.Ga()};h.prototype.readUint64=h.prototype.ga;h.prototype.ha=function(){return w(this.b==0),this.a.Ha()};h.prototype.readUint64String=h.prototype.ha;h.prototype.zc=function(){return w(this.b==0),this.a.Ia()};h.prototype.readSint32=h.prototype.zc;h.prototype.Ac=function(){return w(this.b==0),this.a.Ja()};h.prototype.readSint64=h.prototype.Ac;h.prototype.Bc=function(){return w(this.b==0),this.a.Ka()};h.prototype.readSint64String=h.prototype.Bc;h.prototype.Rb=function(){return w(this.b==5),this.a.m()};h.prototype.readFixed32=h.prototype.Rb;h.prototype.Sb=function(){return w(this.b==1),this.a.ga()};h.prototype.readFixed64=h.prototype.Sb;h.prototype.Tb=function(){return w(this.b==1),this.a.ha()};h.prototype.readFixed64String=h.prototype.Tb;h.prototype.vc=function(){return w(this.b==5),this.a.P()};h.prototype.readSfixed32=h.prototype.vc;h.prototype.wc=function(){return w(this.b==5),this.a.P().toString()};h.prototype.readSfixed32String=h.prototype.wc;h.prototype.xc=function(){return w(this.b==1),this.a.ba()};h.prototype.readSfixed64=h.prototype.xc;h.prototype.yc=function(){return w(this.b==1),this.a.ca()};h.prototype.readSfixed64String=h.prototype.yc;h.prototype.aa=function(){return w(this.b==5),this.a.aa()};h.prototype.readFloat=h.prototype.aa;h.prototype.Z=function(){return w(this.b==1),this.a.Z()};h.prototype.readDouble=h.prototype.Z;h.prototype.pa=function(){return w(this.b==0),!!this.a.o()};h.prototype.readBool=h.prototype.pa;h.prototype.ra=function(){return w(this.b==0),this.a.sa()};h.prototype.readEnum=h.prototype.ra;h.prototype.fa=function(){w(this.b==2);var e=this.a.o();return this.a.fa(e)};h.prototype.readString=h.prototype.fa;h.prototype.qa=function(){w(this.b==2);var e=this.a.o();return this.a.qa(e)};h.prototype.readBytes=h.prototype.qa;h.prototype.ia=function(){return w(this.b==0),this.a.ia()};h.prototype.readVarintHash64=h.prototype.ia;h.prototype.Cc=function(){return w(this.b==0),this.a.fb()};h.prototype.readSintHash64=h.prototype.Cc;h.prototype.w=function(e){return w(this.b==0),this.a.w(e)};h.prototype.readSplitVarint64=h.prototype.w;h.prototype.ea=function(e){return w(this.b==0),this.a.w(function(t,r){return rs(t,r,e)})};h.prototype.readSplitZigzagVarint64=h.prototype.ea;h.prototype.$=function(){return w(this.b==1),this.a.$()};h.prototype.readFixedHash64=h.prototype.$;h.prototype.ta=function(e){return w(this.b==1),this.a.ta(e)};h.prototype.readSplitFixed64=h.prototype.ta;function Ae(e,t){w(e.b==2);var r=e.a.o();r=e.a.B()+r;for(var n=[];e.a.B()<r;)n.push(t.call(e.a));return n}h.prototype.gc=function(){return Ae(this,this.a.da)};h.prototype.readPackedInt32=h.prototype.gc;h.prototype.hc=function(){return Ae(this,this.a.Ea)};h.prototype.readPackedInt32String=h.prototype.hc;h.prototype.ic=function(){return Ae(this,this.a.sa)};h.prototype.readPackedInt64=h.prototype.ic;h.prototype.jc=function(){return Ae(this,this.a.Fa)};h.prototype.readPackedInt64String=h.prototype.jc;h.prototype.qc=function(){return Ae(this,this.a.o)};h.prototype.readPackedUint32=h.prototype.qc;h.prototype.rc=function(){return Ae(this,this.a.O)};h.prototype.readPackedUint32String=h.prototype.rc;h.prototype.sc=function(){return Ae(this,this.a.Ga)};h.prototype.readPackedUint64=h.prototype.sc;h.prototype.tc=function(){return Ae(this,this.a.Ha)};h.prototype.readPackedUint64String=h.prototype.tc;h.prototype.nc=function(){return Ae(this,this.a.Ia)};h.prototype.readPackedSint32=h.prototype.nc;h.prototype.oc=function(){return Ae(this,this.a.Ja)};h.prototype.readPackedSint64=h.prototype.oc;h.prototype.pc=function(){return Ae(this,this.a.Ka)};h.prototype.readPackedSint64String=h.prototype.pc;h.prototype.bc=function(){return Ae(this,this.a.m)};h.prototype.readPackedFixed32=h.prototype.bc;h.prototype.cc=function(){return Ae(this,this.a.ga)};h.prototype.readPackedFixed64=h.prototype.cc;h.prototype.dc=function(){return Ae(this,this.a.ha)};h.prototype.readPackedFixed64String=h.prototype.dc;h.prototype.kc=function(){return Ae(this,this.a.P)};h.prototype.readPackedSfixed32=h.prototype.kc;h.prototype.lc=function(){return Ae(this,this.a.ba)};h.prototype.readPackedSfixed64=h.prototype.lc;h.prototype.mc=function(){return Ae(this,this.a.ca)};h.prototype.readPackedSfixed64String=h.prototype.mc;h.prototype.fc=function(){return Ae(this,this.a.aa)};h.prototype.readPackedFloat=h.prototype.fc;h.prototype.$b=function(){return Ae(this,this.a.Z)};h.prototype.readPackedDouble=h.prototype.$b;h.prototype.Zb=function(){return Ae(this,this.a.pa)};h.prototype.readPackedBool=h.prototype.Zb;h.prototype.ac=function(){return Ae(this,this.a.ra)};h.prototype.readPackedEnum=h.prototype.ac;h.prototype.uc=function(){return Ae(this,this.a.ia)};h.prototype.readPackedVarintHash64=h.prototype.uc;h.prototype.ec=function(){return Ae(this,this.a.$)};h.prototype.readPackedFixedHash64=h.prototype.ec;function Hn(e,t,r,n,o){this.ma=e,this.Ba=t,this.la=r,this.Na=n,this.na=o;}$("jspb.ExtensionFieldInfo",Hn,void 0);function wp(e,t,r,n,o,s){this.Za=e,this.za=t,this.Aa=r,this.Wa=n,this.Ab=o,this.Nb=s;}$("jspb.ExtensionFieldBinaryInfo",wp,void 0);Hn.prototype.F=function(){return !!this.la};Hn.prototype.isMessageType=Hn.prototype.F;function M(){}$("jspb.Message",M,void 0);M.GENERATE_TO_OBJECT=true;M.GENERATE_FROM_OBJECT=true;var as=typeof Uint8Array=="function";M.prototype.Ib=function(){return this.b};M.prototype.getJsPbMessageId=M.prototype.Ib;M.initialize=function(e,t,r,n,o,s){e.f=null,t||(t=r?[r]:[]),e.b=r?String(r):void 0,e.D=r===0?-1:0,e.u=t;e:{if(r=e.u.length,t=-1,r&&(t=r-1,r=e.u[t],!(r===null||typeof r!="object"||Array.isArray(r)||as&&r instanceof Uint8Array))){e.G=t-e.D,e.i=r;break e} -1<n?(e.G=Math.max(n,t+1-e.D),e.i=null):e.G=Number.MAX_VALUE;}if(e.a={},o)for(n=0;n<o.length;n++)t=o[n],t<e.G?(t+=e.D,e.u[t]=e.u[t]||Wn):(is(e),e.i[t]=e.i[t]||Wn);if(s&&s.length)for(n=0;n<s.length;n++)ha(e,s[n]);};var Wn=Object.freeze?Object.freeze([]):[];function is(e){var t=e.G+e.D;e.u[t]||(e.i=e.u[t]={});}function xp(e,t,r){for(var n=[],o=0;o<e.length;o++)n[o]=t.call(e[o],r,e[o]);return n}M.toObjectList=xp;M.toObjectExtension=function(e,t,r,n,o){for(var s in r){var a=r[s],l=n.call(e,a);if(l!=null){for(var u in a.Ba)if(a.Ba.hasOwnProperty(u))break;t[u]=a.Na?a.na?xp(l,a.Na,o):a.Na(o,l):l;}}};M.serializeBinaryExtensions=function(e,t,r,n){for(var o in r){var s=r[o],a=s.Za;if(!s.Aa)throw Error("Message extension present that was generated without binary serialization support");var l=n.call(e,a);if(l!=null)if(a.F())if(s.Wa)s.Aa.call(t,a.ma,l,s.Wa);else throw Error("Message extension present holding submessage without binary support enabled, and message is being serialized to binary format");else s.Aa.call(t,a.ma,l);}};M.readBinaryExtension=function(e,t,r,n,o){var s=r[t.c];if(s){if(r=s.Za,!s.za)throw Error("Deserializing extension whose generated code does not support binary format");if(r.F()){var a=new r.la;s.za.call(t,a,s.Ab);}else a=s.za.call(t);r.na&&!s.Nb?(t=n.call(e,r))?t.push(a):o.call(e,r,[a]):o.call(e,r,a);}else t.C();};function pt(e,t){if(t<e.G){t+=e.D;var r=e.u[t];return r===Wn?e.u[t]=[]:r}if(e.i)return r=e.i[t],r===Wn?e.i[t]=[]:r}M.getField=pt;M.getRepeatedField=function(e,t){return pt(e,t)};function Sp(e,t){return e=pt(e,t),e==null?e:+e}M.getOptionalFloatingPointField=Sp;function Tp(e,t){return e=pt(e,t),e==null?e:!!e}M.getBooleanField=Tp;M.getRepeatedFloatingPointField=function(e,t){var r=pt(e,t);if(e.a||(e.a={}),!e.a[t]){for(var n=0;n<r.length;n++)r[n]=+r[n];e.a[t]=true;}return r};M.getRepeatedBooleanField=function(e,t){var r=pt(e,t);if(e.a||(e.a={}),!e.a[t]){for(var n=0;n<r.length;n++)r[n]=!!r[n];e.a[t]=true;}return r};function Ip(e){return e==null||typeof e=="string"?e:as&&e instanceof Uint8Array?up(e):(Le("Cannot coerce to b64 string: "+Xt(e)),null)}M.bytesAsB64=Ip;function kp(e){return e==null||e instanceof Uint8Array?e:typeof e=="string"?pp(e):(Le("Cannot coerce to Uint8Array: "+Xt(e)),null)}M.bytesAsU8=kp;M.bytesListAsB64=function(e){return Ap(e),e.length&&typeof e[0]!="string"?Kn(e,Ip):e};M.bytesListAsU8=function(e){return Ap(e),!e.length||e[0]instanceof Uint8Array?e:Kn(e,kp)};function Ap(e){if(e&&1<e.length){var t=Xt(e[0]);ty(e,function(r){Xt(r)!=t&&Le("Inconsistent type in JSPB repeated field array. Got "+Xt(r)+" expected "+t);});}}function Ep(e,t,r){return e=pt(e,t),e==null?r:e}M.getFieldWithDefault=Ep;M.getBooleanFieldWithDefault=function(e,t,r){return e=Tp(e,t),e==null?r:e};M.getFloatingPointFieldWithDefault=function(e,t,r){return e=Sp(e,t),e==null?r:e};M.getFieldProto3=Ep;M.getMapField=function(e,t,r,n){if(e.f||(e.f={}),t in e.f)return e.f[t];var o=pt(e,t);if(!o){if(r)return;o=[],Qt(e,t,o);}return e.f[t]=new H(o,n)};function Qt(e,t,r){return Ct(e,M),t<e.G?e.u[t+e.D]=r:(is(e),e.i[t]=r),e}M.setField=Qt;M.setProto3IntField=function(e,t,r){return Fr(e,t,r,0)};M.setProto3FloatField=function(e,t,r){return Fr(e,t,r,0)};M.setProto3BooleanField=function(e,t,r){return Fr(e,t,r,false)};M.setProto3StringField=function(e,t,r){return Fr(e,t,r,"")};M.setProto3BytesField=function(e,t,r){return Fr(e,t,r,"")};M.setProto3EnumField=function(e,t,r){return Fr(e,t,r,0)};M.setProto3StringIntField=function(e,t,r){return Fr(e,t,r,"0")};function Fr(e,t,r,n){return Ct(e,M),r!==n?Qt(e,t,r):t<e.G?e.u[t+e.D]=null:(is(e),delete e.i[t]),e}M.addToRepeatedField=function(e,t,r,n){return Ct(e,M),t=pt(e,t),n!=null?t.splice(n,0,r):t.push(r),e};function Cp(e,t,r,n){return Ct(e,M),(r=ha(e,r))&&r!==t&&n!==void 0&&(e.f&&r in e.f&&(e.f[r]=void 0),Qt(e,r,void 0)),Qt(e,t,n)}M.setOneofField=Cp;function ha(e,t){for(var r,n,o=0;o<t.length;o++){var s=t[o],a=pt(e,s);a!=null&&(r=s,n=a,Qt(e,s,void 0));}return r?(Qt(e,r,n),r):0}M.computeOneofCase=ha;M.getWrapperField=function(e,t,r,n){if(e.f||(e.f={}),!e.f[r]){var o=pt(e,r);(n||o)&&(e.f[r]=new t(o));}return e.f[r]};M.getRepeatedWrapperField=function(e,t,r){return Rp(e,t,r),t=e.f[r],t==Wn&&(t=e.f[r]=[]),t};function Rp(e,t,r){if(e.f||(e.f={}),!e.f[r]){for(var n=pt(e,r),o=[],s=0;s<n.length;s++)o[s]=new t(n[s]);e.f[r]=o;}}M.setWrapperField=function(e,t,r){Ct(e,M),e.f||(e.f={});var n=r&&r.g();return e.f[t]=r,Qt(e,t,n)};M.setOneofWrapperField=function(e,t,r,n){Ct(e,M),e.f||(e.f={});var o=n&&n.g();return e.f[t]=n,Cp(e,t,r,o)};M.setRepeatedWrapperField=function(e,t,r){Ct(e,M),e.f||(e.f={}),r=r||[];for(var n=[],o=0;o<r.length;o++)n[o]=r[o].g();return e.f[t]=r,Qt(e,t,n)};M.addToRepeatedWrapperField=function(e,t,r,n,o){Rp(e,n,t);var s=e.f[t];return s||(s=e.f[t]=[]),r=r||new n,e=pt(e,t),o!=null?(s.splice(o,0,r),e.splice(o,0,r.g())):(s.push(r),e.push(r.g())),r};M.toMap=function(e,t,r,n){for(var o={},s=0;s<e.length;s++)o[t.call(e[s])]=r?r.call(e[s],n,e[s]):e[s];return o};function jp(e){if(e.f)for(var t in e.f){var r=e.f[t];if(Array.isArray(r))for(var n=0;n<r.length;n++)r[n]&&r[n].g();else r&&r.g();}}M.prototype.g=function(){return jp(this),this.u};M.prototype.toArray=M.prototype.g;M.prototype.toString=function(){return jp(this),this.u.toString()};M.prototype.getExtension=function(e){if(this.i){this.f||(this.f={});var t=e.ma;if(e.na){if(e.F())return this.f[t]||(this.f[t]=Kn(this.i[t]||[],function(r){return new e.la(r)})),this.f[t]}else if(e.F())return !this.f[t]&&this.i[t]&&(this.f[t]=new e.la(this.i[t])),this.f[t];return this.i[t]}};M.prototype.getExtension=M.prototype.getExtension;M.prototype.Kc=function(e,t){this.f||(this.f={}),is(this);var r=e.ma;return e.na?(t=t||[],e.F()?(this.f[r]=t,this.i[r]=Kn(t,function(n){return n.g()})):this.i[r]=t):e.F()?(this.f[r]=t,this.i[r]=t&&t.g()):this.i[r]=t,this};M.prototype.setExtension=M.prototype.Kc;M.difference=function(e,t){if(!(e instanceof t.constructor))throw Error("Messages have different types.");var r=e.g();t=t.g();var n=[],o=0,s=r.length>t.length?r.length:t.length;for(e.b&&(n[0]=e.b,o=1);o<s;o++)no(r[o],t[o])||(n[o]=t[o]);return new e.constructor(n)};M.equals=function(e,t){return e==t||!(!e||!t)&&e instanceof t.constructor&&no(e.g(),t.g())};function la(e,t){e=e||{},t=t||{};var r={},n;for(n in e)r[n]=0;for(n in t)r[n]=0;for(n in r)if(!no(e[n],t[n]))return  false;return  true}M.compareExtensions=la;function no(e,t){if(e==t)return  true;if(!Qu(e)||!Qu(t))return typeof e=="number"&&isNaN(e)||typeof t=="number"&&isNaN(t)?String(e)==String(t):false;if(e.constructor!=t.constructor)return  false;if(as&&e.constructor===Uint8Array){if(e.length!=t.length)return  false;for(var r=0;r<e.length;r++)if(e[r]!=t[r])return  false;return  true}if(e.constructor===Array){var n=void 0,o=void 0,s=Math.max(e.length,t.length);for(r=0;r<s;r++){var a=e[r],l=t[r];if(a&&a.constructor==Object&&(w(n===void 0),w(r===e.length-1),n=a,a=void 0),l&&l.constructor==Object&&(w(o===void 0),w(r===t.length-1),o=l,l=void 0),!no(a,l))return  false}return n||o?(n=n||{},o=o||{},la(n,o)):true}if(e.constructor===Object)return la(e,t);throw Error("Invalid type in JSPB array")}M.compareFields=no;M.prototype.Bb=function(){return ls(this)};M.prototype.cloneMessage=M.prototype.Bb;M.prototype.clone=function(){return ls(this)};M.prototype.clone=M.prototype.clone;M.clone=function(e){return ls(e)};function ls(e){return new e.constructor(ua(e.g()))}M.copyInto=function(e,t){Ct(e,M),Ct(t,M),w(e.constructor==t.constructor,"Copy source and target message should have the same type."),e=ls(e);for(var r=t.g(),n=e.g(),o=r.length=0;o<n.length;o++)r[o]=n[o];t.f=e.f,t.i=e.i;};function ua(e){if(Array.isArray(e)){for(var t=Array(e.length),r=0;r<e.length;r++){var n=e[r];n!=null&&(t[r]=typeof n=="object"?ua(w(n)):n);}return t}if(as&&e instanceof Uint8Array)return new Uint8Array(e);t={};for(r in e)n=e[r],n!=null&&(t[r]=typeof n=="object"?ua(w(n)):n);return t}M.registerMessageType=function(e,t){t.we=e;};var Et={dump:function(e){return Ct(e,M,"jspb.Message instance expected"),w(e.getExtension,"Only unobfuscated and unoptimized compilation modes supported."),Et.X(e)}};$("jspb.debug.dump",Et.dump,void 0);Et.X=function(e){var t=Xt(e);if(t=="number"||t=="string"||t=="boolean"||t=="null"||t=="undefined"||typeof Uint8Array!="undefined"&&e instanceof Uint8Array)return e;if(t=="array")return oy(e),Kn(e,Et.X);if(e instanceof H){var r={};e=e.entries();for(var n=e.next();!n.done;n=e.next())r[n.value[0]]=Et.X(n.value[1]);return r}Ct(e,M,"Only messages expected: "+e),t=e.constructor;var o={$name:t.name||t.displayName};for(l in t.prototype){var s=/^get([A-Z]\w*)/.exec(l);if(s&&l!="getExtension"&&l!="getJsPbMessageId"){var a="has"+s[1];(!e[a]||e[a]())&&(a=e[l](),o[Et.$a(s[1])]=Et.X(a));}}if(e.extensionObject_)return o.$extensions="Recursive dumping of extensions not supported in compiled code. Switch to uncompiled or dump extension object directly",o;for(n in t.extensions)if(/^\d+$/.test(n)){a=t.extensions[n];var l=e.getExtension(a);s=void 0,a=a.Ba;var u=[],p=0;for(s in a)u[p++]=s;s=u[0],l!=null&&(r||(r=o.$extensions={}),r[Et.$a(s)]=Et.X(l));}return o};Et.$a=function(e){return e.replace(/^[A-Z]/,function(t){return t.toLowerCase()})};function j(){this.a=[];}$("jspb.BinaryEncoder",j,void 0);j.prototype.length=function(){return this.a.length};j.prototype.length=j.prototype.length;j.prototype.end=function(){var e=this.a;return this.a=[],e};j.prototype.end=j.prototype.end;j.prototype.l=function(e,t){for(w(e==Math.floor(e)),w(t==Math.floor(t)),w(0<=e&&4294967296>e),w(0<=t&&4294967296>t);0<t||127<e;)this.a.push(e&127|128),e=(e>>>7|t<<25)>>>0,t>>>=7;this.a.push(e);};j.prototype.writeSplitVarint64=j.prototype.l;j.prototype.A=function(e,t){w(e==Math.floor(e)),w(t==Math.floor(t)),w(0<=e&&4294967296>e),w(0<=t&&4294967296>t),this.s(e),this.s(t);};j.prototype.writeSplitFixed64=j.prototype.A;j.prototype.j=function(e){for(w(e==Math.floor(e)),w(0<=e&&4294967296>e);127<e;)this.a.push(e&127|128),e>>>=7;this.a.push(e);};j.prototype.writeUnsignedVarint32=j.prototype.j;j.prototype.M=function(e){if(w(e==Math.floor(e)),w(-2147483648<=e&&2147483648>e),0<=e)this.j(e);else {for(var t=0;9>t;t++)this.a.push(e&127|128),e>>=7;this.a.push(1);}};j.prototype.writeSignedVarint32=j.prototype.M;j.prototype.va=function(e){w(e==Math.floor(e)),w(0<=e&&18446744073709552e3>e),Xn(e),this.l(fe,me);};j.prototype.writeUnsignedVarint64=j.prototype.va;j.prototype.ua=function(e){w(e==Math.floor(e)),w(-9223372036854776e3<=e&&9223372036854776e3>e),Xn(e),this.l(fe,me);};j.prototype.writeSignedVarint64=j.prototype.ua;j.prototype.wa=function(e){w(e==Math.floor(e)),w(-2147483648<=e&&2147483648>e),this.j((e<<1^e>>31)>>>0);};j.prototype.writeZigzagVarint32=j.prototype.wa;j.prototype.xa=function(e){w(e==Math.floor(e)),w(-9223372036854776e3<=e&&9223372036854776e3>e),dp(e),this.l(fe,me);};j.prototype.writeZigzagVarint64=j.prototype.xa;j.prototype.Ta=function(e){this.W(ro(e));};j.prototype.writeZigzagVarint64String=j.prototype.Ta;j.prototype.W=function(e){var t=this;cr(e),ts(fe,me,function(r,n){t.l(r>>>0,n>>>0);});};j.prototype.writeZigzagVarintHash64=j.prototype.W;j.prototype.be=function(e){w(e==Math.floor(e)),w(0<=e&&256>e),this.a.push(e>>>0&255);};j.prototype.writeUint8=j.prototype.be;j.prototype.ae=function(e){w(e==Math.floor(e)),w(0<=e&&65536>e),this.a.push(e>>>0&255),this.a.push(e>>>8&255);};j.prototype.writeUint16=j.prototype.ae;j.prototype.s=function(e){w(e==Math.floor(e)),w(0<=e&&4294967296>e),this.a.push(e>>>0&255),this.a.push(e>>>8&255),this.a.push(e>>>16&255),this.a.push(e>>>24&255);};j.prototype.writeUint32=j.prototype.s;j.prototype.V=function(e){w(e==Math.floor(e)),w(0<=e&&18446744073709552e3>e),fa(e),this.s(fe),this.s(me);};j.prototype.writeUint64=j.prototype.V;j.prototype.Qc=function(e){w(e==Math.floor(e)),w(-128<=e&&128>e),this.a.push(e>>>0&255);};j.prototype.writeInt8=j.prototype.Qc;j.prototype.Pc=function(e){w(e==Math.floor(e)),w(-32768<=e&&32768>e),this.a.push(e>>>0&255),this.a.push(e>>>8&255);};j.prototype.writeInt16=j.prototype.Pc;j.prototype.S=function(e){w(e==Math.floor(e)),w(-2147483648<=e&&2147483648>e),this.a.push(e>>>0&255),this.a.push(e>>>8&255),this.a.push(e>>>16&255),this.a.push(e>>>24&255);};j.prototype.writeInt32=j.prototype.S;j.prototype.T=function(e){w(e==Math.floor(e)),w(-9223372036854776e3<=e&&9223372036854776e3>e),Xn(e),this.A(fe,me);};j.prototype.writeInt64=j.prototype.T;j.prototype.ka=function(e){w(e==Math.floor(e)),w(-9223372036854776e3<=+e&&9223372036854776e3>+e),cr(ro(e)),this.A(fe,me);};j.prototype.writeInt64String=j.prototype.ka;j.prototype.L=function(e){w(e===1/0||e===-1/0||isNaN(e)||-34028234663852886e22<=e&&34028234663852886e22>=e),fp(e),this.s(fe);};j.prototype.writeFloat=j.prototype.L;j.prototype.J=function(e){w(e===1/0||e===-1/0||isNaN(e)||-17976931348623157e292<=e&&17976931348623157e292>=e),hp(e),this.s(fe),this.s(me);};j.prototype.writeDouble=j.prototype.J;j.prototype.I=function(e){w(typeof e=="boolean"||typeof e=="number"),this.a.push(e?1:0);};j.prototype.writeBool=j.prototype.I;j.prototype.R=function(e){w(e==Math.floor(e)),w(-2147483648<=e&&2147483648>e),this.M(e);};j.prototype.writeEnum=j.prototype.R;j.prototype.ja=function(e){this.a.push.apply(this.a,e);};j.prototype.writeBytes=j.prototype.ja;j.prototype.N=function(e){cr(e),this.l(fe,me);};j.prototype.writeVarintHash64=j.prototype.N;j.prototype.K=function(e){cr(e),this.s(fe),this.s(me);};j.prototype.writeFixedHash64=j.prototype.K;j.prototype.U=function(e){var t=this.a.length;ny(e);for(var r=0;r<e.length;r++){var n=e.charCodeAt(r);if(128>n)this.a.push(n);else if(2048>n)this.a.push(n>>6|192),this.a.push(n&63|128);else if(65536>n)if(55296<=n&&56319>=n&&r+1<e.length){var o=e.charCodeAt(r+1);56320<=o&&57343>=o&&(n=1024*(n-55296)+o-56320+65536,this.a.push(n>>18|240),this.a.push(n>>12&63|128),this.a.push(n>>6&63|128),this.a.push(n&63|128),r++);}else this.a.push(n>>12|224),this.a.push(n>>6&63|128),this.a.push(n&63|128);}return this.a.length-t};j.prototype.writeString=j.prototype.U;function J(e,t){this.lo=e,this.hi=t;}$("jspb.arith.UInt64",J,void 0);J.prototype.cmp=function(e){return this.hi<e.hi||this.hi==e.hi&&this.lo<e.lo?-1:this.hi==e.hi&&this.lo==e.lo?0:1};J.prototype.cmp=J.prototype.cmp;J.prototype.La=function(){return new J((this.lo>>>1|(this.hi&1)<<31)>>>0,this.hi>>>1>>>0)};J.prototype.rightShift=J.prototype.La;J.prototype.Da=function(){return new J(this.lo<<1>>>0,(this.hi<<1|this.lo>>>31)>>>0)};J.prototype.leftShift=J.prototype.Da;J.prototype.cb=function(){return !!(this.hi&2147483648)};J.prototype.msb=J.prototype.cb;J.prototype.Ob=function(){return !!(this.lo&1)};J.prototype.lsb=J.prototype.Ob;J.prototype.Ua=function(){return this.lo==0&&this.hi==0};J.prototype.zero=J.prototype.Ua;J.prototype.add=function(e){return new J((this.lo+e.lo&4294967295)>>>0>>>0,((this.hi+e.hi&4294967295)>>>0)+(4294967296<=this.lo+e.lo?1:0)>>>0)};J.prototype.add=J.prototype.add;J.prototype.sub=function(e){return new J((this.lo-e.lo&4294967295)>>>0>>>0,((this.hi-e.hi&4294967295)>>>0)-(0>this.lo-e.lo?1:0)>>>0)};J.prototype.sub=J.prototype.sub;function pa(e,t){var r=e&65535;e>>>=16;var n=t&65535,o=t>>>16;for(t=r*n+65536*(r*o&65535)+65536*(e*n&65535),r=e*o+(r*o>>>16)+(e*n>>>16);4294967296<=t;)t-=4294967296,r+=1;return new J(t>>>0,r>>>0)}J.mul32x32=pa;J.prototype.eb=function(e){var t=pa(this.lo,e);return e=pa(this.hi,e),e.hi=e.lo,e.lo=0,t.add(e)};J.prototype.mul=J.prototype.eb;J.prototype.Xa=function(e){if(e==0)return [];var t=new J(0,0),r=new J(this.lo,this.hi);e=new J(e,0);for(var n=new J(1,0);!e.cb();)e=e.Da(),n=n.Da();for(;!n.Ua();)0>=e.cmp(r)&&(t=t.add(n),r=r.sub(e)),e=e.La(),n=n.La();return [t,r]};J.prototype.div=J.prototype.Xa;J.prototype.toString=function(){for(var e="",t=this;!t.Ua();){t=t.Xa(10);var r=t[0];e=t[1].lo+e,t=r;}return e==""&&(e="0"),e};J.prototype.toString=J.prototype.toString;function fn(e){for(var t=new J(0,0),r=new J(0,0),n=0;n<e.length;n++){if("0">e[n]||"9"<e[n])return null;r.lo=parseInt(e[n],10),t=t.eb(10).add(r);}return t}J.fromString=fn;J.prototype.clone=function(){return new J(this.lo,this.hi)};J.prototype.clone=J.prototype.clone;function Ve(e,t){this.lo=e,this.hi=t;}$("jspb.arith.Int64",Ve,void 0);Ve.prototype.add=function(e){return new Ve((this.lo+e.lo&4294967295)>>>0>>>0,((this.hi+e.hi&4294967295)>>>0)+(4294967296<=this.lo+e.lo?1:0)>>>0)};Ve.prototype.add=Ve.prototype.add;Ve.prototype.sub=function(e){return new Ve((this.lo-e.lo&4294967295)>>>0>>>0,((this.hi-e.hi&4294967295)>>>0)-(0>this.lo-e.lo?1:0)>>>0)};Ve.prototype.sub=Ve.prototype.sub;Ve.prototype.clone=function(){return new Ve(this.lo,this.hi)};Ve.prototype.clone=Ve.prototype.clone;Ve.prototype.toString=function(){var e=(this.hi&2147483648)!=0,t=new J(this.lo,this.hi);return e&&(t=new J(0,0).sub(t)),(e?"-":"")+t.toString()};Ve.prototype.toString=Ve.prototype.toString;function us(e){var t=0<e.length&&e[0]=="-";return t&&(e=e.substring(1)),e=fn(e),e===null?null:(t&&(e=new J(0,0).sub(e)),new Ve(e.lo,e.hi))}Ve.fromString=us;function c(){this.c=[],this.b=0,this.a=new j,this.h=[];}$("jspb.BinaryWriter",c,void 0);function Op(e,t){var r=e.a.end();e.c.push(r),e.c.push(t),e.b+=r.length+t.length;}function je(e,t){return Z(e,t,2),t=e.a.end(),e.c.push(t),e.b+=t.length,t.push(e.b),t}function Oe(e,t){var r=t.pop();for(r=e.b+e.a.length()-r,w(0<=r);127<r;)t.push(r&127|128),r>>>=7,e.b++;t.push(r),e.b++;}c.prototype.pb=function(e,t,r){Op(this,e.subarray(t,r));};c.prototype.writeSerializedMessage=c.prototype.pb;c.prototype.Pb=function(e,t,r){e!=null&&t!=null&&r!=null&&this.pb(e,t,r);};c.prototype.maybeWriteSerializedMessage=c.prototype.Pb;c.prototype.reset=function(){this.c=[],this.a.end(),this.b=0,this.h=[];};c.prototype.reset=c.prototype.reset;c.prototype.ab=function(){w(this.h.length==0);for(var e=new Uint8Array(this.b+this.a.length()),t=this.c,r=t.length,n=0,o=0;o<r;o++){var s=t[o];e.set(s,n),n+=s.length;}return t=this.a.end(),e.set(t,n),n+=t.length,w(n==e.length),this.c=[e],e};c.prototype.getResultBuffer=c.prototype.ab;c.prototype.Kb=function(e){return up(this.ab(),e)};c.prototype.getResultBase64String=c.prototype.Kb;c.prototype.Va=function(e){this.h.push(je(this,e));};c.prototype.beginSubMessage=c.prototype.Va;c.prototype.Ya=function(){w(0<=this.h.length),Oe(this,this.h.pop());};c.prototype.endSubMessage=c.prototype.Ya;function Z(e,t,r){w(1<=t&&t==Math.floor(t)),e.a.j(8*t+r);}c.prototype.Nc=function(e,t,r){switch(e){case 1:this.J(t,r);break;case 2:this.L(t,r);break;case 3:this.T(t,r);break;case 4:this.V(t,r);break;case 5:this.S(t,r);break;case 6:this.Qa(t,r);break;case 7:this.Pa(t,r);break;case 8:this.I(t,r);break;case 9:this.U(t,r);break;case 10:Le("Group field type not supported in writeAny()");break;case 11:Le("Message field type not supported in writeAny()");break;case 12:this.ja(t,r);break;case 13:this.s(t,r);break;case 14:this.R(t,r);break;case 15:this.Ra(t,r);break;case 16:this.Sa(t,r);break;case 17:this.rb(t,r);break;case 18:this.sb(t,r);break;case 30:this.K(t,r);break;case 31:this.N(t,r);break;default:Le("Invalid field type in writeAny()");}};c.prototype.writeAny=c.prototype.Nc;function ma(e,t,r){r!=null&&(Z(e,t,0),e.a.j(r));}function ga(e,t,r){r!=null&&(Z(e,t,0),e.a.M(r));}c.prototype.S=function(e,t){t!=null&&(w(-2147483648<=t&&2147483648>t),ga(this,e,t));};c.prototype.writeInt32=c.prototype.S;c.prototype.ob=function(e,t){t!=null&&(t=parseInt(t,10),w(-2147483648<=t&&2147483648>t),ga(this,e,t));};c.prototype.writeInt32String=c.prototype.ob;c.prototype.T=function(e,t){t!=null&&(w(-9223372036854776e3<=t&&9223372036854776e3>t),t!=null&&(Z(this,e,0),this.a.ua(t)));};c.prototype.writeInt64=c.prototype.T;c.prototype.ka=function(e,t){t!=null&&(t=us(t),Z(this,e,0),this.a.l(t.lo,t.hi));};c.prototype.writeInt64String=c.prototype.ka;c.prototype.s=function(e,t){t!=null&&(w(0<=t&&4294967296>t),ma(this,e,t));};c.prototype.writeUint32=c.prototype.s;c.prototype.ub=function(e,t){t!=null&&(t=parseInt(t,10),w(0<=t&&4294967296>t),ma(this,e,t));};c.prototype.writeUint32String=c.prototype.ub;c.prototype.V=function(e,t){t!=null&&(w(0<=t&&18446744073709552e3>t),t!=null&&(Z(this,e,0),this.a.va(t)));};c.prototype.writeUint64=c.prototype.V;c.prototype.vb=function(e,t){t!=null&&(t=fn(t),Z(this,e,0),this.a.l(t.lo,t.hi));};c.prototype.writeUint64String=c.prototype.vb;c.prototype.rb=function(e,t){t!=null&&(w(-2147483648<=t&&2147483648>t),t!=null&&(Z(this,e,0),this.a.wa(t)));};c.prototype.writeSint32=c.prototype.rb;c.prototype.sb=function(e,t){t!=null&&(w(-9223372036854776e3<=t&&9223372036854776e3>t),t!=null&&(Z(this,e,0),this.a.xa(t)));};c.prototype.writeSint64=c.prototype.sb;c.prototype.$d=function(e,t){t!=null&&t!=null&&(Z(this,e,0),this.a.W(t));};c.prototype.writeSintHash64=c.prototype.$d;c.prototype.Zd=function(e,t){t!=null&&t!=null&&(Z(this,e,0),this.a.Ta(t));};c.prototype.writeSint64String=c.prototype.Zd;c.prototype.Pa=function(e,t){t!=null&&(w(0<=t&&4294967296>t),Z(this,e,5),this.a.s(t));};c.prototype.writeFixed32=c.prototype.Pa;c.prototype.Qa=function(e,t){t!=null&&(w(0<=t&&18446744073709552e3>t),Z(this,e,1),this.a.V(t));};c.prototype.writeFixed64=c.prototype.Qa;c.prototype.nb=function(e,t){t!=null&&(t=fn(t),Z(this,e,1),this.a.A(t.lo,t.hi));};c.prototype.writeFixed64String=c.prototype.nb;c.prototype.Ra=function(e,t){t!=null&&(w(-2147483648<=t&&2147483648>t),Z(this,e,5),this.a.S(t));};c.prototype.writeSfixed32=c.prototype.Ra;c.prototype.Sa=function(e,t){t!=null&&(w(-9223372036854776e3<=t&&9223372036854776e3>t),Z(this,e,1),this.a.T(t));};c.prototype.writeSfixed64=c.prototype.Sa;c.prototype.qb=function(e,t){t!=null&&(t=us(t),Z(this,e,1),this.a.A(t.lo,t.hi));};c.prototype.writeSfixed64String=c.prototype.qb;c.prototype.L=function(e,t){t!=null&&(Z(this,e,5),this.a.L(t));};c.prototype.writeFloat=c.prototype.L;c.prototype.J=function(e,t){t!=null&&(Z(this,e,1),this.a.J(t));};c.prototype.writeDouble=c.prototype.J;c.prototype.I=function(e,t){t!=null&&(w(typeof t=="boolean"||typeof t=="number"),Z(this,e,0),this.a.I(t));};c.prototype.writeBool=c.prototype.I;c.prototype.R=function(e,t){t!=null&&(w(-2147483648<=t&&2147483648>t),Z(this,e,0),this.a.M(t));};c.prototype.writeEnum=c.prototype.R;c.prototype.U=function(e,t){t!=null&&(e=je(this,e),this.a.U(t),Oe(this,e));};c.prototype.writeString=c.prototype.U;c.prototype.ja=function(e,t){t!=null&&(t=os(t),Z(this,e,2),this.a.j(t.length),Op(this,t));};c.prototype.writeBytes=c.prototype.ja;c.prototype.Rc=function(e,t,r){t!=null&&(e=je(this,e),r(t,this),Oe(this,e));};c.prototype.writeMessage=c.prototype.Rc;c.prototype.Sc=function(e,t,r){t!=null&&(Z(this,1,3),Z(this,2,0),this.a.M(e),e=je(this,3),r(t,this),Oe(this,e),Z(this,1,4));};c.prototype.writeMessageSet=c.prototype.Sc;c.prototype.Oc=function(e,t,r){t!=null&&(Z(this,e,3),r(t,this),Z(this,e,4));};c.prototype.writeGroup=c.prototype.Oc;c.prototype.K=function(e,t){t!=null&&(w(t.length==8),Z(this,e,1),this.a.K(t));};c.prototype.writeFixedHash64=c.prototype.K;c.prototype.N=function(e,t){t!=null&&(w(t.length==8),Z(this,e,0),this.a.N(t));};c.prototype.writeVarintHash64=c.prototype.N;c.prototype.A=function(e,t,r){Z(this,e,1),this.a.A(t,r);};c.prototype.writeSplitFixed64=c.prototype.A;c.prototype.l=function(e,t,r){Z(this,e,0),this.a.l(t,r);};c.prototype.writeSplitVarint64=c.prototype.l;c.prototype.tb=function(e,t,r){Z(this,e,0);var n=this.a;ts(t,r,function(o,s){n.l(o>>>0,s>>>0);});};c.prototype.writeSplitZigzagVarint64=c.prototype.tb;c.prototype.Ed=function(e,t){if(t!=null)for(var r=0;r<t.length;r++)ga(this,e,t[r]);};c.prototype.writeRepeatedInt32=c.prototype.Ed;c.prototype.Fd=function(e,t){if(t!=null)for(var r=0;r<t.length;r++)this.ob(e,t[r]);};c.prototype.writeRepeatedInt32String=c.prototype.Fd;c.prototype.Gd=function(e,t){if(t!=null)for(var r=0;r<t.length;r++){var n=t[r];n!=null&&(Z(this,e,0),this.a.ua(n));}};c.prototype.writeRepeatedInt64=c.prototype.Gd;c.prototype.Qd=function(e,t,r,n){if(t!=null)for(var o=0;o<t.length;o++)this.A(e,r(t[o]),n(t[o]));};c.prototype.writeRepeatedSplitFixed64=c.prototype.Qd;c.prototype.Rd=function(e,t,r,n){if(t!=null)for(var o=0;o<t.length;o++)this.l(e,r(t[o]),n(t[o]));};c.prototype.writeRepeatedSplitVarint64=c.prototype.Rd;c.prototype.Sd=function(e,t,r,n){if(t!=null)for(var o=0;o<t.length;o++)this.tb(e,r(t[o]),n(t[o]));};c.prototype.writeRepeatedSplitZigzagVarint64=c.prototype.Sd;c.prototype.Hd=function(e,t){if(t!=null)for(var r=0;r<t.length;r++)this.ka(e,t[r]);};c.prototype.writeRepeatedInt64String=c.prototype.Hd;c.prototype.Ud=function(e,t){if(t!=null)for(var r=0;r<t.length;r++)ma(this,e,t[r]);};c.prototype.writeRepeatedUint32=c.prototype.Ud;c.prototype.Vd=function(e,t){if(t!=null)for(var r=0;r<t.length;r++)this.ub(e,t[r]);};c.prototype.writeRepeatedUint32String=c.prototype.Vd;c.prototype.Wd=function(e,t){if(t!=null)for(var r=0;r<t.length;r++){var n=t[r];n!=null&&(Z(this,e,0),this.a.va(n));}};c.prototype.writeRepeatedUint64=c.prototype.Wd;c.prototype.Xd=function(e,t){if(t!=null)for(var r=0;r<t.length;r++)this.vb(e,t[r]);};c.prototype.writeRepeatedUint64String=c.prototype.Xd;c.prototype.Md=function(e,t){if(t!=null)for(var r=0;r<t.length;r++){var n=t[r];n!=null&&(Z(this,e,0),this.a.wa(n));}};c.prototype.writeRepeatedSint32=c.prototype.Md;c.prototype.Nd=function(e,t){if(t!=null)for(var r=0;r<t.length;r++){var n=t[r];n!=null&&(Z(this,e,0),this.a.xa(n));}};c.prototype.writeRepeatedSint64=c.prototype.Nd;c.prototype.Od=function(e,t){if(t!=null)for(var r=0;r<t.length;r++){var n=t[r];n!=null&&(Z(this,e,0),this.a.Ta(n));}};c.prototype.writeRepeatedSint64String=c.prototype.Od;c.prototype.Pd=function(e,t){if(t!=null)for(var r=0;r<t.length;r++){var n=t[r];n!=null&&(Z(this,e,0),this.a.W(n));}};c.prototype.writeRepeatedSintHash64=c.prototype.Pd;c.prototype.yd=function(e,t){if(t!=null)for(var r=0;r<t.length;r++)this.Pa(e,t[r]);};c.prototype.writeRepeatedFixed32=c.prototype.yd;c.prototype.zd=function(e,t){if(t!=null)for(var r=0;r<t.length;r++)this.Qa(e,t[r]);};c.prototype.writeRepeatedFixed64=c.prototype.zd;c.prototype.Ad=function(e,t){if(t!=null)for(var r=0;r<t.length;r++)this.nb(e,t[r]);};c.prototype.writeRepeatedFixed64String=c.prototype.Ad;c.prototype.Jd=function(e,t){if(t!=null)for(var r=0;r<t.length;r++)this.Ra(e,t[r]);};c.prototype.writeRepeatedSfixed32=c.prototype.Jd;c.prototype.Kd=function(e,t){if(t!=null)for(var r=0;r<t.length;r++)this.Sa(e,t[r]);};c.prototype.writeRepeatedSfixed64=c.prototype.Kd;c.prototype.Ld=function(e,t){if(t!=null)for(var r=0;r<t.length;r++)this.qb(e,t[r]);};c.prototype.writeRepeatedSfixed64String=c.prototype.Ld;c.prototype.Cd=function(e,t){if(t!=null)for(var r=0;r<t.length;r++)this.L(e,t[r]);};c.prototype.writeRepeatedFloat=c.prototype.Cd;c.prototype.wd=function(e,t){if(t!=null)for(var r=0;r<t.length;r++)this.J(e,t[r]);};c.prototype.writeRepeatedDouble=c.prototype.wd;c.prototype.ud=function(e,t){if(t!=null)for(var r=0;r<t.length;r++)this.I(e,t[r]);};c.prototype.writeRepeatedBool=c.prototype.ud;c.prototype.xd=function(e,t){if(t!=null)for(var r=0;r<t.length;r++)this.R(e,t[r]);};c.prototype.writeRepeatedEnum=c.prototype.xd;c.prototype.Td=function(e,t){if(t!=null)for(var r=0;r<t.length;r++)this.U(e,t[r]);};c.prototype.writeRepeatedString=c.prototype.Td;c.prototype.vd=function(e,t){if(t!=null)for(var r=0;r<t.length;r++)this.ja(e,t[r]);};c.prototype.writeRepeatedBytes=c.prototype.vd;c.prototype.Id=function(e,t,r){if(t!=null)for(var n=0;n<t.length;n++){var o=je(this,e);r(t[n],this),Oe(this,o);}};c.prototype.writeRepeatedMessage=c.prototype.Id;c.prototype.Dd=function(e,t,r){if(t!=null)for(var n=0;n<t.length;n++)Z(this,e,3),r(t[n],this),Z(this,e,4);};c.prototype.writeRepeatedGroup=c.prototype.Dd;c.prototype.Bd=function(e,t){if(t!=null)for(var r=0;r<t.length;r++)this.K(e,t[r]);};c.prototype.writeRepeatedFixedHash64=c.prototype.Bd;c.prototype.Yd=function(e,t){if(t!=null)for(var r=0;r<t.length;r++)this.N(e,t[r]);};c.prototype.writeRepeatedVarintHash64=c.prototype.Yd;c.prototype.ad=function(e,t){if(t!=null&&t.length){e=je(this,e);for(var r=0;r<t.length;r++)this.a.M(t[r]);Oe(this,e);}};c.prototype.writePackedInt32=c.prototype.ad;c.prototype.bd=function(e,t){if(t!=null&&t.length){e=je(this,e);for(var r=0;r<t.length;r++)this.a.M(parseInt(t[r],10));Oe(this,e);}};c.prototype.writePackedInt32String=c.prototype.bd;c.prototype.cd=function(e,t){if(t!=null&&t.length){e=je(this,e);for(var r=0;r<t.length;r++)this.a.ua(t[r]);Oe(this,e);}};c.prototype.writePackedInt64=c.prototype.cd;c.prototype.md=function(e,t,r,n){if(t!=null){e=je(this,e);for(var o=0;o<t.length;o++)this.a.A(r(t[o]),n(t[o]));Oe(this,e);}};c.prototype.writePackedSplitFixed64=c.prototype.md;c.prototype.nd=function(e,t,r,n){if(t!=null){e=je(this,e);for(var o=0;o<t.length;o++)this.a.l(r(t[o]),n(t[o]));Oe(this,e);}};c.prototype.writePackedSplitVarint64=c.prototype.nd;c.prototype.od=function(e,t,r,n){if(t!=null){e=je(this,e);for(var o=this.a,s=0;s<t.length;s++)ts(r(t[s]),n(t[s]),function(a,l){o.l(a>>>0,l>>>0);});Oe(this,e);}};c.prototype.writePackedSplitZigzagVarint64=c.prototype.od;c.prototype.dd=function(e,t){if(t!=null&&t.length){e=je(this,e);for(var r=0;r<t.length;r++){var n=us(t[r]);this.a.l(n.lo,n.hi);}Oe(this,e);}};c.prototype.writePackedInt64String=c.prototype.dd;c.prototype.pd=function(e,t){if(t!=null&&t.length){e=je(this,e);for(var r=0;r<t.length;r++)this.a.j(t[r]);Oe(this,e);}};c.prototype.writePackedUint32=c.prototype.pd;c.prototype.qd=function(e,t){if(t!=null&&t.length){e=je(this,e);for(var r=0;r<t.length;r++)this.a.j(parseInt(t[r],10));Oe(this,e);}};c.prototype.writePackedUint32String=c.prototype.qd;c.prototype.rd=function(e,t){if(t!=null&&t.length){e=je(this,e);for(var r=0;r<t.length;r++)this.a.va(t[r]);Oe(this,e);}};c.prototype.writePackedUint64=c.prototype.rd;c.prototype.sd=function(e,t){if(t!=null&&t.length){e=je(this,e);for(var r=0;r<t.length;r++){var n=fn(t[r]);this.a.l(n.lo,n.hi);}Oe(this,e);}};c.prototype.writePackedUint64String=c.prototype.sd;c.prototype.hd=function(e,t){if(t!=null&&t.length){e=je(this,e);for(var r=0;r<t.length;r++)this.a.wa(t[r]);Oe(this,e);}};c.prototype.writePackedSint32=c.prototype.hd;c.prototype.jd=function(e,t){if(t!=null&&t.length){e=je(this,e);for(var r=0;r<t.length;r++)this.a.xa(t[r]);Oe(this,e);}};c.prototype.writePackedSint64=c.prototype.jd;c.prototype.kd=function(e,t){if(t!=null&&t.length){e=je(this,e);for(var r=0;r<t.length;r++)this.a.W(ro(t[r]));Oe(this,e);}};c.prototype.writePackedSint64String=c.prototype.kd;c.prototype.ld=function(e,t){if(t!=null&&t.length){e=je(this,e);for(var r=0;r<t.length;r++)this.a.W(t[r]);Oe(this,e);}};c.prototype.writePackedSintHash64=c.prototype.ld;c.prototype.Wc=function(e,t){if(t!=null&&t.length)for(Z(this,e,2),this.a.j(4*t.length),e=0;e<t.length;e++)this.a.s(t[e]);};c.prototype.writePackedFixed32=c.prototype.Wc;c.prototype.Xc=function(e,t){if(t!=null&&t.length)for(Z(this,e,2),this.a.j(8*t.length),e=0;e<t.length;e++)this.a.V(t[e]);};c.prototype.writePackedFixed64=c.prototype.Xc;c.prototype.Yc=function(e,t){if(t!=null&&t.length)for(Z(this,e,2),this.a.j(8*t.length),e=0;e<t.length;e++){var r=fn(t[e]);this.a.A(r.lo,r.hi);}};c.prototype.writePackedFixed64String=c.prototype.Yc;c.prototype.ed=function(e,t){if(t!=null&&t.length)for(Z(this,e,2),this.a.j(4*t.length),e=0;e<t.length;e++)this.a.S(t[e]);};c.prototype.writePackedSfixed32=c.prototype.ed;c.prototype.fd=function(e,t){if(t!=null&&t.length)for(Z(this,e,2),this.a.j(8*t.length),e=0;e<t.length;e++)this.a.T(t[e]);};c.prototype.writePackedSfixed64=c.prototype.fd;c.prototype.gd=function(e,t){if(t!=null&&t.length)for(Z(this,e,2),this.a.j(8*t.length),e=0;e<t.length;e++)this.a.ka(t[e]);};c.prototype.writePackedSfixed64String=c.prototype.gd;c.prototype.$c=function(e,t){if(t!=null&&t.length)for(Z(this,e,2),this.a.j(4*t.length),e=0;e<t.length;e++)this.a.L(t[e]);};c.prototype.writePackedFloat=c.prototype.$c;c.prototype.Uc=function(e,t){if(t!=null&&t.length)for(Z(this,e,2),this.a.j(8*t.length),e=0;e<t.length;e++)this.a.J(t[e]);};c.prototype.writePackedDouble=c.prototype.Uc;c.prototype.Tc=function(e,t){if(t!=null&&t.length)for(Z(this,e,2),this.a.j(t.length),e=0;e<t.length;e++)this.a.I(t[e]);};c.prototype.writePackedBool=c.prototype.Tc;c.prototype.Vc=function(e,t){if(t!=null&&t.length){e=je(this,e);for(var r=0;r<t.length;r++)this.a.R(t[r]);Oe(this,e);}};c.prototype.writePackedEnum=c.prototype.Vc;c.prototype.Zc=function(e,t){if(t!=null&&t.length)for(Z(this,e,2),this.a.j(8*t.length),e=0;e<t.length;e++)this.a.K(t[e]);};c.prototype.writePackedFixedHash64=c.prototype.Zc;c.prototype.td=function(e,t){if(t!=null&&t.length){e=je(this,e);for(var r=0;r<t.length;r++)this.a.N(t[r]);Oe(this,e);}};c.prototype.writePackedVarintHash64=c.prototype.td;typeof Ge=="object"&&(Ge.debug=Et,Ge.Map=H,Ge.Message=M,Ge.BinaryReader=h,Ge.BinaryWriter=c,Ge.ExtensionFieldInfo=Hn,Ge.ExtensionFieldBinaryInfo=wp,Ge.exportSymbol=Xg,Ge.inherits=Qg,Ge.object={extend:ey},Ge.typeOf=Xt);});var Ma="vercel.ai.error",lc=Symbol.for(Ma),Na,uc=class Da extends Error{constructor({name:t,message:r,cause:n}){super(r),this[Na]=true,this.name=t,this.cause=n;}static isInstance(t){return Da.hasMarker(t,Ma)}static hasMarker(t,r){let n=Symbol.for(r);return t!=null&&typeof t=="object"&&n in t&&typeof t[n]=="boolean"&&t[n]===true}};Na=lc;var B=uc,Fa="AI_APICallError",Ua=`vercel.ai.error.${Fa}`,pc=Symbol.for(Ua),$a,Se=class extends B{constructor({message:e,url:t,requestBodyValues:r,statusCode:n,responseHeaders:o,responseBody:s,cause:a,isRetryable:l=n!=null&&(n===408||n===409||n===429||n>=500),data:u}){super({name:Fa,message:e,cause:a}),this[$a]=true,this.url=t,this.requestBodyValues=r,this.statusCode=n,this.responseHeaders=o,this.responseBody=s,this.isRetryable=l,this.data=u;}static isInstance(e){return B.hasMarker(e,Ua)}};$a=pc;var qa="AI_EmptyResponseBodyError",Ba=`vercel.ai.error.${qa}`,cc=Symbol.for(Ba),za,_o=class extends B{constructor({message:e="Empty response body"}={}){super({name:qa,message:e}),this[za]=true;}static isInstance(e){return B.hasMarker(e,Ba)}};za=cc;function rr(e){return e==null?"unknown error":typeof e=="string"?e:e instanceof Error?e.message:JSON.stringify(e)}var La="AI_InvalidArgumentError",Va=`vercel.ai.error.${La}`,dc=Symbol.for(Va),Ja,nr=class extends B{constructor({message:e,cause:t,argument:r}){super({name:La,message:e,cause:t}),this[Ja]=true,this.argument=r;}static isInstance(e){return B.hasMarker(e,Va)}};Ja=dc;var Za="AI_InvalidPromptError",Ga=`vercel.ai.error.${Za}`,fc=Symbol.for(Ga),Ha,_t=class extends B{constructor({prompt:e,message:t,cause:r}){super({name:Za,message:`Invalid prompt: ${t}`,cause:r}),this[Ha]=true,this.prompt=e;}static isInstance(e){return B.hasMarker(e,Ga)}};Ha=fc;var Wa="AI_InvalidResponseDataError",Ka=`vercel.ai.error.${Wa}`,hc=Symbol.for(Ka),Ya,wo=class extends B{constructor({data:e,message:t=`Invalid response data: ${JSON.stringify(e)}.`}){super({name:Wa,message:t}),this[Ya]=true,this.data=e;}static isInstance(e){return B.hasMarker(e,Ka)}};Ya=hc;var Xa="AI_JSONParseError",Qa=`vercel.ai.error.${Xa}`,mc=Symbol.for(Qa),ei,dt=class extends B{constructor({text:e,cause:t}){super({name:Xa,message:`JSON parsing failed: Text: ${e}.
Error message: ${rr(t)}`,cause:t}),this[ei]=true,this.text=e;}static isInstance(e){return B.hasMarker(e,Qa)}};ei=mc;var ti="AI_LoadAPIKeyError",ri=`vercel.ai.error.${ti}`,gc=Symbol.for(ri),ni,Mt=class extends B{constructor({message:e}){super({name:ti,message:e}),this[ni]=true;}static isInstance(e){return B.hasMarker(e,ri)}};ni=gc;var oi="AI_TooManyEmbeddingValuesForCallError",si=`vercel.ai.error.${oi}`,Cc=Symbol.for(si),ai,xo=class extends B{constructor(e){super({name:oi,message:`Too many values for a single embedding call. The ${e.provider} model "${e.modelId}" can only embed up to ${e.maxEmbeddingsPerCall} values per call, but ${e.values.length} values were provided.`}),this[ai]=true,this.provider=e.provider,this.modelId=e.modelId,this.maxEmbeddingsPerCall=e.maxEmbeddingsPerCall,this.values=e.values;}static isInstance(e){return B.hasMarker(e,si)}};ai=Cc;var ii="AI_TypeValidationError",li=`vercel.ai.error.${ii}`,Rc=Symbol.for(li),ui,jc=class ws extends B{constructor({value:t,cause:r}){super({name:ii,message:`Type validation failed: Value: ${JSON.stringify(t)}.
Error message: ${rr(r)}`,cause:r}),this[ui]=true,this.value=t;}static isInstance(t){return B.hasMarker(t,li)}static wrap({value:t,cause:r}){return ws.isInstance(r)&&r.value===t?r:new ws({value:t,cause:r})}};ui=Rc;var Be=jc,pi="AI_UnsupportedFunctionalityError",ci=`vercel.ai.error.${pi}`,Oc=Symbol.for(ci),di,ae=class extends B{constructor({functionality:e,message:t=`'${e}' functionality not supported.`}){super({name:pi,message:t}),this[di]=true,this.functionality=e;}static isInstance(e){return B.hasMarker(e,ci)}};di=Oc;function bo(e){return e===null||typeof e=="string"||typeof e=="number"||typeof e=="boolean"?true:Array.isArray(e)?e.every(bo):typeof e=="object"?Object.entries(e).every(([t,r])=>typeof t=="string"&&bo(r)):false}function xs(e){return Array.isArray(e)&&e.every(bo)}function So(e){return e!=null&&typeof e=="object"&&Object.entries(e).every(([t,r])=>typeof t=="string"&&bo(r))}var To=(e,t=21)=>(r=t)=>{let n="",o=r|0;for(;o--;)n+=e[Math.random()*e.length|0];return n};var Io=_s(Ts());function Ze(...e){return e.reduce((t,r)=>d(d({},t),r!=null?r:{}),{})}function yi(e){return new ReadableStream({pull(r){return A(this,null,function*(){try{let{value:n,done:o}=yield e.next();o?r.close():r.enqueue(n);}catch(n){r.error(n);}})},cancel(){}})}function vi(e){return A(this,null,function*(){return e==null?Promise.resolve():new Promise(t=>setTimeout(t,e))})}function Nc(){let e="",t,r=[],n,o;function s(u,p){if(u===""){a(p);return}if(u.startsWith(":"))return;let f=u.indexOf(":");if(f===-1){l(u,"");return}let m=u.slice(0,f),y=f+1,v=y<u.length&&u[y]===" "?u.slice(y+1):u.slice(y);l(m,v);}function a(u){r.length>0&&(u.enqueue({event:t,data:r.join(`
`),id:n,retry:o}),r=[],t=void 0,o=void 0);}function l(u,p){switch(u){case "event":t=p;break;case "data":r.push(p);break;case "id":n=p;break;case "retry":let f=parseInt(p,10);isNaN(f)||(o=f);break}}return new TransformStream({transform(u,p){let{lines:f,incompleteLine:m}=Dc(e,u);e=m;for(let y=0;y<f.length;y++)s(f[y],p);},flush(u){s(e,u),a(u);}})}function Dc(e,t){let r=[],n=e;for(let o=0;o<t.length;){let s=t[o++];s===`
`?(r.push(n),n=""):s==="\r"?(r.push(n),n="",t[o+1]===`
`&&o++):n+=s;}return {lines:r,incompleteLine:n}}function An(e){let t={};return e.headers.forEach((r,n)=>{t[n]=r;}),t}var wt=({prefix:e,size:t=16,alphabet:r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:n="-"}={})=>{let o=To(r,t);if(e==null)return o;if(r.includes(n))throw new nr({argument:"separator",message:`The separator "${n}" must not be part of the alphabet "${r}".`});return s=>`${e}${n}${o(s)}`},ft=wt();function bi(e){return e==null?"unknown error":typeof e=="string"?e:e instanceof Error?e.message:JSON.stringify(e)}function Fc(e){return Object.fromEntries(Object.entries(e).filter(([t,r])=>r!=null))}function In(e){return e instanceof Error&&(e.name==="AbortError"||e.name==="TimeoutError")}function _i({apiKey:e,environmentVariableName:t,apiKeyParameterName:r="apiKey",description:n}){if(typeof e=="string")return e;if(e!=null)throw new Mt({message:`${n} API key must be a string.`});if(typeof process=="undefined")throw new Mt({message:`${n} API key is missing. Pass it using the '${r}' parameter. Environment variables is not supported in this environment.`});if(e=process.env[t],e==null)throw new Mt({message:`${n} API key is missing. Pass it using the '${r}' parameter or the ${t} environment variable.`});if(typeof e!="string")throw new Mt({message:`${n} API key must be a string. The value of the ${t} environment variable is not a string.`});return e}var kn=Symbol.for("vercel.ai.validator");function Uc(e){return {[kn]:true,validate:e}}function $c(e){return typeof e=="object"&&e!==null&&kn in e&&e[kn]===true&&"validate"in e}function qc(e){return $c(e)?e:Bc(e)}function Bc(e){return Uc(t=>{let r=e.safeParse(t);return r.success?{success:true,value:r.data}:{success:false,error:r.error}})}function zc({value:e,schema:t}){let r=it({value:e,schema:t});if(!r.success)throw Be.wrap({value:e,cause:r.error});return r.value}function it({value:e,schema:t}){let r=qc(t);try{if(r.validate==null)return {success:!0,value:e};let n=r.validate(e);return n.success?n:{success:!1,error:Be.wrap({value:e,cause:n.error})}}catch(n){return {success:false,error:Be.wrap({value:e,cause:n})}}}function Lc({text:e,schema:t}){try{let r=Io.default.parse(e);return t==null?r:zc({value:r,schema:t})}catch(r){throw dt.isInstance(r)||Be.isInstance(r)?r:new dt({text:e,cause:r})}}function xt({text:e,schema:t}){try{let r=Io.default.parse(e);if(t==null)return {success:!0,value:r,rawValue:r};let n=it({value:r,schema:t});return n.success?g(d({},n),{rawValue:r}):n}catch(r){return {success:false,error:dt.isInstance(r)?r:new dt({text:e,cause:r})}}}function Is(e){try{return Io.default.parse(e),!0}catch(t){return  false}}function Lr({provider:e,providerOptions:t,schema:r}){if((t==null?void 0:t[e])==null)return;let n=it({value:t[e],schema:r});if(!n.success)throw new nr({argument:"providerOptions",message:`invalid ${e} provider options`,cause:n.error});return n.value}var Vc=()=>globalThis.fetch,Qe=l=>A(null,[l],function*({url:e,headers:t,body:r,failedResponseHandler:n,successfulResponseHandler:o,abortSignal:s,fetch:a}){return xi({url:e,headers:d({"Content-Type":"application/json"},t),body:{content:JSON.stringify(r),values:r},failedResponseHandler:n,successfulResponseHandler:o,abortSignal:s,fetch:a})}),wi=l=>A(null,[l],function*({url:e,headers:t,formData:r,failedResponseHandler:n,successfulResponseHandler:o,abortSignal:s,fetch:a}){return xi({url:e,headers:t,body:{content:r,values:Object.fromEntries(r.entries())},failedResponseHandler:n,successfulResponseHandler:o,abortSignal:s,fetch:a})}),xi=l=>A(null,[l],function*({url:e,headers:t={},body:r,successfulResponseHandler:n,failedResponseHandler:o,abortSignal:s,fetch:a=Vc()}){try{let u=yield a(e,{method:"POST",headers:Fc(t),body:r.content,signal:s}),p=An(u);if(!u.ok){let f;try{f=yield o({response:u,url:e,requestBodyValues:r.values});}catch(m){throw In(m)||Se.isInstance(m)?m:new Se({message:"Failed to process error response",cause:m,statusCode:u.status,url:e,responseHeaders:p,requestBodyValues:r.values})}throw f.value}try{return yield n({response:u,url:e,requestBodyValues:r.values})}catch(f){throw f instanceof Error&&(In(f)||Se.isInstance(f))?f:new Se({message:"Failed to process successful response",cause:f,statusCode:u.status,url:e,responseHeaders:p,requestBodyValues:r.values})}}catch(u){if(In(u))throw u;if(u instanceof TypeError&&u.message==="fetch failed"){let p=u.cause;if(p!=null)throw new Se({message:`Cannot connect to API: ${p.message}`,cause:p,url:e,requestBodyValues:r.values,isRetryable:true})}throw u}});var Si=({errorSchema:e,errorToMessage:t,isRetryable:r})=>a=>A(null,[a],function*({response:n,url:o,requestBodyValues:s}){let l=yield n.text(),u=An(n);if(l.trim()==="")return {responseHeaders:u,value:new Se({message:n.statusText,url:o,requestBodyValues:s,statusCode:n.status,responseHeaders:u,responseBody:l,isRetryable:r==null?void 0:r(n)})};try{let p=Lc({text:l,schema:e});return {responseHeaders:u,value:new Se({message:t(p),url:o,requestBodyValues:s,statusCode:n.status,responseHeaders:u,responseBody:l,data:p,isRetryable:r==null?void 0:r(n,p)})}}catch(p){return {responseHeaders:u,value:new Se({message:n.statusText,url:o,requestBodyValues:s,statusCode:n.status,responseHeaders:u,responseBody:l,isRetryable:r==null?void 0:r(n)})}}}),Vr=e=>r=>A(null,[r],function*({response:t}){let n=An(t);if(t.body==null)throw new _o({});return {responseHeaders:n,value:t.body.pipeThrough(new TextDecoderStream).pipeThrough(Nc()).pipeThrough(new TransformStream({transform({data:o},s){o!=="[DONE]"&&s.enqueue(xt({text:o,schema:e}));}}))}});var ht=e=>o=>A(null,[o],function*({response:t,url:r,requestBodyValues:n}){let s=yield t.text(),a=xt({text:s,schema:e}),l=An(t);if(!a.success)throw new Se({message:"Invalid JSON response",cause:a.error,statusCode:t.status,responseHeaders:l,responseBody:s,url:r,requestBodyValues:n});return {responseHeaders:l,value:a.value,rawValue:a.rawValue}}),Ti=()=>n=>A(null,[n],function*({response:e,url:t,requestBodyValues:r}){let o=An(e);if(!e.body)throw new Se({message:"Response body is empty",url:t,requestBodyValues:r,statusCode:e.status,responseHeaders:o,responseBody:void 0});try{let s=yield e.arrayBuffer();return {responseHeaders:o,value:new Uint8Array(s)}}catch(s){throw new Se({message:"Failed to read response as array buffer",url:t,requestBodyValues:r,statusCode:e.status,responseHeaders:o,responseBody:void 0,cause:s})}});var{btoa:Jc,atob:Zc}=globalThis;function or(e){let t=e.replace(/-/g,"+").replace(/_/g,"/"),r=Zc(t);return Uint8Array.from(r,n=>n.codePointAt(0))}function Lt(e){let t="";for(let r=0;r<e.length;r++)t+=String.fromCodePoint(e[r]);return Jc(t)}function Ii(e){return e==null?void 0:e.replace(/\/$/,"")}var ue;(function(e){e.assertEqual=o=>o;function t(o){}e.assertIs=t;function r(o){throw new Error}e.assertNever=r,e.arrayToEnum=o=>{let s={};for(let a of o)s[a]=a;return s},e.getValidEnumValues=o=>{let s=e.objectKeys(o).filter(l=>typeof o[o[l]]!="number"),a={};for(let l of s)a[l]=o[l];return e.objectValues(a)},e.objectValues=o=>e.objectKeys(o).map(function(s){return o[s]}),e.objectKeys=typeof Object.keys=="function"?o=>Object.keys(o):o=>{let s=[];for(let a in o)Object.prototype.hasOwnProperty.call(o,a)&&s.push(a);return s},e.find=(o,s)=>{for(let a of o)if(s(a))return a},e.isInteger=typeof Number.isInteger=="function"?o=>Number.isInteger(o):o=>typeof o=="number"&&isFinite(o)&&Math.floor(o)===o;function n(o,s=" | "){return o.map(a=>typeof a=="string"?`'${a}'`:a).join(s)}e.joinValues=n,e.jsonStringifyReplacer=(o,s)=>typeof s=="bigint"?s.toString():s;})(ue||(ue={}));var As;(function(e){e.mergeShapes=(t,r)=>d(d({},t),r);})(As||(As={}));var U=ue.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Jt=e=>{switch(typeof e){case "undefined":return U.undefined;case "string":return U.string;case "number":return isNaN(e)?U.nan:U.number;case "boolean":return U.boolean;case "function":return U.function;case "bigint":return U.bigint;case "symbol":return U.symbol;case "object":return Array.isArray(e)?U.array:e===null?U.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?U.promise:typeof Map!="undefined"&&e instanceof Map?U.map:typeof Set!="undefined"&&e instanceof Set?U.set:typeof Date!="undefined"&&e instanceof Date?U.date:U.object;default:return U.unknown}},E=ue.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),Gc=e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:"),lt=class e extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n];},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n];};let r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=t;}format(t){let r=t||function(s){return s.message},n={_errors:[]},o=s=>{for(let a of s.issues)if(a.code==="invalid_union")a.unionErrors.map(o);else if(a.code==="invalid_return_type")o(a.returnTypeError);else if(a.code==="invalid_arguments")o(a.argumentsError);else if(a.path.length===0)n._errors.push(r(a));else {let l=n,u=0;for(;u<a.path.length;){let p=a.path[u];u===a.path.length-1?(l[p]=l[p]||{_errors:[]},l[p]._errors.push(r(a))):l[p]=l[p]||{_errors:[]},l=l[p],u++;}}};return o(this),n}static assert(t){if(!(t instanceof e))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,ue.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=r=>r.message){let r={},n=[];for(let o of this.issues)o.path.length>0?(r[o.path[0]]=r[o.path[0]]||[],r[o.path[0]].push(t(o))):n.push(t(o));return {formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}};lt.create=e=>new lt(e);var Gr=(e,t)=>{let r;switch(e.code){case E.invalid_type:e.received===U.undefined?r="Required":r=`Expected ${e.expected}, received ${e.received}`;break;case E.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(e.expected,ue.jsonStringifyReplacer)}`;break;case E.unrecognized_keys:r=`Unrecognized key(s) in object: ${ue.joinValues(e.keys,", ")}`;break;case E.invalid_union:r="Invalid input";break;case E.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${ue.joinValues(e.options)}`;break;case E.invalid_enum_value:r=`Invalid enum value. Expected ${ue.joinValues(e.options)}, received '${e.received}'`;break;case E.invalid_arguments:r="Invalid function arguments";break;case E.invalid_return_type:r="Invalid function return type";break;case E.invalid_date:r="Invalid date";break;case E.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(r=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?r=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?r=`Invalid input: must end with "${e.validation.endsWith}"`:ue.assertNever(e.validation):e.validation!=="regex"?r=`Invalid ${e.validation}`:r="Invalid";break;case E.too_small:e.type==="array"?r=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?r=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?r=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?r=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:r="Invalid input";break;case E.too_big:e.type==="array"?r=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?r=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?r=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?r=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?r=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:r="Invalid input";break;case E.custom:r="Invalid input";break;case E.invalid_intersection_types:r="Intersection results could not be merged";break;case E.not_multiple_of:r=`Number must be a multiple of ${e.multipleOf}`;break;case E.not_finite:r="Number must be finite";break;default:r=t.defaultError,ue.assertNever(e);}return {message:r}},Ci=Gr;function Hc(e){Ci=e;}function ko(){return Ci}var Ao=e=>{let{data:t,path:r,errorMaps:n,issueData:o}=e,s=[...r,...o.path||[]],a=g(d({},o),{path:s});if(o.message!==void 0)return g(d({},o),{path:s,message:o.message});let l="",u=n.filter(p=>!!p).slice().reverse();for(let p of u)l=p(a,{data:t,defaultError:l}).message;return g(d({},o),{path:s,message:l})},Wc=[];function D(e,t){let r=ko(),n=Ao({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,r,r===Gr?void 0:Gr].filter(o=>!!o)});e.common.issues.push(n);}var Ye=class e{constructor(){this.value="valid";}dirty(){this.value==="valid"&&(this.value="dirty");}abort(){this.value!=="aborted"&&(this.value="aborted");}static mergeArray(t,r){let n=[];for(let o of r){if(o.status==="aborted")return W;o.status==="dirty"&&t.dirty(),n.push(o.value);}return {status:t.value,value:n}}static mergeObjectAsync(t,r){return A(this,null,function*(){let n=[];for(let o of r){let s=yield o.key,a=yield o.value;n.push({key:s,value:a});}return e.mergeObjectSync(t,n)})}static mergeObjectSync(t,r){let n={};for(let o of r){let{key:s,value:a}=o;if(s.status==="aborted"||a.status==="aborted")return W;s.status==="dirty"&&t.dirty(),a.status==="dirty"&&t.dirty(),s.value!=="__proto__"&&(typeof a.value!="undefined"||o.alwaysSet)&&(n[s.value]=a.value);}return {status:t.value,value:n}}},W=Object.freeze({status:"aborted"}),Zr=e=>({status:"dirty",value:e}),et=e=>({status:"valid",value:e}),Es=e=>e.status==="aborted",Cs=e=>e.status==="dirty",br=e=>e.status==="valid",Rn=e=>typeof Promise!="undefined"&&e instanceof Promise;function Eo(e,t,r,n){if(typeof t=="function"?e!==t||true:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t.get(e)}function Ri(e,t,r,n,o){if(typeof t=="function"?e!==t||true:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(e,r),r}var z;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t==null?void 0:t.message;})(z||(z={}));var En,Cn,mt=class{constructor(t,r,n,o){this._cachedPath=[],this.parent=t,this.data=r,this._path=n,this._key=o;}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},ki=(e,t)=>{if(br(t))return {success:true,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return {success:false,get error(){if(this._error)return this._error;let r=new lt(e.common.issues);return this._error=r,this._error}}};function ee(e){if(!e)return {};let{errorMap:t,invalid_type_error:r,required_error:n,description:o}=e;if(t&&(r||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:o}:{errorMap:(a,l)=>{var u,p;let{message:f}=e;return a.code==="invalid_enum_value"?{message:f!=null?f:l.defaultError}:typeof l.data=="undefined"?{message:(u=f!=null?f:n)!==null&&u!==void 0?u:l.defaultError}:a.code!=="invalid_type"?{message:l.defaultError}:{message:(p=f!=null?f:r)!==null&&p!==void 0?p:l.defaultError}},description:o}}var te=class{get description(){return this._def.description}_getType(t){return Jt(t.data)}_getOrReturnCtx(t,r){return r||{common:t.parent.common,data:t.data,parsedType:Jt(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return {status:new Ye,ctx:{common:t.parent.common,data:t.data,parsedType:Jt(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){let r=this._parse(t);if(Rn(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(t){let r=this._parse(t);return Promise.resolve(r)}parse(t,r){let n=this.safeParse(t,r);if(n.success)return n.data;throw n.error}safeParse(t,r){var n;let o={common:{issues:[],async:(n=r==null?void 0:r.async)!==null&&n!==void 0?n:false,contextualErrorMap:r==null?void 0:r.errorMap},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Jt(t)},s=this._parseSync({data:t,path:o.path,parent:o});return ki(o,s)}"~validate"(t){var r,n;let o={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Jt(t)};if(!this["~standard"].async)try{let s=this._parseSync({data:t,path:[],parent:o});return br(s)?{value:s.value}:{issues:o.common.issues}}catch(s){!((n=(r=s==null?void 0:s.message)===null||r===void 0?void 0:r.toLowerCase())===null||n===void 0)&&n.includes("encountered")&&(this["~standard"].async=true),o.common={issues:[],async:true};}return this._parseAsync({data:t,path:[],parent:o}).then(s=>br(s)?{value:s.value}:{issues:o.common.issues})}parseAsync(t,r){return A(this,null,function*(){let n=yield this.safeParseAsync(t,r);if(n.success)return n.data;throw n.error})}safeParseAsync(t,r){return A(this,null,function*(){let n={common:{issues:[],contextualErrorMap:r==null?void 0:r.errorMap,async:true},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Jt(t)},o=this._parse({data:t,path:n.path,parent:n}),s=yield Rn(o)?o:Promise.resolve(o);return ki(n,s)})}refine(t,r){let n=o=>typeof r=="string"||typeof r=="undefined"?{message:r}:typeof r=="function"?r(o):r;return this._refinement((o,s)=>{let a=t(o),l=()=>s.addIssue(d({code:E.custom},n(o)));return typeof Promise!="undefined"&&a instanceof Promise?a.then(u=>u?true:(l(),false)):a?true:(l(),false)})}refinement(t,r){return this._refinement((n,o)=>t(n)?true:(o.addIssue(typeof r=="function"?r(n,o):r),false))}_refinement(t){return new ut({schema:this,typeName:C.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)};}optional(){return ot.create(this,this._def)}nullable(){return Dt.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Gt.create(this)}promise(){return ir.create(this,this._def)}or(t){return kr.create([this,t],this._def)}and(t){return Ar.create(this,t,this._def)}transform(t){return new ut(g(d({},ee(this._def)),{schema:this,typeName:C.ZodEffects,effect:{type:"transform",transform:t}}))}default(t){let r=typeof t=="function"?t:()=>t;return new Or(g(d({},ee(this._def)),{innerType:this,defaultValue:r,typeName:C.ZodDefault}))}brand(){return new jn(d({typeName:C.ZodBranded,type:this},ee(this._def)))}catch(t){let r=typeof t=="function"?t:()=>t;return new Pr(g(d({},ee(this._def)),{innerType:this,catchValue:r,typeName:C.ZodCatch}))}describe(t){let r=this.constructor;return new r(g(d({},this._def),{description:t}))}pipe(t){return On.create(this,t)}readonly(){return Mr.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},Kc=/^c[^\s-]{8,}$/i,Yc=/^[0-9a-z]+$/,Xc=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Qc=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,ed=/^[a-z0-9_-]{21}$/i,td=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,rd=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,nd=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,od="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",ks,sd=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ad=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,id=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,ld=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,ud=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,pd=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,ji="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",cd=new RegExp(`^${ji}$`);function Oi(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`);let r=e.precision?"+":"?";return `([01]\\d|2[0-3]):[0-5]\\d(:${t})${r}`}function dd(e){return new RegExp(`^${Oi(e)}$`)}function Pi(e){let t=`${ji}T${Oi(e)}`,r=[];return r.push(e.local?"Z?":"Z"),e.offset&&r.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${r.join("|")})`,new RegExp(`^${t}$`)}function fd(e,t){return !!((t==="v4"||!t)&&sd.test(e)||(t==="v6"||!t)&&id.test(e))}function hd(e,t){if(!td.test(e))return  false;try{let[r]=e.split("."),n=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),o=JSON.parse(atob(n));return !(typeof o!="object"||o===null||!o.typ||!o.alg||t&&o.alg!==t)}catch(r){return  false}}function md(e,t){return !!((t==="v4"||!t)&&ad.test(e)||(t==="v6"||!t)&&ld.test(e))}var sr=class e extends te{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==U.string){let s=this._getOrReturnCtx(t);return D(s,{code:E.invalid_type,expected:U.string,received:s.parsedType}),W}let n=new Ye,o;for(let s of this._def.checks)if(s.kind==="min")t.data.length<s.value&&(o=this._getOrReturnCtx(t,o),D(o,{code:E.too_small,minimum:s.value,type:"string",inclusive:true,exact:false,message:s.message}),n.dirty());else if(s.kind==="max")t.data.length>s.value&&(o=this._getOrReturnCtx(t,o),D(o,{code:E.too_big,maximum:s.value,type:"string",inclusive:true,exact:false,message:s.message}),n.dirty());else if(s.kind==="length"){let a=t.data.length>s.value,l=t.data.length<s.value;(a||l)&&(o=this._getOrReturnCtx(t,o),a?D(o,{code:E.too_big,maximum:s.value,type:"string",inclusive:true,exact:true,message:s.message}):l&&D(o,{code:E.too_small,minimum:s.value,type:"string",inclusive:true,exact:true,message:s.message}),n.dirty());}else if(s.kind==="email")nd.test(t.data)||(o=this._getOrReturnCtx(t,o),D(o,{validation:"email",code:E.invalid_string,message:s.message}),n.dirty());else if(s.kind==="emoji")ks||(ks=new RegExp(od,"u")),ks.test(t.data)||(o=this._getOrReturnCtx(t,o),D(o,{validation:"emoji",code:E.invalid_string,message:s.message}),n.dirty());else if(s.kind==="uuid")Qc.test(t.data)||(o=this._getOrReturnCtx(t,o),D(o,{validation:"uuid",code:E.invalid_string,message:s.message}),n.dirty());else if(s.kind==="nanoid")ed.test(t.data)||(o=this._getOrReturnCtx(t,o),D(o,{validation:"nanoid",code:E.invalid_string,message:s.message}),n.dirty());else if(s.kind==="cuid")Kc.test(t.data)||(o=this._getOrReturnCtx(t,o),D(o,{validation:"cuid",code:E.invalid_string,message:s.message}),n.dirty());else if(s.kind==="cuid2")Yc.test(t.data)||(o=this._getOrReturnCtx(t,o),D(o,{validation:"cuid2",code:E.invalid_string,message:s.message}),n.dirty());else if(s.kind==="ulid")Xc.test(t.data)||(o=this._getOrReturnCtx(t,o),D(o,{validation:"ulid",code:E.invalid_string,message:s.message}),n.dirty());else if(s.kind==="url")try{new URL(t.data);}catch(a){o=this._getOrReturnCtx(t,o),D(o,{validation:"url",code:E.invalid_string,message:s.message}),n.dirty();}else s.kind==="regex"?(s.regex.lastIndex=0,s.regex.test(t.data)||(o=this._getOrReturnCtx(t,o),D(o,{validation:"regex",code:E.invalid_string,message:s.message}),n.dirty())):s.kind==="trim"?t.data=t.data.trim():s.kind==="includes"?t.data.includes(s.value,s.position)||(o=this._getOrReturnCtx(t,o),D(o,{code:E.invalid_string,validation:{includes:s.value,position:s.position},message:s.message}),n.dirty()):s.kind==="toLowerCase"?t.data=t.data.toLowerCase():s.kind==="toUpperCase"?t.data=t.data.toUpperCase():s.kind==="startsWith"?t.data.startsWith(s.value)||(o=this._getOrReturnCtx(t,o),D(o,{code:E.invalid_string,validation:{startsWith:s.value},message:s.message}),n.dirty()):s.kind==="endsWith"?t.data.endsWith(s.value)||(o=this._getOrReturnCtx(t,o),D(o,{code:E.invalid_string,validation:{endsWith:s.value},message:s.message}),n.dirty()):s.kind==="datetime"?Pi(s).test(t.data)||(o=this._getOrReturnCtx(t,o),D(o,{code:E.invalid_string,validation:"datetime",message:s.message}),n.dirty()):s.kind==="date"?cd.test(t.data)||(o=this._getOrReturnCtx(t,o),D(o,{code:E.invalid_string,validation:"date",message:s.message}),n.dirty()):s.kind==="time"?dd(s).test(t.data)||(o=this._getOrReturnCtx(t,o),D(o,{code:E.invalid_string,validation:"time",message:s.message}),n.dirty()):s.kind==="duration"?rd.test(t.data)||(o=this._getOrReturnCtx(t,o),D(o,{validation:"duration",code:E.invalid_string,message:s.message}),n.dirty()):s.kind==="ip"?fd(t.data,s.version)||(o=this._getOrReturnCtx(t,o),D(o,{validation:"ip",code:E.invalid_string,message:s.message}),n.dirty()):s.kind==="jwt"?hd(t.data,s.alg)||(o=this._getOrReturnCtx(t,o),D(o,{validation:"jwt",code:E.invalid_string,message:s.message}),n.dirty()):s.kind==="cidr"?md(t.data,s.version)||(o=this._getOrReturnCtx(t,o),D(o,{validation:"cidr",code:E.invalid_string,message:s.message}),n.dirty()):s.kind==="base64"?ud.test(t.data)||(o=this._getOrReturnCtx(t,o),D(o,{validation:"base64",code:E.invalid_string,message:s.message}),n.dirty()):s.kind==="base64url"?pd.test(t.data)||(o=this._getOrReturnCtx(t,o),D(o,{validation:"base64url",code:E.invalid_string,message:s.message}),n.dirty()):ue.assertNever(s);return {status:n.value,value:t.data}}_regex(t,r,n){return this.refinement(o=>t.test(o),d({validation:r,code:E.invalid_string},z.errToObj(n)))}_addCheck(t){return new e(g(d({},this._def),{checks:[...this._def.checks,t]}))}email(t){return this._addCheck(d({kind:"email"},z.errToObj(t)))}url(t){return this._addCheck(d({kind:"url"},z.errToObj(t)))}emoji(t){return this._addCheck(d({kind:"emoji"},z.errToObj(t)))}uuid(t){return this._addCheck(d({kind:"uuid"},z.errToObj(t)))}nanoid(t){return this._addCheck(d({kind:"nanoid"},z.errToObj(t)))}cuid(t){return this._addCheck(d({kind:"cuid"},z.errToObj(t)))}cuid2(t){return this._addCheck(d({kind:"cuid2"},z.errToObj(t)))}ulid(t){return this._addCheck(d({kind:"ulid"},z.errToObj(t)))}base64(t){return this._addCheck(d({kind:"base64"},z.errToObj(t)))}base64url(t){return this._addCheck(d({kind:"base64url"},z.errToObj(t)))}jwt(t){return this._addCheck(d({kind:"jwt"},z.errToObj(t)))}ip(t){return this._addCheck(d({kind:"ip"},z.errToObj(t)))}cidr(t){return this._addCheck(d({kind:"cidr"},z.errToObj(t)))}datetime(t){var r,n;return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:false,local:false,message:t}):this._addCheck(d({kind:"datetime",precision:typeof(t==null?void 0:t.precision)=="undefined"?null:t==null?void 0:t.precision,offset:(r=t==null?void 0:t.offset)!==null&&r!==void 0?r:false,local:(n=t==null?void 0:t.local)!==null&&n!==void 0?n:false},z.errToObj(t==null?void 0:t.message)))}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck(d({kind:"time",precision:typeof(t==null?void 0:t.precision)=="undefined"?null:t==null?void 0:t.precision},z.errToObj(t==null?void 0:t.message)))}duration(t){return this._addCheck(d({kind:"duration"},z.errToObj(t)))}regex(t,r){return this._addCheck(d({kind:"regex",regex:t},z.errToObj(r)))}includes(t,r){return this._addCheck(d({kind:"includes",value:t,position:r==null?void 0:r.position},z.errToObj(r==null?void 0:r.message)))}startsWith(t,r){return this._addCheck(d({kind:"startsWith",value:t},z.errToObj(r)))}endsWith(t,r){return this._addCheck(d({kind:"endsWith",value:t},z.errToObj(r)))}min(t,r){return this._addCheck(d({kind:"min",value:t},z.errToObj(r)))}max(t,r){return this._addCheck(d({kind:"max",value:t},z.errToObj(r)))}length(t,r){return this._addCheck(d({kind:"length",value:t},z.errToObj(r)))}nonempty(t){return this.min(1,z.errToObj(t))}trim(){return new e(g(d({},this._def),{checks:[...this._def.checks,{kind:"trim"}]}))}toLowerCase(){return new e(g(d({},this._def),{checks:[...this._def.checks,{kind:"toLowerCase"}]}))}toUpperCase(){return new e(g(d({},this._def),{checks:[...this._def.checks,{kind:"toUpperCase"}]}))}get isDatetime(){return !!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return !!this._def.checks.find(t=>t.kind==="date")}get isTime(){return !!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return !!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return !!this._def.checks.find(t=>t.kind==="email")}get isURL(){return !!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return !!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return !!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return !!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return !!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return !!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return !!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return !!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return !!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return !!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return !!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(let r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxLength(){let t=null;for(let r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}};sr.create=e=>{var t;return new sr(d({checks:[],typeName:C.ZodString,coerce:(t=e==null?void 0:e.coerce)!==null&&t!==void 0?t:false},ee(e)))};function gd(e,t){let r=(e.toString().split(".")[1]||"").length,n=(t.toString().split(".")[1]||"").length,o=r>n?r:n,s=parseInt(e.toFixed(o).replace(".","")),a=parseInt(t.toFixed(o).replace(".",""));return s%a/Math.pow(10,o)}var _r=class e extends te{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf;}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==U.number){let s=this._getOrReturnCtx(t);return D(s,{code:E.invalid_type,expected:U.number,received:s.parsedType}),W}let n,o=new Ye;for(let s of this._def.checks)s.kind==="int"?ue.isInteger(t.data)||(n=this._getOrReturnCtx(t,n),D(n,{code:E.invalid_type,expected:"integer",received:"float",message:s.message}),o.dirty()):s.kind==="min"?(s.inclusive?t.data<s.value:t.data<=s.value)&&(n=this._getOrReturnCtx(t,n),D(n,{code:E.too_small,minimum:s.value,type:"number",inclusive:s.inclusive,exact:false,message:s.message}),o.dirty()):s.kind==="max"?(s.inclusive?t.data>s.value:t.data>=s.value)&&(n=this._getOrReturnCtx(t,n),D(n,{code:E.too_big,maximum:s.value,type:"number",inclusive:s.inclusive,exact:false,message:s.message}),o.dirty()):s.kind==="multipleOf"?gd(t.data,s.value)!==0&&(n=this._getOrReturnCtx(t,n),D(n,{code:E.not_multiple_of,multipleOf:s.value,message:s.message}),o.dirty()):s.kind==="finite"?Number.isFinite(t.data)||(n=this._getOrReturnCtx(t,n),D(n,{code:E.not_finite,message:s.message}),o.dirty()):ue.assertNever(s);return {status:o.value,value:t.data}}gte(t,r){return this.setLimit("min",t,true,z.toString(r))}gt(t,r){return this.setLimit("min",t,false,z.toString(r))}lte(t,r){return this.setLimit("max",t,true,z.toString(r))}lt(t,r){return this.setLimit("max",t,false,z.toString(r))}setLimit(t,r,n,o){return new e(g(d({},this._def),{checks:[...this._def.checks,{kind:t,value:r,inclusive:n,message:z.toString(o)}]}))}_addCheck(t){return new e(g(d({},this._def),{checks:[...this._def.checks,t]}))}int(t){return this._addCheck({kind:"int",message:z.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:false,message:z.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:false,message:z.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:true,message:z.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:true,message:z.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:z.toString(r)})}finite(t){return this._addCheck({kind:"finite",message:z.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:true,value:Number.MIN_SAFE_INTEGER,message:z.toString(t)})._addCheck({kind:"max",inclusive:true,value:Number.MAX_SAFE_INTEGER,message:z.toString(t)})}get minValue(){let t=null;for(let r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(let r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}get isInt(){return !!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&ue.isInteger(t.value))}get isFinite(){let t=null,r=null;for(let n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return  true;n.kind==="min"?(r===null||n.value>r)&&(r=n.value):n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);}return Number.isFinite(r)&&Number.isFinite(t)}};_r.create=e=>new _r(d({checks:[],typeName:C.ZodNumber,coerce:(e==null?void 0:e.coerce)||false},ee(e)));var wr=class e extends te{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte;}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data);}catch(s){return this._getInvalidInput(t)}if(this._getType(t)!==U.bigint)return this._getInvalidInput(t);let n,o=new Ye;for(let s of this._def.checks)s.kind==="min"?(s.inclusive?t.data<s.value:t.data<=s.value)&&(n=this._getOrReturnCtx(t,n),D(n,{code:E.too_small,type:"bigint",minimum:s.value,inclusive:s.inclusive,message:s.message}),o.dirty()):s.kind==="max"?(s.inclusive?t.data>s.value:t.data>=s.value)&&(n=this._getOrReturnCtx(t,n),D(n,{code:E.too_big,type:"bigint",maximum:s.value,inclusive:s.inclusive,message:s.message}),o.dirty()):s.kind==="multipleOf"?t.data%s.value!==BigInt(0)&&(n=this._getOrReturnCtx(t,n),D(n,{code:E.not_multiple_of,multipleOf:s.value,message:s.message}),o.dirty()):ue.assertNever(s);return {status:o.value,value:t.data}}_getInvalidInput(t){let r=this._getOrReturnCtx(t);return D(r,{code:E.invalid_type,expected:U.bigint,received:r.parsedType}),W}gte(t,r){return this.setLimit("min",t,true,z.toString(r))}gt(t,r){return this.setLimit("min",t,false,z.toString(r))}lte(t,r){return this.setLimit("max",t,true,z.toString(r))}lt(t,r){return this.setLimit("max",t,false,z.toString(r))}setLimit(t,r,n,o){return new e(g(d({},this._def),{checks:[...this._def.checks,{kind:t,value:r,inclusive:n,message:z.toString(o)}]}))}_addCheck(t){return new e(g(d({},this._def),{checks:[...this._def.checks,t]}))}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:false,message:z.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:false,message:z.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:true,message:z.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:true,message:z.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:z.toString(r)})}get minValue(){let t=null;for(let r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(let r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}};wr.create=e=>{var t;return new wr(d({checks:[],typeName:C.ZodBigInt,coerce:(t=e==null?void 0:e.coerce)!==null&&t!==void 0?t:false},ee(e)))};var xr=class extends te{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==U.boolean){let n=this._getOrReturnCtx(t);return D(n,{code:E.invalid_type,expected:U.boolean,received:n.parsedType}),W}return et(t.data)}};xr.create=e=>new xr(d({typeName:C.ZodBoolean,coerce:(e==null?void 0:e.coerce)||false},ee(e)));var Sr=class e extends te{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==U.date){let s=this._getOrReturnCtx(t);return D(s,{code:E.invalid_type,expected:U.date,received:s.parsedType}),W}if(isNaN(t.data.getTime())){let s=this._getOrReturnCtx(t);return D(s,{code:E.invalid_date}),W}let n=new Ye,o;for(let s of this._def.checks)s.kind==="min"?t.data.getTime()<s.value&&(o=this._getOrReturnCtx(t,o),D(o,{code:E.too_small,message:s.message,inclusive:true,exact:false,minimum:s.value,type:"date"}),n.dirty()):s.kind==="max"?t.data.getTime()>s.value&&(o=this._getOrReturnCtx(t,o),D(o,{code:E.too_big,message:s.message,inclusive:true,exact:false,maximum:s.value,type:"date"}),n.dirty()):ue.assertNever(s);return {status:n.value,value:new Date(t.data.getTime())}}_addCheck(t){return new e(g(d({},this._def),{checks:[...this._def.checks,t]}))}min(t,r){return this._addCheck({kind:"min",value:t.getTime(),message:z.toString(r)})}max(t,r){return this._addCheck({kind:"max",value:t.getTime(),message:z.toString(r)})}get minDate(){let t=null;for(let r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(let r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t!=null?new Date(t):null}};Sr.create=e=>new Sr(d({checks:[],coerce:(e==null?void 0:e.coerce)||false,typeName:C.ZodDate},ee(e)));var Hr=class extends te{_parse(t){if(this._getType(t)!==U.symbol){let n=this._getOrReturnCtx(t);return D(n,{code:E.invalid_type,expected:U.symbol,received:n.parsedType}),W}return et(t.data)}};Hr.create=e=>new Hr(d({typeName:C.ZodSymbol},ee(e)));var Tr=class extends te{_parse(t){if(this._getType(t)!==U.undefined){let n=this._getOrReturnCtx(t);return D(n,{code:E.invalid_type,expected:U.undefined,received:n.parsedType}),W}return et(t.data)}};Tr.create=e=>new Tr(d({typeName:C.ZodUndefined},ee(e)));var Ir=class extends te{_parse(t){if(this._getType(t)!==U.null){let n=this._getOrReturnCtx(t);return D(n,{code:E.invalid_type,expected:U.null,received:n.parsedType}),W}return et(t.data)}};Ir.create=e=>new Ir(d({typeName:C.ZodNull},ee(e)));var ar=class extends te{constructor(){super(...arguments),this._any=true;}_parse(t){return et(t.data)}};ar.create=e=>new ar(d({typeName:C.ZodAny},ee(e)));var Zt=class extends te{constructor(){super(...arguments),this._unknown=true;}_parse(t){return et(t.data)}};Zt.create=e=>new Zt(d({typeName:C.ZodUnknown},ee(e)));var St=class extends te{_parse(t){let r=this._getOrReturnCtx(t);return D(r,{code:E.invalid_type,expected:U.never,received:r.parsedType}),W}};St.create=e=>new St(d({typeName:C.ZodNever},ee(e)));var Wr=class extends te{_parse(t){if(this._getType(t)!==U.undefined){let n=this._getOrReturnCtx(t);return D(n,{code:E.invalid_type,expected:U.void,received:n.parsedType}),W}return et(t.data)}};Wr.create=e=>new Wr(d({typeName:C.ZodVoid},ee(e)));var Gt=class e extends te{_parse(t){let{ctx:r,status:n}=this._processInputParams(t),o=this._def;if(r.parsedType!==U.array)return D(r,{code:E.invalid_type,expected:U.array,received:r.parsedType}),W;if(o.exactLength!==null){let a=r.data.length>o.exactLength.value,l=r.data.length<o.exactLength.value;(a||l)&&(D(r,{code:a?E.too_big:E.too_small,minimum:l?o.exactLength.value:void 0,maximum:a?o.exactLength.value:void 0,type:"array",inclusive:true,exact:true,message:o.exactLength.message}),n.dirty());}if(o.minLength!==null&&r.data.length<o.minLength.value&&(D(r,{code:E.too_small,minimum:o.minLength.value,type:"array",inclusive:true,exact:false,message:o.minLength.message}),n.dirty()),o.maxLength!==null&&r.data.length>o.maxLength.value&&(D(r,{code:E.too_big,maximum:o.maxLength.value,type:"array",inclusive:true,exact:false,message:o.maxLength.message}),n.dirty()),r.common.async)return Promise.all([...r.data].map((a,l)=>o.type._parseAsync(new mt(r,a,r.path,l)))).then(a=>Ye.mergeArray(n,a));let s=[...r.data].map((a,l)=>o.type._parseSync(new mt(r,a,r.path,l)));return Ye.mergeArray(n,s)}get element(){return this._def.type}min(t,r){return new e(g(d({},this._def),{minLength:{value:t,message:z.toString(r)}}))}max(t,r){return new e(g(d({},this._def),{maxLength:{value:t,message:z.toString(r)}}))}length(t,r){return new e(g(d({},this._def),{exactLength:{value:t,message:z.toString(r)}}))}nonempty(t){return this.min(1,t)}};Gt.create=(e,t)=>new Gt(d({type:e,minLength:null,maxLength:null,exactLength:null,typeName:C.ZodArray},ee(t)));function Jr(e){if(e instanceof st){let t={};for(let r in e.shape){let n=e.shape[r];t[r]=ot.create(Jr(n));}return new st(g(d({},e._def),{shape:()=>t}))}else return e instanceof Gt?new Gt(g(d({},e._def),{type:Jr(e.element)})):e instanceof ot?ot.create(Jr(e.unwrap())):e instanceof Dt?Dt.create(Jr(e.unwrap())):e instanceof Nt?Nt.create(e.items.map(t=>Jr(t))):e}var st=class e extends te{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend;}_getCached(){if(this._cached!==null)return this._cached;let t=this._def.shape(),r=ue.objectKeys(t);return this._cached={shape:t,keys:r}}_parse(t){if(this._getType(t)!==U.object){let p=this._getOrReturnCtx(t);return D(p,{code:E.invalid_type,expected:U.object,received:p.parsedType}),W}let{status:n,ctx:o}=this._processInputParams(t),{shape:s,keys:a}=this._getCached(),l=[];if(!(this._def.catchall instanceof St&&this._def.unknownKeys==="strip"))for(let p in o.data)a.includes(p)||l.push(p);let u=[];for(let p of a){let f=s[p],m=o.data[p];u.push({key:{status:"valid",value:p},value:f._parse(new mt(o,m,o.path,p)),alwaysSet:p in o.data});}if(this._def.catchall instanceof St){let p=this._def.unknownKeys;if(p==="passthrough")for(let f of l)u.push({key:{status:"valid",value:f},value:{status:"valid",value:o.data[f]}});else if(p==="strict")l.length>0&&(D(o,{code:E.unrecognized_keys,keys:l}),n.dirty());else if(p!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else {let p=this._def.catchall;for(let f of l){let m=o.data[f];u.push({key:{status:"valid",value:f},value:p._parse(new mt(o,m,o.path,f)),alwaysSet:f in o.data});}}return o.common.async?Promise.resolve().then(()=>A(this,null,function*(){let p=[];for(let f of u){let m=yield f.key,y=yield f.value;p.push({key:m,value:y,alwaysSet:f.alwaysSet});}return p})).then(p=>Ye.mergeObjectSync(n,p)):Ye.mergeObjectSync(n,u)}get shape(){return this._def.shape()}strict(t){return z.errToObj,new e(d(g(d({},this._def),{unknownKeys:"strict"}),t!==void 0?{errorMap:(r,n)=>{var o,s,a,l;let u=(a=(s=(o=this._def).errorMap)===null||s===void 0?void 0:s.call(o,r,n).message)!==null&&a!==void 0?a:n.defaultError;return r.code==="unrecognized_keys"?{message:(l=z.errToObj(t).message)!==null&&l!==void 0?l:u}:{message:u}}}:{}))}strip(){return new e(g(d({},this._def),{unknownKeys:"strip"}))}passthrough(){return new e(g(d({},this._def),{unknownKeys:"passthrough"}))}extend(t){return new e(g(d({},this._def),{shape:()=>d(d({},this._def.shape()),t)}))}merge(t){return new e({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>d(d({},this._def.shape()),t._def.shape()),typeName:C.ZodObject})}setKey(t,r){return this.augment({[t]:r})}catchall(t){return new e(g(d({},this._def),{catchall:t}))}pick(t){let r={};return ue.objectKeys(t).forEach(n=>{t[n]&&this.shape[n]&&(r[n]=this.shape[n]);}),new e(g(d({},this._def),{shape:()=>r}))}omit(t){let r={};return ue.objectKeys(this.shape).forEach(n=>{t[n]||(r[n]=this.shape[n]);}),new e(g(d({},this._def),{shape:()=>r}))}deepPartial(){return Jr(this)}partial(t){let r={};return ue.objectKeys(this.shape).forEach(n=>{let o=this.shape[n];t&&!t[n]?r[n]=o:r[n]=o.optional();}),new e(g(d({},this._def),{shape:()=>r}))}required(t){let r={};return ue.objectKeys(this.shape).forEach(n=>{if(t&&!t[n])r[n]=this.shape[n];else {let s=this.shape[n];for(;s instanceof ot;)s=s._def.innerType;r[n]=s;}}),new e(g(d({},this._def),{shape:()=>r}))}keyof(){return Mi(ue.objectKeys(this.shape))}};st.create=(e,t)=>new st(d({shape:()=>e,unknownKeys:"strip",catchall:St.create(),typeName:C.ZodObject},ee(t)));st.strictCreate=(e,t)=>new st(d({shape:()=>e,unknownKeys:"strict",catchall:St.create(),typeName:C.ZodObject},ee(t)));st.lazycreate=(e,t)=>new st(d({shape:e,unknownKeys:"strip",catchall:St.create(),typeName:C.ZodObject},ee(t)));var kr=class extends te{_parse(t){let{ctx:r}=this._processInputParams(t),n=this._def.options;function o(s){for(let l of s)if(l.result.status==="valid")return l.result;for(let l of s)if(l.result.status==="dirty")return r.common.issues.push(...l.ctx.common.issues),l.result;let a=s.map(l=>new lt(l.ctx.common.issues));return D(r,{code:E.invalid_union,unionErrors:a}),W}if(r.common.async)return Promise.all(n.map(s=>A(this,null,function*(){let a=g(d({},r),{common:g(d({},r.common),{issues:[]}),parent:null});return {result:yield s._parseAsync({data:r.data,path:r.path,parent:a}),ctx:a}}))).then(o);{let s,a=[];for(let u of n){let p=g(d({},r),{common:g(d({},r.common),{issues:[]}),parent:null}),f=u._parseSync({data:r.data,path:r.path,parent:p});if(f.status==="valid")return f;f.status==="dirty"&&!s&&(s={result:f,ctx:p}),p.common.issues.length&&a.push(p.common.issues);}if(s)return r.common.issues.push(...s.ctx.common.issues),s.result;let l=a.map(u=>new lt(u));return D(r,{code:E.invalid_union,unionErrors:l}),W}}get options(){return this._def.options}};kr.create=(e,t)=>new kr(d({options:e,typeName:C.ZodUnion},ee(t)));var Vt=e=>e instanceof Er?Vt(e.schema):e instanceof ut?Vt(e.innerType()):e instanceof Cr?[e.value]:e instanceof Rr?e.options:e instanceof jr?ue.objectValues(e.enum):e instanceof Or?Vt(e._def.innerType):e instanceof Tr?[void 0]:e instanceof Ir?[null]:e instanceof ot?[void 0,...Vt(e.unwrap())]:e instanceof Dt?[null,...Vt(e.unwrap())]:e instanceof jn||e instanceof Mr?Vt(e.unwrap()):e instanceof Pr?Vt(e._def.innerType):[],Co=class e extends te{_parse(t){let{ctx:r}=this._processInputParams(t);if(r.parsedType!==U.object)return D(r,{code:E.invalid_type,expected:U.object,received:r.parsedType}),W;let n=this.discriminator,o=r.data[n],s=this.optionsMap.get(o);return s?r.common.async?s._parseAsync({data:r.data,path:r.path,parent:r}):s._parseSync({data:r.data,path:r.path,parent:r}):(D(r,{code:E.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),W)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,r,n){let o=new Map;for(let s of r){let a=Vt(s.shape[t]);if(!a.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(let l of a){if(o.has(l))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(l)}`);o.set(l,s);}}return new e(d({typeName:C.ZodDiscriminatedUnion,discriminator:t,options:r,optionsMap:o},ee(n)))}};function Rs(e,t){let r=Jt(e),n=Jt(t);if(e===t)return {valid:true,data:e};if(r===U.object&&n===U.object){let o=ue.objectKeys(t),s=ue.objectKeys(e).filter(l=>o.indexOf(l)!==-1),a=d(d({},e),t);for(let l of s){let u=Rs(e[l],t[l]);if(!u.valid)return {valid:false};a[l]=u.data;}return {valid:true,data:a}}else if(r===U.array&&n===U.array){if(e.length!==t.length)return {valid:false};let o=[];for(let s=0;s<e.length;s++){let a=e[s],l=t[s],u=Rs(a,l);if(!u.valid)return {valid:false};o.push(u.data);}return {valid:true,data:o}}else return r===U.date&&n===U.date&&+e==+t?{valid:true,data:e}:{valid:false}}var Ar=class extends te{_parse(t){let{status:r,ctx:n}=this._processInputParams(t),o=(s,a)=>{if(Es(s)||Es(a))return W;let l=Rs(s.value,a.value);return l.valid?((Cs(s)||Cs(a))&&r.dirty(),{status:r.value,value:l.data}):(D(n,{code:E.invalid_intersection_types}),W)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([s,a])=>o(s,a)):o(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}};Ar.create=(e,t,r)=>new Ar(d({left:e,right:t,typeName:C.ZodIntersection},ee(r)));var Nt=class e extends te{_parse(t){let{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==U.array)return D(n,{code:E.invalid_type,expected:U.array,received:n.parsedType}),W;if(n.data.length<this._def.items.length)return D(n,{code:E.too_small,minimum:this._def.items.length,inclusive:true,exact:false,type:"array"}),W;!this._def.rest&&n.data.length>this._def.items.length&&(D(n,{code:E.too_big,maximum:this._def.items.length,inclusive:true,exact:false,type:"array"}),r.dirty());let s=[...n.data].map((a,l)=>{let u=this._def.items[l]||this._def.rest;return u?u._parse(new mt(n,a,n.path,l)):null}).filter(a=>!!a);return n.common.async?Promise.all(s).then(a=>Ye.mergeArray(r,a)):Ye.mergeArray(r,s)}get items(){return this._def.items}rest(t){return new e(g(d({},this._def),{rest:t}))}};Nt.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Nt(d({items:e,typeName:C.ZodTuple,rest:null},ee(t)))};var Ro=class e extends te{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){let{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==U.object)return D(n,{code:E.invalid_type,expected:U.object,received:n.parsedType}),W;let o=[],s=this._def.keyType,a=this._def.valueType;for(let l in n.data)o.push({key:s._parse(new mt(n,l,n.path,l)),value:a._parse(new mt(n,n.data[l],n.path,l)),alwaysSet:l in n.data});return n.common.async?Ye.mergeObjectAsync(r,o):Ye.mergeObjectSync(r,o)}get element(){return this._def.valueType}static create(t,r,n){return r instanceof te?new e(d({keyType:t,valueType:r,typeName:C.ZodRecord},ee(n))):new e(d({keyType:sr.create(),valueType:t,typeName:C.ZodRecord},ee(r)))}},Kr=class extends te{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){let{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==U.map)return D(n,{code:E.invalid_type,expected:U.map,received:n.parsedType}),W;let o=this._def.keyType,s=this._def.valueType,a=[...n.data.entries()].map(([l,u],p)=>({key:o._parse(new mt(n,l,n.path,[p,"key"])),value:s._parse(new mt(n,u,n.path,[p,"value"]))}));if(n.common.async){let l=new Map;return Promise.resolve().then(()=>A(this,null,function*(){for(let u of a){let p=yield u.key,f=yield u.value;if(p.status==="aborted"||f.status==="aborted")return W;(p.status==="dirty"||f.status==="dirty")&&r.dirty(),l.set(p.value,f.value);}return {status:r.value,value:l}}))}else {let l=new Map;for(let u of a){let p=u.key,f=u.value;if(p.status==="aborted"||f.status==="aborted")return W;(p.status==="dirty"||f.status==="dirty")&&r.dirty(),l.set(p.value,f.value);}return {status:r.value,value:l}}}};Kr.create=(e,t,r)=>new Kr(d({valueType:t,keyType:e,typeName:C.ZodMap},ee(r)));var Yr=class e extends te{_parse(t){let{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==U.set)return D(n,{code:E.invalid_type,expected:U.set,received:n.parsedType}),W;let o=this._def;o.minSize!==null&&n.data.size<o.minSize.value&&(D(n,{code:E.too_small,minimum:o.minSize.value,type:"set",inclusive:true,exact:false,message:o.minSize.message}),r.dirty()),o.maxSize!==null&&n.data.size>o.maxSize.value&&(D(n,{code:E.too_big,maximum:o.maxSize.value,type:"set",inclusive:true,exact:false,message:o.maxSize.message}),r.dirty());let s=this._def.valueType;function a(u){let p=new Set;for(let f of u){if(f.status==="aborted")return W;f.status==="dirty"&&r.dirty(),p.add(f.value);}return {status:r.value,value:p}}let l=[...n.data.values()].map((u,p)=>s._parse(new mt(n,u,n.path,p)));return n.common.async?Promise.all(l).then(u=>a(u)):a(l)}min(t,r){return new e(g(d({},this._def),{minSize:{value:t,message:z.toString(r)}}))}max(t,r){return new e(g(d({},this._def),{maxSize:{value:t,message:z.toString(r)}}))}size(t,r){return this.min(t,r).max(t,r)}nonempty(t){return this.min(1,t)}};Yr.create=(e,t)=>new Yr(d({valueType:e,minSize:null,maxSize:null,typeName:C.ZodSet},ee(t)));var jo=class e extends te{constructor(){super(...arguments),this.validate=this.implement;}_parse(t){let{ctx:r}=this._processInputParams(t);if(r.parsedType!==U.function)return D(r,{code:E.invalid_type,expected:U.function,received:r.parsedType}),W;function n(l,u){return Ao({data:l,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,ko(),Gr].filter(p=>!!p),issueData:{code:E.invalid_arguments,argumentsError:u}})}function o(l,u){return Ao({data:l,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,ko(),Gr].filter(p=>!!p),issueData:{code:E.invalid_return_type,returnTypeError:u}})}let s={errorMap:r.common.contextualErrorMap},a=r.data;if(this._def.returns instanceof ir){let l=this;return et(function(...u){return A(this,null,function*(){let p=new lt([]),f=yield l._def.args.parseAsync(u,s).catch(v=>{throw p.addIssue(n(u,v)),p}),m=yield Reflect.apply(a,this,f);return yield l._def.returns._def.type.parseAsync(m,s).catch(v=>{throw p.addIssue(o(m,v)),p})})})}else {let l=this;return et(function(...u){let p=l._def.args.safeParse(u,s);if(!p.success)throw new lt([n(u,p.error)]);let f=Reflect.apply(a,this,p.data),m=l._def.returns.safeParse(f,s);if(!m.success)throw new lt([o(f,m.error)]);return m.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...t){return new e(g(d({},this._def),{args:Nt.create(t).rest(Zt.create())}))}returns(t){return new e(g(d({},this._def),{returns:t}))}implement(t){return this.parse(t)}strictImplement(t){return this.parse(t)}static create(t,r,n){return new e(d({args:t||Nt.create([]).rest(Zt.create()),returns:r||Zt.create(),typeName:C.ZodFunction},ee(n)))}},Er=class extends te{get schema(){return this._def.getter()}_parse(t){let{ctx:r}=this._processInputParams(t);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}};Er.create=(e,t)=>new Er(d({getter:e,typeName:C.ZodLazy},ee(t)));var Cr=class extends te{_parse(t){if(t.data!==this._def.value){let r=this._getOrReturnCtx(t);return D(r,{received:r.data,code:E.invalid_literal,expected:this._def.value}),W}return {status:"valid",value:t.data}}get value(){return this._def.value}};Cr.create=(e,t)=>new Cr(d({value:e,typeName:C.ZodLiteral},ee(t)));function Mi(e,t){return new Rr(d({values:e,typeName:C.ZodEnum},ee(t)))}var Rr=class e extends te{constructor(){super(...arguments),En.set(this,void 0);}_parse(t){if(typeof t.data!="string"){let r=this._getOrReturnCtx(t),n=this._def.values;return D(r,{expected:ue.joinValues(n),received:r.parsedType,code:E.invalid_type}),W}if(Eo(this,En)||Ri(this,En,new Set(this._def.values)),!Eo(this,En).has(t.data)){let r=this._getOrReturnCtx(t),n=this._def.values;return D(r,{received:r.data,code:E.invalid_enum_value,options:n}),W}return et(t.data)}get options(){return this._def.values}get enum(){let t={};for(let r of this._def.values)t[r]=r;return t}get Values(){let t={};for(let r of this._def.values)t[r]=r;return t}get Enum(){let t={};for(let r of this._def.values)t[r]=r;return t}extract(t,r=this._def){return e.create(t,d(d({},this._def),r))}exclude(t,r=this._def){return e.create(this.options.filter(n=>!t.includes(n)),d(d({},this._def),r))}};En=new WeakMap;Rr.create=Mi;var jr=class extends te{constructor(){super(...arguments),Cn.set(this,void 0);}_parse(t){let r=ue.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(t);if(n.parsedType!==U.string&&n.parsedType!==U.number){let o=ue.objectValues(r);return D(n,{expected:ue.joinValues(o),received:n.parsedType,code:E.invalid_type}),W}if(Eo(this,Cn)||Ri(this,Cn,new Set(ue.getValidEnumValues(this._def.values))),!Eo(this,Cn).has(t.data)){let o=ue.objectValues(r);return D(n,{received:n.data,code:E.invalid_enum_value,options:o}),W}return et(t.data)}get enum(){return this._def.values}};Cn=new WeakMap;jr.create=(e,t)=>new jr(d({values:e,typeName:C.ZodNativeEnum},ee(t)));var ir=class extends te{unwrap(){return this._def.type}_parse(t){let{ctx:r}=this._processInputParams(t);if(r.parsedType!==U.promise&&r.common.async===false)return D(r,{code:E.invalid_type,expected:U.promise,received:r.parsedType}),W;let n=r.parsedType===U.promise?r.data:Promise.resolve(r.data);return et(n.then(o=>this._def.type.parseAsync(o,{path:r.path,errorMap:r.common.contextualErrorMap})))}};ir.create=(e,t)=>new ir(d({type:e,typeName:C.ZodPromise},ee(t)));var ut=class extends te{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===C.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){let{status:r,ctx:n}=this._processInputParams(t),o=this._def.effect||null,s={addIssue:a=>{D(n,a),a.fatal?r.abort():r.dirty();},get path(){return n.path}};if(s.addIssue=s.addIssue.bind(s),o.type==="preprocess"){let a=o.transform(n.data,s);if(n.common.async)return Promise.resolve(a).then(l=>A(this,null,function*(){if(r.value==="aborted")return W;let u=yield this._def.schema._parseAsync({data:l,path:n.path,parent:n});return u.status==="aborted"?W:u.status==="dirty"||r.value==="dirty"?Zr(u.value):u}));{if(r.value==="aborted")return W;let l=this._def.schema._parseSync({data:a,path:n.path,parent:n});return l.status==="aborted"?W:l.status==="dirty"||r.value==="dirty"?Zr(l.value):l}}if(o.type==="refinement"){let a=l=>{let u=o.refinement(l,s);if(n.common.async)return Promise.resolve(u);if(u instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return l};if(n.common.async===false){let l=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return l.status==="aborted"?W:(l.status==="dirty"&&r.dirty(),a(l.value),{status:r.value,value:l.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(l=>l.status==="aborted"?W:(l.status==="dirty"&&r.dirty(),a(l.value).then(()=>({status:r.value,value:l.value}))))}if(o.type==="transform")if(n.common.async===false){let a=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!br(a))return a;let l=o.transform(a.value,s);if(l instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return {status:r.value,value:l}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(a=>br(a)?Promise.resolve(o.transform(a.value,s)).then(l=>({status:r.value,value:l})):a);ue.assertNever(o);}};ut.create=(e,t,r)=>new ut(d({schema:e,typeName:C.ZodEffects,effect:t},ee(r)));ut.createWithPreprocess=(e,t,r)=>new ut(d({schema:t,effect:{type:"preprocess",transform:e},typeName:C.ZodEffects},ee(r)));var ot=class extends te{_parse(t){return this._getType(t)===U.undefined?et(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}};ot.create=(e,t)=>new ot(d({innerType:e,typeName:C.ZodOptional},ee(t)));var Dt=class extends te{_parse(t){return this._getType(t)===U.null?et(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}};Dt.create=(e,t)=>new Dt(d({innerType:e,typeName:C.ZodNullable},ee(t)));var Or=class extends te{_parse(t){let{ctx:r}=this._processInputParams(t),n=r.data;return r.parsedType===U.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:r.path,parent:r})}removeDefault(){return this._def.innerType}};Or.create=(e,t)=>new Or(d({innerType:e,typeName:C.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default},ee(t)));var Pr=class extends te{_parse(t){let{ctx:r}=this._processInputParams(t),n=g(d({},r),{common:g(d({},r.common),{issues:[]})}),o=this._def.innerType._parse({data:n.data,path:n.path,parent:d({},n)});return Rn(o)?o.then(s=>({status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new lt(n.common.issues)},input:n.data})})):{status:"valid",value:o.status==="valid"?o.value:this._def.catchValue({get error(){return new lt(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}};Pr.create=(e,t)=>new Pr(d({innerType:e,typeName:C.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch},ee(t)));var Xr=class extends te{_parse(t){if(this._getType(t)!==U.nan){let n=this._getOrReturnCtx(t);return D(n,{code:E.invalid_type,expected:U.nan,received:n.parsedType}),W}return {status:"valid",value:t.data}}};Xr.create=e=>new Xr(d({typeName:C.ZodNaN},ee(e)));var yd=Symbol("zod_brand"),jn=class extends te{_parse(t){let{ctx:r}=this._processInputParams(t),n=r.data;return this._def.type._parse({data:n,path:r.path,parent:r})}unwrap(){return this._def.type}},On=class e extends te{_parse(t){let{status:r,ctx:n}=this._processInputParams(t);if(n.common.async)return A(this,null,function*(){let s=yield this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return s.status==="aborted"?W:s.status==="dirty"?(r.dirty(),Zr(s.value)):this._def.out._parseAsync({data:s.value,path:n.path,parent:n})});{let o=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return o.status==="aborted"?W:o.status==="dirty"?(r.dirty(),{status:"dirty",value:o.value}):this._def.out._parseSync({data:o.value,path:n.path,parent:n})}}static create(t,r){return new e({in:t,out:r,typeName:C.ZodPipeline})}},Mr=class extends te{_parse(t){let r=this._def.innerType._parse(t),n=o=>(br(o)&&(o.value=Object.freeze(o.value)),o);return Rn(r)?r.then(o=>n(o)):n(r)}unwrap(){return this._def.innerType}};Mr.create=(e,t)=>new Mr(d({innerType:e,typeName:C.ZodReadonly},ee(t)));function Ai(e,t){let r=typeof e=="function"?e(t):typeof e=="string"?{message:e}:e;return typeof r=="string"?{message:r}:r}function Ni(e,t={},r){return e?ar.create().superRefine((n,o)=>{var s,a;let l=e(n);if(l instanceof Promise)return l.then(u=>{var p,f;if(!u){let m=Ai(t,n),y=(f=(p=m.fatal)!==null&&p!==void 0?p:r)!==null&&f!==void 0?f:true;o.addIssue(g(d({code:"custom"},m),{fatal:y}));}});if(!l){let u=Ai(t,n),p=(a=(s=u.fatal)!==null&&s!==void 0?s:r)!==null&&a!==void 0?a:true;o.addIssue(g(d({code:"custom"},u),{fatal:p}));}}):ar.create()}var vd={object:st.lazycreate},C;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly";})(C||(C={}));var bd=(e,t={message:`Input not instance of ${e.name}`})=>Ni(r=>r instanceof e,t),Di=sr.create,Fi=_r.create,_d=Xr.create,wd=wr.create,Ui=xr.create,xd=Sr.create,Sd=Hr.create,Td=Tr.create,Id=Ir.create,kd=ar.create,Ad=Zt.create,Ed=St.create,Cd=Wr.create,Rd=Gt.create,jd=st.create,Od=st.strictCreate,Pd=kr.create,Md=Co.create,Nd=Ar.create,Dd=Nt.create,Fd=Ro.create,Ud=Kr.create,$d=Yr.create,qd=jo.create,Bd=Er.create,zd=Cr.create,Ld=Rr.create,Vd=jr.create,Jd=ir.create,Ei=ut.create,Zd=ot.create,Gd=Dt.create,Hd=ut.createWithPreprocess,Wd=On.create,Kd=()=>Di().optional(),Yd=()=>Fi().optional(),Xd=()=>Ui().optional(),Qd={string:e=>sr.create(g(d({},e),{coerce:true})),number:e=>_r.create(g(d({},e),{coerce:true})),boolean:e=>xr.create(g(d({},e),{coerce:true})),bigint:e=>wr.create(g(d({},e),{coerce:true})),date:e=>Sr.create(g(d({},e),{coerce:true}))},ef=W,i=Object.freeze({__proto__:null,defaultErrorMap:Gr,setErrorMap:Hc,getErrorMap:ko,makeIssue:Ao,EMPTY_PATH:Wc,addIssueToContext:D,ParseStatus:Ye,INVALID:W,DIRTY:Zr,OK:et,isAborted:Es,isDirty:Cs,isValid:br,isAsync:Rn,get util(){return ue},get objectUtil(){return As},ZodParsedType:U,getParsedType:Jt,ZodType:te,datetimeRegex:Pi,ZodString:sr,ZodNumber:_r,ZodBigInt:wr,ZodBoolean:xr,ZodDate:Sr,ZodSymbol:Hr,ZodUndefined:Tr,ZodNull:Ir,ZodAny:ar,ZodUnknown:Zt,ZodNever:St,ZodVoid:Wr,ZodArray:Gt,ZodObject:st,ZodUnion:kr,ZodDiscriminatedUnion:Co,ZodIntersection:Ar,ZodTuple:Nt,ZodRecord:Ro,ZodMap:Kr,ZodSet:Yr,ZodFunction:jo,ZodLazy:Er,ZodLiteral:Cr,ZodEnum:Rr,ZodNativeEnum:jr,ZodPromise:ir,ZodEffects:ut,ZodTransformer:ut,ZodOptional:ot,ZodNullable:Dt,ZodDefault:Or,ZodCatch:Pr,ZodNaN:Xr,BRAND:yd,ZodBranded:jn,ZodPipeline:On,ZodReadonly:Mr,custom:Ni,Schema:te,ZodSchema:te,late:vd,get ZodFirstPartyTypeKind(){return C},coerce:Qd,any:kd,array:Rd,bigint:wd,boolean:Ui,date:xd,discriminatedUnion:Md,effect:Ei,enum:Ld,function:qd,instanceof:bd,intersection:Nd,lazy:Bd,literal:zd,map:Ud,nan:_d,nativeEnum:Vd,never:Ed,null:Id,nullable:Gd,number:Fi,object:jd,oboolean:Xd,onumber:Yd,optional:Zd,ostring:Kd,pipeline:Wd,preprocess:Hd,promise:Jd,record:Fd,set:$d,strictObject:Od,string:Di,symbol:Sd,transformer:Ei,tuple:Dd,undefined:Td,union:Pd,unknown:Ad,void:Cd,NEVER:ef,ZodIssueCode:E,quotelessJson:Gc,ZodError:lt});function tf({prompt:e,useLegacyFunctionCalling:t=false,systemMessageMode:r="system"}){let n=[],o=[];for(let{role:s,content:a}of e)switch(s){case "system":{switch(r){case "system":{n.push({role:"system",content:a});break}case "developer":{n.push({role:"developer",content:a});break}case "remove":{o.push({type:"other",message:"system messages are removed for this model"});break}default:{let l=r;throw new Error(`Unsupported system message mode: ${l}`)}}break}case "user":{if(a.length===1&&a[0].type==="text"){n.push({role:"user",content:a[0].text});break}n.push({role:"user",content:a.map((l,u)=>{var p,f,m,y;switch(l.type){case "text":return {type:"text",text:l.text};case "image":return {type:"image_url",image_url:{url:l.image instanceof URL?l.image.toString():`data:${(p=l.mimeType)!=null?p:"image/jpeg"};base64,${Lt(l.image)}`,detail:(m=(f=l.providerMetadata)==null?void 0:f.openai)==null?void 0:m.imageDetail}};case "file":{if(l.data instanceof URL)throw new ae({functionality:"'File content parts with URL data' functionality not supported."});switch(l.mimeType){case "audio/wav":return {type:"input_audio",input_audio:{data:l.data,format:"wav"}};case "audio/mp3":case "audio/mpeg":return {type:"input_audio",input_audio:{data:l.data,format:"mp3"}};case "application/pdf":return {type:"file",file:{filename:(y=l.filename)!=null?y:`part-${u}.pdf`,file_data:`data:application/pdf;base64,${l.data}`}};default:throw new ae({functionality:`File content part type ${l.mimeType} in user messages`})}}}})});break}case "assistant":{let l="",u=[];for(let p of a)switch(p.type){case "text":{l+=p.text;break}case "tool-call":{u.push({id:p.toolCallId,type:"function",function:{name:p.toolName,arguments:JSON.stringify(p.args)}});break}}if(t){if(u.length>1)throw new ae({functionality:"useLegacyFunctionCalling with multiple tool calls in one message"});n.push({role:"assistant",content:l,function_call:u.length>0?u[0].function:void 0});}else n.push({role:"assistant",content:l,tool_calls:u.length>0?u:void 0});break}case "tool":{for(let l of a)t?n.push({role:"function",name:l.toolName,content:JSON.stringify(l.result)}):n.push({role:"tool",tool_call_id:l.toolCallId,content:JSON.stringify(l.result)});break}default:{let l=s;throw new Error(`Unsupported role: ${l}`)}}return {messages:n,warnings:o}}function $i(e){var t,r;return (r=(t=e==null?void 0:e.content)==null?void 0:t.map(({token:n,logprob:o,top_logprobs:s})=>({token:n,logprob:o,topLogprobs:s?s.map(({token:a,logprob:l})=>({token:a,logprob:l})):[]})))!=null?r:void 0}function Oo(e){switch(e){case "stop":return "stop";case "length":return "length";case "content_filter":return "content-filter";case "function_call":case "tool_calls":return "tool-calls";default:return "unknown"}}var Os=i.object({error:i.object({message:i.string(),type:i.string().nullish(),param:i.any().nullish(),code:i.union([i.string(),i.number()]).nullish()})}),Ft=Si({errorSchema:Os,errorToMessage:e=>e.error.message});function Po({id:e,model:t,created:r}){return {id:e!=null?e:void 0,modelId:t!=null?t:void 0,timestamp:r!=null?new Date(r*1e3):void 0}}function rf({mode:e,useLegacyFunctionCalling:t=false,structuredOutputs:r}){var n;let o=(n=e.tools)!=null&&n.length?e.tools:void 0,s=[];if(o==null)return {tools:void 0,tool_choice:void 0,toolWarnings:s};let a=e.toolChoice;if(t){let p=[];for(let m of o)m.type==="provider-defined"?s.push({type:"unsupported-tool",tool:m}):p.push({name:m.name,description:m.description,parameters:m.parameters});if(a==null)return {functions:p,function_call:void 0,toolWarnings:s};switch(a.type){case "auto":case "none":case void 0:return {functions:p,function_call:void 0,toolWarnings:s};case "required":throw new ae({functionality:"useLegacyFunctionCalling and toolChoice: required"});default:return {functions:p,function_call:{name:a.toolName},toolWarnings:s}}}let l=[];for(let p of o)p.type==="provider-defined"?s.push({type:"unsupported-tool",tool:p}):l.push({type:"function",function:{name:p.name,description:p.description,parameters:p.parameters,strict:r?true:void 0}});if(a==null)return {tools:l,tool_choice:void 0,toolWarnings:s};let u=a.type;switch(u){case "auto":case "none":case "required":return {tools:l,tool_choice:u,toolWarnings:s};case "tool":return {tools:l,tool_choice:{type:"function",function:{name:a.toolName}},toolWarnings:s};default:{let p=u;throw new ae({functionality:`Unsupported tool choice type: ${p}`})}}}var nf=class{constructor(e,t,r){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=r;}get supportsStructuredOutputs(){var e;return (e=this.settings.structuredOutputs)!=null?e:js(this.modelId)}get defaultObjectGenerationMode(){return af(this.modelId)?"tool":this.supportsStructuredOutputs?"json":"tool"}get provider(){return this.config.provider}get supportsImageUrls(){return !this.settings.downloadImages}getArgs({mode:e,prompt:t,maxTokens:r,temperature:n,topP:o,topK:s,frequencyPenalty:a,presencePenalty:l,stopSequences:u,responseFormat:p,seed:f,providerMetadata:m}){var y,v,x,S,_,I,R,T;let N=e.type,F=[];s!=null&&F.push({type:"unsupported-setting",setting:"topK"}),(p==null?void 0:p.type)==="json"&&p.schema!=null&&!this.supportsStructuredOutputs&&F.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format schema is only supported with structuredOutputs"});let O=this.settings.useLegacyFunctionCalling;if(O&&this.settings.parallelToolCalls===true)throw new ae({functionality:"useLegacyFunctionCalling with parallelToolCalls"});if(O&&this.supportsStructuredOutputs)throw new ae({functionality:"structuredOutputs with useLegacyFunctionCalling"});let{messages:Y,warnings:P}=tf({prompt:t,useLegacyFunctionCalling:O,systemMessageMode:lf(this.modelId)});F.push(...P);let q={model:this.modelId,logit_bias:this.settings.logitBias,logprobs:this.settings.logprobs===true||typeof this.settings.logprobs=="number"?true:void 0,top_logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,user:this.settings.user,parallel_tool_calls:this.settings.parallelToolCalls,max_tokens:r,temperature:n,top_p:o,frequency_penalty:a,presence_penalty:l,response_format:(p==null?void 0:p.type)==="json"?this.supportsStructuredOutputs&&p.schema!=null?{type:"json_schema",json_schema:{schema:p.schema,strict:true,name:(y=p.name)!=null?y:"response",description:p.description}}:{type:"json_object"}:void 0,stop:u,seed:f,max_completion_tokens:(v=m==null?void 0:m.openai)==null?void 0:v.maxCompletionTokens,store:(x=m==null?void 0:m.openai)==null?void 0:x.store,metadata:(S=m==null?void 0:m.openai)==null?void 0:S.metadata,prediction:(_=m==null?void 0:m.openai)==null?void 0:_.prediction,reasoning_effort:(R=(I=m==null?void 0:m.openai)==null?void 0:I.reasoningEffort)!=null?R:this.settings.reasoningEffort,messages:Y};switch(js(this.modelId)?(q.temperature!=null&&(q.temperature=void 0,F.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for reasoning models"})),q.top_p!=null&&(q.top_p=void 0,F.push({type:"unsupported-setting",setting:"topP",details:"topP is not supported for reasoning models"})),q.frequency_penalty!=null&&(q.frequency_penalty=void 0,F.push({type:"unsupported-setting",setting:"frequencyPenalty",details:"frequencyPenalty is not supported for reasoning models"})),q.presence_penalty!=null&&(q.presence_penalty=void 0,F.push({type:"unsupported-setting",setting:"presencePenalty",details:"presencePenalty is not supported for reasoning models"})),q.logit_bias!=null&&(q.logit_bias=void 0,F.push({type:"other",message:"logitBias is not supported for reasoning models"})),q.logprobs!=null&&(q.logprobs=void 0,F.push({type:"other",message:"logprobs is not supported for reasoning models"})),q.top_logprobs!=null&&(q.top_logprobs=void 0,F.push({type:"other",message:"topLogprobs is not supported for reasoning models"})),q.max_tokens!=null&&(q.max_completion_tokens==null&&(q.max_completion_tokens=q.max_tokens),q.max_tokens=void 0)):(this.modelId.startsWith("gpt-4o-search-preview")||this.modelId.startsWith("gpt-4o-mini-search-preview"))&&q.temperature!=null&&(q.temperature=void 0,F.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for the search preview models and has been removed."})),N){case "regular":{let{tools:oe,tool_choice:ye,functions:ke,function_call:Te,toolWarnings:he}=rf({mode:e,useLegacyFunctionCalling:O,structuredOutputs:this.supportsStructuredOutputs});return {args:g(d({},q),{tools:oe,tool_choice:ye,functions:ke,function_call:Te}),warnings:[...F,...he]}}case "object-json":return {args:g(d({},q),{response_format:this.supportsStructuredOutputs&&e.schema!=null?{type:"json_schema",json_schema:{schema:e.schema,strict:true,name:(T=e.name)!=null?T:"response",description:e.description}}:{type:"json_object"}}),warnings:F};case "object-tool":return {args:O?g(d({},q),{function_call:{name:e.tool.name},functions:[{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters}]}):g(d({},q),{tool_choice:{type:"function",function:{name:e.tool.name}},tools:[{type:"function",function:{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters,strict:this.supportsStructuredOutputs?true:void 0}}]}),warnings:F};default:{let oe=N;throw new Error(`Unsupported type: ${oe}`)}}}doGenerate(e){return A(this,null,function*(){var t,r,n,o,s,a,l,u;let{args:p,warnings:f}=this.getArgs(e),{responseHeaders:m,value:y,rawValue:v}=yield Qe({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Ze(this.config.headers(),e.headers),body:p,failedResponseHandler:Ft,successfulResponseHandler:ht(of),abortSignal:e.abortSignal,fetch:this.config.fetch}),N=p,{messages:x}=N,S=qe(N,["messages"]),_=y.choices[0],I=(t=y.usage)==null?void 0:t.completion_tokens_details,R=(r=y.usage)==null?void 0:r.prompt_tokens_details,T={openai:{}};return (I==null?void 0:I.reasoning_tokens)!=null&&(T.openai.reasoningTokens=I==null?void 0:I.reasoning_tokens),(I==null?void 0:I.accepted_prediction_tokens)!=null&&(T.openai.acceptedPredictionTokens=I==null?void 0:I.accepted_prediction_tokens),(I==null?void 0:I.rejected_prediction_tokens)!=null&&(T.openai.rejectedPredictionTokens=I==null?void 0:I.rejected_prediction_tokens),(R==null?void 0:R.cached_tokens)!=null&&(T.openai.cachedPromptTokens=R==null?void 0:R.cached_tokens),{text:(n=_.message.content)!=null?n:void 0,toolCalls:this.settings.useLegacyFunctionCalling&&_.message.function_call?[{toolCallType:"function",toolCallId:ft(),toolName:_.message.function_call.name,args:_.message.function_call.arguments}]:(o=_.message.tool_calls)==null?void 0:o.map(F=>{var O;return {toolCallType:"function",toolCallId:(O=F.id)!=null?O:ft(),toolName:F.function.name,args:F.function.arguments}}),finishReason:Oo(_.finish_reason),usage:{promptTokens:(a=(s=y.usage)==null?void 0:s.prompt_tokens)!=null?a:NaN,completionTokens:(u=(l=y.usage)==null?void 0:l.completion_tokens)!=null?u:NaN},rawCall:{rawPrompt:x,rawSettings:S},rawResponse:{headers:m,body:v},request:{body:JSON.stringify(p)},response:Po(y),warnings:f,logprobs:$i(_.logprobs),providerMetadata:T}})}doStream(e){return A(this,null,function*(){if(this.settings.simulateStreaming){let _=yield this.doGenerate(e);return {stream:new ReadableStream({start(R){if(R.enqueue(d({type:"response-metadata"},_.response)),_.text&&R.enqueue({type:"text-delta",textDelta:_.text}),_.toolCalls)for(let T of _.toolCalls)R.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:T.toolCallId,toolName:T.toolName,argsTextDelta:T.args}),R.enqueue(d({type:"tool-call"},T));R.enqueue({type:"finish",finishReason:_.finishReason,usage:_.usage,logprobs:_.logprobs,providerMetadata:_.providerMetadata}),R.close();}}),rawCall:_.rawCall,rawResponse:_.rawResponse,warnings:_.warnings}}let{args:t,warnings:r}=this.getArgs(e),n=g(d({},t),{stream:true,stream_options:this.config.compatibility==="strict"?{include_usage:true}:void 0}),{responseHeaders:o,value:s}=yield Qe({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Ze(this.config.headers(),e.headers),body:n,failedResponseHandler:Ft,successfulResponseHandler:Vr(sf),abortSignal:e.abortSignal,fetch:this.config.fetch}),S=t,{messages:a}=S,l=qe(S,["messages"]),u=[],p="unknown",f={promptTokens:void 0,completionTokens:void 0},m,y=true,{useLegacyFunctionCalling:v}=this.settings,x={openai:{}};return {stream:s.pipeThrough(new TransformStream({transform(_,I){var R,T,N,F,O,Y,P,q,oe,ye,ke,Te;if(!_.success){p="error",I.enqueue({type:"error",error:_.error});return}let he=_.value;if("error"in he){p="error",I.enqueue({type:"error",error:he.error});return}if(y&&(y=false,I.enqueue(d({type:"response-metadata"},Po(he)))),he.usage!=null){let{prompt_tokens:de,completion_tokens:we,prompt_tokens_details:X,completion_tokens_details:Q}=he.usage;f={promptTokens:de!=null?de:void 0,completionTokens:we!=null?we:void 0},(Q==null?void 0:Q.reasoning_tokens)!=null&&(x.openai.reasoningTokens=Q==null?void 0:Q.reasoning_tokens),(Q==null?void 0:Q.accepted_prediction_tokens)!=null&&(x.openai.acceptedPredictionTokens=Q==null?void 0:Q.accepted_prediction_tokens),(Q==null?void 0:Q.rejected_prediction_tokens)!=null&&(x.openai.rejectedPredictionTokens=Q==null?void 0:Q.rejected_prediction_tokens),(X==null?void 0:X.cached_tokens)!=null&&(x.openai.cachedPromptTokens=X==null?void 0:X.cached_tokens);}let le=he.choices[0];if((le==null?void 0:le.finish_reason)!=null&&(p=Oo(le.finish_reason)),(le==null?void 0:le.delta)==null)return;let Ne=le.delta;Ne.content!=null&&I.enqueue({type:"text-delta",textDelta:Ne.content});let ve=$i(le==null?void 0:le.logprobs);ve!=null&&ve.length&&(m===void 0&&(m=[]),m.push(...ve));let Pe=v&&Ne.function_call!=null?[{type:"function",id:ft(),function:Ne.function_call,index:0}]:Ne.tool_calls;if(Pe!=null)for(let de of Pe){let we=de.index;if(u[we]==null){if(de.type!=="function")throw new wo({data:de,message:"Expected 'function' type."});if(de.id==null)throw new wo({data:de,message:"Expected 'id' to be a string."});if(((R=de.function)==null?void 0:R.name)==null)throw new wo({data:de,message:"Expected 'function.name' to be a string."});u[we]={id:de.id,type:"function",function:{name:de.function.name,arguments:(T=de.function.arguments)!=null?T:""},hasFinished:false};let Q=u[we];((N=Q.function)==null?void 0:N.name)!=null&&((F=Q.function)==null?void 0:F.arguments)!=null&&(Q.function.arguments.length>0&&I.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:Q.id,toolName:Q.function.name,argsTextDelta:Q.function.arguments}),Is(Q.function.arguments)&&(I.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(O=Q.id)!=null?O:ft(),toolName:Q.function.name,args:Q.function.arguments}),Q.hasFinished=true));continue}let X=u[we];X.hasFinished||(((Y=de.function)==null?void 0:Y.arguments)!=null&&(X.function.arguments+=(q=(P=de.function)==null?void 0:P.arguments)!=null?q:""),I.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:X.id,toolName:X.function.name,argsTextDelta:(oe=de.function.arguments)!=null?oe:""}),((ye=X.function)==null?void 0:ye.name)!=null&&((ke=X.function)==null?void 0:ke.arguments)!=null&&Is(X.function.arguments)&&(I.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(Te=X.id)!=null?Te:ft(),toolName:X.function.name,args:X.function.arguments}),X.hasFinished=true));}},flush(_){var I,R;_.enqueue(d({type:"finish",finishReason:p,logprobs:m,usage:{promptTokens:(I=f.promptTokens)!=null?I:NaN,completionTokens:(R=f.completionTokens)!=null?R:NaN}},x!=null?{providerMetadata:x}:{}));}})),rawCall:{rawPrompt:a,rawSettings:l},rawResponse:{headers:o},request:{body:JSON.stringify(n)},warnings:r}})}},Li=i.object({prompt_tokens:i.number().nullish(),completion_tokens:i.number().nullish(),prompt_tokens_details:i.object({cached_tokens:i.number().nullish()}).nullish(),completion_tokens_details:i.object({reasoning_tokens:i.number().nullish(),accepted_prediction_tokens:i.number().nullish(),rejected_prediction_tokens:i.number().nullish()}).nullish()}).nullish(),of=i.object({id:i.string().nullish(),created:i.number().nullish(),model:i.string().nullish(),choices:i.array(i.object({message:i.object({role:i.literal("assistant").nullish(),content:i.string().nullish(),function_call:i.object({arguments:i.string(),name:i.string()}).nullish(),tool_calls:i.array(i.object({id:i.string().nullish(),type:i.literal("function"),function:i.object({name:i.string(),arguments:i.string()})})).nullish()}),index:i.number(),logprobs:i.object({content:i.array(i.object({token:i.string(),logprob:i.number(),top_logprobs:i.array(i.object({token:i.string(),logprob:i.number()}))})).nullable()}).nullish(),finish_reason:i.string().nullish()})),usage:Li}),sf=i.union([i.object({id:i.string().nullish(),created:i.number().nullish(),model:i.string().nullish(),choices:i.array(i.object({delta:i.object({role:i.enum(["assistant"]).nullish(),content:i.string().nullish(),function_call:i.object({name:i.string().optional(),arguments:i.string().optional()}).nullish(),tool_calls:i.array(i.object({index:i.number(),id:i.string().nullish(),type:i.literal("function").nullish(),function:i.object({name:i.string().nullish(),arguments:i.string().nullish()})})).nullish()}).nullish(),logprobs:i.object({content:i.array(i.object({token:i.string(),logprob:i.number(),top_logprobs:i.array(i.object({token:i.string(),logprob:i.number()}))})).nullable()}).nullish(),finish_reason:i.string().nullish(),index:i.number()})),usage:Li}),Os]);function js(e){return e.startsWith("o")}function af(e){return e.startsWith("gpt-4o-audio-preview")}function lf(e){var t,r;return js(e)?(r=(t=uf[e])==null?void 0:t.systemMessageMode)!=null?r:"developer":"system"}var uf={"o1-mini":{systemMessageMode:"remove"},"o1-mini-2024-09-12":{systemMessageMode:"remove"},"o1-preview":{systemMessageMode:"remove"},"o1-preview-2024-09-12":{systemMessageMode:"remove"},o3:{systemMessageMode:"developer"},"o3-2025-04-16":{systemMessageMode:"developer"},"o3-mini":{systemMessageMode:"developer"},"o3-mini-2025-01-31":{systemMessageMode:"developer"},"o4-mini":{systemMessageMode:"developer"},"o4-mini-2025-04-16":{systemMessageMode:"developer"}};function pf({prompt:e,inputFormat:t,user:r="user",assistant:n="assistant"}){if(t==="prompt"&&e.length===1&&e[0].role==="user"&&e[0].content.length===1&&e[0].content[0].type==="text")return {prompt:e[0].content[0].text};let o="";e[0].role==="system"&&(o+=`${e[0].content}

`,e=e.slice(1));for(let{role:s,content:a}of e)switch(s){case "system":throw new _t({message:"Unexpected system message in prompt: ${content}",prompt:e});case "user":{let l=a.map(u=>{switch(u.type){case "text":return u.text;case "image":throw new ae({functionality:"images"})}}).join("");o+=`${r}:
${l}

`;break}case "assistant":{let l=a.map(u=>{switch(u.type){case "text":return u.text;case "tool-call":throw new ae({functionality:"tool-call messages"})}}).join("");o+=`${n}:
${l}

`;break}case "tool":throw new ae({functionality:"tool messages"});default:{let l=s;throw new Error(`Unsupported role: ${l}`)}}return o+=`${n}:
`,{prompt:o,stopSequences:[`
${r}:`]}}function qi(e){return e==null?void 0:e.tokens.map((t,r)=>({token:t,logprob:e.token_logprobs[r],topLogprobs:e.top_logprobs?Object.entries(e.top_logprobs[r]).map(([n,o])=>({token:n,logprob:o})):[]}))}var cf=class{constructor(e,t,r){this.specificationVersion="v1",this.defaultObjectGenerationMode=void 0,this.modelId=e,this.settings=t,this.config=r;}get provider(){return this.config.provider}getArgs({mode:e,inputFormat:t,prompt:r,maxTokens:n,temperature:o,topP:s,topK:a,frequencyPenalty:l,presencePenalty:u,stopSequences:p,responseFormat:f,seed:m}){var y;let v=e.type,x=[];a!=null&&x.push({type:"unsupported-setting",setting:"topK"}),f!=null&&f.type!=="text"&&x.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format is not supported."});let{prompt:S,stopSequences:_}=pf({prompt:r,inputFormat:t}),I=[..._!=null?_:[],...p!=null?p:[]],R={model:this.modelId,echo:this.settings.echo,logit_bias:this.settings.logitBias,logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,suffix:this.settings.suffix,user:this.settings.user,max_tokens:n,temperature:o,top_p:s,frequency_penalty:l,presence_penalty:u,seed:m,prompt:S,stop:I.length>0?I:void 0};switch(v){case "regular":{if((y=e.tools)!=null&&y.length)throw new ae({functionality:"tools"});if(e.toolChoice)throw new ae({functionality:"toolChoice"});return {args:R,warnings:x}}case "object-json":throw new ae({functionality:"object-json mode"});case "object-tool":throw new ae({functionality:"object-tool mode"});default:{let T=v;throw new Error(`Unsupported type: ${T}`)}}}doGenerate(e){return A(this,null,function*(){let{args:t,warnings:r}=this.getArgs(e),{responseHeaders:n,value:o,rawValue:s}=yield Qe({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Ze(this.config.headers(),e.headers),body:t,failedResponseHandler:Ft,successfulResponseHandler:ht(df),abortSignal:e.abortSignal,fetch:this.config.fetch}),p=t,{prompt:a}=p,l=qe(p,["prompt"]),u=o.choices[0];return {text:u.text,usage:{promptTokens:o.usage.prompt_tokens,completionTokens:o.usage.completion_tokens},finishReason:Oo(u.finish_reason),logprobs:qi(u.logprobs),rawCall:{rawPrompt:a,rawSettings:l},rawResponse:{headers:n,body:s},response:Po(o),warnings:r,request:{body:JSON.stringify(t)}}})}doStream(e){return A(this,null,function*(){let{args:t,warnings:r}=this.getArgs(e),n=g(d({},t),{stream:true,stream_options:this.config.compatibility==="strict"?{include_usage:true}:void 0}),{responseHeaders:o,value:s}=yield Qe({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Ze(this.config.headers(),e.headers),body:n,failedResponseHandler:Ft,successfulResponseHandler:Vr(ff),abortSignal:e.abortSignal,fetch:this.config.fetch}),y=t,{prompt:a}=y,l=qe(y,["prompt"]),u="unknown",p={promptTokens:Number.NaN,completionTokens:Number.NaN},f,m=true;return {stream:s.pipeThrough(new TransformStream({transform(v,x){if(!v.success){u="error",x.enqueue({type:"error",error:v.error});return}let S=v.value;if("error"in S){u="error",x.enqueue({type:"error",error:S.error});return}m&&(m=false,x.enqueue(d({type:"response-metadata"},Po(S)))),S.usage!=null&&(p={promptTokens:S.usage.prompt_tokens,completionTokens:S.usage.completion_tokens});let _=S.choices[0];(_==null?void 0:_.finish_reason)!=null&&(u=Oo(_.finish_reason)),(_==null?void 0:_.text)!=null&&x.enqueue({type:"text-delta",textDelta:_.text});let I=qi(_==null?void 0:_.logprobs);I!=null&&I.length&&(f===void 0&&(f=[]),f.push(...I));},flush(v){v.enqueue({type:"finish",finishReason:u,logprobs:f,usage:p});}})),rawCall:{rawPrompt:a,rawSettings:l},rawResponse:{headers:o},warnings:r,request:{body:JSON.stringify(n)}}})}},df=i.object({id:i.string().nullish(),created:i.number().nullish(),model:i.string().nullish(),choices:i.array(i.object({text:i.string(),finish_reason:i.string(),logprobs:i.object({tokens:i.array(i.string()),token_logprobs:i.array(i.number()),top_logprobs:i.array(i.record(i.string(),i.number())).nullable()}).nullish()})),usage:i.object({prompt_tokens:i.number(),completion_tokens:i.number()})}),ff=i.union([i.object({id:i.string().nullish(),created:i.number().nullish(),model:i.string().nullish(),choices:i.array(i.object({text:i.string(),finish_reason:i.string().nullish(),index:i.number(),logprobs:i.object({tokens:i.array(i.string()),token_logprobs:i.array(i.number()),top_logprobs:i.array(i.record(i.string(),i.number())).nullable()}).nullish()})),usage:i.object({prompt_tokens:i.number(),completion_tokens:i.number()}).nullish()}),Os]),hf=class{constructor(e,t,r){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=r;}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){var e;return (e=this.settings.maxEmbeddingsPerCall)!=null?e:2048}get supportsParallelCalls(){var e;return (e=this.settings.supportsParallelCalls)!=null?e:true}doEmbed(n){return A(this,arguments,function*({values:e,headers:t,abortSignal:r}){if(e.length>this.maxEmbeddingsPerCall)throw new xo({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:e});let{responseHeaders:o,value:s}=yield Qe({url:this.config.url({path:"/embeddings",modelId:this.modelId}),headers:Ze(this.config.headers(),t),body:{model:this.modelId,input:e,encoding_format:"float",dimensions:this.settings.dimensions,user:this.settings.user},failedResponseHandler:Ft,successfulResponseHandler:ht(mf),abortSignal:r,fetch:this.config.fetch});return {embeddings:s.data.map(a=>a.embedding),usage:s.usage?{tokens:s.usage.prompt_tokens}:void 0,rawResponse:{headers:o}}})}},mf=i.object({data:i.array(i.object({embedding:i.array(i.number())})),usage:i.object({prompt_tokens:i.number()}).nullish()}),gf={"dall-e-3":1,"dall-e-2":10,"gpt-image-1":10},yf=new Set(["gpt-image-1"]),vf=class{constructor(e,t,r){this.modelId=e,this.settings=t,this.config=r,this.specificationVersion="v1";}get maxImagesPerCall(){var e,t;return (t=(e=this.settings.maxImagesPerCall)!=null?e:gf[this.modelId])!=null?t:1}get provider(){return this.config.provider}doGenerate(u){return A(this,arguments,function*({prompt:e,n:t,size:r,aspectRatio:n,seed:o,providerOptions:s,headers:a,abortSignal:l}){var p,f,m,y;let v=[];n!=null&&v.push({type:"unsupported-setting",setting:"aspectRatio",details:"This model does not support aspect ratio. Use `size` instead."}),o!=null&&v.push({type:"unsupported-setting",setting:"seed"});let x=(m=(f=(p=this.config._internal)==null?void 0:p.currentDate)==null?void 0:f.call(p))!=null?m:new Date,{value:S,responseHeaders:_}=yield Qe({url:this.config.url({path:"/images/generations",modelId:this.modelId}),headers:Ze(this.config.headers(),a),body:d(d({model:this.modelId,prompt:e,n:t,size:r},(y=s.openai)!=null?y:{}),yf.has(this.modelId)?{}:{response_format:"b64_json"}),failedResponseHandler:Ft,successfulResponseHandler:ht(bf),abortSignal:l,fetch:this.config.fetch});return {images:S.data.map(I=>I.b64_json),warnings:v,response:{timestamp:x,modelId:this.modelId,headers:_}}})}},bf=i.object({data:i.array(i.object({b64_json:i.string()}))}),_f=i.object({include:i.array(i.string()).nullish(),language:i.string().nullish(),prompt:i.string().nullish(),temperature:i.number().min(0).max(1).nullish().default(0),timestampGranularities:i.array(i.enum(["word","segment"])).nullish().default(["segment"])}),Bi={afrikaans:"af",arabic:"ar",armenian:"hy",azerbaijani:"az",belarusian:"be",bosnian:"bs",bulgarian:"bg",catalan:"ca",chinese:"zh",croatian:"hr",czech:"cs",danish:"da",dutch:"nl",english:"en",estonian:"et",finnish:"fi",french:"fr",galician:"gl",german:"de",greek:"el",hebrew:"he",hindi:"hi",hungarian:"hu",icelandic:"is",indonesian:"id",italian:"it",japanese:"ja",kannada:"kn",kazakh:"kk",korean:"ko",latvian:"lv",lithuanian:"lt",macedonian:"mk",malay:"ms",marathi:"mr",maori:"mi",nepali:"ne",norwegian:"no",persian:"fa",polish:"pl",portuguese:"pt",romanian:"ro",russian:"ru",serbian:"sr",slovak:"sk",slovenian:"sl",spanish:"es",swahili:"sw",swedish:"sv",tagalog:"tl",tamil:"ta",thai:"th",turkish:"tr",ukrainian:"uk",urdu:"ur",vietnamese:"vi",welsh:"cy"},wf=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v1";}get provider(){return this.config.provider}getArgs({audio:e,mediaType:t,providerOptions:r}){var n,o,s,a,l;let u=[],p=Lr({provider:"openai",providerOptions:r,schema:_f}),f=new FormData,m=e instanceof Uint8Array?new Blob([e]):new Blob([or(e)]);if(f.append("model",this.modelId),f.append("file",new File([m],"audio",{type:t})),p){let y={include:(n=p.include)!=null?n:void 0,language:(o=p.language)!=null?o:void 0,prompt:(s=p.prompt)!=null?s:void 0,temperature:(a=p.temperature)!=null?a:void 0,timestamp_granularities:(l=p.timestampGranularities)!=null?l:void 0};for(let v in y){let x=y[v];x!==void 0&&f.append(v,String(x));}}return {formData:f,warnings:u}}doGenerate(e){return A(this,null,function*(){var t,r,n,o,s,a;let l=(n=(r=(t=this.config._internal)==null?void 0:t.currentDate)==null?void 0:r.call(t))!=null?n:new Date,{formData:u,warnings:p}=this.getArgs(e),{value:f,responseHeaders:m,rawValue:y}=yield wi({url:this.config.url({path:"/audio/transcriptions",modelId:this.modelId}),headers:Ze(this.config.headers(),e.headers),formData:u,failedResponseHandler:Ft,successfulResponseHandler:ht(xf),abortSignal:e.abortSignal,fetch:this.config.fetch}),v=f.language!=null&&f.language in Bi?Bi[f.language]:void 0;return {text:f.text,segments:(s=(o=f.words)==null?void 0:o.map(x=>({text:x.word,startSecond:x.start,endSecond:x.end})))!=null?s:[],language:v,durationInSeconds:(a=f.duration)!=null?a:void 0,warnings:p,response:{timestamp:l,modelId:this.modelId,headers:m,body:y}}})}},xf=i.object({text:i.string(),language:i.string().nullish(),duration:i.number().nullish(),words:i.array(i.object({word:i.string(),start:i.number(),end:i.number()})).nullish()});function Sf({prompt:e,systemMessageMode:t}){let r=[],n=[];for(let{role:o,content:s}of e)switch(o){case "system":{switch(t){case "system":{r.push({role:"system",content:s});break}case "developer":{r.push({role:"developer",content:s});break}case "remove":{n.push({type:"other",message:"system messages are removed for this model"});break}default:{let a=t;throw new Error(`Unsupported system message mode: ${a}`)}}break}case "user":{r.push({role:"user",content:s.map((a,l)=>{var u,p,f,m;switch(a.type){case "text":return {type:"input_text",text:a.text};case "image":return {type:"input_image",image_url:a.image instanceof URL?a.image.toString():`data:${(u=a.mimeType)!=null?u:"image/jpeg"};base64,${Lt(a.image)}`,detail:(f=(p=a.providerMetadata)==null?void 0:p.openai)==null?void 0:f.imageDetail};case "file":{if(a.data instanceof URL)throw new ae({functionality:"File URLs in user messages"});switch(a.mimeType){case "application/pdf":return {type:"input_file",filename:(m=a.filename)!=null?m:`part-${l}.pdf`,file_data:`data:application/pdf;base64,${a.data}`};default:throw new ae({functionality:"Only PDF files are supported in user messages"})}}}})});break}case "assistant":{for(let a of s)switch(a.type){case "text":{r.push({role:"assistant",content:[{type:"output_text",text:a.text}]});break}case "tool-call":{r.push({type:"function_call",call_id:a.toolCallId,name:a.toolName,arguments:JSON.stringify(a.args)});break}}break}case "tool":{for(let a of s)r.push({type:"function_call_output",call_id:a.toolCallId,output:JSON.stringify(a.result)});break}default:{let a=o;throw new Error(`Unsupported role: ${a}`)}}return {messages:r,warnings:n}}function zi({finishReason:e,hasToolCalls:t}){switch(e){case void 0:case null:return t?"tool-calls":"stop";case "max_output_tokens":return "length";case "content_filter":return "content-filter";default:return t?"tool-calls":"unknown"}}function Tf({mode:e,strict:t}){var r;let n=(r=e.tools)!=null&&r.length?e.tools:void 0,o=[];if(n==null)return {tools:void 0,tool_choice:void 0,toolWarnings:o};let s=e.toolChoice,a=[];for(let u of n)switch(u.type){case "function":a.push({type:"function",name:u.name,description:u.description,parameters:u.parameters,strict:t?true:void 0});break;case "provider-defined":switch(u.id){case "openai.web_search_preview":a.push({type:"web_search_preview",search_context_size:u.args.searchContextSize,user_location:u.args.userLocation});break;default:o.push({type:"unsupported-tool",tool:u});break}break;default:o.push({type:"unsupported-tool",tool:u});break}if(s==null)return {tools:a,tool_choice:void 0,toolWarnings:o};let l=s.type;switch(l){case "auto":case "none":case "required":return {tools:a,tool_choice:l,toolWarnings:o};case "tool":return s.toolName==="web_search_preview"?{tools:a,tool_choice:{type:"web_search_preview"},toolWarnings:o}:{tools:a,tool_choice:{type:"function",name:s.toolName},toolWarnings:o};default:{let u=l;throw new ae({functionality:`Unsupported tool choice type: ${u}`})}}}var If=class{constructor(e,t){this.specificationVersion="v1",this.defaultObjectGenerationMode="json",this.supportsStructuredOutputs=true,this.modelId=e,this.config=t;}get provider(){return this.config.provider}getArgs({mode:e,maxTokens:t,temperature:r,stopSequences:n,topP:o,topK:s,presencePenalty:a,frequencyPenalty:l,seed:u,prompt:p,providerMetadata:f,responseFormat:m}){var y,v,x;let S=[],_=Lf(this.modelId),I=e.type;s!=null&&S.push({type:"unsupported-setting",setting:"topK"}),u!=null&&S.push({type:"unsupported-setting",setting:"seed"}),a!=null&&S.push({type:"unsupported-setting",setting:"presencePenalty"}),l!=null&&S.push({type:"unsupported-setting",setting:"frequencyPenalty"}),n!=null&&S.push({type:"unsupported-setting",setting:"stopSequences"});let{messages:R,warnings:T}=Sf({prompt:p,systemMessageMode:_.systemMessageMode});S.push(...T);let N=Lr({provider:"openai",providerOptions:f,schema:Vf}),F=(y=N==null?void 0:N.strictSchemas)!=null?y:true,O=d(d(g(d({model:this.modelId,input:R,temperature:r,top_p:o,max_output_tokens:t},(m==null?void 0:m.type)==="json"&&{text:{format:m.schema!=null?{type:"json_schema",strict:F,name:(v=m.name)!=null?v:"response",description:m.description,schema:m.schema}:{type:"json_object"}}}),{metadata:N==null?void 0:N.metadata,parallel_tool_calls:N==null?void 0:N.parallelToolCalls,previous_response_id:N==null?void 0:N.previousResponseId,store:N==null?void 0:N.store,user:N==null?void 0:N.user,instructions:N==null?void 0:N.instructions}),_.isReasoningModel&&((N==null?void 0:N.reasoningEffort)!=null||(N==null?void 0:N.reasoningSummary)!=null)&&{reasoning:d(d({},(N==null?void 0:N.reasoningEffort)!=null&&{effort:N.reasoningEffort}),(N==null?void 0:N.reasoningSummary)!=null&&{summary:N.reasoningSummary})}),_.requiredAutoTruncation&&{truncation:"auto"});switch(_.isReasoningModel&&(O.temperature!=null&&(O.temperature=void 0,S.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for reasoning models"})),O.top_p!=null&&(O.top_p=void 0,S.push({type:"unsupported-setting",setting:"topP",details:"topP is not supported for reasoning models"}))),I){case "regular":{let{tools:Y,tool_choice:P,toolWarnings:q}=Tf({mode:e,strict:F});return {args:g(d({},O),{tools:Y,tool_choice:P}),warnings:[...S,...q]}}case "object-json":return {args:g(d({},O),{text:{format:e.schema!=null?{type:"json_schema",strict:F,name:(x=e.name)!=null?x:"response",description:e.description,schema:e.schema}:{type:"json_object"}}}),warnings:S};case "object-tool":return {args:g(d({},O),{tool_choice:{type:"function",name:e.tool.name},tools:[{type:"function",name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters,strict:F}]}),warnings:S};default:{let Y=I;throw new Error(`Unsupported type: ${Y}`)}}}doGenerate(e){return A(this,null,function*(){var t,r,n,o,s,a,l;let{args:u,warnings:p}=this.getArgs(e),{responseHeaders:f,value:m,rawValue:y}=yield Qe({url:this.config.url({path:"/responses",modelId:this.modelId}),headers:Ze(this.config.headers(),e.headers),body:u,failedResponseHandler:Ft,successfulResponseHandler:ht(i.object({id:i.string(),created_at:i.number(),model:i.string(),output:i.array(i.discriminatedUnion("type",[i.object({type:i.literal("message"),role:i.literal("assistant"),content:i.array(i.object({type:i.literal("output_text"),text:i.string(),annotations:i.array(i.object({type:i.literal("url_citation"),start_index:i.number(),end_index:i.number(),url:i.string(),title:i.string()}))}))}),i.object({type:i.literal("function_call"),call_id:i.string(),name:i.string(),arguments:i.string()}),i.object({type:i.literal("web_search_call")}),i.object({type:i.literal("computer_call")}),i.object({type:i.literal("reasoning"),summary:i.array(i.object({type:i.literal("summary_text"),text:i.string()}))})])),incomplete_details:i.object({reason:i.string()}).nullable(),usage:Vi})),abortSignal:e.abortSignal,fetch:this.config.fetch}),v=m.output.filter(_=>_.type==="message").flatMap(_=>_.content).filter(_=>_.type==="output_text"),x=m.output.filter(_=>_.type==="function_call").map(_=>({toolCallType:"function",toolCallId:_.call_id,toolName:_.name,args:_.arguments})),S=(r=(t=m.output.find(_=>_.type==="reasoning"))==null?void 0:t.summary)!=null?r:null;return {text:v.map(_=>_.text).join(`
`),sources:v.flatMap(_=>_.annotations.map(I=>{var R,T,N;return {sourceType:"url",id:(N=(T=(R=this.config).generateId)==null?void 0:T.call(R))!=null?N:ft(),url:I.url,title:I.title}})),finishReason:zi({finishReason:(n=m.incomplete_details)==null?void 0:n.reason,hasToolCalls:x.length>0}),toolCalls:x.length>0?x:void 0,reasoning:S?S.map(_=>({type:"text",text:_.text})):void 0,usage:{promptTokens:m.usage.input_tokens,completionTokens:m.usage.output_tokens},rawCall:{rawPrompt:void 0,rawSettings:{}},rawResponse:{headers:f,body:y},request:{body:JSON.stringify(u)},response:{id:m.id,timestamp:new Date(m.created_at*1e3),modelId:m.model},providerMetadata:{openai:{responseId:m.id,cachedPromptTokens:(s=(o=m.usage.input_tokens_details)==null?void 0:o.cached_tokens)!=null?s:null,reasoningTokens:(l=(a=m.usage.output_tokens_details)==null?void 0:a.reasoning_tokens)!=null?l:null}},warnings:p}})}doStream(e){return A(this,null,function*(){let{args:t,warnings:r}=this.getArgs(e),{responseHeaders:n,value:o}=yield Qe({url:this.config.url({path:"/responses",modelId:this.modelId}),headers:Ze(this.config.headers(),e.headers),body:g(d({},t),{stream:true}),failedResponseHandler:Ft,successfulResponseHandler:Vr(Mf),abortSignal:e.abortSignal,fetch:this.config.fetch}),s=this,a="unknown",l=NaN,u=NaN,p=null,f=null,m=null,y={},v=false;return {stream:o.pipeThrough(new TransformStream({transform(x,S){var _,I,R,T,N,F,O,Y;if(!x.success){a="error",S.enqueue({type:"error",error:x.error});return}let P=x.value;if(qf(P))P.item.type==="function_call"&&(y[P.output_index]={toolName:P.item.name,toolCallId:P.item.call_id},S.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:P.item.call_id,toolName:P.item.name,argsTextDelta:P.item.arguments}));else if($f(P)){let q=y[P.output_index];q!=null&&S.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:q.toolCallId,toolName:q.toolName,argsTextDelta:P.delta});}else Uf(P)?(m=P.response.id,S.enqueue({type:"response-metadata",id:P.response.id,timestamp:new Date(P.response.created_at*1e3),modelId:P.response.model})):Nf(P)?S.enqueue({type:"text-delta",textDelta:P.delta}):zf(P)?S.enqueue({type:"reasoning",textDelta:P.delta}):Df(P)&&P.item.type==="function_call"?(y[P.output_index]=void 0,v=true,S.enqueue({type:"tool-call",toolCallType:"function",toolCallId:P.item.call_id,toolName:P.item.name,args:P.item.arguments})):Ff(P)?(a=zi({finishReason:(_=P.response.incomplete_details)==null?void 0:_.reason,hasToolCalls:v}),l=P.response.usage.input_tokens,u=P.response.usage.output_tokens,p=(R=(I=P.response.usage.input_tokens_details)==null?void 0:I.cached_tokens)!=null?R:p,f=(N=(T=P.response.usage.output_tokens_details)==null?void 0:T.reasoning_tokens)!=null?N:f):Bf(P)&&S.enqueue({type:"source",source:{sourceType:"url",id:(Y=(O=(F=s.config).generateId)==null?void 0:O.call(F))!=null?Y:ft(),url:P.annotation.url,title:P.annotation.title}});},flush(x){x.enqueue(d({type:"finish",finishReason:a,usage:{promptTokens:l,completionTokens:u}},(p!=null||f!=null)&&{providerMetadata:{openai:{responseId:m,cachedPromptTokens:p,reasoningTokens:f}}}));}})),rawCall:{rawPrompt:void 0,rawSettings:{}},rawResponse:{headers:n},request:{body:JSON.stringify(t)},warnings:r}})}},Vi=i.object({input_tokens:i.number(),input_tokens_details:i.object({cached_tokens:i.number().nullish()}).nullish(),output_tokens:i.number(),output_tokens_details:i.object({reasoning_tokens:i.number().nullish()}).nullish()}),kf=i.object({type:i.literal("response.output_text.delta"),delta:i.string()}),Af=i.object({type:i.enum(["response.completed","response.incomplete"]),response:i.object({incomplete_details:i.object({reason:i.string()}).nullish(),usage:Vi})}),Ef=i.object({type:i.literal("response.created"),response:i.object({id:i.string(),created_at:i.number(),model:i.string()})}),Cf=i.object({type:i.literal("response.output_item.done"),output_index:i.number(),item:i.discriminatedUnion("type",[i.object({type:i.literal("message")}),i.object({type:i.literal("function_call"),id:i.string(),call_id:i.string(),name:i.string(),arguments:i.string(),status:i.literal("completed")})])}),Rf=i.object({type:i.literal("response.function_call_arguments.delta"),item_id:i.string(),output_index:i.number(),delta:i.string()}),jf=i.object({type:i.literal("response.output_item.added"),output_index:i.number(),item:i.discriminatedUnion("type",[i.object({type:i.literal("message")}),i.object({type:i.literal("function_call"),id:i.string(),call_id:i.string(),name:i.string(),arguments:i.string()})])}),Of=i.object({type:i.literal("response.output_text.annotation.added"),annotation:i.object({type:i.literal("url_citation"),url:i.string(),title:i.string()})}),Pf=i.object({type:i.literal("response.reasoning_summary_text.delta"),item_id:i.string(),output_index:i.number(),summary_index:i.number(),delta:i.string()}),Mf=i.union([kf,Af,Ef,Cf,Rf,jf,Of,Pf,i.object({type:i.string()}).passthrough()]);function Nf(e){return e.type==="response.output_text.delta"}function Df(e){return e.type==="response.output_item.done"}function Ff(e){return e.type==="response.completed"||e.type==="response.incomplete"}function Uf(e){return e.type==="response.created"}function $f(e){return e.type==="response.function_call_arguments.delta"}function qf(e){return e.type==="response.output_item.added"}function Bf(e){return e.type==="response.output_text.annotation.added"}function zf(e){return e.type==="response.reasoning_summary_text.delta"}function Lf(e){return e.startsWith("o")?e.startsWith("o1-mini")||e.startsWith("o1-preview")?{isReasoningModel:true,systemMessageMode:"remove",requiredAutoTruncation:false}:{isReasoningModel:true,systemMessageMode:"developer",requiredAutoTruncation:false}:{isReasoningModel:false,systemMessageMode:"system",requiredAutoTruncation:false}}var Vf=i.object({metadata:i.any().nullish(),parallelToolCalls:i.boolean().nullish(),previousResponseId:i.string().nullish(),store:i.boolean().nullish(),user:i.string().nullish(),reasoningEffort:i.string().nullish(),strictSchemas:i.boolean().nullish(),instructions:i.string().nullish(),reasoningSummary:i.string().nullish()}),Jf=i.object({});function Zf({searchContextSize:e,userLocation:t}={}){return {type:"provider-defined",id:"openai.web_search_preview",args:{searchContextSize:e,userLocation:t},parameters:Jf}}var Gf={webSearchPreview:Zf},Hf=i.object({instructions:i.string().nullish(),speed:i.number().min(.25).max(4).default(1).nullish()}),Wf=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v1";}get provider(){return this.config.provider}getArgs({text:e,voice:t="alloy",outputFormat:r="mp3",speed:n,instructions:o,providerOptions:s}){let a=[],l=Lr({provider:"openai",providerOptions:s,schema:Hf}),u={model:this.modelId,input:e,voice:t,response_format:"mp3",speed:n,instructions:o};if(r&&(["mp3","opus","aac","flac","wav","pcm"].includes(r)?u.response_format=r:a.push({type:"unsupported-setting",setting:"outputFormat",details:`Unsupported output format: ${r}. Using mp3 instead.`})),l){let p={};for(let f in p){let m=p[f];m!==void 0&&(u[f]=m);}}return {requestBody:u,warnings:a}}doGenerate(e){return A(this,null,function*(){var t,r,n;let o=(n=(r=(t=this.config._internal)==null?void 0:t.currentDate)==null?void 0:r.call(t))!=null?n:new Date,{requestBody:s,warnings:a}=this.getArgs(e),{value:l,responseHeaders:u,rawValue:p}=yield Qe({url:this.config.url({path:"/audio/speech",modelId:this.modelId}),headers:Ze(this.config.headers(),e.headers),body:s,failedResponseHandler:Ft,successfulResponseHandler:Ti(),abortSignal:e.abortSignal,fetch:this.config.fetch});return {audio:l,warnings:a,request:{body:JSON.stringify(s)},response:{timestamp:o,modelId:this.modelId,headers:u,body:p}}})}};function Ps(e={}){var t,r,n;let o=(t=Ii(e.baseURL))!=null?t:"https://api.openai.com/v1",s=(r=e.compatibility)!=null?r:"compatible",a=(n=e.name)!=null?n:"openai",l=()=>d({Authorization:`Bearer ${_i({apiKey:e.apiKey,environmentVariableName:"OPENAI_API_KEY",description:"OpenAI"})}`,"OpenAI-Organization":e.organization,"OpenAI-Project":e.project},e.headers),u=(I,R={})=>new nf(I,R,{provider:`${a}.chat`,url:({path:T})=>`${o}${T}`,headers:l,compatibility:s,fetch:e.fetch}),p=(I,R={})=>new cf(I,R,{provider:`${a}.completion`,url:({path:T})=>`${o}${T}`,headers:l,compatibility:s,fetch:e.fetch}),f=(I,R={})=>new hf(I,R,{provider:`${a}.embedding`,url:({path:T})=>`${o}${T}`,headers:l,fetch:e.fetch}),m=(I,R={})=>new vf(I,R,{provider:`${a}.image`,url:({path:T})=>`${o}${T}`,headers:l,fetch:e.fetch}),y=I=>new wf(I,{provider:`${a}.transcription`,url:({path:R})=>`${o}${R}`,headers:l,fetch:e.fetch}),v=I=>new Wf(I,{provider:`${a}.speech`,url:({path:R})=>`${o}${R}`,headers:l,fetch:e.fetch}),x=(I,R)=>{if(new.target)throw new Error("The OpenAI model function cannot be called with the new keyword.");return I==="gpt-3.5-turbo-instruct"?p(I,R):u(I,R)},S=I=>new If(I,{provider:`${a}.responses`,url:({path:R})=>`${o}${R}`,headers:l,fetch:e.fetch}),_=function(I,R){return x(I,R)};return _.languageModel=x,_.chat=u,_.completion=p,_.responses=S,_.embedding=f,_.textEmbedding=f,_.textEmbeddingModel=f,_.image=m,_.imageModel=m,_.transcription=y,_.transcriptionModel=y,_.speech=v,_.speechModel=v,_.tools=Gf,_}Ps({compatibility:"strict"});var lr=class{static convert(t){return this.parseSchema(t)}static matchesCondition(t,r){if(!r.properties)return  true;if(typeof t!="object"||t===null||Array.isArray(t))return  false;let n=t;for(let[o,s]of Object.entries(r.properties)){if(!(o in n)){if("const"in s)return  false;continue}let a=n[o];if("const"in s&&a!==s.const||"minimum"in s&&typeof a=="number"&&a<s.minimum||"maximum"in s&&typeof a=="number"&&a>s.maximum)return  false}return  true}static validateConditionalSchema(t,r,n){this.validateRequiredProperties(t,r,n),this.validatePropertyPatterns(t,r,n),this.validateNestedConditions(t,r,n);}static validateRequiredProperties(t,r,n){if(r.required){if(typeof t!="object"||t===null){for(let o of r.required)n.addIssue({code:i.ZodIssueCode.custom,message:`Required property '${o}' is missing`,path:[o]});return}for(let o of r.required)o in t||n.addIssue({code:i.ZodIssueCode.custom,message:`Required property '${o}' is missing`,path:[o]});}}static validatePropertyPatterns(t,r,n){if(!r.properties||typeof t!="object"||t===null||Array.isArray(t))return;let o=t;for(let[s,a]of Object.entries(r.properties)){if(!(s in o))continue;let l=o[s];a.pattern&&typeof l=="string"&&(new RegExp(a.pattern).test(l)||n.addIssue({code:i.ZodIssueCode.custom,message:`String '${l}' does not match pattern '${a.pattern}'`,path:[s]}));}}static validateNestedConditions(t,r,n){if(!r.if||!r.then)return;this.matchesCondition(t,r.if)?this.validateConditionalSchema(t,r.then,n):r.else&&this.validateConditionalSchema(t,r.else,n);}static parseSchema(t){return Array.isArray(t.type)?this.handleTypeArray(t):t.oneOf||t.anyOf||t.allOf?this.parseCombinator(t):t.if&&t.then?this.parseObject(t):t.properties&&(!t.type||t.type==="object")?this.parseObject(t):this.handleSingleType(t)}static handleTypeArray(t){if(!Array.isArray(t.type))throw new Error("Expected schema.type to be an array");return t.type.includes("null")?this.handleNullableType(t):this.createUnionFromTypes(t.type,t)}static handleNullableType(t){if(!Array.isArray(t.type))throw new Error("Expected schema.type to be an array");let r=d({},t);return r.type=t.type.filter(o=>o!=="null"),r.type.length===1?this.handleSingleType(g(d({},t),{type:r.type[0]})).nullable():this.parseSchema(r).nullable()}static createUnionFromTypes(t,r){let n=t.map(o=>{let s=g(d({},r),{type:o});return this.parseSchema(s)});return i.union(n)}static handleSingleType(t){if(t.type===void 0)return t.oneOf||t.anyOf||t.allOf?this.parseCombinator(t):t.properties?this.parseObject(t):i.any();switch(t.type){case "string":return this.parseString(t);case "number":case "integer":return this.parseNumberSchema(t);case "boolean":return i.boolean();case "array":return this.parseArray(t);case "object":return this.parseObject(t);default:throw new Error("Unsupported schema type")}}static parseNumberSchema(t){let r=i.number(),n=r;return n=this.applyNumberBounds(r,t),n=this.applyNumberMultipleOf(r,t),n=this.applyNumberEnum(r,t),n=this.applyIntegerConstraint(r,t),n}static applyNumberBounds(t,r){let n=t;return r.minimum!==void 0&&(n=r.exclusiveMinimum?n.gt(r.minimum):n.gte(r.minimum)),r.maximum!==void 0&&(n=r.exclusiveMaximum?n.lt(r.maximum):n.lte(r.maximum)),n}static applyNumberMultipleOf(t,r){return r.multipleOf===void 0?t:t.refine(n=>n%r.multipleOf===0,{message:`Number must be a multiple of ${r.multipleOf}`})}static applyNumberEnum(t,r){if(!r.enum)return t;let n=r.enum.filter(o=>typeof o=="number");return n.length===0?t:t.refine(o=>n.includes(o),{message:`Number must be one of: ${n.join(", ")}`})}static applyIntegerConstraint(t,r){return r.type!=="integer"?t:t.refine(n=>Number.isInteger(n),{message:"Number must be an integer"})}static parseString(t){let r=i.string(),n=r;return t.format?this.applyStringFormat(r,t):(n=this.applyStringPattern(r,t),n=this.applyStringLength(r,t),n=this.applyStringEnum(r,t),n)}static applyStringFormat(t,r){if(!r.format)return t;switch(r.format){case "email":return t.email();case "date-time":return t.datetime();case "uri":return t.url();case "uuid":return t.uuid();case "date":return t.date();default:return t}}static applyStringPattern(t,r){if(!r.pattern)return t;let n=new RegExp(r.pattern);return t.regex(n,{message:`String must match pattern: ${r.pattern}`})}static applyStringLength(t,r){let n=t;return r.minLength!==void 0&&(t=t.min(r.minLength)),r.maxLength!==void 0&&(t=t.max(r.maxLength)),n}static applyStringEnum(t,r){var n;return r.enum?t.refine(o=>{var s;return (s=r.enum)==null?void 0:s.includes(o)},{message:`Value must be one of: ${(n=r.enum)==null?void 0:n.join(", ")}`}):t}static parseArray(t){if(Array.isArray(t.items)){let s=t.items.map(a=>this.parseSchema(a));return i.union(s)}let r=t.items?this.parseSchema(t.items):i.any(),n=i.array(r),o=n;return o=this.applyArrayConstraints(n,t),o}static applyArrayConstraints(t,r){return r.minItems!==void 0&&(t=t.min(r.minItems)),r.maxItems!==void 0&&(t=t.max(r.maxItems)),r.uniqueItems?t.refine(n=>new Set(n).size===n.length,{message:"Array items must be unique"}):t}static parseObject(t){if(t.if&&t.then)return this.parseConditional(t);let r={};return this.processObjectProperties(t,r),this.processAdditionalProperties(t,i.object(r))}static processObjectProperties(t,r){let n=new Set(t.required||[]);if(t.properties)for(let[o,s]of Object.entries(t.properties)){let a=this.parseSchema(s);r[o]=n.has(o)?a:a.optional();}}static processAdditionalProperties(t,r){if(t.additionalProperties===true)return r.passthrough();if(t.additionalProperties&&typeof t.additionalProperties=="object"){let n=this.parseSchema(t.additionalProperties);return r.catchall(n)}else return r.strict()}static parseConditional(t){let r=this.createBaseObjectSchema(t),n=t.if,o=t.then,s=t.else;return r.superRefine((a,l)=>{let u=this.applyDefaultValues(a,t);this.matchesCondition(u,n)?this.validateConditionalSchema(u,o,l):s&&this.validateConditionalSchema(u,s,l);})}static createBaseObjectSchema(t){let r={},n=new Set(t.required||[]);for(let[s,a]of Object.entries(t.properties||{})){let l=this.parseSchema(a);r[s]=n.has(s)?l:l.optional();}let o=i.object(r);return this.processAdditionalProperties(t,o)}static applyDefaultValues(t,r){if(typeof t!="object"||t===null||Array.isArray(t))return t;let o=d({},t);if(!r.properties)return o;for(let[s,a]of Object.entries(r.properties))!(s in o)&&"default"in a&&(o[s]=a.default);return o}static parseCombinator(t){if(t.oneOf)return this.parseOneOf(t.oneOf);if(t.anyOf)return this.parseAnyOf(t.anyOf);if(t.allOf)return this.parseAllOf(t.allOf);throw new Error("Unsupported schema type")}static parseOneOf(t){return this.createUnionFromSchemas(t)}static parseAnyOf(t){return this.createUnionFromSchemas(t)}static createUnionFromSchemas(t){if(t.length===0)return i.any();if(t.length===1)return this.parseSchema(t[0]);let r=[];for(let n of t)n.type==="null"?r.push(i.null()):r.push(this.parseSchema(n));return r.length>=2?i.union(r):r.length===1?r[0]:i.any()}static parseAllOf(t){if(t.length===0)return i.any();if(t.length===1)return this.parseSchema(t[0]);let r=t.reduce((n,o)=>this.mergeSchemas(n,o));return this.parseSchema(r)}static mergeSchemas(t,r){let n=d(d({},t),r);if(t.properties&&r.properties){let o=d(d({},t.properties),r.properties);n.properties=o;}if(t.required&&r.required){let o=[...new Set([...t.required,...r.required])];n.required=o;}return n}};var Zi=Symbol("Let zodToJsonSchema decide on which parser to use");var Ji={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:true,rejectedAdditionalProperties:false,definitionPath:"definitions",target:"jsonSchema7",strictUnions:false,definitions:{},errorMessages:false,markdownDescription:false,patternStrategy:"escape",applyRegexFlags:false,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},Gi=e=>typeof e=="string"?g(d({},Ji),{name:e}):d(d({},Ji),e);var Hi=e=>{let t=Gi(e),r=t.name!==void 0?[...t.basePath,t.definitionPath,t.name]:t.basePath;return g(d({},t),{currentPath:r,propertyPath:void 0,seen:new Map(Object.entries(t.definitions).map(([n,o])=>[o._def,{def:o._def,path:[...t.basePath,t.definitionPath,n],jsonSchema:void 0}]))})};function Ms(e,t,r,n){n!=null&&n.errorMessages&&r&&(e.errorMessage=g(d({},e.errorMessage),{[t]:r}));}function ie(e,t,r,n,o){e[t]=r,Ms(e,t,n,o);}function Wi(){return {}}function Ki(e,t){var n,o,s;let r={type:"array"};return (n=e.type)!=null&&n._def&&((s=(o=e.type)==null?void 0:o._def)==null?void 0:s.typeName)!==C.ZodAny&&(r.items=G(e.type._def,g(d({},t),{currentPath:[...t.currentPath,"items"]}))),e.minLength&&ie(r,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&ie(r,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&(ie(r,"minItems",e.exactLength.value,e.exactLength.message,t),ie(r,"maxItems",e.exactLength.value,e.exactLength.message,t)),r}function Yi(e,t){let r={type:"integer",format:"int64"};if(!e.checks)return r;for(let n of e.checks)switch(n.kind){case "min":t.target==="jsonSchema7"?n.inclusive?ie(r,"minimum",n.value,n.message,t):ie(r,"exclusiveMinimum",n.value,n.message,t):(n.inclusive||(r.exclusiveMinimum=true),ie(r,"minimum",n.value,n.message,t));break;case "max":t.target==="jsonSchema7"?n.inclusive?ie(r,"maximum",n.value,n.message,t):ie(r,"exclusiveMaximum",n.value,n.message,t):(n.inclusive||(r.exclusiveMaximum=true),ie(r,"maximum",n.value,n.message,t));break;case "multipleOf":ie(r,"multipleOf",n.value,n.message,t);break}return r}function Xi(){return {type:"boolean"}}function Mo(e,t){return G(e.type._def,t)}var Qi=(e,t)=>G(e.innerType._def,t);function Ns(e,t,r){let n=r!=null?r:t.dateStrategy;if(Array.isArray(n))return {anyOf:n.map((o,s)=>Ns(e,t,o))};switch(n){case "string":case "format:date-time":return {type:"string",format:"date-time"};case "format:date":return {type:"string",format:"date"};case "integer":return Kf(e,t)}}var Kf=(e,t)=>{let r={type:"integer",format:"unix-time"};if(t.target==="openApi3")return r;for(let n of e.checks)switch(n.kind){case "min":ie(r,"minimum",n.value,n.message,t);break;case "max":ie(r,"maximum",n.value,n.message,t);break}return r};function el(e,t){return g(d({},G(e.innerType._def,t)),{default:e.defaultValue()})}function tl(e,t){return t.effectStrategy==="input"?G(e.schema._def,t):{}}function rl(e){return {type:"string",enum:Array.from(e.values)}}var Yf=e=>"type"in e&&e.type==="string"?false:"allOf"in e;function nl(e,t){let r=[G(e.left._def,g(d({},t),{currentPath:[...t.currentPath,"allOf","0"]})),G(e.right._def,g(d({},t),{currentPath:[...t.currentPath,"allOf","1"]}))].filter(s=>!!s),n=t.target==="jsonSchema2019-09"?{unevaluatedProperties:false}:void 0,o=[];return r.forEach(s=>{if(Yf(s))o.push(...s.allOf),s.unevaluatedProperties===void 0&&(n=void 0);else {let l=s;if("additionalProperties"in s&&s.additionalProperties===false){let a=s,{additionalProperties:u}=a;l=qe(a,["additionalProperties"]);}else n=void 0;o.push(l);}}),o.length?d({allOf:o},n):void 0}function ol(e,t){let r=typeof e.value;return r!=="bigint"&&r!=="number"&&r!=="boolean"&&r!=="string"?{type:Array.isArray(e.value)?"array":"object"}:t.target==="openApi3"?{type:r==="bigint"?"integer":r,enum:[e.value]}:{type:r==="bigint"?"integer":r,const:e.value}}var Ds,Tt={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(Ds===void 0&&(Ds=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),Ds),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function No(e,t){let r={type:"string"};if(e.checks)for(let n of e.checks)switch(n.kind){case "min":ie(r,"minLength",typeof r.minLength=="number"?Math.max(r.minLength,n.value):n.value,n.message,t);break;case "max":ie(r,"maxLength",typeof r.maxLength=="number"?Math.min(r.maxLength,n.value):n.value,n.message,t);break;case "email":switch(t.emailStrategy){case "format:email":It(r,"email",n.message,t);break;case "format:idn-email":It(r,"idn-email",n.message,t);break;case "pattern:zod":tt(r,Tt.email,n.message,t);break}break;case "url":It(r,"uri",n.message,t);break;case "uuid":It(r,"uuid",n.message,t);break;case "regex":tt(r,n.regex,n.message,t);break;case "cuid":tt(r,Tt.cuid,n.message,t);break;case "cuid2":tt(r,Tt.cuid2,n.message,t);break;case "startsWith":tt(r,RegExp(`^${Fs(n.value,t)}`),n.message,t);break;case "endsWith":tt(r,RegExp(`${Fs(n.value,t)}$`),n.message,t);break;case "datetime":It(r,"date-time",n.message,t);break;case "date":It(r,"date",n.message,t);break;case "time":It(r,"time",n.message,t);break;case "duration":It(r,"duration",n.message,t);break;case "length":ie(r,"minLength",typeof r.minLength=="number"?Math.max(r.minLength,n.value):n.value,n.message,t),ie(r,"maxLength",typeof r.maxLength=="number"?Math.min(r.maxLength,n.value):n.value,n.message,t);break;case "includes":{tt(r,RegExp(Fs(n.value,t)),n.message,t);break}case "ip":{n.version!=="v6"&&It(r,"ipv4",n.message,t),n.version!=="v4"&&It(r,"ipv6",n.message,t);break}case "base64url":tt(r,Tt.base64url,n.message,t);break;case "jwt":tt(r,Tt.jwt,n.message,t);break;case "cidr":{n.version!=="v6"&&tt(r,Tt.ipv4Cidr,n.message,t),n.version!=="v4"&&tt(r,Tt.ipv6Cidr,n.message,t);break}case "emoji":tt(r,Tt.emoji(),n.message,t);break;case "ulid":{tt(r,Tt.ulid,n.message,t);break}case "base64":{switch(t.base64Strategy){case "format:binary":{It(r,"binary",n.message,t);break}case "contentEncoding:base64":{ie(r,"contentEncoding","base64",n.message,t);break}case "pattern:zod":{tt(r,Tt.base64,n.message,t);break}}break}case "nanoid":tt(r,Tt.nanoid,n.message,t);}return r}function Fs(e,t){return t.patternStrategy==="escape"?Qf(e):e}var Xf=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function Qf(e){let t="";for(let r=0;r<e.length;r++)Xf.has(e[r])||(t+="\\"),t+=e[r];return t}function It(e,t,r,n){var o;e.format||(o=e.anyOf)!=null&&o.some(s=>s.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push(d({format:e.format},e.errorMessage&&n.errorMessages&&{errorMessage:{format:e.errorMessage.format}})),delete e.format,e.errorMessage&&(delete e.errorMessage.format,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.anyOf.push(d({format:t},r&&n.errorMessages&&{errorMessage:{format:r}}))):ie(e,"format",t,r,n);}function tt(e,t,r,n){var o;e.pattern||(o=e.allOf)!=null&&o.some(s=>s.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push(d({pattern:e.pattern},e.errorMessage&&n.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}})),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.allOf.push(d({pattern:sl(t,n)},r&&n.errorMessages&&{errorMessage:{pattern:r}}))):ie(e,"pattern",sl(t,n),r,n);}function sl(e,t){var u;if(!t.applyRegexFlags||!e.flags)return e.source;let r={i:e.flags.includes("i"),m:e.flags.includes("m"),s:e.flags.includes("s")},n=r.i?e.source.toLowerCase():e.source,o="",s=false,a=false,l=false;for(let p=0;p<n.length;p++){if(s){o+=n[p],s=false;continue}if(r.i){if(a){if(n[p].match(/[a-z]/)){l?(o+=n[p],o+=`${n[p-2]}-${n[p]}`.toUpperCase(),l=false):n[p+1]==="-"&&((u=n[p+2])!=null&&u.match(/[a-z]/))?(o+=n[p],l=true):o+=`${n[p]}${n[p].toUpperCase()}`;continue}}else if(n[p].match(/[a-z]/)){o+=`[${n[p]}${n[p].toUpperCase()}]`;continue}}if(r.m){if(n[p]==="^"){o+=`(^|(?<=[\r
]))`;continue}else if(n[p]==="$"){o+=`($|(?=[\r
]))`;continue}}if(r.s&&n[p]==="."){o+=a?`${n[p]}\r
`:`[${n[p]}\r
]`;continue}o+=n[p],n[p]==="\\"?s=true:a&&n[p]==="]"?a=false:!a&&n[p]==="["&&(a=true);}try{new RegExp(o);}catch(p){return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),e.source}return o}function Do(e,t){var n,o,s,a,u,p,f;if(t.target==="openAi"&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),t.target==="openApi3"&&((n=e.keyType)==null?void 0:n._def.typeName)===C.ZodEnum)return {type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((y,v)=>{var x;return g(d({},y),{[v]:(x=G(e.valueType._def,g(d({},t),{currentPath:[...t.currentPath,"properties",v]})))!=null?x:{}})},{}),additionalProperties:t.rejectedAdditionalProperties};let r={type:"object",additionalProperties:(o=G(e.valueType._def,g(d({},t),{currentPath:[...t.currentPath,"additionalProperties"]})))!=null?o:t.allowedAdditionalProperties};if(t.target==="openApi3")return r;if(((s=e.keyType)==null?void 0:s._def.typeName)===C.ZodString&&((a=e.keyType._def.checks)!=null&&a.length)){let l=No(e.keyType._def,t),{type:y}=l,v=qe(l,["type"]);return g(d({},r),{propertyNames:v})}else {if(((u=e.keyType)==null?void 0:u._def.typeName)===C.ZodEnum)return g(d({},r),{propertyNames:{enum:e.keyType._def.values}});if(((p=e.keyType)==null?void 0:p._def.typeName)===C.ZodBranded&&e.keyType._def.type._def.typeName===C.ZodString&&((f=e.keyType._def.type._def.checks)!=null&&f.length)){let m=Mo(e.keyType._def,t),{type:y}=m,v=qe(m,["type"]);return g(d({},r),{propertyNames:v})}}return r}function al(e,t){if(t.mapStrategy==="record")return Do(e,t);let r=G(e.keyType._def,g(d({},t),{currentPath:[...t.currentPath,"items","items","0"]}))||{},n=G(e.valueType._def,g(d({},t),{currentPath:[...t.currentPath,"items","items","1"]}))||{};return {type:"array",maxItems:125,items:{type:"array",items:[r,n],minItems:2,maxItems:2}}}function il(e){let t=e.values,n=Object.keys(e.values).filter(s=>typeof t[t[s]]!="number").map(s=>t[s]),o=Array.from(new Set(n.map(s=>typeof s)));return {type:o.length===1?o[0]==="string"?"string":"number":["string","number"],enum:n}}function ll(){return {not:{}}}function ul(e){return e.target==="openApi3"?{enum:["null"],nullable:true}:{type:"null"}}var Pn={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function cl(e,t){if(t.target==="openApi3")return pl(e,t);let r=e.options instanceof Map?Array.from(e.options.values()):e.options;if(r.every(n=>n._def.typeName in Pn&&(!n._def.checks||!n._def.checks.length))){let n=r.reduce((o,s)=>{let a=Pn[s._def.typeName];return a&&!o.includes(a)?[...o,a]:o},[]);return {type:n.length>1?n:n[0]}}else if(r.every(n=>n._def.typeName==="ZodLiteral"&&!n.description)){let n=r.reduce((o,s)=>{let a=typeof s._def.value;switch(a){case "string":case "number":case "boolean":return [...o,a];case "bigint":return [...o,"integer"];case "object":if(s._def.value===null)return [...o,"null"];case "symbol":case "undefined":case "function":default:return o}},[]);if(n.length===r.length){let o=n.filter((s,a,l)=>l.indexOf(s)===a);return {type:o.length>1?o:o[0],enum:r.reduce((s,a)=>s.includes(a._def.value)?s:[...s,a._def.value],[])}}}else if(r.every(n=>n._def.typeName==="ZodEnum"))return {type:"string",enum:r.reduce((n,o)=>[...n,...o._def.values.filter(s=>!n.includes(s))],[])};return pl(e,t)}var pl=(e,t)=>{let r=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((n,o)=>G(n._def,g(d({},t),{currentPath:[...t.currentPath,"anyOf",`${o}`]}))).filter(n=>!!n&&(!t.strictUnions||typeof n=="object"&&Object.keys(n).length>0));return r.length?{anyOf:r}:void 0};function dl(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return t.target==="openApi3"?{type:Pn[e.innerType._def.typeName],nullable:true}:{type:[Pn[e.innerType._def.typeName],"null"]};if(t.target==="openApi3"){let n=G(e.innerType._def,g(d({},t),{currentPath:[...t.currentPath]}));return n&&"$ref"in n?{allOf:[n],nullable:true}:n&&g(d({},n),{nullable:true})}let r=G(e.innerType._def,g(d({},t),{currentPath:[...t.currentPath,"anyOf","0"]}));return r&&{anyOf:[r,{type:"null"}]}}function fl(e,t){let r={type:"number"};if(!e.checks)return r;for(let n of e.checks)switch(n.kind){case "int":r.type="integer",Ms(r,"type",n.message,t);break;case "min":t.target==="jsonSchema7"?n.inclusive?ie(r,"minimum",n.value,n.message,t):ie(r,"exclusiveMinimum",n.value,n.message,t):(n.inclusive||(r.exclusiveMinimum=true),ie(r,"minimum",n.value,n.message,t));break;case "max":t.target==="jsonSchema7"?n.inclusive?ie(r,"maximum",n.value,n.message,t):ie(r,"exclusiveMaximum",n.value,n.message,t):(n.inclusive||(r.exclusiveMaximum=true),ie(r,"maximum",n.value,n.message,t));break;case "multipleOf":ie(r,"multipleOf",n.value,n.message,t);break}return r}function hl(e,t){let r=t.target==="openAi",n={type:"object",properties:{}},o=[],s=e.shape();for(let l in s){let u=s[l];if(u===void 0||u._def===void 0)continue;let p=th(u);p&&r&&(u instanceof ot&&(u=u._def.innerType),u.isNullable()||(u=u.nullable()),p=false);let f=G(u._def,g(d({},t),{currentPath:[...t.currentPath,"properties",l],propertyPath:[...t.currentPath,"properties",l]}));f!==void 0&&(n.properties[l]=f,p||o.push(l));}o.length&&(n.required=o);let a=eh(e,t);return a!==void 0&&(n.additionalProperties=a),n}function eh(e,t){if(e.catchall._def.typeName!=="ZodNever")return G(e.catchall._def,g(d({},t),{currentPath:[...t.currentPath,"additionalProperties"]}));switch(e.unknownKeys){case "passthrough":return t.allowedAdditionalProperties;case "strict":return t.rejectedAdditionalProperties;case "strip":return t.removeAdditionalStrategy==="strict"?t.allowedAdditionalProperties:t.rejectedAdditionalProperties}}function th(e){try{return e.isOptional()}catch(t){return  true}}var ml=(e,t)=>{var n;if(t.currentPath.toString()===((n=t.propertyPath)==null?void 0:n.toString()))return G(e.innerType._def,t);let r=G(e.innerType._def,g(d({},t),{currentPath:[...t.currentPath,"anyOf","1"]}));return r?{anyOf:[{not:{}},r]}:{}};var gl=(e,t)=>{if(t.pipeStrategy==="input")return G(e.in._def,t);if(t.pipeStrategy==="output")return G(e.out._def,t);let r=G(e.in._def,g(d({},t),{currentPath:[...t.currentPath,"allOf","0"]})),n=G(e.out._def,g(d({},t),{currentPath:[...t.currentPath,"allOf",r?"1":"0"]}));return {allOf:[r,n].filter(o=>o!==void 0)}};function yl(e,t){return G(e.type._def,t)}function vl(e,t){let n={type:"array",uniqueItems:true,items:G(e.valueType._def,g(d({},t),{currentPath:[...t.currentPath,"items"]}))};return e.minSize&&ie(n,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&ie(n,"maxItems",e.maxSize.value,e.maxSize.message,t),n}function bl(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((r,n)=>G(r._def,g(d({},t),{currentPath:[...t.currentPath,"items",`${n}`]}))).reduce((r,n)=>n===void 0?r:[...r,n],[]),additionalItems:G(e.rest._def,g(d({},t),{currentPath:[...t.currentPath,"additionalItems"]}))}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((r,n)=>G(r._def,g(d({},t),{currentPath:[...t.currentPath,"items",`${n}`]}))).reduce((r,n)=>n===void 0?r:[...r,n],[])}}function _l(){return {not:{}}}function wl(){return {}}var xl=(e,t)=>G(e.innerType._def,t);var Sl=(e,t,r)=>{switch(t){case C.ZodString:return No(e,r);case C.ZodNumber:return fl(e,r);case C.ZodObject:return hl(e,r);case C.ZodBigInt:return Yi(e,r);case C.ZodBoolean:return Xi();case C.ZodDate:return Ns(e,r);case C.ZodUndefined:return _l();case C.ZodNull:return ul(r);case C.ZodArray:return Ki(e,r);case C.ZodUnion:case C.ZodDiscriminatedUnion:return cl(e,r);case C.ZodIntersection:return nl(e,r);case C.ZodTuple:return bl(e,r);case C.ZodRecord:return Do(e,r);case C.ZodLiteral:return ol(e,r);case C.ZodEnum:return rl(e);case C.ZodNativeEnum:return il(e);case C.ZodNullable:return dl(e,r);case C.ZodOptional:return ml(e,r);case C.ZodMap:return al(e,r);case C.ZodSet:return vl(e,r);case C.ZodLazy:return ()=>e.getter()._def;case C.ZodPromise:return yl(e,r);case C.ZodNaN:case C.ZodNever:return ll();case C.ZodEffects:return tl(e,r);case C.ZodAny:return Wi();case C.ZodUnknown:return wl();case C.ZodDefault:return el(e,r);case C.ZodBranded:return Mo(e,r);case C.ZodReadonly:return xl(e,r);case C.ZodCatch:return Qi(e,r);case C.ZodPipeline:return gl(e,r);case C.ZodFunction:case C.ZodVoid:case C.ZodSymbol:return;default:return (n=>{})()}};function G(e,t,r=false){var l;let n=t.seen.get(e);if(t.override){let u=(l=t.override)==null?void 0:l.call(t,e,t,n,r);if(u!==Zi)return u}if(n&&!r){let u=rh(n,t);if(u!==void 0)return u}let o={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,o);let s=Sl(e,e.typeName,t),a=typeof s=="function"?G(s(),t):s;if(a&&oh(e,t,a),t.postProcess){let u=t.postProcess(a,e,t);return o.jsonSchema=a,u}return o.jsonSchema=a,a}var rh=(e,t)=>{switch(t.$refStrategy){case "root":return {$ref:e.path.join("/")};case "relative":return {$ref:nh(t.currentPath,e.path)};case "none":case "seen":return e.path.length<t.currentPath.length&&e.path.every((r,n)=>t.currentPath[n]===r)?(console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{}):t.$refStrategy==="seen"?{}:void 0}},nh=(e,t)=>{let r=0;for(;r<e.length&&r<t.length&&e[r]===t[r];r++);return [(e.length-r).toString(),...t.slice(r)].join("/")},oh=(e,t,r)=>(e.description&&(r.description=e.description,t.markdownDescription&&(r.markdownDescription=e.description)),r);var Tl=(e,t)=>{var u;let r=Hi(t),n=typeof t=="object"&&t.definitions?Object.entries(t.definitions).reduce((p,[f,m])=>{var y;return g(d({},p),{[f]:(y=G(m._def,g(d({},r),{currentPath:[...r.basePath,r.definitionPath,f]}),true))!=null?y:{}})},{}):void 0,o=typeof t=="string"?t:(t==null?void 0:t.nameStrategy)==="title"||t==null?void 0:t.name,s=(u=G(e._def,o===void 0?r:g(d({},r),{currentPath:[...r.basePath,r.definitionPath,o]}),false))!=null?u:{},a=typeof t=="object"&&t.name!==void 0&&t.nameStrategy==="title"?t.name:void 0;a!==void 0&&(s.title=a);let l=o===void 0?n?g(d({},s),{[r.definitionPath]:n}):s:{$ref:[...r.$refStrategy==="relative"?[]:r.basePath,r.definitionPath,o].join("/"),[r.definitionPath]:g(d({},n),{[o]:s})};return r.target==="jsonSchema7"?l.$schema="http://json-schema.org/draft-07/schema#":(r.target==="jsonSchema2019-09"||r.target==="openAi")&&(l.$schema="https://json-schema.org/draft/2019-09/schema#"),r.target==="openAi"&&("anyOf"in l||"oneOf"in l||"allOf"in l||"type"in l&&Array.isArray(l.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),l};var Il=Tl;var Mn={code:"0",name:"text",parse:e=>{if(typeof e!="string")throw new Error('"text" parts expect a string value.');return {type:"text",value:e}}},Nn={code:"3",name:"error",parse:e=>{if(typeof e!="string")throw new Error('"error" parts expect a string value.');return {type:"error",value:e}}},Dn={code:"4",name:"assistant_message",parse:e=>{if(e==null||typeof e!="object"||!("id"in e)||!("role"in e)||!("content"in e)||typeof e.id!="string"||typeof e.role!="string"||e.role!=="assistant"||!Array.isArray(e.content)||!e.content.every(t=>t!=null&&typeof t=="object"&&"type"in t&&t.type==="text"&&"text"in t&&t.text!=null&&typeof t.text=="object"&&"value"in t.text&&typeof t.text.value=="string"))throw new Error('"assistant_message" parts expect an object with an "id", "role", and "content" property.');return {type:"assistant_message",value:e}}},Fn={code:"5",name:"assistant_control_data",parse:e=>{if(e==null||typeof e!="object"||!("threadId"in e)||!("messageId"in e)||typeof e.threadId!="string"||typeof e.messageId!="string")throw new Error('"assistant_control_data" parts expect an object with a "threadId" and "messageId" property.');return {type:"assistant_control_data",value:{threadId:e.threadId,messageId:e.messageId}}}},Un={code:"6",name:"data_message",parse:e=>{if(e==null||typeof e!="object"||!("role"in e)||!("data"in e)||typeof e.role!="string"||e.role!=="data")throw new Error('"data_message" parts expect an object with a "role" and "data" property.');return {type:"data_message",value:e}}},sh=[Mn,Nn,Dn,Fn,Un];({[Mn.code]:Mn,[Nn.code]:Nn,[Dn.code]:Dn,[Fn.code]:Fn,[Un.code]:Un});({[Mn.name]:Mn.code,[Nn.name]:Nn.code,[Dn.name]:Dn.code,[Fn.name]:Fn.code,[Un.name]:Un.code});sh.map(e=>e.code);function ah(e){let t=["ROOT"],r=-1,n=null;function o(u,p,f){switch(u){case '"':{r=p,t.pop(),t.push(f),t.push("INSIDE_STRING");break}case "f":case "t":case "n":{r=p,n=p,t.pop(),t.push(f),t.push("INSIDE_LITERAL");break}case "-":{t.pop(),t.push(f),t.push("INSIDE_NUMBER");break}case "0":case "1":case "2":case "3":case "4":case "5":case "6":case "7":case "8":case "9":{r=p,t.pop(),t.push(f),t.push("INSIDE_NUMBER");break}case "{":{r=p,t.pop(),t.push(f),t.push("INSIDE_OBJECT_START");break}case "[":{r=p,t.pop(),t.push(f),t.push("INSIDE_ARRAY_START");break}}}function s(u,p){switch(u){case ",":{t.pop(),t.push("INSIDE_OBJECT_AFTER_COMMA");break}case "}":{r=p,t.pop();break}}}function a(u,p){switch(u){case ",":{t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break}case "]":{r=p,t.pop();break}}}for(let u=0;u<e.length;u++){let p=e[u];switch(t[t.length-1]){case "ROOT":o(p,u,"FINISH");break;case "INSIDE_OBJECT_START":{switch(p){case '"':{t.pop(),t.push("INSIDE_OBJECT_KEY");break}case "}":{r=u,t.pop();break}}break}case "INSIDE_OBJECT_AFTER_COMMA":{switch(p){case '"':{t.pop(),t.push("INSIDE_OBJECT_KEY");break}}break}case "INSIDE_OBJECT_KEY":{switch(p){case '"':{t.pop(),t.push("INSIDE_OBJECT_AFTER_KEY");break}}break}case "INSIDE_OBJECT_AFTER_KEY":{switch(p){case ":":{t.pop(),t.push("INSIDE_OBJECT_BEFORE_VALUE");break}}break}case "INSIDE_OBJECT_BEFORE_VALUE":{o(p,u,"INSIDE_OBJECT_AFTER_VALUE");break}case "INSIDE_OBJECT_AFTER_VALUE":{s(p,u);break}case "INSIDE_STRING":{switch(p){case '"':{t.pop(),r=u;break}case "\\":{t.push("INSIDE_STRING_ESCAPE");break}default:r=u;}break}case "INSIDE_ARRAY_START":{switch(p){case "]":{r=u,t.pop();break}default:{r=u,o(p,u,"INSIDE_ARRAY_AFTER_VALUE");break}}break}case "INSIDE_ARRAY_AFTER_VALUE":{switch(p){case ",":{t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break}case "]":{r=u,t.pop();break}default:{r=u;break}}break}case "INSIDE_ARRAY_AFTER_COMMA":{o(p,u,"INSIDE_ARRAY_AFTER_VALUE");break}case "INSIDE_STRING_ESCAPE":{t.pop(),r=u;break}case "INSIDE_NUMBER":{switch(p){case "0":case "1":case "2":case "3":case "4":case "5":case "6":case "7":case "8":case "9":{r=u;break}case "e":case "E":case "-":case ".":break;case ",":{t.pop(),t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&a(p,u),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"&&s(p,u);break}case "}":{t.pop(),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"&&s(p,u);break}case "]":{t.pop(),t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&a(p,u);break}default:{t.pop();break}}break}case "INSIDE_LITERAL":{let m=e.substring(n,u+1);!"false".startsWith(m)&&!"true".startsWith(m)&&!"null".startsWith(m)?(t.pop(),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"?s(p,u):t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&a(p,u)):r=u;break}}}let l=e.slice(0,r+1);for(let u=t.length-1;u>=0;u--)switch(t[u]){case "INSIDE_STRING":{l+='"';break}case "INSIDE_OBJECT_KEY":case "INSIDE_OBJECT_AFTER_KEY":case "INSIDE_OBJECT_AFTER_COMMA":case "INSIDE_OBJECT_START":case "INSIDE_OBJECT_BEFORE_VALUE":case "INSIDE_OBJECT_AFTER_VALUE":{l+="}";break}case "INSIDE_ARRAY_START":case "INSIDE_ARRAY_AFTER_COMMA":case "INSIDE_ARRAY_AFTER_VALUE":{l+="]";break}case "INSIDE_LITERAL":{let f=e.substring(n,e.length);"true".startsWith(f)?l+="true".slice(f.length):"false".startsWith(f)?l+="false".slice(f.length):"null".startsWith(f)&&(l+="null".slice(f.length));}}return l}function Fo(e){if(e===void 0)return {value:void 0,state:"undefined-input"};let t=xt({text:e});return t.success?{value:t.value,state:"successful-parse"}:(t=xt({text:ah(e)}),t.success?{value:t.value,state:"repaired-parse"}:{value:void 0,state:"failed-parse"})}var ih={code:"0",name:"text",parse:e=>{if(typeof e!="string")throw new Error('"text" parts expect a string value.');return {type:"text",value:e}}},lh={code:"2",name:"data",parse:e=>{if(!Array.isArray(e))throw new Error('"data" parts expect an array value.');return {type:"data",value:e}}},uh={code:"3",name:"error",parse:e=>{if(typeof e!="string")throw new Error('"error" parts expect a string value.');return {type:"error",value:e}}},ph={code:"8",name:"message_annotations",parse:e=>{if(!Array.isArray(e))throw new Error('"message_annotations" parts expect an array value.');return {type:"message_annotations",value:e}}},ch={code:"9",name:"tool_call",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("toolName"in e)||typeof e.toolName!="string"||!("args"in e)||typeof e.args!="object")throw new Error('"tool_call" parts expect an object with a "toolCallId", "toolName", and "args" property.');return {type:"tool_call",value:e}}},dh={code:"a",name:"tool_result",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("result"in e))throw new Error('"tool_result" parts expect an object with a "toolCallId" and a "result" property.');return {type:"tool_result",value:e}}},fh={code:"b",name:"tool_call_streaming_start",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("toolName"in e)||typeof e.toolName!="string")throw new Error('"tool_call_streaming_start" parts expect an object with a "toolCallId" and "toolName" property.');return {type:"tool_call_streaming_start",value:e}}},hh={code:"c",name:"tool_call_delta",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("argsTextDelta"in e)||typeof e.argsTextDelta!="string")throw new Error('"tool_call_delta" parts expect an object with a "toolCallId" and "argsTextDelta" property.');return {type:"tool_call_delta",value:e}}},mh={code:"d",name:"finish_message",parse:e=>{if(e==null||typeof e!="object"||!("finishReason"in e)||typeof e.finishReason!="string")throw new Error('"finish_message" parts expect an object with a "finishReason" property.');let t={finishReason:e.finishReason};return "usage"in e&&e.usage!=null&&typeof e.usage=="object"&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:typeof e.usage.promptTokens=="number"?e.usage.promptTokens:Number.NaN,completionTokens:typeof e.usage.completionTokens=="number"?e.usage.completionTokens:Number.NaN}),{type:"finish_message",value:t}}},gh={code:"e",name:"finish_step",parse:e=>{if(e==null||typeof e!="object"||!("finishReason"in e)||typeof e.finishReason!="string")throw new Error('"finish_step" parts expect an object with a "finishReason" property.');let t={finishReason:e.finishReason,isContinued:false};return "usage"in e&&e.usage!=null&&typeof e.usage=="object"&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:typeof e.usage.promptTokens=="number"?e.usage.promptTokens:Number.NaN,completionTokens:typeof e.usage.completionTokens=="number"?e.usage.completionTokens:Number.NaN}),"isContinued"in e&&typeof e.isContinued=="boolean"&&(t.isContinued=e.isContinued),{type:"finish_step",value:t}}},yh={code:"f",name:"start_step",parse:e=>{if(e==null||typeof e!="object"||!("messageId"in e)||typeof e.messageId!="string")throw new Error('"start_step" parts expect an object with an "id" property.');return {type:"start_step",value:{messageId:e.messageId}}}},vh={code:"g",name:"reasoning",parse:e=>{if(typeof e!="string")throw new Error('"reasoning" parts expect a string value.');return {type:"reasoning",value:e}}},bh={code:"h",name:"source",parse:e=>{if(e==null||typeof e!="object")throw new Error('"source" parts expect a Source object.');return {type:"source",value:e}}},_h={code:"i",name:"redacted_reasoning",parse:e=>{if(e==null||typeof e!="object"||!("data"in e)||typeof e.data!="string")throw new Error('"redacted_reasoning" parts expect an object with a "data" property.');return {type:"redacted_reasoning",value:{data:e.data}}}},wh={code:"j",name:"reasoning_signature",parse:e=>{if(e==null||typeof e!="object"||!("signature"in e)||typeof e.signature!="string")throw new Error('"reasoning_signature" parts expect an object with a "signature" property.');return {type:"reasoning_signature",value:{signature:e.signature}}}},xh={code:"k",name:"file",parse:e=>{if(e==null||typeof e!="object"||!("data"in e)||typeof e.data!="string"||!("mimeType"in e)||typeof e.mimeType!="string")throw new Error('"file" parts expect an object with a "data" and "mimeType" property.');return {type:"file",value:e}}},Uo=[ih,lh,uh,ph,ch,dh,fh,hh,mh,gh,yh,vh,bh,_h,wh,xh];Object.fromEntries(Uo.map(e=>[e.code,e]));Object.fromEntries(Uo.map(e=>[e.name,e.code]));Uo.map(e=>e.code);function ze(e,t){let r=Uo.find(n=>n.name===e);if(!r)throw new Error(`Invalid stream part type: ${e}`);return `${r.code}:${JSON.stringify(t)}
`}function $n(e,t){if(e===t)return  true;if(e==null||t==null)return  false;if(typeof e!="object"&&typeof t!="object")return e===t;if(e.constructor!==t.constructor)return  false;if(e instanceof Date&&t instanceof Date)return e.getTime()===t.getTime();if(Array.isArray(e)){if(e.length!==t.length)return  false;for(let o=0;o<e.length;o++)if(!$n(e[o],t[o]))return  false;return  true}let r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return  false;for(let o of r)if(!n.includes(o)||!$n(e[o],t[o]))return  false;return  true}function Sh(e,t){var r;let n=(r=void 0)!=null?r:false;return Th(Il(e,{$refStrategy:n?"root":"none",target:"jsonSchema7"}),{validate:o=>{let s=e.safeParse(o);return s.success?{success:true,value:s.data}:{success:false,error:s.error}}})}var Us=Symbol.for("vercel.ai.schema");function Th(e,{validate:t}={}){return {[Us]:true,_type:void 0,[kn]:true,jsonSchema:e,validate:t}}function Ih(e){return typeof e=="object"&&e!==null&&Us in e&&e[Us]===true&&"jsonSchema"in e&&"validate"in e}function Ut(e){return Ih(e)?e:Sh(e)}var kl=typeof globalThis=="object"?globalThis:typeof self=="object"?self:typeof window=="object"?window:typeof global=="object"?global:{};var Ht="1.9.0";var Al=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/;function kh(e){var t=new Set([e]),r=new Set,n=e.match(Al);if(!n)return function(){return  false};var o={major:+n[1],minor:+n[2],patch:+n[3],prerelease:n[4]};if(o.prerelease!=null)return function(u){return u===e};function s(l){return r.add(l),false}function a(l){return t.add(l),true}return function(u){if(t.has(u))return  true;if(r.has(u))return  false;var p=u.match(Al);if(!p)return s(u);var f={major:+p[1],minor:+p[2],patch:+p[3],prerelease:p[4]};return f.prerelease!=null||o.major!==f.major?s(u):o.major===0?o.minor===f.minor&&o.patch<=f.patch?a(u):s(u):o.minor<=f.minor?a(u):s(u)}}var El=kh(Ht);var Ah=Ht.split(".")[0],qn=Symbol.for("opentelemetry.js.api."+Ah),Bn=kl;function Qr(e,t,r,n){var o;n===void 0&&(n=false);var s=Bn[qn]=(o=Bn[qn])!==null&&o!==void 0?o:{version:Ht};if(!n&&s[e]){var a=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+e);return r.error(a.stack||a.message),false}if(s.version!==Ht){var a=new Error("@opentelemetry/api: Registration of version v"+s.version+" for "+e+" does not match previously registered API v"+Ht);return r.error(a.stack||a.message),false}return s[e]=t,r.debug("@opentelemetry/api: Registered a global for "+e+" v"+Ht+"."),true}function Wt(e){var t,r,n=(t=Bn[qn])===null||t===void 0?void 0:t.version;if(!(!n||!El(n)))return (r=Bn[qn])===null||r===void 0?void 0:r[e]}function en(e,t){t.debug("@opentelemetry/api: Unregistering a global for "+e+" v"+Ht+".");var r=Bn[qn];r&&delete r[e];}var Eh=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,s=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)s.push(o.value);}catch(l){a={error:l};}finally{try{o&&!o.done&&(r=n.return)&&r.call(n);}finally{if(a)throw a.error}}return s},Ch=function(e,t,r){if(arguments.length===2)for(var n=0,o=t.length,s;n<o;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))},Cl=function(){function e(t){this._namespace=t.namespace||"DiagComponentLogger";}return e.prototype.debug=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return zn("debug",this._namespace,t)},e.prototype.error=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return zn("error",this._namespace,t)},e.prototype.info=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return zn("info",this._namespace,t)},e.prototype.warn=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return zn("warn",this._namespace,t)},e.prototype.verbose=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return zn("verbose",this._namespace,t)},e}();function zn(e,t,r){var n=Wt("diag");if(n)return r.unshift(t),n[e].apply(n,Ch([],Eh(r),false))}var rt;(function(e){e[e.NONE=0]="NONE",e[e.ERROR=30]="ERROR",e[e.WARN=50]="WARN",e[e.INFO=60]="INFO",e[e.DEBUG=70]="DEBUG",e[e.VERBOSE=80]="VERBOSE",e[e.ALL=9999]="ALL";})(rt||(rt={}));function Rl(e,t){e<rt.NONE?e=rt.NONE:e>rt.ALL&&(e=rt.ALL),t=t||{};function r(n,o){var s=t[n];return typeof s=="function"&&e>=o?s.bind(t):function(){}}return {error:r("error",rt.ERROR),warn:r("warn",rt.WARN),info:r("info",rt.INFO),debug:r("debug",rt.DEBUG),verbose:r("verbose",rt.VERBOSE)}}var Rh=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,s=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)s.push(o.value);}catch(l){a={error:l};}finally{try{o&&!o.done&&(r=n.return)&&r.call(n);}finally{if(a)throw a.error}}return s},jh=function(e,t,r){if(arguments.length===2)for(var n=0,o=t.length,s;n<o;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))},Oh="diag",tn=function(){function e(){function t(o){return function(){for(var s=[],a=0;a<arguments.length;a++)s[a]=arguments[a];var l=Wt("diag");if(l)return l[o].apply(l,jh([],Rh(s),false))}}var r=this,n=function(o,s){var a,l,u;if(s===void 0&&(s={logLevel:rt.INFO}),o===r){var p=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return r.error((a=p.stack)!==null&&a!==void 0?a:p.message),false}typeof s=="number"&&(s={logLevel:s});var f=Wt("diag"),m=Rl((l=s.logLevel)!==null&&l!==void 0?l:rt.INFO,o);if(f&&!s.suppressOverrideMessage){var y=(u=new Error().stack)!==null&&u!==void 0?u:"<failed to generate stacktrace>";f.warn("Current logger will be overwritten from "+y),m.warn("Current logger will overwrite one already registered from "+y);}return Qr("diag",m,r,true)};r.setLogger=n,r.disable=function(){en(Oh,r);},r.createComponentLogger=function(o){return new Cl(o)},r.verbose=t("verbose"),r.debug=t("debug"),r.info=t("info"),r.warn=t("warn"),r.error=t("error");}return e.instance=function(){return this._instance||(this._instance=new e),this._instance},e}();function jl(e){return Symbol.for(e)}var Ph=function(){function e(t){var r=this;r._currentContext=t?new Map(t):new Map,r.getValue=function(n){return r._currentContext.get(n)},r.setValue=function(n,o){var s=new e(r._currentContext);return s._currentContext.set(n,o),s},r.deleteValue=function(n){var o=new e(r._currentContext);return o._currentContext.delete(n),o};}return e}(),Ol=new Ph;var Mh=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,s=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)s.push(o.value);}catch(l){a={error:l};}finally{try{o&&!o.done&&(r=n.return)&&r.call(n);}finally{if(a)throw a.error}}return s},Nh=function(e,t,r){if(arguments.length===2)for(var n=0,o=t.length,s;n<o;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))},Pl=function(){function e(){}return e.prototype.active=function(){return Ol},e.prototype.with=function(t,r,n){for(var o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return r.call.apply(r,Nh([n],Mh(o),false))},e.prototype.bind=function(t,r){return r},e.prototype.enable=function(){return this},e.prototype.disable=function(){return this},e}();var Dh=function(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,s=[],a;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)s.push(o.value);}catch(l){a={error:l};}finally{try{o&&!o.done&&(r=n.return)&&r.call(n);}finally{if(a)throw a.error}}return s},Fh=function(e,t,r){if(arguments.length===2)for(var n=0,o=t.length,s;n<o;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))},$s="context",Uh=new Pl,$o=function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalContextManager=function(t){return Qr($s,t,tn.instance())},e.prototype.active=function(){return this._getContextManager().active()},e.prototype.with=function(t,r,n){for(var o,s=[],a=3;a<arguments.length;a++)s[a-3]=arguments[a];return (o=this._getContextManager()).with.apply(o,Fh([t,r,n],Dh(s),false))},e.prototype.bind=function(t,r){return this._getContextManager().bind(t,r)},e.prototype._getContextManager=function(){return Wt($s)||Uh},e.prototype.disable=function(){this._getContextManager().disable(),en($s,tn.instance());},e}();var qo;(function(e){e[e.NONE=0]="NONE",e[e.SAMPLED=1]="SAMPLED";})(qo||(qo={}));var qs="0000000000000000",Bs="00000000000000000000000000000000",Ml={traceId:Bs,spanId:qs,traceFlags:qo.NONE};var ur=function(){function e(t){t===void 0&&(t=Ml),this._spanContext=t;}return e.prototype.spanContext=function(){return this._spanContext},e.prototype.setAttribute=function(t,r){return this},e.prototype.setAttributes=function(t){return this},e.prototype.addEvent=function(t,r){return this},e.prototype.addLink=function(t){return this},e.prototype.addLinks=function(t){return this},e.prototype.setStatus=function(t){return this},e.prototype.updateName=function(t){return this},e.prototype.end=function(t){},e.prototype.isRecording=function(){return  false},e.prototype.recordException=function(t,r){},e}();var zs=jl("OpenTelemetry Context Key SPAN");function Bo(e){return e.getValue(zs)||void 0}function Nl(){return Bo($o.getInstance().active())}function Ln(e,t){return e.setValue(zs,t)}function Dl(e){return e.deleteValue(zs)}function Fl(e,t){return Ln(e,new ur(t))}function zo(e){var t;return (t=Bo(e))===null||t===void 0?void 0:t.spanContext()}var $h=/^([0-9a-f]{32})$/i,qh=/^[0-9a-f]{16}$/i;function Bh(e){return $h.test(e)&&e!==Bs}function zh(e){return qh.test(e)&&e!==qs}function Lo(e){return Bh(e.traceId)&&zh(e.spanId)}function Ul(e){return new ur(e)}var Ls=$o.getInstance(),Vo=function(){function e(){}return e.prototype.startSpan=function(t,r,n){n===void 0&&(n=Ls.active());var o=!!(r!=null&&r.root);if(o)return new ur;var s=n&&zo(n);return Lh(s)&&Lo(s)?new ur(s):new ur},e.prototype.startActiveSpan=function(t,r,n,o){var s,a,l;if(!(arguments.length<2)){arguments.length===2?l=r:arguments.length===3?(s=r,l=n):(s=r,a=n,l=o);var u=a!=null?a:Ls.active(),p=this.startSpan(t,s,u),f=Ln(u,p);return Ls.with(f,l,void 0,p)}},e}();function Lh(e){return typeof e=="object"&&typeof e.spanId=="string"&&typeof e.traceId=="string"&&typeof e.traceFlags=="number"}var Vh=new Vo,$l=function(){function e(t,r,n,o){this._provider=t,this.name=r,this.version=n,this.options=o;}return e.prototype.startSpan=function(t,r,n){return this._getTracer().startSpan(t,r,n)},e.prototype.startActiveSpan=function(t,r,n,o){var s=this._getTracer();return Reflect.apply(s.startActiveSpan,s,arguments)},e.prototype._getTracer=function(){if(this._delegate)return this._delegate;var t=this._provider.getDelegateTracer(this.name,this.version,this.options);return t?(this._delegate=t,this._delegate):Vh},e}();var ql=function(){function e(){}return e.prototype.getTracer=function(t,r,n){return new Vo},e}();var Jh=new ql,Vs=function(){function e(){}return e.prototype.getTracer=function(t,r,n){var o;return (o=this.getDelegateTracer(t,r,n))!==null&&o!==void 0?o:new $l(this,t,r,n)},e.prototype.getDelegate=function(){var t;return (t=this._delegate)!==null&&t!==void 0?t:Jh},e.prototype.setDelegate=function(t){this._delegate=t;},e.prototype.getDelegateTracer=function(t,r,n){var o;return (o=this._delegate)===null||o===void 0?void 0:o.getTracer(t,r,n)},e}();var rn;(function(e){e[e.UNSET=0]="UNSET",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR";})(rn||(rn={}));var Js="trace",Bl=function(){function e(){this._proxyTracerProvider=new Vs,this.wrapSpanContext=Ul,this.isSpanContextValid=Lo,this.deleteSpan=Dl,this.getSpan=Bo,this.getActiveSpan=Nl,this.getSpanContext=zo,this.setSpan=Ln,this.setSpanContext=Fl;}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalTracerProvider=function(t){var r=Qr(Js,this._proxyTracerProvider,tn.instance());return r&&this._proxyTracerProvider.setDelegate(t),r},e.prototype.getTracerProvider=function(){return Wt(Js)||this._proxyTracerProvider},e.prototype.getTracer=function(t,r){return this.getTracerProvider().getTracer(t,r)},e.prototype.disable=function(){en(Js,tn.instance()),this._proxyTracerProvider=new Vs;},e}();var Zs=Bl.getInstance();var Zh=Object.defineProperty,ra=(e,t)=>{for(var r in t)Zh(e,r,{get:t[r],enumerable:true});};function nn(e,{contentType:t,dataStreamVersion:r}){let n=new Headers(e!=null?e:{});return n.has("Content-Type")||n.set("Content-Type",t),r!==void 0&&n.set("X-Vercel-AI-Data-Stream",r),n}function Ks(e,{contentType:t,dataStreamVersion:r}){let n={};if(e!=null)for(let[o,s]of Object.entries(e))n[o]=s;return n["Content-Type"]==null&&(n["Content-Type"]=t),r!==void 0&&(n["X-Vercel-AI-Data-Stream"]=r),n}function Ys({response:e,status:t,statusText:r,headers:n,stream:o}){e.writeHead(t!=null?t:200,r,n);let s=o.getReader();A(null,null,function*(){try{for(;;){let{done:l,value:u}=yield s.read();if(l)break;e.write(u);}}catch(l){throw l}finally{e.end();}});}var Wl="AI_InvalidArgumentError",Kl=`vercel.ai.error.${Wl}`,Gh=Symbol.for(Kl),Yl,_e=class extends B{constructor({parameter:e,value:t,message:r}){super({name:Wl,message:`Invalid argument for parameter ${e}: ${r}`}),this[Yl]=true,this.parameter=e,this.value=t;}static isInstance(e){return B.hasMarker(e,Kl)}};Yl=Gh;var Xl="AI_RetryError",Ql=`vercel.ai.error.${Xl}`,Hh=Symbol.for(Ql),eu,zl=class extends B{constructor({message:e,reason:t,errors:r}){super({name:Xl,message:e}),this[eu]=true,this.reason=t,this.errors=r,this.lastError=r[r.length-1];}static isInstance(e){return B.hasMarker(e,Ql)}};eu=Hh;var Wh=({maxRetries:e=2,initialDelayInMs:t=2e3,backoffFactor:r=2}={})=>n=>A(null,null,function*(){return tu(n,{maxRetries:e,delayInMs:t,backoffFactor:r})});function tu(s,a){return A(this,arguments,function*(e,{maxRetries:t,delayInMs:r,backoffFactor:n},o=[]){try{return yield e()}catch(l){if(In(l)||t===0)throw l;let u=bi(l),p=[...o,l],f=p.length;if(f>t)throw new zl({message:`Failed after ${f} attempts. Last error: ${u}`,reason:"maxRetriesExceeded",errors:p});if(l instanceof Error&&Se.isInstance(l)&&l.isRetryable===true&&f<=t)return yield vi(r),tu(e,{maxRetries:t,delayInMs:n*r,backoffFactor:n},p);throw f===1?l:new zl({message:`Failed after ${f} attempts with non-retryable error: '${u}'`,reason:"errorNotRetryable",errors:p})}})}function Go({maxRetries:e}){if(e!=null){if(!Number.isInteger(e))throw new _e({parameter:"maxRetries",value:e,message:"maxRetries must be an integer"});if(e<0)throw new _e({parameter:"maxRetries",value:e,message:"maxRetries must be >= 0"})}let t=e!=null?e:2;return {maxRetries:t,retry:Wh({maxRetries:t})}}function kt({operationId:e,telemetry:t}){return {"operation.name":`${e}${(t==null?void 0:t.functionId)!=null?` ${t.functionId}`:""}`,"resource.name":t==null?void 0:t.functionId,"ai.operationId":e,"ai.telemetry.functionId":t==null?void 0:t.functionId}}function Ho({model:e,settings:t,telemetry:r,headers:n}){var o;return d(d(d({"ai.model.provider":e.provider,"ai.model.id":e.modelId},Object.entries(t).reduce((s,[a,l])=>(s[`ai.settings.${a}`]=l,s),{})),Object.entries((o=r==null?void 0:r.metadata)!=null?o:{}).reduce((s,[a,l])=>(s[`ai.telemetry.metadata.${a}`]=l,s),{})),Object.entries(n!=null?n:{}).reduce((s,[a,l])=>(l!==void 0&&(s[`ai.request.headers.${a}`]=l),s),{}))}var Kh={startSpan(){return Jo},startActiveSpan(e,t,r,n){if(typeof t=="function")return t(Jo);if(typeof r=="function")return r(Jo);if(typeof n=="function")return n(Jo)}},Jo={spanContext(){return Yh},setAttribute(){return this},setAttributes(){return this},addEvent(){return this},addLink(){return this},addLinks(){return this},setStatus(){return this},updateName(){return this},end(){return this},isRecording(){return  false},recordException(){return this}},Yh={traceId:"",spanId:"",traceFlags:0};function Wo({isEnabled:e=false,tracer:t}={}){return e?t||Zs.getTracer("ai"):Kh}function At({name:e,tracer:t,attributes:r,fn:n,endWhenDone:o=true}){return t.startActiveSpan(e,{attributes:r},s=>A(null,null,function*(){try{let a=yield n(s);return o&&s.end(),a}catch(a){try{a instanceof Error?(s.recordException({name:a.name,message:a.message,stack:a.stack}),s.setStatus({code:rn.ERROR,message:a.message})):s.setStatus({code:rn.ERROR});}finally{s.end();}throw a}}))}function Ce({telemetry:e,attributes:t}){return (e==null?void 0:e.isEnabled)!==true?{}:Object.entries(t).reduce((r,[n,o])=>{if(o===void 0)return r;if(typeof o=="object"&&"input"in o&&typeof o.input=="function"){if((e==null?void 0:e.recordInputs)===false)return r;let s=o.input();return s===void 0?r:g(d({},r),{[n]:s})}if(typeof o=="object"&&"output"in o&&typeof o.output=="function"){if((e==null?void 0:e.recordOutputs)===false)return r;let s=o.output();return s===void 0?r:g(d({},r),{[n]:s})}return g(d({},r),{[n]:o})},{})}var ru=class{constructor({data:e,mimeType:t}){let r=e instanceof Uint8Array;this.base64Data=r?void 0:e,this.uint8ArrayData=r?e:void 0,this.mimeType=t;}get base64(){return this.base64Data==null&&(this.base64Data=Lt(this.uint8ArrayData)),this.base64Data}get uint8Array(){return this.uint8ArrayData==null&&(this.uint8ArrayData=or(this.base64Data)),this.uint8ArrayData}},rm=class extends ru{constructor(e){super(e),this.type="file";}},nm=[{mimeType:"image/gif",bytesPrefix:[71,73,70],base64Prefix:"R0lG"},{mimeType:"image/png",bytesPrefix:[137,80,78,71],base64Prefix:"iVBORw"},{mimeType:"image/jpeg",bytesPrefix:[255,216],base64Prefix:"/9j/"},{mimeType:"image/webp",bytesPrefix:[82,73,70,70],base64Prefix:"UklGRg"},{mimeType:"image/bmp",bytesPrefix:[66,77],base64Prefix:"Qk"},{mimeType:"image/tiff",bytesPrefix:[73,73,42,0],base64Prefix:"SUkqAA"},{mimeType:"image/tiff",bytesPrefix:[77,77,0,42],base64Prefix:"TU0AKg"},{mimeType:"image/avif",bytesPrefix:[0,0,0,32,102,116,121,112,97,118,105,102],base64Prefix:"AAAAIGZ0eXBhdmlm"},{mimeType:"image/heic",bytesPrefix:[0,0,0,32,102,116,121,112,104,101,105,99],base64Prefix:"AAAAIGZ0eXBoZWlj"}];var om=e=>{let t=typeof e=="string"?or(e):e,r=(t[6]&127)<<21|(t[7]&127)<<14|(t[8]&127)<<7|t[9]&127;return t.slice(r+10)};function sm(e){return typeof e=="string"&&e.startsWith("SUQz")||typeof e!="string"&&e.length>10&&e[0]===73&&e[1]===68&&e[2]===51?om(e):e}function am({data:e,signatures:t}){let r=sm(e);for(let n of t)if(typeof r=="string"?r.startsWith(n.base64Prefix):r.length>=n.bytesPrefix.length&&n.bytesPrefix.every((o,s)=>r[s]===o))return n.mimeType}var nu="AI_NoObjectGeneratedError",ou=`vercel.ai.error.${nu}`,im=Symbol.for(ou),su,Yt=class extends B{constructor({message:e="No object generated.",cause:t,text:r,response:n,usage:o,finishReason:s}){super({name:nu,message:e,cause:t}),this[su]=true,this.text=r,this.response=n,this.usage=o,this.finishReason=s;}static isInstance(e){return B.hasMarker(e,ou)}};su=im;var au="AI_DownloadError",iu=`vercel.ai.error.${au}`,lm=Symbol.for(iu),lu,Gs=class extends B{constructor({url:e,statusCode:t,statusText:r,cause:n,message:o=n==null?`Failed to download ${e}: ${t} ${r}`:`Failed to download ${e}: ${n}`}){super({name:au,message:o,cause:n}),this[lu]=true,this.url=e,this.statusCode=t,this.statusText=r;}static isInstance(e){return B.hasMarker(e,iu)}};lu=lm;function um(t){return A(this,arguments,function*({url:e}){var r;let n=e.toString();try{let o=yield fetch(n);if(!o.ok)throw new Gs({url:n,statusCode:o.status,statusText:o.statusText});return {data:new Uint8Array(yield o.arrayBuffer()),mimeType:(r=o.headers.get("content-type"))!=null?r:void 0}}catch(o){throw Gs.isInstance(o)?o:new Gs({url:n,cause:o})}})}var uu="AI_InvalidDataContentError",pu=`vercel.ai.error.${uu}`,pm=Symbol.for(pu),cu,Ll=class extends B{constructor({content:e,cause:t,message:r=`Invalid data content. Expected a base64 string, Uint8Array, ArrayBuffer, or Buffer, but got ${typeof e}.`}){super({name:uu,message:r,cause:t}),this[cu]=true,this.content=e;}static isInstance(e){return B.hasMarker(e,pu)}};cu=pm;var du=i.union([i.string(),i.instanceof(Uint8Array),i.instanceof(ArrayBuffer),i.custom(e=>{var t,r;return (r=(t=globalThis.Buffer)==null?void 0:t.isBuffer(e))!=null?r:false},{message:"Must be a Buffer"})]);function fu(e){return typeof e=="string"?e:e instanceof ArrayBuffer?Lt(new Uint8Array(e)):Lt(e)}function Zo(e){if(e instanceof Uint8Array)return e;if(typeof e=="string")try{return or(e)}catch(t){throw new Ll({message:"Invalid data content. Content string is not a base64-encoded media.",content:e,cause:t})}if(e instanceof ArrayBuffer)return new Uint8Array(e);throw new Ll({content:e})}function cm(e){try{return new TextDecoder().decode(e)}catch(t){throw new Error("Error decoding Uint8Array to text")}}var hu="AI_InvalidMessageRoleError",mu=`vercel.ai.error.${hu}`,dm=Symbol.for(mu),gu,fm=class extends B{constructor({role:e,message:t=`Invalid message role: '${e}'. Must be one of: "system", "user", "assistant", "tool".`}){super({name:hu,message:t}),this[gu]=true,this.role=e;}static isInstance(e){return B.hasMarker(e,mu)}};gu=dm;function hm(e){try{let[t,r]=e.split(",");return {mimeType:t.split(";")[0].split(":")[1],base64Content:r}}catch(t){return {mimeType:void 0,base64Content:void 0}}}function on(o){return A(this,arguments,function*({prompt:e,modelSupportsImageUrls:t=true,modelSupportsUrl:r=()=>false,downloadImplementation:n=um}){let s=yield gm(e.messages,n,t,r);return [...e.system!=null?[{role:"system",content:e.system}]:[],...e.messages.map(a=>mm(a,s))]})}function mm(e,t){var r,n,o,s,a,l;let u=e.role;switch(u){case "system":return {role:"system",content:e.content,providerMetadata:(r=e.providerOptions)!=null?r:e.experimental_providerMetadata};case "user":return typeof e.content=="string"?{role:"user",content:[{type:"text",text:e.content}],providerMetadata:(n=e.providerOptions)!=null?n:e.experimental_providerMetadata}:{role:"user",content:e.content.map(p=>ym(p,t)).filter(p=>p.type!=="text"||p.text!==""),providerMetadata:(o=e.providerOptions)!=null?o:e.experimental_providerMetadata};case "assistant":return typeof e.content=="string"?{role:"assistant",content:[{type:"text",text:e.content}],providerMetadata:(s=e.providerOptions)!=null?s:e.experimental_providerMetadata}:{role:"assistant",content:e.content.filter(p=>p.type!=="text"||p.text!=="").map(p=>{var f;let m=(f=p.providerOptions)!=null?f:p.experimental_providerMetadata;switch(p.type){case "file":return {type:"file",data:p.data instanceof URL?p.data:fu(p.data),filename:p.filename,mimeType:p.mimeType,providerMetadata:m};case "reasoning":return {type:"reasoning",text:p.text,signature:p.signature,providerMetadata:m};case "redacted-reasoning":return {type:"redacted-reasoning",data:p.data,providerMetadata:m};case "text":return {type:"text",text:p.text,providerMetadata:m};case "tool-call":return {type:"tool-call",toolCallId:p.toolCallId,toolName:p.toolName,args:p.args,providerMetadata:m}}}),providerMetadata:(a=e.providerOptions)!=null?a:e.experimental_providerMetadata};case "tool":return {role:"tool",content:e.content.map(p=>{var f;return {type:"tool-result",toolCallId:p.toolCallId,toolName:p.toolName,result:p.result,content:p.experimental_content,isError:p.isError,providerMetadata:(f=p.providerOptions)!=null?f:p.experimental_providerMetadata}}),providerMetadata:(l=e.providerOptions)!=null?l:e.experimental_providerMetadata};default:{let p=u;throw new fm({role:p})}}}function gm(e,t,r,n){return A(this,null,function*(){let o=e.filter(a=>a.role==="user").map(a=>a.content).filter(a=>Array.isArray(a)).flat().filter(a=>a.type==="image"||a.type==="file").filter(a=>!(a.type==="image"&&r===true)).map(a=>a.type==="image"?a.image:a.data).map(a=>typeof a=="string"&&(a.startsWith("http:")||a.startsWith("https:"))?new URL(a):a).filter(a=>a instanceof URL).filter(a=>!n(a)),s=yield Promise.all(o.map(a=>A(null,null,function*(){return {url:a,data:yield t({url:a})}})));return Object.fromEntries(s.map(({url:a,data:l})=>[a.toString(),l]))})}function ym(e,t){var r,n,o,s;if(e.type==="text")return {type:"text",text:e.text,providerMetadata:(r=e.providerOptions)!=null?r:e.experimental_providerMetadata};let a=e.mimeType,l,u,p,f=e.type;switch(f){case "image":l=e.image;break;case "file":l=e.data;break;default:throw new Error(`Unsupported part type: ${f}`)}try{u=typeof l=="string"?new URL(l):l;}catch(m){u=l;}if(u instanceof URL)if(u.protocol==="data:"){let{mimeType:m,base64Content:y}=hm(u.toString());if(m==null||y==null)throw new Error(`Invalid data URL format in part ${f}`);a=m,p=Zo(y);}else {let m=t[u.toString()];m?(p=m.data,a!=null||(a=m.mimeType)):p=u;}else p=Zo(u);switch(f){case "image":return p instanceof Uint8Array&&(a=(n=am({data:p,signatures:nm}))!=null?n:a),{type:"image",image:p,mimeType:a,providerMetadata:(o=e.providerOptions)!=null?o:e.experimental_providerMetadata};case "file":{if(a==null)throw new Error("Mime type is missing for file part");return {type:"file",data:p instanceof Uint8Array?fu(p):p,filename:e.filename,mimeType:a,providerMetadata:(s=e.providerOptions)!=null?s:e.experimental_providerMetadata}}}}function sn({maxTokens:e,temperature:t,topP:r,topK:n,presencePenalty:o,frequencyPenalty:s,stopSequences:a,seed:l}){if(e!=null){if(!Number.isInteger(e))throw new _e({parameter:"maxTokens",value:e,message:"maxTokens must be an integer"});if(e<1)throw new _e({parameter:"maxTokens",value:e,message:"maxTokens must be >= 1"})}if(t!=null&&typeof t!="number")throw new _e({parameter:"temperature",value:t,message:"temperature must be a number"});if(r!=null&&typeof r!="number")throw new _e({parameter:"topP",value:r,message:"topP must be a number"});if(n!=null&&typeof n!="number")throw new _e({parameter:"topK",value:n,message:"topK must be a number"});if(o!=null&&typeof o!="number")throw new _e({parameter:"presencePenalty",value:o,message:"presencePenalty must be a number"});if(s!=null&&typeof s!="number")throw new _e({parameter:"frequencyPenalty",value:s,message:"frequencyPenalty must be a number"});if(l!=null&&!Number.isInteger(l))throw new _e({parameter:"seed",value:l,message:"seed must be an integer"});return {maxTokens:e,temperature:t!=null?t:0,topP:r,topK:n,presencePenalty:o,frequencyPenalty:s,stopSequences:a!=null&&a.length>0?a:void 0,seed:l}}function Vl(e){var t,r,n;let o=[];for(let s of e){let a;try{a=new URL(s.url);}catch(l){throw new Error(`Invalid URL: ${s.url}`)}switch(a.protocol){case "http:":case "https:":{if((t=s.contentType)!=null&&t.startsWith("image/"))o.push({type:"image",image:a});else {if(!s.contentType)throw new Error("If the attachment is not an image, it must specify a content type");o.push({type:"file",data:a,mimeType:s.contentType});}break}case "data:":{let l,u,p;try{[l,u]=s.url.split(","),p=l.split(";")[0].split(":")[1];}catch(f){throw new Error(`Error processing data URL: ${s.url}`)}if(p==null||u==null)throw new Error(`Invalid data URL format: ${s.url}`);if((r=s.contentType)!=null&&r.startsWith("image/"))o.push({type:"image",image:Zo(u)});else if((n=s.contentType)!=null&&n.startsWith("text/"))o.push({type:"text",text:cm(Zo(u))});else {if(!s.contentType)throw new Error("If the attachment is not an image or text, it must specify a content type");o.push({type:"file",data:u,mimeType:s.contentType});}break}default:throw new Error(`Unsupported URL protocol: ${a.protocol}`)}}return o}var yu="AI_MessageConversionError",vu=`vercel.ai.error.${yu}`,vm=Symbol.for(vu),bu,Hs=class extends B{constructor({originalMessage:e,message:t}){super({name:yu,message:t}),this[bu]=true,this.originalMessage=e;}static isInstance(e){return B.hasMarker(e,vu)}};bu=vm;function bm(e,t){var r,n;let o=(r=t==null?void 0:t.tools)!=null?r:{},s=[];for(let l=0;l<e.length;l++){let u=e[l],p=l===e.length-1,{role:f,content:m,experimental_attachments:y}=u;switch(f){case "system":{s.push({role:"system",content:m});break}case "user":{if(u.parts==null)s.push({role:"user",content:y?[{type:"text",text:m},...Vl(y)]:m});else {let v=u.parts.filter(x=>x.type==="text").map(x=>({type:"text",text:x.text}));s.push({role:"user",content:y?[...v,...Vl(y)]:v});}break}case "assistant":{if(u.parts!=null){let S=function(){let T=[];for(let F of R)switch(F.type){case "file":case "text":{T.push(F);break}case "reasoning":{for(let O of F.details)switch(O.type){case "text":T.push({type:"reasoning",text:O.text,signature:O.signature});break;case "redacted":T.push({type:"redacted-reasoning",data:O.data});break}break}case "tool-invocation":T.push({type:"tool-call",toolCallId:F.toolInvocation.toolCallId,toolName:F.toolInvocation.toolName,args:F.toolInvocation.args});break;default:{let O=F;throw new Error(`Unsupported part: ${O}`)}}s.push({role:"assistant",content:T});let N=R.filter(F=>F.type==="tool-invocation").map(F=>F.toolInvocation);N.length>0&&s.push({role:"tool",content:N.map(F=>{if(!("result"in F))throw new Hs({originalMessage:u,message:"ToolInvocation must have a result: "+JSON.stringify(F)});let{toolCallId:O,toolName:Y,result:P}=F,q=o[Y];return (q==null?void 0:q.experimental_toToolResultContent)!=null?{type:"tool-result",toolCallId:O,toolName:Y,result:q.experimental_toToolResultContent(P),experimental_content:q.experimental_toToolResultContent(P)}:{type:"tool-result",toolCallId:O,toolName:Y,result:P}})}),R=[],I=false,_++;};let _=0,I=false,R=[];for(let T of u.parts)switch(T.type){case "text":{I&&S(),R.push(T);break}case "file":case "reasoning":{R.push(T);break}case "tool-invocation":{((n=T.toolInvocation.step)!=null?n:0)!==_&&S(),R.push(T),I=true;break}}S();break}let v=u.toolInvocations;if(v==null||v.length===0){s.push({role:"assistant",content:m});break}let x=v.reduce((S,_)=>{var I;return Math.max(S,(I=_.step)!=null?I:0)},0);for(let S=0;S<=x;S++){let _=v.filter(I=>{var R;return ((R=I.step)!=null?R:0)===S});_.length!==0&&(s.push({role:"assistant",content:[...p&&m&&S===0?[{type:"text",text:m}]:[],..._.map(({toolCallId:I,toolName:R,args:T})=>({type:"tool-call",toolCallId:I,toolName:R,args:T}))]}),s.push({role:"tool",content:_.map(I=>{if(!("result"in I))throw new Hs({originalMessage:u,message:"ToolInvocation must have a result: "+JSON.stringify(I)});let{toolCallId:R,toolName:T,result:N}=I,F=o[T];return (F==null?void 0:F.experimental_toToolResultContent)!=null?{type:"tool-result",toolCallId:R,toolName:T,result:F.experimental_toToolResultContent(N),experimental_content:F.experimental_toToolResultContent(N)}:{type:"tool-result",toolCallId:R,toolName:T,result:N}})}));}m&&!p&&s.push({role:"assistant",content:m});break}case "data":break;default:{let v=f;throw new Hs({originalMessage:u,message:`Unsupported role: ${v}`})}}}return s}var Xs=i.lazy(()=>i.union([i.null(),i.string(),i.number(),i.boolean(),i.record(i.string(),Xs),i.array(Xs)])),Re=i.record(i.string(),i.record(i.string(),Xs)),_m=i.array(i.union([i.object({type:i.literal("text"),text:i.string()}),i.object({type:i.literal("image"),data:i.string(),mimeType:i.string().optional()})])),_u=i.object({type:i.literal("text"),text:i.string(),providerOptions:Re.optional(),experimental_providerMetadata:Re.optional()}),wm=i.object({type:i.literal("image"),image:i.union([du,i.instanceof(URL)]),mimeType:i.string().optional(),providerOptions:Re.optional(),experimental_providerMetadata:Re.optional()}),wu=i.object({type:i.literal("file"),data:i.union([du,i.instanceof(URL)]),filename:i.string().optional(),mimeType:i.string(),providerOptions:Re.optional(),experimental_providerMetadata:Re.optional()}),xm=i.object({type:i.literal("reasoning"),text:i.string(),providerOptions:Re.optional(),experimental_providerMetadata:Re.optional()}),Sm=i.object({type:i.literal("redacted-reasoning"),data:i.string(),providerOptions:Re.optional(),experimental_providerMetadata:Re.optional()}),Tm=i.object({type:i.literal("tool-call"),toolCallId:i.string(),toolName:i.string(),args:i.unknown(),providerOptions:Re.optional(),experimental_providerMetadata:Re.optional()}),Im=i.object({type:i.literal("tool-result"),toolCallId:i.string(),toolName:i.string(),result:i.unknown(),content:_m.optional(),isError:i.boolean().optional(),providerOptions:Re.optional(),experimental_providerMetadata:Re.optional()}),km=i.object({role:i.literal("system"),content:i.string(),providerOptions:Re.optional(),experimental_providerMetadata:Re.optional()}),Am=i.object({role:i.literal("user"),content:i.union([i.string(),i.array(i.union([_u,wm,wu]))]),providerOptions:Re.optional(),experimental_providerMetadata:Re.optional()}),Em=i.object({role:i.literal("assistant"),content:i.union([i.string(),i.array(i.union([_u,wu,xm,Sm,Tm]))]),providerOptions:Re.optional(),experimental_providerMetadata:Re.optional()}),Cm=i.object({role:i.literal("tool"),content:i.array(Im),providerOptions:Re.optional(),experimental_providerMetadata:Re.optional()}),Rm=i.union([km,Am,Em,Cm]);function an({prompt:e,tools:t}){if(e.prompt==null&&e.messages==null)throw new _t({prompt:e,message:"prompt or messages must be defined"});if(e.prompt!=null&&e.messages!=null)throw new _t({prompt:e,message:"prompt and messages cannot be defined at the same time"});if(e.system!=null&&typeof e.system!="string")throw new _t({prompt:e,message:"system must be a string"});if(e.prompt!=null){if(typeof e.prompt!="string")throw new _t({prompt:e,message:"prompt must be a string"});return {type:"prompt",system:e.system,messages:[{role:"user",content:e.prompt}]}}if(e.messages!=null){let n=jm(e.messages)==="ui-messages"?bm(e.messages,{tools:t}):e.messages;if(n.length===0)throw new _t({prompt:e,message:"messages must not be empty"});let o=it({value:n,schema:i.array(Rm)});if(!o.success)throw new _t({prompt:e,message:["message must be a CoreMessage or a UI message",`Validation error: ${o.error.message}`].join(`
`),cause:o.error});return {type:"messages",messages:n,system:e.system}}throw new Error("unreachable")}function jm(e){if(!Array.isArray(e))throw new _t({prompt:e,message:["messages must be an array of CoreMessage or UIMessage",`Received non-array value: ${JSON.stringify(e)}`].join(`
`),cause:e});if(e.length===0)return "messages";let t=e.map(Om);if(t.some(n=>n==="has-ui-specific-parts"))return "ui-messages";let r=t.findIndex(n=>n!=="has-core-specific-parts"&&n!=="message");if(r===-1)return "messages";throw new _t({prompt:e,message:["messages must be an array of CoreMessage or UIMessage",`Received message of type: "${t[r]}" at index ${r}`,`messages[${r}]: ${JSON.stringify(e[r])}`].join(`
`),cause:e})}function Om(e){return typeof e=="object"&&e!==null&&(e.role==="function"||e.role==="data"||"toolInvocations"in e||"parts"in e||"experimental_attachments"in e)?"has-ui-specific-parts":typeof e=="object"&&e!==null&&"content"in e&&(Array.isArray(e.content)||"experimental_providerMetadata"in e||"providerOptions"in e)?"has-core-specific-parts":typeof e=="object"&&e!==null&&"role"in e&&"content"in e&&typeof e.content=="string"&&["system","user","assistant","tool"].includes(e.role)?"message":"other"}function Kt({promptTokens:e,completionTokens:t}){return {promptTokens:e,completionTokens:t,totalTokens:e+t}}function xu(e,t){return {promptTokens:e.promptTokens+t.promptTokens,completionTokens:e.completionTokens+t.completionTokens,totalTokens:e.totalTokens+t.totalTokens}}var Pm="JSON schema:",Mm="You MUST answer with a JSON object that matches the JSON schema above.",Nm="You MUST answer with JSON.";function Vn({prompt:e,schema:t,schemaPrefix:r=t!=null?Pm:void 0,schemaSuffix:n=t!=null?Mm:Nm}){return [e!=null&&e.length>0?e:void 0,e!=null&&e.length>0?"":void 0,r,t!=null?JSON.stringify(t):void 0,n].filter(o=>o!=null).join(`
`)}function Nr(e){let t=e.pipeThrough(new TransformStream);return t[Symbol.asyncIterator]=()=>{let r=t.getReader();return {next(){return A(this,null,function*(){let{done:o,value:s}=yield r.read();return o?{done:true,value:void 0}:{done:false,value:s}})}}},t}var Dm={type:"no-schema",jsonSchema:void 0,validatePartialResult({value:e,textDelta:t}){return {success:true,value:{partial:e,textDelta:t}}},validateFinalResult(e,t){return e===void 0?{success:false,error:new Yt({message:"No object generated: response did not match schema.",text:t.text,response:t.response,usage:t.usage,finishReason:t.finishReason})}:{success:true,value:e}},createElementStream(){throw new ae({functionality:"element streams in no-schema mode"})}},Fm=e=>({type:"object",jsonSchema:e.jsonSchema,validatePartialResult({value:t,textDelta:r}){return {success:true,value:{partial:t,textDelta:r}}},validateFinalResult(t){return it({value:t,schema:e})},createElementStream(){throw new ae({functionality:"element streams in object mode"})}}),Um=e=>{let n=e.jsonSchema,{$schema:t}=n;return {type:"enum",jsonSchema:{$schema:"http://json-schema.org/draft-07/schema#",type:"object",properties:{elements:{type:"array",items:qe(n,["$schema"])}},required:["elements"],additionalProperties:false},validatePartialResult({value:o,latestObject:s,isFirstDelta:a,isFinalDelta:l}){var u;if(!So(o)||!xs(o.elements))return {success:false,error:new Be({value:o,cause:"value must be an object that contains an array of elements"})};let p=o.elements,f=[];for(let v=0;v<p.length;v++){let x=p[v],S=it({value:x,schema:e});if(!(v===p.length-1&&!l)){if(!S.success)return S;f.push(S.value);}}let m=(u=s==null?void 0:s.length)!=null?u:0,y="";return a&&(y+="["),m>0&&(y+=","),y+=f.slice(m).map(v=>JSON.stringify(v)).join(","),l&&(y+="]"),{success:true,value:{partial:f,textDelta:y}}},validateFinalResult(o){if(!So(o)||!xs(o.elements))return {success:false,error:new Be({value:o,cause:"value must be an object that contains an array of elements"})};let s=o.elements;for(let a of s){let l=it({value:a,schema:e});if(!l.success)return l}return {success:true,value:s}},createElementStream(o){let s=0;return Nr(o.pipeThrough(new TransformStream({transform(a,l){switch(a.type){case "object":{let u=a.object;for(;s<u.length;s++)l.enqueue(u[s]);break}case "text-delta":case "finish":case "error":break;default:{let u=a;throw new Error(`Unsupported chunk type: ${u}`)}}}})))}}},$m=e=>({type:"enum",jsonSchema:{$schema:"http://json-schema.org/draft-07/schema#",type:"object",properties:{result:{type:"string",enum:e}},required:["result"],additionalProperties:false},validateFinalResult(t){if(!So(t)||typeof t.result!="string")return {success:false,error:new Be({value:t,cause:'value must be an object that contains a string in the "result" property.'})};let r=t.result;return e.includes(r)?{success:true,value:r}:{success:false,error:new Be({value:t,cause:"value must be a string in the enum"})}},validatePartialResult(){throw new ae({functionality:"partial results in enum mode"})},createElementStream(){throw new ae({functionality:"element streams in enum mode"})}});function Su({output:e,schema:t,enumValues:r}){switch(e){case "object":return Fm(Ut(t));case "array":return Um(Ut(t));case "enum":return $m(r);case "no-schema":return Dm;default:{let n=e;throw new Error(`Unsupported output: ${n}`)}}}function Tu({output:e,mode:t,schema:r,schemaName:n,schemaDescription:o,enumValues:s}){if(e!=null&&e!=="object"&&e!=="array"&&e!=="enum"&&e!=="no-schema")throw new _e({parameter:"output",value:e,message:"Invalid output type."});if(e==="no-schema"){if(t==="auto"||t==="tool")throw new _e({parameter:"mode",value:t,message:'Mode must be "json" for no-schema output.'});if(r!=null)throw new _e({parameter:"schema",value:r,message:"Schema is not supported for no-schema output."});if(o!=null)throw new _e({parameter:"schemaDescription",value:o,message:"Schema description is not supported for no-schema output."});if(n!=null)throw new _e({parameter:"schemaName",value:n,message:"Schema name is not supported for no-schema output."});if(s!=null)throw new _e({parameter:"enumValues",value:s,message:"Enum values are not supported for no-schema output."})}if(e==="object"){if(r==null)throw new _e({parameter:"schema",value:r,message:"Schema is required for object output."});if(s!=null)throw new _e({parameter:"enumValues",value:s,message:"Enum values are not supported for object output."})}if(e==="array"){if(r==null)throw new _e({parameter:"schema",value:r,message:"Element schema is required for array output."});if(s!=null)throw new _e({parameter:"enumValues",value:s,message:"Enum values are not supported for array output."})}if(e==="enum"){if(r!=null)throw new _e({parameter:"schema",value:r,message:"Schema is not supported for enum output."});if(o!=null)throw new _e({parameter:"schemaDescription",value:o,message:"Schema description is not supported for enum output."});if(n!=null)throw new _e({parameter:"schemaName",value:n,message:"Schema name is not supported for enum output."});if(s==null)throw new _e({parameter:"enumValues",value:s,message:"Enum values are required for enum output."});for(let a of s)if(typeof a!="string")throw new _e({parameter:"enumValues",value:a,message:"Enum values must be strings."})}}var qm=wt({prefix:"aiobj",size:24});function Ko(N){return A(this,null,function*(){var F=N,{model:e,enum:t,schema:r,schemaName:n,schemaDescription:o,mode:s,output:a="object",system:l,prompt:u,messages:p,maxRetries:f,abortSignal:m,headers:y,experimental_repairText:v,experimental_telemetry:x,experimental_providerMetadata:S,providerOptions:_=S,_internal:{generateId:I=qm,currentDate:R=()=>new Date}={}}=F,T=qe(F,["model","enum","schema","schemaName","schemaDescription","mode","output","system","prompt","messages","maxRetries","abortSignal","headers","experimental_repairText","experimental_telemetry","experimental_providerMetadata","providerOptions","_internal"]);Tu({output:a,mode:s,schema:r,schemaName:n,schemaDescription:o,enumValues:t});let{maxRetries:O,retry:Y}=Go({maxRetries:f}),P=Su({output:a,schema:r,enumValues:t});P.type==="no-schema"&&s===void 0&&(s="json");let q=Ho({model:e,telemetry:x,headers:y,settings:g(d({},T),{maxRetries:O})}),oe=Wo(x);return At({name:"ai.generateObject",attributes:Ce({telemetry:x,attributes:g(d(d({},kt({operationId:"ai.generateObject",telemetry:x})),q),{"ai.prompt":{input:()=>JSON.stringify({system:l,prompt:u,messages:p})},"ai.schema":P.jsonSchema!=null?{input:()=>JSON.stringify(P.jsonSchema)}:void 0,"ai.schema.name":n,"ai.schema.description":o,"ai.settings.output":P.type,"ai.settings.mode":s})}),tracer:oe,fn:ye=>A(null,null,function*(){var ke,Te,he,le;(s==="auto"||s==null)&&(s=e.defaultObjectGenerationMode);let Ne,ve,Pe,de,we,X,Q,Xe,He;switch(s){case "json":{let pe=an({prompt:{system:P.jsonSchema==null?Vn({prompt:l}):e.supportsStructuredOutputs?l:Vn({prompt:l,schema:P.jsonSchema}),prompt:u,messages:p},tools:void 0}),ce=yield on({prompt:pe,modelSupportsImageUrls:e.supportsImageUrls,modelSupportsUrl:(ke=e.supportsUrl)==null?void 0:ke.bind(e)}),ge=yield Y(()=>At({name:"ai.generateObject.doGenerate",attributes:Ce({telemetry:x,attributes:g(d(d({},kt({operationId:"ai.generateObject.doGenerate",telemetry:x})),q),{"ai.prompt.format":{input:()=>pe.type},"ai.prompt.messages":{input:()=>JSON.stringify(ce)},"ai.settings.mode":s,"gen_ai.system":e.provider,"gen_ai.request.model":e.modelId,"gen_ai.request.frequency_penalty":T.frequencyPenalty,"gen_ai.request.max_tokens":T.maxTokens,"gen_ai.request.presence_penalty":T.presencePenalty,"gen_ai.request.temperature":T.temperature,"gen_ai.request.top_k":T.topK,"gen_ai.request.top_p":T.topP})}),tracer:oe,fn:Ee=>A(null,null,function*(){var K,$e,Je,nt,ne,V;let se=yield e.doGenerate(g(d({mode:{type:"object-json",schema:P.jsonSchema,name:n,description:o}},sn(T)),{inputFormat:pe.type,prompt:ce,providerMetadata:_,abortSignal:m,headers:y})),be={id:($e=(K=se.response)==null?void 0:K.id)!=null?$e:I(),timestamp:(nt=(Je=se.response)==null?void 0:Je.timestamp)!=null?nt:R(),modelId:(V=(ne=se.response)==null?void 0:ne.modelId)!=null?V:e.modelId};if(se.text===void 0)throw new Yt({message:"No object generated: the model did not return a response.",response:be,usage:Kt(se.usage),finishReason:se.finishReason});return Ee.setAttributes(Ce({telemetry:x,attributes:{"ai.response.finishReason":se.finishReason,"ai.response.object":{output:()=>se.text},"ai.response.id":be.id,"ai.response.model":be.modelId,"ai.response.timestamp":be.timestamp.toISOString(),"ai.usage.promptTokens":se.usage.promptTokens,"ai.usage.completionTokens":se.usage.completionTokens,"gen_ai.response.finish_reasons":[se.finishReason],"gen_ai.response.id":be.id,"gen_ai.response.model":be.modelId,"gen_ai.usage.prompt_tokens":se.usage.promptTokens,"gen_ai.usage.completion_tokens":se.usage.completionTokens}})),g(d({},se),{objectText:se.text,responseData:be})})}));Ne=ge.objectText,ve=ge.finishReason,Pe=ge.usage,de=ge.warnings,we=ge.rawResponse,Xe=ge.logprobs,He=ge.providerMetadata,Q=(Te=ge.request)!=null?Te:{},X=ge.responseData;break}case "tool":{let pe=an({prompt:{system:l,prompt:u,messages:p},tools:void 0}),ce=yield on({prompt:pe,modelSupportsImageUrls:e.supportsImageUrls,modelSupportsUrl:(he=e.supportsUrl)==null?void 0:he.bind(e)}),ge=pe.type,Ee=yield Y(()=>At({name:"ai.generateObject.doGenerate",attributes:Ce({telemetry:x,attributes:g(d(d({},kt({operationId:"ai.generateObject.doGenerate",telemetry:x})),q),{"ai.prompt.format":{input:()=>ge},"ai.prompt.messages":{input:()=>JSON.stringify(ce)},"ai.settings.mode":s,"gen_ai.system":e.provider,"gen_ai.request.model":e.modelId,"gen_ai.request.frequency_penalty":T.frequencyPenalty,"gen_ai.request.max_tokens":T.maxTokens,"gen_ai.request.presence_penalty":T.presencePenalty,"gen_ai.request.temperature":T.temperature,"gen_ai.request.top_k":T.topK,"gen_ai.request.top_p":T.topP})}),tracer:oe,fn:K=>A(null,null,function*(){var $e,Je,nt,ne,V,se,be,Fe;let k=yield e.doGenerate(g(d({mode:{type:"object-tool",tool:{type:"function",name:n!=null?n:"json",description:o!=null?o:"Respond with a JSON object.",parameters:P.jsonSchema}}},sn(T)),{inputFormat:ge,prompt:ce,providerMetadata:_,abortSignal:m,headers:y})),xe=(Je=($e=k.toolCalls)==null?void 0:$e[0])==null?void 0:Je.args,Ie={id:(ne=(nt=k.response)==null?void 0:nt.id)!=null?ne:I(),timestamp:(se=(V=k.response)==null?void 0:V.timestamp)!=null?se:R(),modelId:(Fe=(be=k.response)==null?void 0:be.modelId)!=null?Fe:e.modelId};if(xe===void 0)throw new Yt({message:"No object generated: the tool was not called.",response:Ie,usage:Kt(k.usage),finishReason:k.finishReason});return K.setAttributes(Ce({telemetry:x,attributes:{"ai.response.finishReason":k.finishReason,"ai.response.object":{output:()=>xe},"ai.response.id":Ie.id,"ai.response.model":Ie.modelId,"ai.response.timestamp":Ie.timestamp.toISOString(),"ai.usage.promptTokens":k.usage.promptTokens,"ai.usage.completionTokens":k.usage.completionTokens,"gen_ai.response.finish_reasons":[k.finishReason],"gen_ai.response.id":Ie.id,"gen_ai.response.model":Ie.modelId,"gen_ai.usage.input_tokens":k.usage.promptTokens,"gen_ai.usage.output_tokens":k.usage.completionTokens}})),g(d({},k),{objectText:xe,responseData:Ie})})}));Ne=Ee.objectText,ve=Ee.finishReason,Pe=Ee.usage,de=Ee.warnings,we=Ee.rawResponse,Xe=Ee.logprobs,He=Ee.providerMetadata,Q=(le=Ee.request)!=null?le:{},X=Ee.responseData;break}case void 0:throw new Error("Model does not have a default object generation mode.");default:{let pe=s;throw new Error(`Unsupported mode: ${pe}`)}}function ct(pe){let ce=xt({text:pe});if(!ce.success)throw new Yt({message:"No object generated: could not parse the response.",cause:ce.error,text:pe,response:X,usage:Kt(Pe),finishReason:ve});let ge=P.validateFinalResult(ce.value,{text:pe,response:X,usage:Kt(Pe)});if(!ge.success)throw new Yt({message:"No object generated: response did not match schema.",cause:ge.error,text:pe,response:X,usage:Kt(Pe),finishReason:ve});return ge.value}let De;try{De=ct(Ne);}catch(pe){if(v!=null&&Yt.isInstance(pe)&&(dt.isInstance(pe.cause)||Be.isInstance(pe.cause))){let ce=yield v({text:Ne,error:pe.cause});if(ce===null)throw pe;De=ct(ce);}else throw pe}return ye.setAttributes(Ce({telemetry:x,attributes:{"ai.response.finishReason":ve,"ai.response.object":{output:()=>JSON.stringify(De)},"ai.usage.promptTokens":Pe.promptTokens,"ai.usage.completionTokens":Pe.completionTokens}})),new Bm({object:De,finishReason:ve,usage:Kt(Pe),warnings:de,request:Q,response:g(d({},X),{headers:we==null?void 0:we.headers,body:we==null?void 0:we.body}),logprobs:Xe,providerMetadata:He})})})})}var Bm=class{constructor(e){this.object=e.object,this.finishReason=e.finishReason,this.usage=e.usage,this.warnings=e.warnings,this.providerMetadata=e.providerMetadata,this.experimental_providerMetadata=e.providerMetadata,this.response=e.response,this.request=e.request,this.logprobs=e.logprobs;}toJsonResponse(e){var t;return new Response(JSON.stringify(this.object),{status:(t=e==null?void 0:e.status)!=null?t:200,headers:nn(e==null?void 0:e.headers,{contentType:"application/json; charset=utf-8"})})}},Ue=class{constructor(){this.status={type:"pending"},this._resolve=void 0,this._reject=void 0;}get value(){return this.promise?this.promise:(this.promise=new Promise((e,t)=>{this.status.type==="resolved"?e(this.status.value):this.status.type==="rejected"&&t(this.status.error),this._resolve=e,this._reject=t;}),this.promise)}resolve(e){var t;this.status={type:"resolved",value:e},this.promise&&((t=this._resolve)==null||t.call(this,e));}reject(e){var t;this.status={type:"rejected",error:e},this.promise&&((t=this._reject)==null||t.call(this,e));}};function Jl(){let e,t;return {promise:new Promise((n,o)=>{e=n,t=o;}),resolve:e,reject:t}}function Iu(){let e=[],t=null,r=false,n=Jl(),o=()=>A(null,null,function*(){if(r&&e.length===0){t==null||t.close();return}if(e.length===0)return n=Jl(),yield n.promise,o();try{let{value:a,done:l}=yield e[0].read();l?(e.shift(),e.length>0?yield o():r&&(t==null||t.close())):t==null||t.enqueue(a);}catch(a){t==null||t.error(a),e.shift(),r&&e.length===0&&(t==null||t.close());}});return {stream:new ReadableStream({start(a){t=a;},pull:o,cancel(){return A(this,null,function*(){for(let a of e)yield a.cancel();e=[],r=true;})}}),addStream:a=>{if(r)throw new Error("Cannot add inner stream: outer stream is closed");e.push(a.getReader()),n.resolve();},close:()=>{r=true,n.resolve(),e.length===0&&(t==null||t.close());},terminate:()=>{r=true,n.resolve(),e.forEach(a=>a.cancel()),e=[],t==null||t.close();}}}function ku(){var e,t;return (t=(e=globalThis==null?void 0:globalThis.performance)==null?void 0:e.now())!=null?t:Date.now()}var zm=wt({prefix:"aiobj",size:24});function Yo(F){var O=F,{model:e,schema:t,schemaName:r,schemaDescription:n,mode:o,output:s="object",system:a,prompt:l,messages:u,maxRetries:p,abortSignal:f,headers:m,experimental_telemetry:y,experimental_providerMetadata:v,providerOptions:x=v,onError:S,onFinish:_,_internal:{generateId:I=zm,currentDate:R=()=>new Date,now:T=ku}={}}=O,N=qe(O,["model","schema","schemaName","schemaDescription","mode","output","system","prompt","messages","maxRetries","abortSignal","headers","experimental_telemetry","experimental_providerMetadata","providerOptions","onError","onFinish","_internal"]);Tu({output:s,mode:o,schema:t,schemaName:r,schemaDescription:n});let Y=Su({output:s,schema:t});return Y.type==="no-schema"&&o===void 0&&(o="json"),new Lm({model:e,telemetry:y,headers:m,settings:N,maxRetries:p,abortSignal:f,outputStrategy:Y,system:a,prompt:l,messages:u,schemaName:r,schemaDescription:n,providerOptions:x,mode:o,onError:S,onFinish:_,generateId:I,currentDate:R,now:T})}var Lm=class{constructor({model:e,headers:t,telemetry:r,settings:n,maxRetries:o,abortSignal:s,outputStrategy:a,system:l,prompt:u,messages:p,schemaName:f,schemaDescription:m,providerOptions:y,mode:v,onError:x,onFinish:S,generateId:_,currentDate:I,now:R}){this.objectPromise=new Ue,this.usagePromise=new Ue,this.providerMetadataPromise=new Ue,this.warningsPromise=new Ue,this.requestPromise=new Ue,this.responsePromise=new Ue;let{maxRetries:T,retry:N}=Go({maxRetries:o}),F=Ho({model:e,telemetry:r,headers:t,settings:g(d({},n),{maxRetries:T})}),O=Wo(r),Y=this,P=Iu(),q=new TransformStream({transform(oe,ye){ye.enqueue(oe),oe.type==="error"&&(x==null||x({error:oe.error}));}});this.baseStream=P.stream.pipeThrough(q),At({name:"ai.streamObject",attributes:Ce({telemetry:r,attributes:g(d(d({},kt({operationId:"ai.streamObject",telemetry:r})),F),{"ai.prompt":{input:()=>JSON.stringify({system:l,prompt:u,messages:p})},"ai.schema":a.jsonSchema!=null?{input:()=>JSON.stringify(a.jsonSchema)}:void 0,"ai.schema.name":f,"ai.schema.description":m,"ai.settings.output":a.type,"ai.settings.mode":v})}),tracer:O,endWhenDone:!1,fn:oe=>A(this,null,function*(){var ye,ke;(v==="auto"||v==null)&&(v=e.defaultObjectGenerationMode);let Te,he;switch(v){case "json":{let ne=an({prompt:{system:a.jsonSchema==null?Vn({prompt:l}):e.supportsStructuredOutputs?l:Vn({prompt:l,schema:a.jsonSchema}),prompt:u,messages:p},tools:void 0});Te=g(d({mode:{type:"object-json",schema:a.jsonSchema,name:f,description:m}},sn(n)),{inputFormat:ne.type,prompt:yield on({prompt:ne,modelSupportsImageUrls:e.supportsImageUrls,modelSupportsUrl:(ye=e.supportsUrl)==null?void 0:ye.bind(e)}),providerMetadata:y,abortSignal:s,headers:t}),he={transform:(V,se)=>{switch(V.type){case "text-delta":se.enqueue(V.textDelta);break;case "response-metadata":case "finish":case "error":se.enqueue(V);break}}};break}case "tool":{let ne=an({prompt:{system:l,prompt:u,messages:p},tools:void 0});Te=g(d({mode:{type:"object-tool",tool:{type:"function",name:f!=null?f:"json",description:m!=null?m:"Respond with a JSON object.",parameters:a.jsonSchema}}},sn(n)),{inputFormat:ne.type,prompt:yield on({prompt:ne,modelSupportsImageUrls:e.supportsImageUrls,modelSupportsUrl:(ke=e.supportsUrl)==null?void 0:ke.bind(e)}),providerMetadata:y,abortSignal:s,headers:t}),he={transform(V,se){switch(V.type){case "tool-call-delta":se.enqueue(V.argsTextDelta);break;case "response-metadata":case "finish":case "error":se.enqueue(V);break}}};break}case void 0:throw new Error("Model does not have a default object generation mode.");default:{let ne=v;throw new Error(`Unsupported mode: ${ne}`)}}let{result:{stream:le,warnings:Ne,rawResponse:ve,request:Pe},doStreamSpan:de,startTimestampMs:we}=yield N(()=>At({name:"ai.streamObject.doStream",attributes:Ce({telemetry:r,attributes:g(d(d({},kt({operationId:"ai.streamObject.doStream",telemetry:r})),F),{"ai.prompt.format":{input:()=>Te.inputFormat},"ai.prompt.messages":{input:()=>JSON.stringify(Te.prompt)},"ai.settings.mode":v,"gen_ai.system":e.provider,"gen_ai.request.model":e.modelId,"gen_ai.request.frequency_penalty":n.frequencyPenalty,"gen_ai.request.max_tokens":n.maxTokens,"gen_ai.request.presence_penalty":n.presencePenalty,"gen_ai.request.temperature":n.temperature,"gen_ai.request.top_k":n.topK,"gen_ai.request.top_p":n.topP})}),tracer:O,endWhenDone:!1,fn:ne=>A(this,null,function*(){return {startTimestampMs:R(),doStreamSpan:ne,result:yield e.doStream(Te)}})}));Y.requestPromise.resolve(Pe!=null?Pe:{});let X,Q,Xe,He,ct,De="",pe="",ce={id:_(),timestamp:I(),modelId:e.modelId},ge,Ee,K=!0,$e=!0,Je=le.pipeThrough(new TransformStream(he)).pipeThrough(new TransformStream({transform(ne,V){return A(this,null,function*(){var se,be,Fe;if(K){let k=R()-we;K=!1,de.addEvent("ai.stream.firstChunk",{"ai.stream.msToFirstChunk":k}),de.setAttributes({"ai.stream.msToFirstChunk":k});}if(typeof ne=="string"){De+=ne,pe+=ne;let{value:k,state:xe}=Fo(De);if(k!==void 0&&!$n(ge,k)){let Ie=a.validatePartialResult({value:k,textDelta:pe,latestObject:Ee,isFirstDelta:$e,isFinalDelta:xe==="successful-parse"});Ie.success&&!$n(Ee,Ie.value.partial)&&(ge=k,Ee=Ie.value.partial,V.enqueue({type:"object",object:Ee}),V.enqueue({type:"text-delta",textDelta:Ie.value.textDelta}),pe="",$e=!1);}return}switch(ne.type){case "response-metadata":{ce={id:(se=ne.id)!=null?se:ce.id,timestamp:(be=ne.timestamp)!=null?be:ce.timestamp,modelId:(Fe=ne.modelId)!=null?Fe:ce.modelId};break}case "finish":{pe!==""&&V.enqueue({type:"text-delta",textDelta:pe}),Q=ne.finishReason,X=Kt(ne.usage),Xe=ne.providerMetadata,V.enqueue(g(d({},ne),{usage:X,response:ce})),Y.usagePromise.resolve(X),Y.providerMetadataPromise.resolve(Xe),Y.responsePromise.resolve(g(d({},ce),{headers:ve==null?void 0:ve.headers}));let k=a.validateFinalResult(ge,{text:De,response:ce,usage:X});k.success?(He=k.value,Y.objectPromise.resolve(He)):(ct=new Yt({message:"No object generated: response did not match schema.",cause:k.error,text:De,response:ce,usage:X,finishReason:Q}),Y.objectPromise.reject(ct));break}default:{V.enqueue(ne);break}}})},flush(ne){return A(this,null,function*(){try{let V=X!=null?X:{promptTokens:NaN,completionTokens:NaN,totalTokens:NaN};de.setAttributes(Ce({telemetry:r,attributes:{"ai.response.finishReason":Q,"ai.response.object":{output:()=>JSON.stringify(He)},"ai.response.id":ce.id,"ai.response.model":ce.modelId,"ai.response.timestamp":ce.timestamp.toISOString(),"ai.usage.promptTokens":V.promptTokens,"ai.usage.completionTokens":V.completionTokens,"gen_ai.response.finish_reasons":[Q],"gen_ai.response.id":ce.id,"gen_ai.response.model":ce.modelId,"gen_ai.usage.input_tokens":V.promptTokens,"gen_ai.usage.output_tokens":V.completionTokens}})),de.end(),oe.setAttributes(Ce({telemetry:r,attributes:{"ai.usage.promptTokens":V.promptTokens,"ai.usage.completionTokens":V.completionTokens,"ai.response.object":{output:()=>JSON.stringify(He)}}})),yield S==null?void 0:S({usage:V,object:He,error:ct,response:g(d({},ce),{headers:ve==null?void 0:ve.headers}),warnings:Ne,providerMetadata:Xe,experimental_providerMetadata:Xe});}catch(V){ne.enqueue({type:"error",error:V});}finally{oe.end();}})}}));P.addStream(Je);})}).catch(oe=>{P.addStream(new ReadableStream({start(ye){ye.enqueue({type:"error",error:oe}),ye.close();}}));}).finally(()=>{P.close();}),this.outputStrategy=a;}get object(){return this.objectPromise.value}get usage(){return this.usagePromise.value}get experimental_providerMetadata(){return this.providerMetadataPromise.value}get providerMetadata(){return this.providerMetadataPromise.value}get warnings(){return this.warningsPromise.value}get request(){return this.requestPromise.value}get response(){return this.responsePromise.value}get partialObjectStream(){return Nr(this.baseStream.pipeThrough(new TransformStream({transform(e,t){switch(e.type){case "object":t.enqueue(e.object);break;case "text-delta":case "finish":case "error":break;default:{let r=e;throw new Error(`Unsupported chunk type: ${r}`)}}}})))}get elementStream(){return this.outputStrategy.createElementStream(this.baseStream)}get textStream(){return Nr(this.baseStream.pipeThrough(new TransformStream({transform(e,t){switch(e.type){case "text-delta":t.enqueue(e.textDelta);break;case "object":case "finish":case "error":break;default:{let r=e;throw new Error(`Unsupported chunk type: ${r}`)}}}})))}get fullStream(){return Nr(this.baseStream)}pipeTextStreamToResponse(e,t){Ys({response:e,status:t==null?void 0:t.status,statusText:t==null?void 0:t.statusText,headers:Ks(t==null?void 0:t.headers,{contentType:"text/plain; charset=utf-8"}),stream:this.textStream.pipeThrough(new TextEncoderStream)});}toTextStreamResponse(e){var t;return new Response(this.textStream.pipeThrough(new TextEncoderStream),{status:(t=e==null?void 0:e.status)!=null?t:200,headers:nn(e==null?void 0:e.headers,{contentType:"text/plain; charset=utf-8"})})}},Au="AI_NoOutputSpecifiedError",Eu=`vercel.ai.error.${Au}`,Vm=Symbol.for(Eu),Cu,Ru=class extends B{constructor({message:e="No output specified."}={}){super({name:Au,message:e}),this[Cu]=true;}static isInstance(e){return B.hasMarker(e,Eu)}};Cu=Vm;var ju="AI_ToolExecutionError",Ou=`vercel.ai.error.${ju}`,Jm=Symbol.for(Ou),Pu,Mu=class extends B{constructor({toolArgs:e,toolName:t,toolCallId:r,cause:n,message:o=`Error executing tool ${t}: ${rr(n)}`}){super({name:ju,message:o,cause:n}),this[Pu]=true,this.toolArgs=e,this.toolName=t,this.toolCallId=r;}static isInstance(e){return B.hasMarker(e,Ou)}};Pu=Jm;function Zm(e){return e!=null&&Object.keys(e).length>0}function Nu({tools:e,toolChoice:t,activeTools:r}){return Zm(e)?{tools:(r!=null?Object.entries(e).filter(([o])=>r.includes(o)):Object.entries(e)).map(([o,s])=>{let a=s.type;switch(a){case void 0:case "function":return {type:"function",name:o,description:s.description,parameters:Ut(s.parameters).jsonSchema};case "provider-defined":return {type:"provider-defined",name:o,id:s.id,args:s.args};default:{let l=a;throw new Error(`Unsupported tool type: ${l}`)}}}),toolChoice:t==null?{type:"auto"}:typeof t=="string"?{type:t}:{type:"tool",toolName:t.toolName}}:{tools:void 0,toolChoice:void 0}}var Gm=/^([\s\S]*?)(\s+)(\S*)$/;function Du(e){let t=e.match(Gm);return t?{prefix:t[1],whitespace:t[2],suffix:t[3]}:void 0}function Hm(e){let t=Du(e);return t?t.prefix+t.whitespace:e}var Fu="AI_InvalidToolArgumentsError",Uu=`vercel.ai.error.${Fu}`,Wm=Symbol.for(Uu),$u,qu=class extends B{constructor({toolArgs:e,toolName:t,cause:r,message:n=`Invalid arguments for tool ${t}: ${rr(r)}`}){super({name:Fu,message:n,cause:r}),this[$u]=true,this.toolArgs=e,this.toolName=t;}static isInstance(e){return B.hasMarker(e,Uu)}};$u=Wm;var Bu="AI_NoSuchToolError",zu=`vercel.ai.error.${Bu}`,Km=Symbol.for(zu),Lu,Qs=class extends B{constructor({toolName:e,availableTools:t=void 0,message:r=`Model tried to call unavailable tool '${e}'. ${t===void 0?"No tools are available.":`Available tools: ${t.join(", ")}.`}`}){super({name:Bu,message:r}),this[Lu]=true,this.toolName=e,this.availableTools=t;}static isInstance(e){return B.hasMarker(e,zu)}};Lu=Km;var Vu="AI_ToolCallRepairError",Ju=`vercel.ai.error.${Vu}`,Ym=Symbol.for(Ju),Zu,Xm=class extends B{constructor({cause:e,originalError:t,message:r=`Error repairing tool call: ${rr(e)}`}){super({name:Vu,message:r,cause:e}),this[Zu]=true,this.originalError=t;}static isInstance(e){return B.hasMarker(e,Ju)}};Zu=Ym;function Gu(s){return A(this,arguments,function*({toolCall:e,tools:t,repairToolCall:r,system:n,messages:o}){if(t==null)throw new Qs({toolName:e.toolName});try{return yield Zl({toolCall:e,tools:t})}catch(a){if(r==null||!(Qs.isInstance(a)||qu.isInstance(a)))throw a;let l=null;try{l=yield r({toolCall:e,tools:t,parameterSchema:({toolName:u})=>Ut(t[u].parameters).jsonSchema,system:n,messages:o,error:a});}catch(u){throw new Xm({cause:u,originalError:a})}if(l==null)throw a;return yield Zl({toolCall:l,tools:t})}})}function Zl(r){return A(this,arguments,function*({toolCall:e,tools:t}){let n=e.toolName,o=t[n];if(o==null)throw new Qs({toolName:e.toolName,availableTools:Object.keys(t)});let s=Ut(o.parameters),a=e.args.trim()===""?it({value:{},schema:s}):xt({text:e.args,schema:s});if(a.success===false)throw new qu({toolName:n,toolArgs:e.args,cause:a.error});return {type:"tool-call",toolCallId:e.toolCallId,toolName:n,args:a.value}})}function ea(e){let t=e.filter(r=>r.type==="text").map(r=>r.text).join("");return t.length>0?t:void 0}function ta({text:e="",files:t,reasoning:r,tools:n,toolCalls:o,toolResults:s,messageId:a,generateMessageId:l}){let u=[],p=[];return r.length>0&&p.push(...r.map(f=>f.type==="text"?g(d({},f),{type:"reasoning"}):g(d({},f),{type:"redacted-reasoning"}))),t.length>0&&p.push(...t.map(f=>({type:"file",data:f.base64,mimeType:f.mimeType}))),e.length>0&&p.push({type:"text",text:e}),o.length>0&&p.push(...o),p.length>0&&u.push({role:"assistant",content:p,id:a}),s.length>0&&u.push({role:"tool",id:l(),content:s.map(f=>{let m=n[f.toolName];return (m==null?void 0:m.experimental_toToolResultContent)!=null?{type:"tool-result",toolCallId:f.toolCallId,toolName:f.toolName,result:m.experimental_toToolResultContent(f.result),experimental_content:m.experimental_toToolResultContent(f.result)}:{type:"tool-result",toolCallId:f.toolCallId,toolName:f.toolName,result:f.result}})}),u}var Qm=wt({prefix:"aitxt",size:24}),eg=wt({prefix:"msg",size:24});function ln(Y){return A(this,null,function*(){var P=Y,{model:e,tools:t,toolChoice:r,system:n,prompt:o,messages:s,maxRetries:a,abortSignal:l,headers:u,maxSteps:p=1,experimental_generateMessageId:f=eg,experimental_output:m,experimental_continueSteps:y=false,experimental_telemetry:v,experimental_providerMetadata:x,providerOptions:S=x,experimental_activeTools:_,experimental_prepareStep:I,experimental_repairToolCall:R,_internal:{generateId:T=Qm,currentDate:N=()=>new Date}={},onStepFinish:F}=P,O=qe(P,["model","tools","toolChoice","system","prompt","messages","maxRetries","abortSignal","headers","maxSteps","experimental_generateMessageId","experimental_output","experimental_continueSteps","experimental_telemetry","experimental_providerMetadata","providerOptions","experimental_activeTools","experimental_prepareStep","experimental_repairToolCall","_internal","onStepFinish"]);var q;if(p<1)throw new _e({parameter:"maxSteps",value:p,message:"maxSteps must be at least 1"});let{maxRetries:oe,retry:ye}=Go({maxRetries:a}),ke=Ho({model:e,telemetry:v,headers:u,settings:g(d({},O),{maxRetries:oe})}),Te=an({prompt:{system:(q=m==null?void 0:m.injectIntoSystemPrompt({system:n,model:e}))!=null?q:n,prompt:o,messages:s},tools:t}),he=Wo(v);return At({name:"ai.generateText",attributes:Ce({telemetry:v,attributes:g(d(d({},kt({operationId:"ai.generateText",telemetry:v})),ke),{"ai.model.provider":e.provider,"ai.model.id":e.modelId,"ai.prompt":{input:()=>JSON.stringify({system:n,prompt:o,messages:s})},"ai.settings.maxSteps":p})}),tracer:he,fn:le=>A(null,null,function*(){var Ne,ve,Pe,de,we,X,Q,Xe,He,ct,De,pe,ce,ge;let Ee=sn(O),K,$e=[],Je=[],nt=[],ne=0,V=[],se="",be=[],Fe=[],k={completionTokens:0,promptTokens:0,totalTokens:0},xe="initial";do{let Ie=ne===0?Te.type:"messages",We=[...Te.messages,...V],yt=yield I==null?void 0:I({model:e,steps:Fe,maxSteps:p,stepNumber:ne}),ms=(Ne=yt==null?void 0:yt.toolChoice)!=null?Ne:r,Ur=(ve=yt==null?void 0:yt.experimental_activeTools)!=null?ve:_,$t=(Pe=yt==null?void 0:yt.model)!=null?Pe:e,vn=yield on({prompt:{type:Ie,system:Te.system,messages:We},modelSupportsImageUrls:$t.supportsImageUrls,modelSupportsUrl:(de=$t.supportsUrl)==null?void 0:de.bind($t)}),er=d({type:"regular"},Nu({tools:t,toolChoice:ms,activeTools:Ur}));K=yield ye(()=>At({name:"ai.generateText.doGenerate",attributes:Ce({telemetry:v,attributes:g(d(d({},kt({operationId:"ai.generateText.doGenerate",telemetry:v})),ke),{"ai.model.provider":$t.provider,"ai.model.id":$t.modelId,"ai.prompt.format":{input:()=>Ie},"ai.prompt.messages":{input:()=>JSON.stringify(vn)},"ai.prompt.tools":{input:()=>{var at;return (at=er.tools)==null?void 0:at.map(vt=>JSON.stringify(vt))}},"ai.prompt.toolChoice":{input:()=>er.toolChoice!=null?JSON.stringify(er.toolChoice):void 0},"gen_ai.system":$t.provider,"gen_ai.request.model":$t.modelId,"gen_ai.request.frequency_penalty":O.frequencyPenalty,"gen_ai.request.max_tokens":O.maxTokens,"gen_ai.request.presence_penalty":O.presencePenalty,"gen_ai.request.stop_sequences":O.stopSequences,"gen_ai.request.temperature":O.temperature,"gen_ai.request.top_k":O.topK,"gen_ai.request.top_p":O.topP})}),tracer:he,fn:at=>A(null,null,function*(){var vt,_n,go,wn,Rt,$r;let Ke=yield $t.doGenerate(g(d({mode:er},Ee),{inputFormat:Ie,responseFormat:m==null?void 0:m.responseFormat({model:e}),prompt:vn,providerMetadata:S,abortSignal:l,headers:u})),zt={id:(_n=(vt=Ke.response)==null?void 0:vt.id)!=null?_n:T(),timestamp:(wn=(go=Ke.response)==null?void 0:go.timestamp)!=null?wn:N(),modelId:($r=(Rt=Ke.response)==null?void 0:Rt.modelId)!=null?$r:$t.modelId};return at.setAttributes(Ce({telemetry:v,attributes:{"ai.response.finishReason":Ke.finishReason,"ai.response.text":{output:()=>Ke.text},"ai.response.toolCalls":{output:()=>JSON.stringify(Ke.toolCalls)},"ai.response.id":zt.id,"ai.response.model":zt.modelId,"ai.response.timestamp":zt.timestamp.toISOString(),"ai.usage.promptTokens":Ke.usage.promptTokens,"ai.usage.completionTokens":Ke.usage.completionTokens,"gen_ai.response.finish_reasons":[Ke.finishReason],"gen_ai.response.id":zt.id,"gen_ai.response.model":zt.modelId,"gen_ai.usage.input_tokens":Ke.usage.promptTokens,"gen_ai.usage.output_tokens":Ke.usage.completionTokens}})),g(d({},Ke),{response:zt})})})),$e=yield Promise.all(((we=K.toolCalls)!=null?we:[]).map(at=>Gu({toolCall:at,tools:t,repairToolCall:R,system:n,messages:We}))),Je=t==null?[]:yield tg({toolCalls:$e,tools:t,tracer:he,telemetry:v,messages:We,abortSignal:l});let bn=Kt(K.usage);k=xu(k,bn);let qt="done";++ne<p&&(y&&K.finishReason==="length"&&$e.length===0?qt="continue":$e.length>0&&Je.length===$e.length&&(qt="tool-result"));let fr=(X=K.text)!=null?X:"",mo=xe==="continue"&&se.trimEnd()!==se?fr.trimStart():fr,Bt=qt==="continue"?Hm(mo):mo;if(se=qt==="continue"||xe==="continue"?se+Bt:Bt,nt=Gl(K.reasoning),be.push(...(Q=K.sources)!=null?Q:[]),xe==="continue"){let at=V[V.length-1];typeof at.content=="string"?at.content+=Bt:at.content.push({text:Bt,type:"text"});}else V.push(...ta({text:se,files:Ws(K.files),reasoning:Gl(K.reasoning),tools:t!=null?t:{},toolCalls:$e,toolResults:Je,messageId:f(),generateMessageId:f}));let hr={stepType:xe,text:Bt,reasoning:ea(nt),reasoningDetails:nt,files:Ws(K.files),sources:(Xe=K.sources)!=null?Xe:[],toolCalls:$e,toolResults:Je,finishReason:K.finishReason,usage:bn,warnings:K.warnings,logprobs:K.logprobs,request:(He=K.request)!=null?He:{},response:g(d({},K.response),{headers:(ct=K.rawResponse)==null?void 0:ct.headers,body:(De=K.rawResponse)==null?void 0:De.body,messages:structuredClone(V)}),providerMetadata:K.providerMetadata,experimental_providerMetadata:K.providerMetadata,isContinued:qt==="continue"};Fe.push(hr),yield F==null?void 0:F(hr),xe=qt;}while(xe!=="done");return le.setAttributes(Ce({telemetry:v,attributes:{"ai.response.finishReason":K.finishReason,"ai.response.text":{output:()=>K.text},"ai.response.toolCalls":{output:()=>JSON.stringify(K.toolCalls)},"ai.usage.promptTokens":K.usage.promptTokens,"ai.usage.completionTokens":K.usage.completionTokens}})),new rg({text:se,files:Ws(K.files),reasoning:ea(nt),reasoningDetails:nt,sources:be,outputResolver:()=>{if(m==null)throw new Ru;return m.parseOutput({text:se},{response:K.response,usage:k,finishReason:K.finishReason})},toolCalls:$e,toolResults:Je,finishReason:K.finishReason,usage:k,warnings:K.warnings,request:(pe=K.request)!=null?pe:{},response:g(d({},K.response),{headers:(ce=K.rawResponse)==null?void 0:ce.headers,body:(ge=K.rawResponse)==null?void 0:ge.body,messages:V}),logprobs:K.logprobs,steps:Fe,providerMetadata:K.providerMetadata})})})})}function tg(a){return A(this,arguments,function*({toolCalls:e,tools:t,tracer:r,telemetry:n,messages:o,abortSignal:s}){return (yield Promise.all(e.map(m=>A(null,[m],function*({toolCallId:u,toolName:p,args:f}){let y=t[p];if((y==null?void 0:y.execute)==null)return;let v=yield At({name:"ai.toolCall",attributes:Ce({telemetry:n,attributes:g(d({},kt({operationId:"ai.toolCall",telemetry:n})),{"ai.toolCall.name":p,"ai.toolCall.id":u,"ai.toolCall.args":{output:()=>JSON.stringify(f)}})}),tracer:r,fn:x=>A(null,null,function*(){try{let S=yield y.execute(f,{toolCallId:u,messages:o,abortSignal:s});try{x.setAttributes(Ce({telemetry:n,attributes:{"ai.toolCall.result":{output:()=>JSON.stringify(S)}}}));}catch(_){}return S}catch(S){throw new Mu({toolCallId:u,toolName:p,toolArgs:f,cause:S})}})});return {type:"tool-result",toolCallId:u,toolName:p,args:f,result:v}})))).filter(u=>u!=null)})}var rg=class{constructor(e){this.text=e.text,this.files=e.files,this.reasoning=e.reasoning,this.reasoningDetails=e.reasoningDetails,this.toolCalls=e.toolCalls,this.toolResults=e.toolResults,this.finishReason=e.finishReason,this.usage=e.usage,this.warnings=e.warnings,this.request=e.request,this.response=e.response,this.steps=e.steps,this.experimental_providerMetadata=e.providerMetadata,this.providerMetadata=e.providerMetadata,this.logprobs=e.logprobs,this.outputResolver=e.outputResolver,this.sources=e.sources;}get experimental_output(){return this.outputResolver()}};function Gl(e){return e==null?[]:typeof e=="string"?[{type:"text",text:e}]:e}function Ws(e){var t;return (t=e==null?void 0:e.map(r=>new ru(r)))!=null?t:[]}var ng={};ra(ng,{object:()=>cg,text:()=>pg});var Hu="AI_InvalidStreamPartError",Wu=`vercel.ai.error.${Hu}`,og=Symbol.for(Wu),Ku,sg=class extends B{constructor({chunk:e,message:t}){super({name:Hu,message:t}),this[Ku]=true,this.chunk=e;}static isInstance(e){return B.hasMarker(e,Wu)}};Ku=og;var pg=()=>({type:"text",responseFormat:()=>({type:"text"}),injectIntoSystemPrompt({system:e}){return e},parsePartial({text:e}){return {partial:e}},parseOutput({text:e}){return e}}),cg=({schema:e})=>{let t=Ut(e);return {type:"object",responseFormat:({model:r})=>({type:"json",schema:r.supportsStructuredOutputs?t.jsonSchema:void 0}),injectIntoSystemPrompt({system:r,model:n}){return n.supportsStructuredOutputs?r:Vn({prompt:r,schema:t.jsonSchema})},parsePartial({text:r}){let n=Fo(r);switch(n.state){case "failed-parse":case "undefined-input":return;case "repaired-parse":case "successful-parse":return {partial:n.value};default:{let o=n.state;throw new Error(`Unsupported parse state: ${o}`)}}},parseOutput({text:r},n){let o=xt({text:r});if(!o.success)throw new Yt({message:"No object generated: could not parse the response.",cause:o.error,text:r,response:n.response,usage:n.usage,finishReason:n.finishReason});let s=it({value:o.value,schema:t});if(!s.success)throw new Yt({message:"No object generated: response did not match schema.",cause:s.error,text:r,response:n.response,usage:n.usage,finishReason:n.finishReason});return s.value}}};function dg(e){return e===void 0?[]:Array.isArray(e)?e:[e]}function fg(r){return A(this,arguments,function*({stream:e,onError:t}){let n=e.getReader();try{for(;;){let{done:o}=yield n.read();if(o)break}}catch(o){t==null||t(o);}finally{n.releaseLock();}})}function na(e,t){let r=e.getReader(),n=t.getReader(),o,s,a=false,l=false;function u(m){return A(this,null,function*(){try{o==null&&(o=r.read());let y=yield o;o=void 0,y.done?m.close():m.enqueue(y.value);}catch(y){m.error(y);}})}function p(m){return A(this,null,function*(){try{s==null&&(s=n.read());let y=yield s;s=void 0,y.done?m.close():m.enqueue(y.value);}catch(y){m.error(y);}})}return new ReadableStream({pull(m){return A(this,null,function*(){try{if(a){yield p(m);return}if(l){yield u(m);return}o==null&&(o=r.read()),s==null&&(s=n.read());let{result:y,reader:v}=yield Promise.race([o.then(x=>({result:x,reader:r})),s.then(x=>({result:x,reader:n}))]);y.done||m.enqueue(y.value),v===r?(o=void 0,y.done&&(yield p(m),a=!0)):(s=void 0,y.done&&(l=!0,yield u(m)));}catch(y){m.error(y);}})},cancel(){r.cancel(),n.cancel();}})}function hg({tools:e,generatorStream:t,toolCallStreaming:r,tracer:n,telemetry:o,system:s,messages:a,abortSignal:l,repairToolCall:u}){let p=null,f=new ReadableStream({start(T){p=T;}}),m={},y=new Set,v=false,x;function S(){v&&y.size===0&&(x!=null&&p.enqueue(x),p.close());}let _=new TransformStream({transform(T,N){return A(this,null,function*(){let F=T.type;switch(F){case "text-delta":case "reasoning":case "reasoning-signature":case "redacted-reasoning":case "source":case "response-metadata":case "error":{N.enqueue(T);break}case "file":{N.enqueue(new rm({data:T.data,mimeType:T.mimeType}));break}case "tool-call-delta":{r&&(m[T.toolCallId]||(N.enqueue({type:"tool-call-streaming-start",toolCallId:T.toolCallId,toolName:T.toolName}),m[T.toolCallId]=true),N.enqueue({type:"tool-call-delta",toolCallId:T.toolCallId,toolName:T.toolName,argsTextDelta:T.argsTextDelta}));break}case "tool-call":{try{let O=yield Gu({toolCall:T,tools:e,repairToolCall:u,system:s,messages:a});N.enqueue(O);let Y=e[O.toolName];if(Y.execute!=null){let P=ft();y.add(P),At({name:"ai.toolCall",attributes:Ce({telemetry:o,attributes:g(d({},kt({operationId:"ai.toolCall",telemetry:o})),{"ai.toolCall.name":O.toolName,"ai.toolCall.id":O.toolCallId,"ai.toolCall.args":{output:()=>JSON.stringify(O.args)}})}),tracer:n,fn:q=>A(null,null,function*(){return Y.execute(O.args,{toolCallId:O.toolCallId,messages:a,abortSignal:l}).then(oe=>{p.enqueue(g(d({},O),{type:"tool-result",result:oe})),y.delete(P),S();try{q.setAttributes(Ce({telemetry:o,attributes:{"ai.toolCall.result":{output:()=>JSON.stringify(oe)}}}));}catch(ye){}},oe=>{p.enqueue({type:"error",error:new Mu({toolCallId:O.toolCallId,toolName:O.toolName,toolArgs:O.args,cause:oe})}),y.delete(P),S();})})});}}catch(O){p.enqueue({type:"error",error:O});}break}case "finish":{x={type:"finish",finishReason:T.finishReason,logprobs:T.logprobs,usage:Kt(T.usage),experimental_providerMetadata:T.providerMetadata};break}default:{let O=F;throw new Error(`Unhandled chunk type: ${O}`)}}})},flush(){v=true,S();}});return new ReadableStream({start(T){return A(this,null,function*(){return Promise.all([t.pipeThrough(_).pipeTo(new WritableStream({write(N){T.enqueue(N);},close(){}})),f.pipeTo(new WritableStream({write(N){T.enqueue(N);},close(){T.close();}}))])})}})}var mg=wt({prefix:"aitxt",size:24}),gg=wt({prefix:"msg",size:24});function un(Te){var he=Te,{model:e,tools:t,toolChoice:r,system:n,prompt:o,messages:s,maxRetries:a,abortSignal:l,headers:u,maxSteps:p=1,experimental_generateMessageId:f=gg,experimental_output:m,experimental_continueSteps:y=false,experimental_telemetry:v,experimental_providerMetadata:x,providerOptions:S=x,experimental_toolCallStreaming:_=false,toolCallStreaming:I=_,experimental_activeTools:R,experimental_repairToolCall:T,experimental_transform:N,onChunk:F,onError:O,onFinish:Y,onStepFinish:P,_internal:{now:q=ku,generateId:oe=mg,currentDate:ye=()=>new Date}={}}=he,ke=qe(he,["model","tools","toolChoice","system","prompt","messages","maxRetries","abortSignal","headers","maxSteps","experimental_generateMessageId","experimental_output","experimental_continueSteps","experimental_telemetry","experimental_providerMetadata","providerOptions","experimental_toolCallStreaming","toolCallStreaming","experimental_activeTools","experimental_repairToolCall","experimental_transform","onChunk","onError","onFinish","onStepFinish","_internal"]);return new vg({model:e,telemetry:v,headers:u,settings:ke,maxRetries:a,abortSignal:l,system:n,prompt:o,messages:s,tools:t,toolChoice:r,toolCallStreaming:I,transforms:dg(N),activeTools:R,repairToolCall:T,maxSteps:p,output:m,continueSteps:y,providerOptions:S,onChunk:F,onError:O,onFinish:Y,onStepFinish:P,now:q,currentDate:ye,generateId:oe,generateMessageId:f})}function yg(e){if(!e)return new TransformStream({transform(s,a){a.enqueue({part:s,partialOutput:void 0});}});let t="",r="",n="";function o({controller:s,partialOutput:a=void 0}){s.enqueue({part:{type:"text-delta",textDelta:r},partialOutput:a}),r="";}return new TransformStream({transform(s,a){if(s.type==="step-finish"&&o({controller:a}),s.type!=="text-delta"){a.enqueue({part:s,partialOutput:void 0});return}t+=s.textDelta,r+=s.textDelta;let l=e.parsePartial({text:t});if(l!=null){let u=JSON.stringify(l.partial);u!==n&&(o({controller:a,partialOutput:l.partial}),n=u);}},flush(s){r.length>0&&o({controller:s});}})}var vg=class{constructor({model:e,telemetry:t,headers:r,settings:n,maxRetries:o,abortSignal:s,system:a,prompt:l,messages:u,tools:p,toolChoice:f,toolCallStreaming:m,transforms:y,activeTools:v,repairToolCall:x,maxSteps:S,output:_,continueSteps:I,providerOptions:R,now:T,currentDate:N,generateId:F,generateMessageId:O,onChunk:Y,onError:P,onFinish:q,onStepFinish:oe}){this.warningsPromise=new Ue,this.usagePromise=new Ue,this.finishReasonPromise=new Ue,this.providerMetadataPromise=new Ue,this.textPromise=new Ue,this.reasoningPromise=new Ue,this.reasoningDetailsPromise=new Ue,this.sourcesPromise=new Ue,this.filesPromise=new Ue,this.toolCallsPromise=new Ue,this.toolResultsPromise=new Ue,this.requestPromise=new Ue,this.responsePromise=new Ue,this.stepsPromise=new Ue;var ye;if(S<1)throw new _e({parameter:"maxSteps",value:S,message:"maxSteps must be at least 1"});this.output=_;let ke="",Te="",he="",le=[],Ne=[],ve,Pe=[],de=[],we={id:F(),timestamp:N(),modelId:e.modelId,messages:[]},X=[],Q=[],Xe,He,ct="initial",De=[],pe,ce=new TransformStream({transform(be,Fe){return A(this,null,function*(){Fe.enqueue(be);let{part:k}=be;if((k.type==="text-delta"||k.type==="reasoning"||k.type==="source"||k.type==="tool-call"||k.type==="tool-result"||k.type==="tool-call-streaming-start"||k.type==="tool-call-delta")&&(yield Y==null?void 0:Y({chunk:k})),k.type==="error"&&(yield P==null?void 0:P({error:k.error})),k.type==="text-delta"&&(ke+=k.textDelta,Te+=k.textDelta,he+=k.textDelta),k.type==="reasoning"&&(ve==null?(ve={type:"text",text:k.textDelta},le.push(ve)):ve.text+=k.textDelta),k.type==="reasoning-signature"){if(ve==null)throw new B({name:"InvalidStreamPart",message:"reasoning-signature without reasoning"});ve.signature=k.signature,ve=void 0;}if(k.type==="redacted-reasoning"&&le.push({type:"redacted",data:k.data}),k.type==="file"&&Ne.push(k),k.type==="source"&&(de.push(k.source),Pe.push(k.source)),k.type==="tool-call"&&X.push(k),k.type==="tool-result"&&Q.push(k),k.type==="step-finish"){let xe=ta({text:Te,files:Ne,reasoning:le,tools:p!=null?p:{},toolCalls:X,toolResults:Q,messageId:k.messageId,generateMessageId:O}),Ie=De.length,We="done";Ie+1<S&&(I&&k.finishReason==="length"&&X.length===0?We="continue":X.length>0&&Q.length===X.length&&(We="tool-result"));let yt={stepType:ct,text:ke,reasoning:ea(le),reasoningDetails:le,files:Ne,sources:Pe,toolCalls:X,toolResults:Q,finishReason:k.finishReason,usage:k.usage,warnings:k.warnings,logprobs:k.logprobs,request:k.request,response:g(d({},k.response),{messages:[...we.messages,...xe]}),providerMetadata:k.experimental_providerMetadata,experimental_providerMetadata:k.experimental_providerMetadata,isContinued:k.isContinued};yield oe==null?void 0:oe(yt),De.push(yt),X=[],Q=[],ke="",Pe=[],le=[],Ne=[],ve=void 0,We!=="done"&&(ct=We),We!=="continue"&&(we.messages.push(...xe),Te="");}k.type==="finish"&&(we.id=k.response.id,we.timestamp=k.response.timestamp,we.modelId=k.response.modelId,we.headers=k.response.headers,He=k.usage,Xe=k.finishReason);})},flush(be){return A(this,null,function*(){var Fe;try{if(De.length===0)return;let k=De[De.length-1];V.warningsPromise.resolve(k.warnings),V.requestPromise.resolve(k.request),V.responsePromise.resolve(k.response),V.toolCallsPromise.resolve(k.toolCalls),V.toolResultsPromise.resolve(k.toolResults),V.providerMetadataPromise.resolve(k.experimental_providerMetadata),V.reasoningPromise.resolve(k.reasoning),V.reasoningDetailsPromise.resolve(k.reasoningDetails);let xe=Xe!=null?Xe:"unknown",Ie=He!=null?He:{completionTokens:NaN,promptTokens:NaN,totalTokens:NaN};V.finishReasonPromise.resolve(xe),V.usagePromise.resolve(Ie),V.textPromise.resolve(he),V.sourcesPromise.resolve(de),V.filesPromise.resolve(k.files),V.stepsPromise.resolve(De),yield q==null?void 0:q({finishReason:xe,logprobs:void 0,usage:Ie,text:he,reasoning:k.reasoning,reasoningDetails:k.reasoningDetails,files:k.files,sources:k.sources,toolCalls:k.toolCalls,toolResults:k.toolResults,request:(Fe=k.request)!=null?Fe:{},response:k.response,warnings:k.warnings,providerMetadata:k.providerMetadata,experimental_providerMetadata:k.experimental_providerMetadata,steps:De}),pe.setAttributes(Ce({telemetry:t,attributes:{"ai.response.finishReason":xe,"ai.response.text":{output:()=>he},"ai.response.toolCalls":{output:()=>{var We;return (We=k.toolCalls)!=null&&We.length?JSON.stringify(k.toolCalls):void 0}},"ai.usage.promptTokens":Ie.promptTokens,"ai.usage.completionTokens":Ie.completionTokens}}));}catch(k){be.error(k);}finally{pe.end();}})}}),ge=Iu();this.addStream=ge.addStream,this.closeStream=ge.close;let Ee=ge.stream;for(let be of y)Ee=Ee.pipeThrough(be({tools:p,stopStream(){ge.terminate();}}));this.baseStream=Ee.pipeThrough(yg(_)).pipeThrough(ce);let{maxRetries:K,retry:$e}=Go({maxRetries:o}),Je=Wo(t),nt=Ho({model:e,telemetry:t,headers:r,settings:g(d({},n),{maxRetries:K})}),ne=an({prompt:{system:(ye=_==null?void 0:_.injectIntoSystemPrompt({system:a,model:e}))!=null?ye:a,prompt:l,messages:u},tools:p}),V=this;At({name:"ai.streamText",attributes:Ce({telemetry:t,attributes:g(d(d({},kt({operationId:"ai.streamText",telemetry:t})),nt),{"ai.prompt":{input:()=>JSON.stringify({system:a,prompt:l,messages:u})},"ai.settings.maxSteps":S})}),tracer:Je,endWhenDone:!1,fn:be=>A(this,null,function*(){pe=be;function Fe($t){return A(this,arguments,function*({currentStep:k,responseMessages:xe,usage:Ie,stepType:We,previousStepText:yt,hasLeadingWhitespace:ms,messageId:Ur}){var vn;let er=xe.length===0?ne.type:"messages",bn=[...ne.messages,...xe],qt=yield on({prompt:{type:er,system:ne.system,messages:bn},modelSupportsImageUrls:e.supportsImageUrls,modelSupportsUrl:(vn=e.supportsUrl)==null?void 0:vn.bind(e)}),fr=d({type:"regular"},Nu({tools:p,toolChoice:f,activeTools:v})),{result:{stream:mo,warnings:Bt,rawResponse:hr,request:at},doStreamSpan:vt,startTimestampMs:_n}=yield $e(()=>At({name:"ai.streamText.doStream",attributes:Ce({telemetry:t,attributes:g(d(d({},kt({operationId:"ai.streamText.doStream",telemetry:t})),nt),{"ai.prompt.format":{input:()=>er},"ai.prompt.messages":{input:()=>JSON.stringify(qt)},"ai.prompt.tools":{input:()=>{var re;return (re=fr.tools)==null?void 0:re.map(Me=>JSON.stringify(Me))}},"ai.prompt.toolChoice":{input:()=>fr.toolChoice!=null?JSON.stringify(fr.toolChoice):void 0},"gen_ai.system":e.provider,"gen_ai.request.model":e.modelId,"gen_ai.request.frequency_penalty":n.frequencyPenalty,"gen_ai.request.max_tokens":n.maxTokens,"gen_ai.request.presence_penalty":n.presencePenalty,"gen_ai.request.stop_sequences":n.stopSequences,"gen_ai.request.temperature":n.temperature,"gen_ai.request.top_k":n.topK,"gen_ai.request.top_p":n.topP})}),tracer:Je,endWhenDone:!1,fn:re=>A(null,null,function*(){return {startTimestampMs:T(),doStreamSpan:re,result:yield e.doStream(g(d({mode:fr},sn(n)),{inputFormat:er,responseFormat:_==null?void 0:_.responseFormat({model:e}),prompt:qt,providerMetadata:R,abortSignal:s,headers:r}))}})})),go=hg({tools:p,generatorStream:mo,toolCallStreaming:m,tracer:Je,telemetry:t,system:a,messages:bn,repairToolCall:x,abortSignal:s}),wn=at!=null?at:{},Rt=[],$r=[],Ke=[],zt=[],mr,gr="unknown",tr={promptTokens:0,completionTokens:0,totalTokens:0},xn,Sa=!0,Sn="",Ta=We==="continue"?yt:"",gs,bt={id:F(),timestamp:N(),modelId:e.modelId},qr="",Ia=!1,ka=!0,Aa=!1;function ys(jt){return A(this,arguments,function*({controller:re,chunk:Me}){re.enqueue(Me),Sn+=Me.textDelta,Ta+=Me.textDelta,Ia=!0,Aa=Me.textDelta.trimEnd()!==Me.textDelta;})}V.addStream(go.pipeThrough(new TransformStream({transform(re,Me){return A(this,null,function*(){var jt,Tn,yr;if(Sa){let Ot=T()-_n;Sa=!1,vt.addEvent("ai.stream.firstChunk",{"ai.response.msToFirstChunk":Ot}),vt.setAttributes({"ai.response.msToFirstChunk":Ot}),Me.enqueue({type:"step-start",messageId:Ur,request:wn,warnings:Bt!=null?Bt:[]});}if(re.type==="text-delta"&&re.textDelta.length===0)return;let Ea=re.type;switch(Ea){case "text-delta":{if(I){let Ot=ka&&ms?re.textDelta.trimStart():re.textDelta;if(Ot.length===0)break;ka=!1,qr+=Ot;let yo=Du(qr);yo!=null&&(qr=yo.suffix,yield ys({controller:Me,chunk:{type:"text-delta",textDelta:yo.prefix+yo.whitespace}}));}else yield ys({controller:Me,chunk:re});break}case "reasoning":{Me.enqueue(re),mr==null?(mr={type:"text",text:re.textDelta},Ke.push(mr)):mr.text+=re.textDelta;break}case "reasoning-signature":{if(Me.enqueue(re),mr==null)throw new sg({chunk:re,message:"reasoning-signature without reasoning"});mr.signature=re.signature,mr=void 0;break}case "redacted-reasoning":{Me.enqueue(re),Ke.push({type:"redacted",data:re.data});break}case "tool-call":{Me.enqueue(re),Rt.push(re);break}case "tool-result":{Me.enqueue(re),$r.push(re);break}case "response-metadata":{bt={id:(jt=re.id)!=null?jt:bt.id,timestamp:(Tn=re.timestamp)!=null?Tn:bt.timestamp,modelId:(yr=re.modelId)!=null?yr:bt.modelId};break}case "finish":{tr=re.usage,gr=re.finishReason,xn=re.experimental_providerMetadata,gs=re.logprobs;let Ot=T()-_n;vt.addEvent("ai.stream.finish"),vt.setAttributes({"ai.response.msToFinish":Ot,"ai.response.avgCompletionTokensPerSecond":1e3*tr.completionTokens/Ot});break}case "file":{zt.push(re),Me.enqueue(re);break}case "source":case "tool-call-streaming-start":case "tool-call-delta":{Me.enqueue(re);break}case "error":{Me.enqueue(re),gr="error";break}default:{let Ot=Ea;throw new Error(`Unknown chunk type: ${Ot}`)}}})},flush(re){return A(this,null,function*(){let Me=Rt.length>0?JSON.stringify(Rt):void 0,jt="done";k+1<S&&(I&&gr==="length"&&Rt.length===0?jt="continue":Rt.length>0&&$r.length===Rt.length&&(jt="tool-result")),I&&qr.length>0&&(jt!=="continue"||We==="continue"&&!Ia)&&(yield ys({controller:re,chunk:{type:"text-delta",textDelta:qr}}),qr="");try{vt.setAttributes(Ce({telemetry:t,attributes:{"ai.response.finishReason":gr,"ai.response.text":{output:()=>Sn},"ai.response.toolCalls":{output:()=>Me},"ai.response.id":bt.id,"ai.response.model":bt.modelId,"ai.response.timestamp":bt.timestamp.toISOString(),"ai.usage.promptTokens":tr.promptTokens,"ai.usage.completionTokens":tr.completionTokens,"gen_ai.response.finish_reasons":[gr],"gen_ai.response.id":bt.id,"gen_ai.response.model":bt.modelId,"gen_ai.usage.input_tokens":tr.promptTokens,"gen_ai.usage.output_tokens":tr.completionTokens}}));}catch(yr){}finally{vt.end();}re.enqueue({type:"step-finish",finishReason:gr,usage:tr,providerMetadata:xn,experimental_providerMetadata:xn,logprobs:gs,request:wn,response:g(d({},bt),{headers:hr==null?void 0:hr.headers}),warnings:Bt,isContinued:jt==="continue",messageId:Ur});let Tn=xu(Ie,tr);if(jt==="done")re.enqueue({type:"finish",finishReason:gr,usage:Tn,providerMetadata:xn,experimental_providerMetadata:xn,logprobs:gs,response:g(d({},bt),{headers:hr==null?void 0:hr.headers})}),V.closeStream();else {if(We==="continue"){let yr=xe[xe.length-1];typeof yr.content=="string"?yr.content+=Sn:yr.content.push({text:Sn,type:"text"});}else xe.push(...ta({text:Sn,files:zt,reasoning:Ke,tools:p!=null?p:{},toolCalls:Rt,toolResults:$r,messageId:Ur,generateMessageId:O}));yield Fe({currentStep:k+1,responseMessages:xe,usage:Tn,stepType:jt,previousStepText:Ta,hasLeadingWhitespace:Aa,messageId:jt==="continue"?Ur:O()});}})}})));})}yield Fe({currentStep:0,responseMessages:[],usage:{promptTokens:0,completionTokens:0,totalTokens:0},previousStepText:"",stepType:"initial",hasLeadingWhitespace:!1,messageId:O()});})}).catch(be=>{V.addStream(new ReadableStream({start(Fe){Fe.enqueue({type:"error",error:be}),Fe.close();}})),V.closeStream();});}get warnings(){return this.warningsPromise.value}get usage(){return this.usagePromise.value}get finishReason(){return this.finishReasonPromise.value}get experimental_providerMetadata(){return this.providerMetadataPromise.value}get providerMetadata(){return this.providerMetadataPromise.value}get text(){return this.textPromise.value}get reasoning(){return this.reasoningPromise.value}get reasoningDetails(){return this.reasoningDetailsPromise.value}get sources(){return this.sourcesPromise.value}get files(){return this.filesPromise.value}get toolCalls(){return this.toolCallsPromise.value}get toolResults(){return this.toolResultsPromise.value}get request(){return this.requestPromise.value}get response(){return this.responsePromise.value}get steps(){return this.stepsPromise.value}teeStream(){let[e,t]=this.baseStream.tee();return this.baseStream=t,e}get textStream(){return Nr(this.teeStream().pipeThrough(new TransformStream({transform({part:e},t){e.type==="text-delta"&&t.enqueue(e.textDelta);}})))}get fullStream(){return Nr(this.teeStream().pipeThrough(new TransformStream({transform({part:e},t){t.enqueue(e);}})))}consumeStream(e){return A(this,null,function*(){var t;try{yield fg({stream:this.fullStream,onError:e==null?void 0:e.onError});}catch(r){(t=e==null?void 0:e.onError)==null||t.call(e,r);}})}get experimental_partialOutputStream(){if(this.output==null)throw new Ru;return Nr(this.teeStream().pipeThrough(new TransformStream({transform({partialOutput:e},t){e!=null&&t.enqueue(e);}})))}toDataStreamInternal({getErrorMessage:e=()=>"An error occurred.",sendUsage:t=true,sendReasoning:r=false,sendSources:n=false,experimental_sendFinish:o=true}){return this.fullStream.pipeThrough(new TransformStream({transform:(s,a)=>A(this,null,function*(){let l=s.type;switch(l){case "text-delta":{a.enqueue(ze("text",s.textDelta));break}case "reasoning":{r&&a.enqueue(ze("reasoning",s.textDelta));break}case "redacted-reasoning":{r&&a.enqueue(ze("redacted_reasoning",{data:s.data}));break}case "reasoning-signature":{r&&a.enqueue(ze("reasoning_signature",{signature:s.signature}));break}case "file":{a.enqueue(ze("file",{mimeType:s.mimeType,data:s.base64}));break}case "source":{n&&a.enqueue(ze("source",s.source));break}case "tool-call-streaming-start":{a.enqueue(ze("tool_call_streaming_start",{toolCallId:s.toolCallId,toolName:s.toolName}));break}case "tool-call-delta":{a.enqueue(ze("tool_call_delta",{toolCallId:s.toolCallId,argsTextDelta:s.argsTextDelta}));break}case "tool-call":{a.enqueue(ze("tool_call",{toolCallId:s.toolCallId,toolName:s.toolName,args:s.args}));break}case "tool-result":{a.enqueue(ze("tool_result",{toolCallId:s.toolCallId,result:s.result}));break}case "error":{a.enqueue(ze("error",e(s.error)));break}case "step-start":{a.enqueue(ze("start_step",{messageId:s.messageId}));break}case "step-finish":{a.enqueue(ze("finish_step",{finishReason:s.finishReason,usage:t?{promptTokens:s.usage.promptTokens,completionTokens:s.usage.completionTokens}:void 0,isContinued:s.isContinued}));break}case "finish":{o&&a.enqueue(ze("finish_message",{finishReason:s.finishReason,usage:t?{promptTokens:s.usage.promptTokens,completionTokens:s.usage.completionTokens}:void 0}));break}default:{let u=l;throw new Error(`Unknown chunk type: ${u}`)}}})}))}pipeDataStreamToResponse(e,{status:t,statusText:r,headers:n,data:o,getErrorMessage:s,sendUsage:a,sendReasoning:l,sendSources:u,experimental_sendFinish:p}={}){Ys({response:e,status:t,statusText:r,headers:Ks(n,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"}),stream:this.toDataStream({data:o,getErrorMessage:s,sendUsage:a,sendReasoning:l,sendSources:u,experimental_sendFinish:p})});}pipeTextStreamToResponse(e,t){Ys({response:e,status:t==null?void 0:t.status,statusText:t==null?void 0:t.statusText,headers:Ks(t==null?void 0:t.headers,{contentType:"text/plain; charset=utf-8"}),stream:this.textStream.pipeThrough(new TextEncoderStream)});}toDataStream(e){let t=this.toDataStreamInternal({getErrorMessage:e==null?void 0:e.getErrorMessage,sendUsage:e==null?void 0:e.sendUsage,sendReasoning:e==null?void 0:e.sendReasoning,sendSources:e==null?void 0:e.sendSources,experimental_sendFinish:e==null?void 0:e.experimental_sendFinish}).pipeThrough(new TextEncoderStream);return e!=null&&e.data?na(e==null?void 0:e.data.stream,t):t}mergeIntoDataStream(e,t){e.merge(this.toDataStreamInternal({getErrorMessage:e.onError,sendUsage:t==null?void 0:t.sendUsage,sendReasoning:t==null?void 0:t.sendReasoning,sendSources:t==null?void 0:t.sendSources,experimental_sendFinish:t==null?void 0:t.experimental_sendFinish}));}toDataStreamResponse({headers:e,status:t,statusText:r,data:n,getErrorMessage:o,sendUsage:s,sendReasoning:a,sendSources:l,experimental_sendFinish:u}={}){return new Response(this.toDataStream({data:n,getErrorMessage:o,sendUsage:s,sendReasoning:a,sendSources:l,experimental_sendFinish:u}),{status:t,statusText:r,headers:nn(e,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}toTextStreamResponse(e){var t;return new Response(this.textStream.pipeThrough(new TextEncoderStream),{status:(t=e==null?void 0:e.status)!=null?t:200,headers:nn(e==null?void 0:e.headers,{contentType:"text/plain; charset=utf-8"})})}};var Sg=i.object({name:i.string(),version:i.string()}).passthrough(),oa=i.object({_meta:i.optional(i.object({}).passthrough())}).passthrough(),Jn=oa,Tg=i.object({method:i.string(),params:i.optional(oa)}),Ig=i.object({experimental:i.optional(i.object({}).passthrough()),logging:i.optional(i.object({}).passthrough()),prompts:i.optional(i.object({listChanged:i.optional(i.boolean())}).passthrough()),resources:i.optional(i.object({subscribe:i.optional(i.boolean()),listChanged:i.optional(i.boolean())}).passthrough()),tools:i.optional(i.object({listChanged:i.optional(i.boolean())}).passthrough())}).passthrough();Jn.extend({protocolVersion:i.string(),capabilities:Ig,serverInfo:Sg,instructions:i.optional(i.string())});var kg=Jn.extend({nextCursor:i.optional(i.string())}),Ag=i.object({name:i.string(),description:i.optional(i.string()),inputSchema:i.object({type:i.literal("object"),properties:i.optional(i.object({}).passthrough())}).passthrough()}).passthrough();kg.extend({tools:i.array(Ag)});var Eg=i.object({type:i.literal("text"),text:i.string()}).passthrough(),Cg=i.object({type:i.literal("image"),data:i.string().base64(),mimeType:i.string()}).passthrough(),Yu=i.object({uri:i.string(),mimeType:i.optional(i.string())}).passthrough(),Rg=Yu.extend({text:i.string()}),jg=Yu.extend({blob:i.string().base64()}),Og=i.object({type:i.literal("resource"),resource:i.union([Rg,jg])}).passthrough();Jn.extend({content:i.array(i.union([Eg,Cg,Og])),isError:i.boolean().default(false).optional()}).or(Jn.extend({toolResult:i.unknown()}));var Xo="2.0",Pg=i.object({jsonrpc:i.literal(Xo),id:i.union([i.string(),i.number().int()])}).merge(Tg).strict(),Mg=i.object({jsonrpc:i.literal(Xo),id:i.union([i.string(),i.number().int()]),result:Jn}).strict(),Ng=i.object({jsonrpc:i.literal(Xo),id:i.union([i.string(),i.number().int()]),error:i.object({code:i.number().int(),message:i.string(),data:i.optional(i.unknown())})}).strict(),Dg=i.object({jsonrpc:i.literal(Xo)}).merge(i.object({method:i.string(),params:i.optional(oa)})).strict();i.union([Pg,Dg,Mg,Ng]);var Fg={};ra(Fg,{mergeIntoDataStream:()=>qg,toDataStream:()=>Ug,toDataStreamResponse:()=>$g});function Xu(e={}){let t=new TextEncoder,r="";return new TransformStream({start(){return A(this,null,function*(){e.onStart&&(yield e.onStart());})},transform(o,s){return A(this,null,function*(){s.enqueue(t.encode(o)),r+=o,e.onToken&&(yield e.onToken(o)),e.onText&&typeof o=="string"&&(yield e.onText(o));})},flush(){return A(this,null,function*(){e.onCompletion&&(yield e.onCompletion(r)),e.onFinal&&(yield e.onFinal(r));})}})}function sa(e,t){return e.pipeThrough(new TransformStream({transform:(r,n)=>A(null,null,function*(){var o;if(typeof r=="string"){n.enqueue(r);return}if("event"in r){r.event==="on_chat_model_stream"&&Hl((o=r.data)==null?void 0:o.chunk,n);return}Hl(r,n);})})).pipeThrough(Xu(t)).pipeThrough(new TextDecoderStream).pipeThrough(new TransformStream({transform:(r,n)=>A(null,null,function*(){n.enqueue(ze("text",r));})}))}function Ug(e,t){return sa(e,t).pipeThrough(new TextEncoderStream)}function $g(e,t){var r;let n=sa(e,t==null?void 0:t.callbacks).pipeThrough(new TextEncoderStream),o=t==null?void 0:t.data,s=t==null?void 0:t.init,a=o?na(o.stream,n):n;return new Response(a,{status:(r=s==null?void 0:s.status)!=null?r:200,statusText:s==null?void 0:s.statusText,headers:nn(s==null?void 0:s.headers,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}function qg(e,t){t.dataStream.merge(sa(e,t.callbacks));}function Hl(e,t){if(typeof e.content=="string")t.enqueue(e.content);else {let r=e.content;for(let n of r)n.type==="text"&&t.enqueue(n.text);}}var Bg={};ra(Bg,{mergeIntoDataStream:()=>Vg,toDataStream:()=>zg,toDataStreamResponse:()=>Lg});function aa(e,t){let r=Jg();return yi(e[Symbol.asyncIterator]()).pipeThrough(new TransformStream({transform(o,s){return A(this,null,function*(){s.enqueue(r(o.delta));})}})).pipeThrough(Xu(t)).pipeThrough(new TextDecoderStream).pipeThrough(new TransformStream({transform:(o,s)=>A(null,null,function*(){s.enqueue(ze("text",o));})}))}function zg(e,t){return aa(e,t).pipeThrough(new TextEncoderStream)}function Lg(e,t={}){var r;let{init:n,data:o,callbacks:s}=t,a=aa(e,s).pipeThrough(new TextEncoderStream),l=o?na(o.stream,a):a;return new Response(l,{status:(r=n==null?void 0:n.status)!=null?r:200,statusText:n==null?void 0:n.statusText,headers:nn(n==null?void 0:n.headers,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}function Vg(e,t){t.dataStream.merge(aa(e,t.callbacks));}function Jg(){let e=true;return t=>(e&&(t=t.trimStart(),t&&(e=false)),t)}var L=_s(Pp());var ps,ao=class ao extends L.Message{constructor(r){super();Br(this,ps,[]);L.Message.initialize(this,Array.isArray(r)?r:[],0,-1,[],Pt(this,ps)),!Array.isArray(r)&&typeof r=="object"&&("name"in r&&r.name!=null&&(this.name=r.name),"mime_type"in r&&r.mime_type!=null&&(this.mime_type=r.mime_type),"data"in r&&r.data!=null&&(this.data=r.data));}get name(){return L.Message.getFieldWithDefault(this,1,"")}set name(r){L.Message.setField(this,1,r);}get mime_type(){return L.Message.getFieldWithDefault(this,2,"")}set mime_type(r){L.Message.setField(this,2,r);}get data(){return L.Message.getFieldWithDefault(this,3,new Uint8Array(0))}set data(r){L.Message.setField(this,3,r);}static fromObject(r){let n=new ao({});return r.name!=null&&(n.name=r.name),r.mime_type!=null&&(n.mime_type=r.mime_type),r.data!=null&&(n.data=r.data),n}toObject(){let r={};return this.name!=null&&(r.name=this.name),this.mime_type!=null&&(r.mime_type=this.mime_type),this.data!=null&&(r.data=this.data),r}serialize(r){let n=r||new L.BinaryWriter;if(this.name.length&&n.writeString(1,this.name),this.mime_type.length&&n.writeString(2,this.mime_type),this.data.length&&n.writeBytes(3,this.data),!r)return n.getResultBuffer()}static deserialize(r){let n=r instanceof L.BinaryReader?r:new L.BinaryReader(r),o=new ao;for(;n.nextField()&&!n.isEndGroup();)switch(n.getFieldNumber()){case 1:o.name=n.readString();break;case 2:o.mime_type=n.readString();break;case 3:o.data=n.readBytes();break;default:n.skipField();}return o}serializeBinary(){return this.serialize()}static deserializeBinary(r){return ao.deserialize(r)}};ps=new WeakMap;var oo=ao;var cs,io=class io extends L.Message{constructor(r){super();Br(this,cs,[]);L.Message.initialize(this,Array.isArray(r)?r:[],0,-1,[2],Pt(this,cs)),!Array.isArray(r)&&typeof r=="object"&&("role"in r&&r.role!=null&&(this.role=r.role),"content"in r&&r.content!=null&&(this.content=r.content));}get role(){return L.Message.getFieldWithDefault(this,1,"")}set role(r){L.Message.setField(this,1,r);}get content(){return L.Message.getRepeatedWrapperField(this,mn,2)}set content(r){L.Message.setRepeatedWrapperField(this,2,r);}static fromObject(r){let n=new io({});return r.role!=null&&(n.role=r.role),r.content!=null&&(n.content=r.content.map(o=>mn.fromObject(o))),n}toObject(){let r={};return this.role!=null&&(r.role=this.role),this.content!=null&&(r.content=this.content.map(n=>n.toObject())),r}serialize(r){let n=r||new L.BinaryWriter;if(this.role.length&&n.writeString(1,this.role),this.content.length&&n.writeRepeatedMessage(2,this.content,o=>o.serialize(n)),!r)return n.getResultBuffer()}static deserialize(r){let n=r instanceof L.BinaryReader?r:new L.BinaryReader(r),o=new io;for(;n.nextField()&&!n.isEndGroup();)switch(n.getFieldNumber()){case 1:o.role=n.readString();break;case 2:n.readMessage(o.content,()=>L.Message.addToRepeatedWrapperField(o,2,mn.deserialize(n),mn));break;default:n.skipField();}return o}serializeBinary(){return this.serialize()}static deserializeBinary(r){return io.deserialize(r)}};cs=new WeakMap;var hn=io,ds,lo=class lo extends L.Message{constructor(r){super();Br(this,ds,[]);L.Message.initialize(this,Array.isArray(r)?r:[],0,-1,[1],Pt(this,ds)),!Array.isArray(r)&&typeof r=="object"&&"messages"in r&&r.messages!=null&&(this.messages=r.messages);}get messages(){return L.Message.getRepeatedWrapperField(this,hn,1)}set messages(r){L.Message.setRepeatedWrapperField(this,1,r);}static fromObject(r){let n=new lo({});return r.messages!=null&&(n.messages=r.messages.map(o=>hn.fromObject(o))),n}toObject(){let r={};return this.messages!=null&&(r.messages=this.messages.map(n=>n.toObject())),r}serialize(r){let n=r||new L.BinaryWriter;if(this.messages.length&&n.writeRepeatedMessage(1,this.messages,o=>o.serialize(n)),!r)return n.getResultBuffer()}static deserialize(r){let n=r instanceof L.BinaryReader?r:new L.BinaryReader(r),o=new lo;for(;n.nextField()&&!n.isEndGroup();)switch(n.getFieldNumber()){case 1:n.readMessage(o.messages,()=>L.Message.addToRepeatedWrapperField(o,1,hn.deserialize(n),hn));break;default:n.skipField();}return o}serializeBinary(){return this.serialize()}static deserializeBinary(r){return lo.deserialize(r)}};ds=new WeakMap;var so=lo,gn,uo=class uo extends L.Message{constructor(r){super();Br(this,gn,[[1,2]]);L.Message.initialize(this,Array.isArray(r)?r:[],0,-1,[],Pt(this,gn)),!Array.isArray(r)&&typeof r=="object"&&("text"in r&&r.text!=null&&(this.text=r.text),"file"in r&&r.file!=null&&(this.file=r.file));}get text(){return L.Message.getFieldWithDefault(this,1,"")}set text(r){L.Message.setOneofField(this,1,Pt(this,gn)[0],r);}get has_text(){return L.Message.getField(this,1)!=null}get file(){return L.Message.getWrapperField(this,oo,2)}set file(r){L.Message.setOneofWrapperField(this,2,Pt(this,gn)[0],r);}get has_file(){return L.Message.getField(this,2)!=null}get input(){return {0:"none",1:"text",2:"file"}[L.Message.computeOneofCase(this,[1,2])]}static fromObject(r){let n=new uo({});return r.text!=null&&(n.text=r.text),r.file!=null&&(n.file=oo.fromObject(r.file)),n}toObject(){let r={};return this.text!=null&&(r.text=this.text),this.file!=null&&(r.file=this.file.toObject()),r}serialize(r){let n=r||new L.BinaryWriter;if(this.has_text&&n.writeString(1,this.text),this.has_file&&n.writeMessage(2,this.file,()=>this.file.serialize(n)),!r)return n.getResultBuffer()}static deserialize(r){let n=r instanceof L.BinaryReader?r:new L.BinaryReader(r),o=new uo;for(;n.nextField()&&!n.isEndGroup();)switch(n.getFieldNumber()){case 1:o.text=n.readString();break;case 2:n.readMessage(o.file,()=>o.file=oo.deserialize(n));break;default:n.skipField();}return o}serializeBinary(){return this.serialize()}static deserializeBinary(r){return uo.deserialize(r)}};gn=new WeakMap;var mn=uo,yn,po=class po extends L.Message{constructor(r){super();Br(this,yn,[[1,2]]);L.Message.initialize(this,Array.isArray(r)?r:[],0,-1,[],Pt(this,yn)),!Array.isArray(r)&&typeof r=="object"&&("prompt"in r&&r.prompt!=null&&(this.prompt=r.prompt),"messages"in r&&r.messages!=null&&(this.messages=r.messages));}get prompt(){return L.Message.getFieldWithDefault(this,1,"")}set prompt(r){L.Message.setOneofField(this,1,Pt(this,yn)[0],r);}get has_prompt(){return L.Message.getField(this,1)!=null}get messages(){return L.Message.getWrapperField(this,so,2)}set messages(r){L.Message.setOneofWrapperField(this,2,Pt(this,yn)[0],r);}get has_messages(){return L.Message.getField(this,2)!=null}get input(){return {0:"none",1:"prompt",2:"messages"}[L.Message.computeOneofCase(this,[1,2])]}static fromObject(r){let n=new po({});return r.prompt!=null&&(n.prompt=r.prompt),r.messages!=null&&(n.messages=so.fromObject(r.messages)),n}toObject(){let r={};return this.prompt!=null&&(r.prompt=this.prompt),this.messages!=null&&(r.messages=this.messages.toObject()),r}serialize(r){let n=r||new L.BinaryWriter;if(this.has_prompt&&n.writeString(1,this.prompt),this.has_messages&&n.writeMessage(2,this.messages,()=>this.messages.serialize(n)),!r)return n.getResultBuffer()}static deserialize(r){let n=r instanceof L.BinaryReader?r:new L.BinaryReader(r),o=new po;for(;n.nextField()&&!n.isEndGroup();)switch(n.getFieldNumber()){case 1:o.prompt=n.readString();break;case 2:n.readMessage(o.messages,()=>o.messages=so.deserialize(n));break;default:n.skipField();}return o}serializeBinary(){return this.serialize()}static deserializeBinary(r){return po.deserialize(r)}};yn=new WeakMap;var dr=po;var ay=(e,t,r,n,o)=>A(null,null,function*(){let s=e.openAI.chat(r,d({},t)),a=dr.deserializeBinary(n),l=[];a.has_messages&&(l=a.messages.messages.map(m=>({role:m.role,content:m.content.map(y=>y.has_file?{type:"file",data:y.file.data,filename:y.file.name,mimeType:y.file.mime_type}:{type:"text",text:y.text})})));let u=l.length===0?ln({model:s,prompt:a.prompt}):ln({model:s,messages:l}),{text:p}=yield u,f=new TextEncoder().encode(p);Dart.send_value(o,f);}),iy=(e,t,r,n)=>A(null,null,function*(){let o=e.openAI.responses(t),s=dr.deserializeBinary(r),a=[];s.has_messages&&(a=s.messages.messages.map(v=>({role:v.role,content:v.content.map(x=>x.has_file?{type:"file",data:x.file.data,filename:x.file.name,mimeType:x.file.mime_type}:{type:"text",text:x.text})})));let u=yield a.length===0?un({model:o,prompt:s.prompt}):un({model:o,messages:a});try{for(var p=vr(u.fullStream),f,m,y;f=!(m=yield p.next()).done;f=!1){let v=m.value;if(v.type==="reasoning"||v.type==="text-delta"){let x=new TextEncoder().encode(v.textDelta);Dart.stream_value(n,x);}}}catch(m){y=[m];}finally{try{f&&(m=p.return)&&(yield m.call(p));}finally{if(y)throw y[0]}}Dart.stream_value_end(n);}),ly=(e,t,r,n,o)=>A(null,null,function*(){let s=lr.convert(n),a=yield Ko({model:e.openAI.responses(t),schema:s,prompt:r}),l=JsonPayload.encode(a.object);if(!l){Dart.send_error(o,"Failed to encode object");return}Dart.send_value(o,l);}),uy=(e,t,r,n,o)=>A(null,null,function*(){let s=lr.convert(n),{fullStream:a}=yield Yo({model:e.openAI.responses(t),schema:s,prompt:r});try{for(var l=vr(a),u,p,f;u=!(p=yield l.next()).done;u=!1){let m=p.value;if(m.type!="object")continue;let y=JsonPayload.encode(m.object);if(!y){Dart.send_error(o,"Failed to encode object");return}Dart.stream_value(o,y);}}catch(p){f=[p];}finally{try{u&&(p=l.return)&&(yield p.call(l));}finally{if(f)throw f[0]}}Dart.stream_value_end(o);}),Mp={openai_chat_generate_text:ay,openai_chat_stream_text:iy,openai_chat_generate_object:ly,openai_chat_stream_object:uy};var py=(e,t,r,n,o)=>A(null,null,function*(){let s=e.google.chat(r,d({},t)),a=dr.deserializeBinary(n),l=[];a.has_messages&&(l=a.messages.messages.map(m=>({role:m.role,content:m.content.map(y=>y.has_file?{type:"file",data:y.file.data,filename:y.file.name,mimeType:y.file.mime_type}:{type:"text",text:y.text})})));let u=l.length===0?ln({model:s,prompt:a.prompt}):ln({model:s,messages:l}),{text:p}=yield u,f=new TextEncoder().encode(p);Dart.send_value(o,f);}),cy=(e,t,r,n)=>A(null,null,function*(){let o=e.google.chat(t),s=dr.deserializeBinary(r),a=[];s.has_messages&&(a=s.messages.messages.map(v=>({role:v.role,content:v.content.map(x=>x.has_file?{type:"file",data:x.file.data,filename:x.file.name,mimeType:x.file.mime_type}:{type:"text",text:x.text})})));let u=yield a.length===0?un({model:o,prompt:s.prompt}):un({model:o,messages:a});try{for(var p=vr(u.fullStream),f,m,y;f=!(m=yield p.next()).done;f=!1){let v=m.value;if(v.type==="reasoning"||v.type==="text-delta"){let x=new TextEncoder().encode(v.textDelta);Dart.stream_value(n,x);}}}catch(m){y=[m];}finally{try{f&&(m=p.return)&&(yield m.call(p));}finally{if(y)throw y[0]}}Dart.stream_value_end(n);}),dy=(e,t,r,n,o)=>A(null,null,function*(){let s=lr.convert(n),a=yield Ko({model:e.google.chat(t),schema:s,prompt:r}),l=JsonPayload.encode(a.object);if(!l){Dart.send_error(o,"Failed to encode object");return}Dart.send_value(o,l);}),fy=(e,t,r,n,o)=>A(null,null,function*(){let s=lr.convert(n),{fullStream:a}=yield Yo({model:e.google.chat(t),schema:s,prompt:r});try{for(var l=vr(a),u,p,f;u=!(p=yield l.next()).done;u=!1){let m=p.value;if(m.type!="object")continue;let y=JsonPayload.encode(m.object);if(!y){Dart.send_error(o,"Failed to encode object");return}Dart.stream_value(o,y);}}catch(p){f=[p];}finally{try{u&&(p=l.return)&&(yield p.call(l));}finally{if(f)throw f[0]}}Dart.stream_value_end(o);}),Np={google_gen_ai_chat_generate_text:py,google_gen_ai_chat_stream_text:cy,google_gen_ai_chat_generate_object:dy,google_gen_ai_chat_stream_object:fy};var ba=_s(Ts());function co(...e){return e.reduce((t,r)=>d(d({},t),r!=null?r:{}),{})}function hy(){let e="",t,r=[],n,o;function s(u,p){if(u===""){a(p);return}if(u.startsWith(":"))return;let f=u.indexOf(":");if(f===-1){l(u,"");return}let m=u.slice(0,f),y=f+1,v=y<u.length&&u[y]===" "?u.slice(y+1):u.slice(y);l(m,v);}function a(u){r.length>0&&(u.enqueue({event:t,data:r.join(`
`),id:n,retry:o}),r=[],t=void 0,o=void 0);}function l(u,p){switch(u){case "event":t=p;break;case "data":r.push(p);break;case "id":n=p;break;case "retry":let f=parseInt(p,10);isNaN(f)||(o=f);break}}return new TransformStream({transform(u,p){let{lines:f,incompleteLine:m}=my(e,u);e=m;for(let y=0;y<f.length;y++)s(f[y],p);},flush(u){s(e,u),a(u);}})}function my(e,t){let r=[],n=e;for(let o=0;o<t.length;){let s=t[o++];s===`
`?(r.push(n),n=""):s==="\r"?(r.push(n),n="",t[o]===`
`&&o++):n+=s;}return {lines:r,incompleteLine:n}}function fs(e){let t={};return e.headers.forEach((r,n)=>{t[n]=r;}),t}var gy=({prefix:e,size:t=16,alphabet:r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:n="-"}={})=>{let o=To(r,t);if(e==null)return o;if(r.includes(n))throw new nr({argument:"separator",message:`The separator "${n}" must not be part of the alphabet "${r}".`});return s=>`${e}${n}${o(s)}`},Dp=gy();function yy(e){return Object.fromEntries(Object.entries(e).filter(([t,r])=>r!=null))}function ya(e){return e instanceof Error&&(e.name==="AbortError"||e.name==="TimeoutError")}function Fp({apiKey:e,environmentVariableName:t,apiKeyParameterName:r="apiKey",description:n}){if(typeof e=="string")return e;if(e!=null)throw new Mt({message:`${n} API key must be a string.`});if(typeof process=="undefined")throw new Mt({message:`${n} API key is missing. Pass it using the '${r}' parameter. Environment variables is not supported in this environment.`});if(e=process.env[t],e==null)throw new Mt({message:`${n} API key is missing. Pass it using the '${r}' parameter or the ${t} environment variable.`});if(typeof e!="string")throw new Mt({message:`${n} API key must be a string. The value of the ${t} environment variable is not a string.`});return e}var va=Symbol.for("vercel.ai.validator");function vy(e){return {[va]:true,validate:e}}function by(e){return typeof e=="object"&&e!==null&&va in e&&e[va]===true&&"validate"in e}function _y(e){return by(e)?e:wy(e)}function wy(e){return vy(t=>{let r=e.safeParse(t);return r.success?{success:true,value:r.data}:{success:false,error:r.error}})}function xy({value:e,schema:t}){let r=_a({value:e,schema:t});if(!r.success)throw Be.wrap({value:e,cause:r.error});return r.value}function _a({value:e,schema:t}){let r=_y(t);try{if(r.validate==null)return {success:!0,value:e};let n=r.validate(e);return n.success?n:{success:!1,error:Be.wrap({value:e,cause:n.error})}}catch(n){return {success:false,error:Be.wrap({value:e,cause:n})}}}function Sy({text:e,schema:t}){try{let r=ba.default.parse(e);return t==null?r:xy({value:r,schema:t})}catch(r){throw dt.isInstance(r)||Be.isInstance(r)?r:new dt({text:e,cause:r})}}function Up({text:e,schema:t}){try{let r=ba.default.parse(e);if(t==null)return {success:!0,value:r,rawValue:r};let n=_a({value:r,schema:t});return n.success?g(d({},n),{rawValue:r}):n}catch(r){return {success:false,error:dt.isInstance(r)?r:new dt({text:e,cause:r})}}}function $p({provider:e,providerOptions:t,schema:r}){if((t==null?void 0:t[e])==null)return;let n=_a({value:t[e],schema:r});if(!n.success)throw new nr({argument:"providerOptions",message:`invalid ${e} provider options`,cause:n.error});return n.value}var Ty=()=>globalThis.fetch,fo=l=>A(null,[l],function*({url:e,headers:t,body:r,failedResponseHandler:n,successfulResponseHandler:o,abortSignal:s,fetch:a}){return Iy({url:e,headers:d({"Content-Type":"application/json"},t),body:{content:JSON.stringify(r),values:r},failedResponseHandler:n,successfulResponseHandler:o,abortSignal:s,fetch:a})});var Iy=l=>A(null,[l],function*({url:e,headers:t={},body:r,successfulResponseHandler:n,failedResponseHandler:o,abortSignal:s,fetch:a=Ty()}){try{let u=yield a(e,{method:"POST",headers:yy(t),body:r.content,signal:s}),p=fs(u);if(!u.ok){let f;try{f=yield o({response:u,url:e,requestBodyValues:r.values});}catch(m){throw ya(m)||Se.isInstance(m)?m:new Se({message:"Failed to process error response",cause:m,statusCode:u.status,url:e,responseHeaders:p,requestBodyValues:r.values})}throw f.value}try{return yield n({response:u,url:e,requestBodyValues:r.values})}catch(f){throw f instanceof Error&&(ya(f)||Se.isInstance(f))?f:new Se({message:"Failed to process successful response",cause:f,statusCode:u.status,url:e,responseHeaders:p,requestBodyValues:r.values})}}catch(u){if(ya(u))throw u;if(u instanceof TypeError&&u.message==="fetch failed"){let p=u.cause;if(p!=null)throw new Se({message:`Cannot connect to API: ${p.message}`,cause:p,url:e,requestBodyValues:r.values,isRetryable:true})}throw u}});function ho(e){return A(this,null,function*(){return typeof e=="function"&&(e=e()),Promise.resolve(e)})}var qp=({errorSchema:e,errorToMessage:t,isRetryable:r})=>a=>A(null,[a],function*({response:n,url:o,requestBodyValues:s}){let l=yield n.text(),u=fs(n);if(l.trim()==="")return {responseHeaders:u,value:new Se({message:n.statusText,url:o,requestBodyValues:s,statusCode:n.status,responseHeaders:u,responseBody:l,isRetryable:r==null?void 0:r(n)})};try{let p=Sy({text:l,schema:e});return {responseHeaders:u,value:new Se({message:t(p),url:o,requestBodyValues:s,statusCode:n.status,responseHeaders:u,responseBody:l,data:p,isRetryable:r==null?void 0:r(n,p)})}}catch(p){return {responseHeaders:u,value:new Se({message:n.statusText,url:o,requestBodyValues:s,statusCode:n.status,responseHeaders:u,responseBody:l,isRetryable:r==null?void 0:r(n)})}}}),Bp=e=>r=>A(null,[r],function*({response:t}){let n=fs(t);if(t.body==null)throw new _o({});return {responseHeaders:n,value:t.body.pipeThrough(new TextDecoderStream).pipeThrough(hy()).pipeThrough(new TransformStream({transform({data:o},s){o!=="[DONE]"&&s.enqueue(Up({text:o,schema:e}));}}))}});var hs=e=>o=>A(null,[o],function*({response:t,url:r,requestBodyValues:n}){let s=yield t.text(),a=Up({text:s,schema:e}),l=fs(t);if(!a.success)throw new Se({message:"Invalid JSON response",cause:a.error,statusCode:t.status,responseHeaders:l,responseBody:s,url:r,requestBodyValues:n});return {responseHeaders:l,value:a.value,rawValue:a.rawValue}});var{btoa:ky}=globalThis;function zp(e){let t="";for(let r=0;r<e.length;r++)t+=String.fromCodePoint(e[r]);return ky(t)}function Lp(e){return e==null?void 0:e.replace(/\/$/,"")}function gt(e){if(Ay(e))return;if(typeof e=="boolean")return {type:"boolean",properties:{}};let{type:t,description:r,required:n,properties:o,items:s,allOf:a,anyOf:l,oneOf:u,format:p,const:f,minLength:m,enum:y}=e,v={};if(r&&(v.description=r),n&&(v.required=n),p&&(v.format=p),f!==void 0&&(v.enum=[f]),t&&(Array.isArray(t)?t.includes("null")?(v.type=t.filter(x=>x!=="null")[0],v.nullable=true):v.type=t:t==="null"?v.type="null":v.type=t),y!==void 0&&(v.enum=y),o!=null&&(v.properties=Object.entries(o).reduce((x,[S,_])=>(x[S]=gt(_),x),{})),s&&(v.items=Array.isArray(s)?s.map(gt):gt(s)),a&&(v.allOf=a.map(gt)),l)if(l.some(x=>typeof x=="object"&&(x==null?void 0:x.type)==="null")){let x=l.filter(S=>!(typeof S=="object"&&(S==null?void 0:S.type)==="null"));if(x.length===1){let S=gt(x[0]);typeof S=="object"&&(v.nullable=true,Object.assign(v,S));}else v.anyOf=x.map(gt),v.nullable=true;}else v.anyOf=l.map(gt);return u&&(v.oneOf=u.map(gt)),m!==void 0&&(v.minLength=m),v}function Ay(e){return e!=null&&typeof e=="object"&&e.type==="object"&&(e.properties==null||Object.keys(e.properties).length===0)}function Ey(e){var t,r;let n=[],o=[],s=true;for(let{role:a,content:l}of e)switch(a){case "system":{if(!s)throw new ae({functionality:"system messages are only supported at the beginning of the conversation"});n.push({text:l});break}case "user":{s=false;let u=[];for(let p of l)switch(p.type){case "text":{u.push({text:p.text});break}case "image":{u.push(p.image instanceof URL?{fileData:{mimeType:(t=p.mimeType)!=null?t:"image/jpeg",fileUri:p.image.toString()}}:{inlineData:{mimeType:(r=p.mimeType)!=null?r:"image/jpeg",data:zp(p.image)}});break}case "file":{u.push(p.data instanceof URL?{fileData:{mimeType:p.mimeType,fileUri:p.data.toString()}}:{inlineData:{mimeType:p.mimeType,data:p.data}});break}}o.push({role:"user",parts:u});break}case "assistant":{s=false,o.push({role:"model",parts:l.map(u=>{switch(u.type){case "text":return u.text.length===0?void 0:{text:u.text};case "file":{if(u.mimeType!=="image/png")throw new ae({functionality:"Only PNG images are supported in assistant messages"});if(u.data instanceof URL)throw new ae({functionality:"File data URLs in assistant messages are not supported"});return {inlineData:{mimeType:u.mimeType,data:u.data}}}case "tool-call":return {functionCall:{name:u.toolName,args:u.args}}}}).filter(u=>u!==void 0)});break}case "tool":{s=false,o.push({role:"user",parts:l.map(u=>({functionResponse:{name:u.toolName,response:{name:u.toolName,content:u.result}}}))});break}}return {systemInstruction:n.length>0?{parts:n}:void 0,contents:o}}function Vp(e){return e.includes("/")?e:`models/${e}`}var Cy=i.object({error:i.object({code:i.number().nullable(),message:i.string(),status:i.string()})}),wa=qp({errorSchema:Cy,errorToMessage:e=>e.error.message});function Ry(e,t,r,n){var o,s;let a=(o=e.tools)!=null&&o.length?e.tools:void 0,l=[],u=n.includes("gemini-2"),p=n.includes("gemini-1.5-flash")&&!n.includes("-8b");if(t)return {tools:u?{googleSearch:{}}:{googleSearchRetrieval:!p||!r?{}:{dynamicRetrievalConfig:r}},toolConfig:void 0,toolWarnings:l};if(a==null)return {tools:void 0,toolConfig:void 0,toolWarnings:l};let f=[];for(let v of a)v.type==="provider-defined"?l.push({type:"unsupported-tool",tool:v}):f.push({name:v.name,description:(s=v.description)!=null?s:"",parameters:gt(v.parameters)});let m=e.toolChoice;if(m==null)return {tools:{functionDeclarations:f},toolConfig:void 0,toolWarnings:l};let y=m.type;switch(y){case "auto":return {tools:{functionDeclarations:f},toolConfig:{functionCallingConfig:{mode:"AUTO"}},toolWarnings:l};case "none":return {tools:{functionDeclarations:f},toolConfig:{functionCallingConfig:{mode:"NONE"}},toolWarnings:l};case "required":return {tools:{functionDeclarations:f},toolConfig:{functionCallingConfig:{mode:"ANY"}},toolWarnings:l};case "tool":return {tools:{functionDeclarations:f},toolConfig:{functionCallingConfig:{mode:"ANY",allowedFunctionNames:[m.toolName]}},toolWarnings:l};default:{let v=y;throw new ae({functionality:`Unsupported tool choice type: ${v}`})}}}function Jp({finishReason:e,hasToolCalls:t}){switch(e){case "STOP":return t?"tool-calls":"stop";case "MAX_TOKENS":return "length";case "IMAGE_SAFETY":case "RECITATION":case "SAFETY":case "BLOCKLIST":case "PROHIBITED_CONTENT":case "SPII":return "content-filter";case "FINISH_REASON_UNSPECIFIED":case "OTHER":return "other";case "MALFORMED_FUNCTION_CALL":return "error";default:return "unknown"}}var jy=class{constructor(e,t,r){this.specificationVersion="v1",this.defaultObjectGenerationMode="json",this.supportsImageUrls=false,this.modelId=e,this.settings=t,this.config=r;}get supportsStructuredOutputs(){var e;return (e=this.settings.structuredOutputs)!=null?e:true}get provider(){return this.config.provider}getArgs(y){return A(this,arguments,function*({mode:e,prompt:t,maxTokens:r,temperature:n,topP:o,topK:s,frequencyPenalty:a,presencePenalty:l,stopSequences:u,responseFormat:p,seed:f,providerMetadata:m}){var v,x,S;let _=e.type,I=[],R=$p({provider:"google",providerOptions:m,schema:Ny});((v=R==null?void 0:R.thinkingConfig)==null?void 0:v.includeThoughts)===true&&!this.config.provider.startsWith("google.vertex.")&&I.push({type:"other",message:`The 'includeThoughts' option is only supported with the Google Vertex provider and might not be supported or could behave unexpectedly with the current Google provider (${this.config.provider}).`});let T=g(d({maxOutputTokens:r,temperature:n,topK:s,topP:o,frequencyPenalty:a,presencePenalty:l,stopSequences:u,seed:f,responseMimeType:(p==null?void 0:p.type)==="json"?"application/json":void 0,responseSchema:(p==null?void 0:p.type)==="json"&&p.schema!=null&&this.supportsStructuredOutputs?gt(p.schema):void 0},this.settings.audioTimestamp&&{audioTimestamp:this.settings.audioTimestamp}),{responseModalities:R==null?void 0:R.responseModalities,thinkingConfig:R==null?void 0:R.thinkingConfig}),{contents:N,systemInstruction:F}=Ey(t);switch(_){case "regular":{let{tools:O,toolConfig:Y,toolWarnings:P}=Ry(e,(x=this.settings.useSearchGrounding)!=null?x:false,this.settings.dynamicRetrievalConfig,this.modelId);return {args:{generationConfig:T,contents:N,systemInstruction:F,safetySettings:this.settings.safetySettings,tools:O,toolConfig:Y,cachedContent:this.settings.cachedContent},warnings:[...I,...P]}}case "object-json":return {args:{generationConfig:g(d({},T),{responseMimeType:"application/json",responseSchema:e.schema!=null&&this.supportsStructuredOutputs?gt(e.schema):void 0}),contents:N,systemInstruction:F,safetySettings:this.settings.safetySettings,cachedContent:this.settings.cachedContent},warnings:I};case "object-tool":return {args:{generationConfig:T,contents:N,tools:{functionDeclarations:[{name:e.tool.name,description:(S=e.tool.description)!=null?S:"",parameters:gt(e.tool.parameters)}]},toolConfig:{functionCallingConfig:{mode:"ANY"}},safetySettings:this.settings.safetySettings,cachedContent:this.settings.cachedContent},warnings:I};default:{let O=_;throw new Error(`Unsupported type: ${O}`)}}})}supportsUrl(e){return this.config.isSupportedUrl(e)}doGenerate(e){return A(this,null,function*(){var t,r,n,o,s;let{args:a,warnings:l}=yield this.getArgs(e),u=JSON.stringify(a),p=co(yield ho(this.config.headers),e.headers),{responseHeaders:f,value:m,rawValue:y}=yield fo({url:`${this.config.baseURL}/${Vp(this.modelId)}:generateContent`,headers:p,body:a,failedResponseHandler:wa,successfulResponseHandler:hs(Py),abortSignal:e.abortSignal,fetch:this.config.fetch}),T=a,{contents:v}=T,x=qe(T,["contents"]),S=m.candidates[0],_=S.content==null||typeof S.content!="object"||!("parts"in S.content)?[]:S.content.parts,I=Zp({parts:_,generateId:this.config.generateId}),R=m.usageMetadata;return {text:Gp(_),reasoning:Hp(_),files:(t=Wp(_))==null?void 0:t.map(N=>({data:N.inlineData.data,mimeType:N.inlineData.mimeType})),toolCalls:I,finishReason:Jp({finishReason:S.finishReason,hasToolCalls:I!=null&&I.length>0}),usage:{promptTokens:(r=R==null?void 0:R.promptTokenCount)!=null?r:NaN,completionTokens:(n=R==null?void 0:R.candidatesTokenCount)!=null?n:NaN},rawCall:{rawPrompt:v,rawSettings:x},rawResponse:{headers:f,body:y},warnings:l,providerMetadata:{google:{groundingMetadata:(o=S.groundingMetadata)!=null?o:null,safetyRatings:(s=S.safetyRatings)!=null?s:null}},sources:Kp({groundingMetadata:S.groundingMetadata,generateId:this.config.generateId}),request:{body:u}}})}doStream(e){return A(this,null,function*(){let{args:t,warnings:r}=yield this.getArgs(e),n=JSON.stringify(t),o=co(yield ho(this.config.headers),e.headers),{responseHeaders:s,value:a}=yield fo({url:`${this.config.baseURL}/${Vp(this.modelId)}:streamGenerateContent?alt=sse`,headers:o,body:t,failedResponseHandler:wa,successfulResponseHandler:Bp(My),abortSignal:e.abortSignal,fetch:this.config.fetch}),x=t,{contents:l}=x,u=qe(x,["contents"]),p="unknown",f={promptTokens:Number.NaN,completionTokens:Number.NaN},m,y=this.config.generateId,v=false;return {stream:a.pipeThrough(new TransformStream({transform(S,_){var I,R,T,N,F,O;if(!S.success){_.enqueue({type:"error",error:S.error});return}let Y=S.value,P=Y.usageMetadata;P!=null&&(f={promptTokens:(I=P.promptTokenCount)!=null?I:NaN,completionTokens:(R=P.candidatesTokenCount)!=null?R:NaN});let q=(T=Y.candidates)==null?void 0:T[0];if(q==null)return;let oe=q.content;if(oe!=null){let ye=Gp(oe.parts);ye!=null&&_.enqueue({type:"text-delta",textDelta:ye});let ke=Hp(oe.parts);if(ke!=null)for(let le of ke)_.enqueue({type:"reasoning",textDelta:le.text});let Te=Wp(oe.parts);if(Te!=null)for(let le of Te)_.enqueue({type:"file",mimeType:le.inlineData.mimeType,data:le.inlineData.data});let he=Zp({parts:oe.parts,generateId:y});if(he!=null)for(let le of he)_.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:le.toolCallId,toolName:le.toolName,argsTextDelta:le.args}),_.enqueue({type:"tool-call",toolCallType:"function",toolCallId:le.toolCallId,toolName:le.toolName,args:le.args}),v=true;}if(q.finishReason!=null){p=Jp({finishReason:q.finishReason,hasToolCalls:v});let ye=(N=Kp({groundingMetadata:q.groundingMetadata,generateId:y}))!=null?N:[];for(let ke of ye)_.enqueue({type:"source",source:ke});m={google:{groundingMetadata:(F=q.groundingMetadata)!=null?F:null,safetyRatings:(O=q.safetyRatings)!=null?O:null}};}},flush(S){S.enqueue({type:"finish",finishReason:p,usage:f,providerMetadata:m});}})),rawCall:{rawPrompt:l,rawSettings:u},rawResponse:{headers:s},warnings:r,request:{body:n}}})}};function Zp({parts:e,generateId:t}){let r=e==null?void 0:e.filter(n=>"functionCall"in n);return r==null||r.length===0?void 0:r.map(n=>({toolCallType:"function",toolCallId:t(),toolName:n.functionCall.name,args:JSON.stringify(n.functionCall.args)}))}function Gp(e){let t=e==null?void 0:e.filter(r=>"text"in r&&r.thought!==true);return t==null||t.length===0?void 0:t.map(r=>r.text).join("")}function Hp(e){let t=e==null?void 0:e.filter(r=>"text"in r&&r.thought===true);return t==null||t.length===0?void 0:t.map(r=>({type:"text",text:r.text}))}function Wp(e){return e==null?void 0:e.filter(t=>"inlineData"in t)}function Kp({groundingMetadata:e,generateId:t}){var r;return (r=e==null?void 0:e.groundingChunks)==null?void 0:r.filter(n=>n.web!=null).map(n=>({sourceType:"url",id:t(),url:n.web.uri,title:n.web.title}))}var Yp=i.object({role:i.string(),parts:i.array(i.union([i.object({text:i.string(),thought:i.boolean().nullish()}),i.object({functionCall:i.object({name:i.string(),args:i.unknown()})}),i.object({inlineData:i.object({mimeType:i.string(),data:i.string()})})])).nullish()}),Oy=i.object({web:i.object({uri:i.string(),title:i.string()}).nullish(),retrievedContext:i.object({uri:i.string(),title:i.string()}).nullish()}),Xp=i.object({webSearchQueries:i.array(i.string()).nullish(),retrievalQueries:i.array(i.string()).nullish(),searchEntryPoint:i.object({renderedContent:i.string()}).nullish(),groundingChunks:i.array(Oy).nullish(),groundingSupports:i.array(i.object({segment:i.object({startIndex:i.number().nullish(),endIndex:i.number().nullish(),text:i.string().nullish()}),segment_text:i.string().nullish(),groundingChunkIndices:i.array(i.number()).nullish(),supportChunkIndices:i.array(i.number()).nullish(),confidenceScores:i.array(i.number()).nullish(),confidenceScore:i.array(i.number()).nullish()})).nullish(),retrievalMetadata:i.union([i.object({webDynamicRetrievalScore:i.number()}),i.object({})]).nullish()}),Qp=i.object({category:i.string().nullish(),probability:i.string().nullish(),probabilityScore:i.number().nullish(),severity:i.string().nullish(),severityScore:i.number().nullish(),blocked:i.boolean().nullish()}),Py=i.object({candidates:i.array(i.object({content:Yp.nullish().or(i.object({}).strict()),finishReason:i.string().nullish(),safetyRatings:i.array(Qp).nullish(),groundingMetadata:Xp.nullish()})),usageMetadata:i.object({promptTokenCount:i.number().nullish(),candidatesTokenCount:i.number().nullish(),totalTokenCount:i.number().nullish()}).nullish()}),My=i.object({candidates:i.array(i.object({content:Yp.nullish(),finishReason:i.string().nullish(),safetyRatings:i.array(Qp).nullish(),groundingMetadata:Xp.nullish()})).nullish(),usageMetadata:i.object({promptTokenCount:i.number().nullish(),candidatesTokenCount:i.number().nullish(),totalTokenCount:i.number().nullish()}).nullish()}),Ny=i.object({responseModalities:i.array(i.enum(["TEXT","IMAGE"])).nullish(),thinkingConfig:i.object({thinkingBudget:i.number().nullish(),includeThoughts:i.boolean().nullish()}).nullish()}),Dy=class{constructor(e,t,r){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=r;}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){return 2048}get supportsParallelCalls(){return  true}doEmbed(n){return A(this,arguments,function*({values:e,headers:t,abortSignal:r}){if(e.length>this.maxEmbeddingsPerCall)throw new xo({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:e});let o=co(yield ho(this.config.headers),t),{responseHeaders:s,value:a}=yield fo({url:`${this.config.baseURL}/models/${this.modelId}:batchEmbedContents`,headers:o,body:{requests:e.map(l=>({model:`models/${this.modelId}`,content:{role:"user",parts:[{text:l}]},outputDimensionality:this.settings.outputDimensionality,taskType:this.settings.taskType}))},failedResponseHandler:wa,successfulResponseHandler:hs(Fy),abortSignal:r,fetch:this.config.fetch});return {embeddings:a.embeddings.map(l=>l.values),usage:void 0,rawResponse:{headers:s}}})}},Fy=i.object({embeddings:i.array(i.object({values:i.array(i.number())}))});function Uy(e){return e.toString().startsWith("https://generativelanguage.googleapis.com/v1beta/files/")}function xa(e={}){var t;let r=(t=Lp(e.baseURL))!=null?t:"https://generativelanguage.googleapis.com/v1beta",n=()=>d({"x-goog-api-key":Fp({apiKey:e.apiKey,environmentVariableName:"GOOGLE_GENERATIVE_AI_API_KEY",description:"Google Generative AI"})},e.headers),o=(l,u={})=>{var p;return new jy(l,u,{provider:"google.generative-ai",baseURL:r,headers:n,generateId:(p=e.generateId)!=null?p:Dp,isSupportedUrl:Uy,fetch:e.fetch})},s=(l,u={})=>new Dy(l,u,{provider:"google.generative-ai",baseURL:r,headers:n,fetch:e.fetch}),a=function(l,u){if(new.target)throw new Error("The Google Generative AI model function cannot be called with the new keyword.");return o(l,u)};return a.languageModel=o,a.chat=o,a.generativeAI=o,a.embedding=s,a.textEmbedding=s,a.textEmbeddingModel=s,a}xa();var NT={init:(e,t)=>e==="google_gen_ai"?{google:xa({apiKey:t})}:e==="openai"?{openAI:Ps({apiKey:t,compatibility:"strict"})}:{},functions:d(d({},Mp),Np)};
export{NT as default};
''';
